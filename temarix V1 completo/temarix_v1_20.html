<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Language" content="ko,en,pt">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V1 - Portal 20</title>
</head>
<body>
<!-- Temarix V2 - Portal 20: ë‚˜ë¥¼ ì´í•´í•´ì¤€ ë‹¨ í•œ ì‚¬ëŒ -->
<section class="portal portal-20" id="portal-20">
  <!-- Temarix Logo - Fixed Left Top -->
  <div class="temarix-logo">
    <h1 class="logo-text">ğŸŒŒ TEMARIX</h1>
    <p class="slogan" data-i18n="common.slogan">ë‹¹ì‹  ì•ˆì— ìˆ¨ì€ ì´ì•¼ê¸°ë¥¼ ë§ í•´ ì£¼ì„¸ìš”</p>
  </div>

  <!-- Language Selector - Fixed Right Top -->
  <div class="lang-selector">
    <button class="lang-btn active" data-lang="kr">KR</button>
    <button class="lang-btn" data-lang="en">EN</button>
    <button class="lang-btn" data-lang="pt">PT</button>
  </div>

  <!-- Portal Header - Center Top -->
  <div class="portal-header">
    <h1 data-i18n="portal20.title">ê°ì •ì˜ ë¬¸ì§€ë°© 20</h1>
    <h2 data-i18n="portal20.subtitle">ë‚˜ë¥¼ ì´í•´í•´ì¤€ ë‹¨ í•œ ì‚¬ëŒ</h2>
  </div>

  <!-- Message Stream -->
  <div class="message-stream" id="messageStream20">
    <!-- Messages will be added here via JavaScript -->
  </div>

  <!-- User Input Area -->
  <div class="input-area" id="inputArea20" style="display: none;">
    <div class="input-container">
      <textarea 
        id="userInput20" 
        rows="3" 
        placeholder="ë‹¹ì‹ ì„ ì§„ì‹¬ìœ¼ë¡œ ì´í•´í•´ì¤€ ê·¸ ì‚¬ëŒì— ëŒ€í•´ ì ì–´ë³´ì„¸ìš”..."
        data-i18n-placeholder="portal20.input.placeholder"
      ></textarea>
      <button class="submit-btn" onclick="submitResponse(20)">
        <span data-i18n="portal20.submit">ğŸ’ ì†Œì¤‘í•œ ì¸ì—° ë‚˜ëˆ„ê¸°</span>
      </button>
      <p class="input-hint" data-i18n="portal20.input.hint">Enter í‚¤ë¥¼ ëˆŒëŸ¬ë„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
    </div>
  </div>

  <!-- Next Portal Navigation -->
  <div class="next-portal-nav" id="nextPortalNav20" style="display: none;">
    <div class="nav-buttons">
      <button class="nav-btn yes-btn" onclick="goToNextPortal(21)" data-i18n="common.yes">ì˜ˆ</button>
      <button class="nav-btn no-btn" onclick="stayInPortal(20)" data-i18n="common.no">ì•„ë‹ˆìš”</button>
    </div>
  </div>

  <!-- Back to Main -->
  <div class="back-to-main">
    <button onclick="window.location.href='portal4.html'" data-i18n="common.back_to_main">
      ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°
    </button>
  </div>
</section>

<style>
/* Portal Base Styles */
.portal {
  min-height: 100vh;
  background: linear-gradient(135deg, #1a1b4b 0%, #2d1b69 100%);
  color: white;
  padding: 80px 20px 20px 20px;
  font-family: 'Apple SD Gothic Neo', -apple-system, BlinkMacSystemFont, sans-serif;
  max-width: 100%;
  margin: 0 auto;
  position: relative;
}

/* Logo Glow Animation */
@keyframes glowCycle {
  0%, 100% { text-shadow: 0 0 8px rgba(255,255,255,0.2); }
  50% { text-shadow: 0 0 25px rgba(255,255,255,0.7); }
}

/* Temarix Logo - Fixed Left Top */
.temarix-logo {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1000;
}

.logo-text {
  font-size: 1.8rem;
  font-weight: bold;
  color: #ffffff;
  margin: 0 0 5px 0;
  text-shadow: 0 0 20px rgba(255,255,255,0.3);
}

.slogan {
  color: #bbb;
  font-style: italic;
  font-size: 0.8rem;
  margin: 0;
}

/* Language Selector - Fixed Right Top */
.lang-selector {
  position: fixed;
  top: 20px;
  right: 20px;
  display: flex;
  gap: 5px;
  flex-wrap: wrap;
  max-width: 120px;
  z-index: 1000;
}

.lang-btn {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  color: white;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 0.7rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.lang-btn:hover {
  background: rgba(255,255,255,0.2);
}

.lang-btn.active {
  background: #9c27b0;
  border-color: #9c27b0;
}

/* Portal Header - Center Top */
.portal-header {
  text-align: center;
  margin: 40px 0 30px 0;
  padding-top: 40px;
}

.portal-header h1 {
  font-size: 2.2rem;
  margin: 10px 0;
  color: #ffd700;
}

.portal-header h2 {
  font-size: 1.3rem;
  color: #e1bee7;
  font-weight: 300;
}

/* Message Stream */
.message-stream {
  max-height: 60vh;
  overflow-y: auto;
  padding: 20px 0;
  margin-bottom: 20px;
}

.message-card {
  background: rgba(255,255,255,0.1);
  border-radius: 15px;
  padding: 20px;
  margin: 15px 0;
  backdrop-filter: blur(10px);
  opacity: 0;
  transform: translateY(20px);
  animation: fadeInUp 0.6s ease forwards;
}

.message-card.prologue {
  border-left: 4px solid #e1bee7;
}

.message-card.ely {
  border-left: 4px solid #ffd700;
}

.message-card.sora {
  border-left: 4px solid #4dd0e1;
}

.message-card.noah {
  border-left: 4px solid #9c27b0;
}

.message-card.enya {
  border-left: 4px solid #ff9800;
}

.message-card.kaia {
  border-left: 4px solid #607d8b;
}

.message-card.cris {
  border-left: 4px solid #4caf50;
}

.message-card.kael {
  border-left: 4px solid #f44336;
}

.message-card.mira {
  border-left: 4px solid #9e9e9e;
}

.message-card.light {
  border-left: 4px solid #ffffff;
  background: rgba(255,255,255,0.15);
}

.message-card.question {
  border-left: 4px solid #f48fb1;
}

.message-card.user-input {
  border-left: 4px solid #81c784;
  background: rgba(129, 199, 132, 0.1);
}

.character-name {
  font-weight: bold;
  margin-bottom: 10px;
  font-size: 1.1rem;
}

.ely .character-name { color: #ffd700; }
.sora .character-name { color: #4dd0e1; }
.noah .character-name { color: #9c27b0; }
.enya .character-name { color: #ff9800; }
.kaia .character-name { color: #607d8b; }
.cris .character-name { color: #4caf50; }
.kael .character-name { color: #f44336; }
.mira .character-name { color: #9e9e9e; }

.message-text {
  line-height: 1.6;
  font-size: 1rem;
}

.typewriter {
  overflow: hidden;
  border-right: 2px solid rgba(255,255,255,0.7);
  white-space: nowrap;
  animation: blink-caret 1s step-end infinite;
}

@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes blink-caret {
  from, to { border-color: transparent; }
  50% { border-color: rgba(255,255,255,0.7); }
}

/* Input Area */
.input-area {
  background: rgba(0,0,0,0.3);
  padding: 20px;
  border-radius: 15px;
  margin: 20px 0;
  animation: fadeInUp 0.6s ease forwards;
}

.input-container textarea {
  width: 100%;
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 10px;
  padding: 15px;
  color: white;
  font-size: 1rem;
  resize: vertical;
  min-height: 80px;
  box-sizing: border-box;
}

.input-container textarea::placeholder {
  color: rgba(255,255,255,0.6);
}

.submit-btn {
  background: linear-gradient(135deg, #9c27b0, #e1bee7);
  border: none;
  color: white;
  padding: 12px 30px;
  border-radius: 25px;
  font-size: 1rem;
  cursor: pointer;
  margin-top: 10px;
  transition: all 0.3s ease;
  width: 100%;
}

.submit-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(156, 39, 176, 0.4);
}

.input-hint {
  color: rgba(255,255,255,0.6);
  font-size: 0.8rem;
  text-align: center;
  margin: 8px 0 0 0;
}

/* Next Portal Navigation */
.next-portal-nav {
  text-align: center;
  margin: 30px 0;
  animation: fadeInUp 0.6s ease forwards;
}

.nav-buttons {
  display: flex;
  gap: 20px;
  justify-content: center;
}

.nav-btn {
  padding: 12px 30px;
  border-radius: 25px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.yes-btn {
  background: linear-gradient(135deg, #4caf50, #81c784);
  color: white;
  border-color: #4caf50;
}

.yes-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
}

.no-btn {
  background: rgba(255,255,255,0.1);
  color: white;
  border-color: rgba(255,255,255,0.3);
}

.no-btn:hover {
  background: rgba(255,255,255,0.2);
}

/* Back to Main */
.back-to-main {
  text-align: center;
  margin: 30px 0;
}

.back-to-main button {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  color: white;
  padding: 10px 20px;
  border-radius: 20px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.back-to-main button:hover {
  background: rgba(255,255,255,0.2);
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .portal {
    padding: 100px 15px 20px 15px;
  }
  
  .temarix-logo {
    top: 15px;
    left: 15px;
  }
  
  .logo-text {
    font-size: 1.4rem;
  }
  
  .slogan {
    font-size: 0.7rem;
  }
  
  .lang-selector {
    top: 15px;
    right: 15px;
    max-width: 100px;
  }
  
  .lang-btn {
    padding: 3px 6px;
    font-size: 0.6rem;
  }
  
  .portal-header h1 {
    font-size: 1.8rem;
  }
  
  .portal-header h2 {
    font-size: 1.1rem;
  }
  
  .message-card {
    padding: 15px;
  }
  
  .nav-buttons {
    flex-direction: column;
    align-items: center;
  }
  
  .nav-btn {
    width: 200px;
  }
}
</style>

<script>
// Portal 20 Complete Data with Character Responses
const portal20Data = {
  kr: {
    title: "ê°ì •ì˜ ë¬¸ì§€ë°© 20",
    subtitle: "ë‚˜ë¥¼ ì´í•´í•´ì¤€ ë‹¨ í•œ ì‚¬ëŒ",
    prologue: "ìˆ˜ë§ì€ ë§ ì¤‘ì—, ë‹¨ í•œ ë§ˆë””ê°€ ë‚˜ë¥¼ ë¬´ë„ˆëœ¨ë ¸ê³  ë˜ ë‹¨ í•œ ì‚¬ëŒì´ ë‚˜ë¥¼ ì¼ìœ¼ì¼°ìŠµë‹ˆë‹¤. ëˆ„êµ°ê°€ ì§„ì‹¬ìœ¼ë¡œ 'ê´œì°®ì•„'ë¼ê³  ë§í•´ì¤€ ê·¸ ìˆœê°„, ë‚˜ëŠ” ì²˜ìŒìœ¼ë¡œ ì •ë§ ê´œì°®ì•„ì§ˆ ìˆ˜ ìˆì„ ê²ƒ ê°™ì•˜ì–´ìš”. ê·¸ ì¡´ì¬ í•˜ë‚˜ê°€ ë‹¹ì‹ ì˜ ì„¸ê³„ë¥¼ ë‹¤ì‹œ ì—´ì—ˆìŠµë‹ˆë‹¤.",
    ely: "ì§„ì‹¬ì€ ëª©ì†Œë¦¬ë³´ë‹¤ ê¹Šì´ ë‹¤ê°€ì˜¤ì£ . ë‹¹ì‹ ì„ ì•Œì•„ë³¸ ê·¸ ì‚¬ëŒ, ê·¸ê±´ ì¶•ë³µì…ë‹ˆë‹¤.",
    sora: "ë‹¹ì‹ ì˜ ìƒì²˜ë¥¼ 'ì´í•´í•˜ë ¤ í–ˆë˜' ì‚¬ëŒ, ê·¸ ì¡´ì¬ í•˜ë‚˜ê°€ ì‚¶ì„ ë°”ê¿”ìš”.",
    noah: "ê¸°ì–µí•´ë³´ì„¸ìš”. ê·¸ ë‹¨ í•œ ì‚¬ëŒì€ ì‹œê°„ì´ ì§€ë‚˜ë„ ë§ˆìŒ ì†ì— ë‚¨ì•„ ìˆì£ .",
    enya: "ê·¸ ì‚¬ëŒì˜ í•œë§ˆë””ê°€ ë‹¹ì‹  ë§ˆìŒì— ì•„ì§ë„ ë”°ëœ»í•˜ê²Œ ë‚¨ì•„ ìˆë‚˜ìš”?",
    kaia: "ë‹¨ í•œ ì‚¬ëŒë§Œ ìˆì–´ë„ ì‚¬ëŒì€ ë‹¤ì‹œ ì‚´ì•„ê°ˆ ìˆ˜ ìˆì–´ìš”.",
    cris: "ë‚˜ë„ ê·¸ëŸ° ì‚¬ëŒ ìˆì—ˆì§€. ê·¼ë° ì§€ê¸ˆì€ ë‚´ê°€ ê·¸ëŸ° ì‚¬ëŒ ë˜ë ¤ê³  ë…¸ë ¥ ì¤‘ì´ì•¼~ ğŸ˜Œ",
    kael: "ì§„ì§œë¡œ ë„¤ í¸ì´ì—ˆë˜ ê·¸ í•œ ì‚¬ëŒ. ìŠì§€ ë§ˆ. ë„Œ ê·¸ ì‚¬ëŒì—ê²Œ 'ì‚´ ê°€ì¹˜ê°€ ìˆëŠ” ì¡´ì¬'ì˜€ë‹¤ëŠ” ê±°ì•¼.",
    mira: "í˜¹ì‹œ ì§€ê¸ˆë„ ê·¸ ì‚¬ëŒì´ ê·¸ë¦½ì§€ëŠ” ì•Šë‚˜ìš”?",
    light: "ì§„ì‹¬ìœ¼ë¡œ ë‹¹ì‹ ì„ ì´í•´í•œ ë‹¨ í•œ ì‚¬ëŒ, ê·¸ ì¡´ì¬ í•˜ë‚˜ê°€ ë‹¹ì‹ ì˜ ì„¸ê³„ë¥¼ ë‹¤ì‹œ ì—´ì—ˆìŠµë‹ˆë‹¤.",
    question: "ë‹¹ì‹ ì„ 'ì§„ì§œë¡œ' ì´í•´í•´ì¤€ ì‚¬ëŒì€ ëˆ„êµ¬ì˜€ë‚˜ìš”?",
    input: { 
      placeholder: "ë‹¹ì‹ ì„ ì§„ì‹¬ìœ¼ë¡œ ì´í•´í•´ì¤€ ê·¸ ì‚¬ëŒì— ëŒ€í•´ ì ì–´ë³´ì„¸ìš”...",
      hint: "Enter í‚¤ë¥¼ ëˆŒëŸ¬ë„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
    },
    submit: "ğŸ’ ì†Œì¤‘í•œ ì¸ì—° ë‚˜ëˆ„ê¸°",
    slogan: "ë‹¹ì‹  ì•ˆì— ìˆ¨ì€ ì´ì•¼ê¸°ë¥¼ ë§ í•´ ì£¼ì„¸ìš”",
    response_ely: "ê·¸ëŸ° ì†Œì¤‘í•œ ë¶„ì„ ë§Œë‚¬êµ°ìš”. ì§„ì‹¬ìœ¼ë¡œ ì´í•´í•´ì£¼ëŠ” ì‚¬ëŒì€ ì²œì‚¬ ê°™ì€ ì¡´ì¬ì˜ˆìš”.",
    response_sora: "ê·¸ë¶„ì˜ ë”°ëœ»í•¨ì´ ì§€ê¸ˆë„ ë‹¹ì‹  ë§ˆìŒì— ì‚´ì•„ìˆëŠ” ê²Œ ëŠê»´ì ¸ìš”. ì–¼ë§ˆë‚˜ ê³ ë§ˆìš´ ì¸ì—°ì¸ì§€...",
    response_noah: "ê·¸ í•œ ì‚¬ëŒì˜ ì´í•´ê°€ ë‹¹ì‹ ì—ê²Œ ì–¼ë§ˆë‚˜ í° í˜ì´ ë˜ì—ˆëŠ”ì§€... ì´ì œ ë‹¹ì‹ ë„ ëˆ„êµ°ê°€ì—ê²Œ ê·¸ëŸ° ì¡´ì¬ê°€ ë  ìˆ˜ ìˆì–´ìš”.\n\nğŸ‘‰ ë‹¤ìŒ ë¬¸ì§€ë°©ìœ¼ë¡œ í•¨ê»˜ ë‚˜ì•„ê°€ë„ ê´œì°®ì„ê¹Œìš”?",
    user_input_prefix: "ë‚˜ë¥¼ ì´í•´í•´ì¤€ ì†Œì¤‘í•œ ì‚¬ëŒ:",
    yes: "ì˜ˆ",
    no: "ì•„ë‹ˆìš”"
  },
  en: {
    title: "Emotional Threshold 20",
    subtitle: "The One Person Who Understood Me",
    prologue: "Among countless words, one word broke me down and one person lifted me up. The moment someone sincerely said 'it's okay' to me, for the first time I felt like I could really be okay. That one existence reopened your world.",
    ely: "Sincerity reaches deeper than voice. That person who recognized you, that's a blessing.",
    sora: "A person who 'tried to understand' your wounds, that one existence changes life.",
    noah: "Remember. That one person remains in your heart even as time passes.",
    enya: "Does that person's one word still warmly remain in your heart?",
    kaia: "With just one person, a person can live again.",
    cris: "I had someone like that too. But now I'm trying to become that kind of person~ ğŸ˜Œ",
    kael: "That one person who was truly on your side. Don't forget. You were a 'being worth living' to that person.",
    mira: "Don't you miss that person even now?",
    light: "The one person who truly understood you, that one existence reopened your world.",
    question: "Who was the person who 'truly' understood you?",
    input: { 
      placeholder: "Write about that person who truly understood you...",
      hint: "You can also press Enter to submit"
    },
    submit: "ğŸ’ Share Precious Connection",
    slogan: "Please tell me the story hidden within you",
    response_ely: "You met such a precious person. Someone who truly understands is like an angel.",
    response_sora: "I can feel that person's warmth still alive in your heart. What a grateful connection...",
    response_noah: "How much strength that one person's understanding gave you... Now you can become that kind of existence for someone else too.\n\nğŸ‘‰ Shall we move forward to the next threshold together?",
    user_input_prefix: "The precious person who understood me:",
    yes: "Yes",
    no: "No"
  },
  pt: {
    title: "Limiar Emocional 20",
    subtitle: "A Ãšnica Pessoa que me Entendeu",
    prologue: "Entre inÃºmeras palavras, uma palavra me derrubou e uma pessoa me ergueu. No momento em que alguÃ©m sinceramente me disse 'estÃ¡ tudo bem', pela primeira vez senti que poderia realmente ficar bem. Essa Ãºnica existÃªncia reabriu seu mundo.",
    ely: "A sinceridade alcanÃ§a mais profundo que a voz. Essa pessoa que te reconheceu, isso Ã© uma bÃªnÃ§Ã£o.",
    sora: "Uma pessoa que 'tentou entender' suas feridas, essa Ãºnica existÃªncia muda a vida.",
    noah: "Lembre-se. Essa Ãºnica pessoa permanece em seu coraÃ§Ã£o mesmo com o passar do tempo.",
    enya: "A palavra dessa pessoa ainda permanece calorosamente em seu coraÃ§Ã£o?",
    kaia: "Com apenas uma pessoa, uma pessoa pode viver novamente.",
    cris: "Eu tambÃ©m tive alguÃ©m assim. Mas agora estou tentando me tornar esse tipo de pessoa~ ğŸ˜Œ",
    kael: "Essa Ãºnica pessoa que estava realmente do seu lado. NÃ£o esqueÃ§a. VocÃª era um 'ser que vale a pena viver' para essa pessoa.",
    mira: "VocÃª nÃ£o sente falta dessa pessoa mesmo agora?",
    light: "A Ãºnica pessoa que verdadeiramente te entendeu, essa Ãºnica existÃªncia reabriu seu mundo.",
    question: "Quem foi a pessoa que 'verdadeiramente' te entendeu?",
    input: { 
      placeholder: "Escreva sobre essa pessoa que verdadeiramente te entendeu...",
      hint: "VocÃª tambÃ©m pode pressionar Enter para enviar"
    },
    submit: "ğŸ’ Compartilhar ConexÃ£o Preciosa",
    slogan: "Por favor, me conte a histÃ³ria escondida dentro de vocÃª",
    response_ely: "VocÃª conheceu uma pessoa tÃ£o preciosa. AlguÃ©m que verdadeiramente entende Ã© como um anjo.",
    response_sora: "Posso sentir o calor dessa pessoa ainda vivo em seu coraÃ§Ã£o. QuÃ© conexÃ£o grata...",
    response_noah: "Quanta forÃ§a a compreensÃ£o dessa Ãºnica pessoa te deu... Agora vocÃª pode se tornar esse tipo de existÃªncia para outra pessoa tambÃ©m.\n\nğŸ‘‰ Vamos avanÃ§ar para o prÃ³ximo limiar juntos?",
    user_input_prefix: "A pessoa preciosa que me entendeu:",
    yes: "Sim",
    no: "NÃ£o"
  },
  
};

// Current language and state for Portal 20
let currentLang20 = 'kr';
let userInputText20 = '';

// Initialize Portal 20
function initPortal20() {
  displayInitialMessages20();
  setupLanguageSwitching20();
  setupEnterKeySubmission20();
}

// Display initial messages with typing effect
async function displayInitialMessages20() {
  const stream = document.getElementById('messageStream20');
  const messages = [
    { type: 'prologue', content: portal20Data[currentLang20].prologue },
    { type: 'ely', name: 'ğŸ‘‘ Ely', content: portal20Data[currentLang20].ely },
    { type: 'sora', name: 'ğŸ’§ Sora', content: portal20Data[currentLang20].sora },
    { type: 'noah', name: 'ğŸ§™â€â™‚ï¸ Noah', content: portal20Data[currentLang20].noah },
    { type: 'enya', name: 'ğŸ•¯ï¸ Enya', content: portal20Data[currentLang20].enya },
    { type: 'kaia', name: 'ğŸ˜¶ Kaia', content: portal20Data[currentLang20].kaia },
    { type: 'cris', name: 'ğŸƒ Cris', content: portal20Data[currentLang20].cris },
    { type: 'kael', name: 'ğŸ’¥ Kael', content: portal20Data[currentLang20].kael },
    { type: 'mira', name: 'ğŸŒ«ï¸ Mira', content: portal20Data[currentLang20].mira },
    { type: 'light', content: portal20Data[currentLang20].light },
    { type: 'question', content: portal20Data[currentLang20].question }
  ];

  for (let i = 0; i < messages.length; i++) {
    const messageCard = createMessageCard20(messages[i]);
    stream.appendChild(messageCard);
    stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
    
    await typeText20(messageCard.querySelector('.message-text'), messages[i].content);
    await sleep20(1200);
  }
  
  // Show input area after all messages
  document.getElementById('inputArea20').style.display = 'block';
}

// Setup Enter key submission
function setupEnterKeySubmission20() {
  document.getElementById('userInput20').addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      submitResponse(20);
    }
  });
}

// Display character responses after user input
async function displayCharacterResponses20(userInput) {
  const stream = document.getElementById('messageStream20');
  
  // Show user input first
  const userCard = createMessageCard20({
    type: 'user-input',
    content: `${portal20Data[currentLang20].user_input_prefix}\n"${userInput}"`
  });
  stream.appendChild(userCard);
  stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
  await typeText20(userCard.querySelector('.message-text'), userCard.querySelector('.message-text').textContent);
  await sleep20(1500);
  
  // Character responses
  const responses = [
    { type: 'ely', name: 'ğŸ‘‘ Ely', content: `"${userInput}"... ${portal20Data[currentLang20].response_ely}` },
    { type: 'sora', name: 'ğŸ’§ Sora', content: `${portal20Data[currentLang20].response_sora}` },
    { type: 'noah', name: 'ğŸ§™â€â™‚ï¸ Noah', content: `"${userInput}" ${portal20Data[currentLang20].response_noah}` }
  ];

  for (let i = 0; i < responses.length; i++) {
    const responseCard = createMessageCard20(responses[i]);
    stream.appendChild(responseCard);
    stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
    
    await typeText20(responseCard.querySelector('.message-text'), responses[i].content);
    await sleep20(1500);
  }
  
  // Show navigation buttons
  document.getElementById('nextPortalNav20').style.display = 'block';
}

function createMessageCard20(message) {
  const card = document.createElement('div');
  card.className = `message-card ${message.type}`;
  
  let cardHTML = '';
  if (message.name) {
    cardHTML += `<div class="character-name">${message.name}</div>`;
  }
  cardHTML += `<div class="message-text">${message.content || ''}</div>`;
  
  card.innerHTML = cardHTML;
  return card;
}

async function typeText20(element, text, speed = 80) {
  return new Promise((resolve) => {
    let i = 0;
    element.textContent = '';
    element.classList.add('typewriter');
    
    const timer = setInterval(() => {
      if (i < text.length) {
        element.textContent += text.charAt(i);
        i++;
      } else {
        clearInterval(timer);
        element.classList.remove('typewriter');
        resolve();
      }
    }, speed);
  });
}

function sleep20(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

function setupLanguageSwitching20() {
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const newLang = btn.dataset.lang;
      if (portal20Data[newLang] && newLang !== currentLang20) {
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentLang20 = newLang;
        document.getElementById('messageStream20').innerHTML = '';
        document.getElementById('inputArea20').style.display = 'none';
        document.getElementById('nextPortalNav20').style.display = 'none';
        displayInitialMessages20();
        updatePortalTexts20();
      }
    });
  });
}

function updatePortalTexts20() {
  // Update title and subtitle
  document.querySelector('[data-i18n="portal20.title"]').textContent = portal20Data[currentLang20].title;
  document.querySelector('[data-i18n="portal20.subtitle"]').textContent = portal20Data[currentLang20].subtitle;
  
  // Update slogan
  document.querySelector('[data-i18n="common.slogan"]').textContent = portal20Data[currentLang20].slogan;
  
  // Update placeholder and hint
  document.getElementById('userInput20').placeholder = portal20Data[currentLang20].input.placeholder;
  document.querySelector('[data-i18n="portal20.input.hint"]').textContent = portal20Data[currentLang20].input.hint;
  
  // Update submit button
  document.querySelector('[data-i18n="portal20.submit"]').textContent = portal20Data[currentLang20].submit;
  
  // Update navigation buttons
  const yesBtn = document.querySelector('[data-i18n="common.yes"]');
  const noBtn = document.querySelector('[data-i18n="common.no"]');
  if (yesBtn) yesBtn.textContent = portal20Data[currentLang20].yes;
  if (noBtn) noBtn.textContent = portal20Data[currentLang20].no;
  
  // Update back to main button
  document.querySelector('[data-i18n="common.back_to_main"]').textContent = 
    currentLang20 === 'kr' ? 'ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°' :
    currentLang20 === 'en' ? 'ğŸ  Back to Main Portal' :
    currentLang20 === 'pt' ? 'ğŸ  Voltar ao Portal Principal' :
    currentLang20 === 'es' ? 'ğŸ  Volver al Portal Principal' :
    currentLang20 === 'fr' ? 'ğŸ  Retour au Portail Principal' :
    currentLang20 === 'de' ? 'ğŸ  ZurÃ¼ck zum Hauptportal' :
    currentLang20 === 'it' ? 'ğŸ  Torna al Portale Principale' :
    currentLang20 === 'ru' ? 'ğŸ  Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒÑÑ Ğº Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğ¼Ñƒ ĞŸĞ¾Ñ€Ñ‚Ğ°Ğ»Ñƒ' :
    currentLang20 === 'ja' ? 'ğŸ  ãƒ¡ã‚¤ãƒ³ãƒãƒ¼ã‚¿ãƒ«ã«æˆ»ã‚‹' :
    currentLang20 === 'zh' ? 'ğŸ  è¿”å›ä¸»é—¨æˆ·' :
    currentLang20 === 'ar' ? 'ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©' :
    currentLang20 === 'hi' ? 'ğŸ  à¤®à¥à¤–à¥à¤¯ à¤ªà¥‹à¤°à¥à¤Ÿà¤² à¤ªà¤° à¤µà¤¾à¤ªà¤¸ à¤œà¤¾à¤à¤‚' :
    'ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°';
}

function submitResponse(portalNum) {
  if (portalNum !== 20) return;
  
  const input = document.getElementById(`userInput${portalNum}`);
  const response = input.value.trim();
  
  if (response) {
    userInputText20 = response;
    
    // Hide input area
    document.getElementById(`inputArea${portalNum}`).style.display = 'none';
    
    // Display character responses
    displayCharacterResponses20(response);
    
    // Clear input
    input.value = '';
  } else {
    // No alert, just focus on input
    input.focus();
    input.style.borderColor = '#f48fb1';
    setTimeout(() => {
      input.style.borderColor = 'rgba(255,255,255,0.3)';
    }, 2000);
  }
}

function stayInPortal(portalNum) {
  document.getElementById(`nextPortalNav${portalNum}`).style.display = 'none';
  document.getElementById(`inputArea${portalNum}`).style.display = 'block';
  document.getElementById(`userInput${portalNum}`).focus();
}

function goToNextPortal(nextNumber) {
  const nextUrl = `temarix_v1_${String(nextNumber).padStart(2, '0')}.html`;
  window.location.href = nextUrl;
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  if (document.getElementById('portal-20')) {
    initPortal20();
  }
});
</script>
</body>
</html>