<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Language" content="ko,en,pt">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V1 - Portal 13</title>
</head>
<body>
<!-- Temarix V1 - Portal 13: ìš©ì„œì˜ ì²«ê±¸ìŒ -->
<section class="portal portal-13" id="portal-13">
  <!-- Temarix Logo - Fixed Left Top -->
  <div class="temarix-logo">
    <h1 class="logo-text">ğŸŒŒ TEMARIX</h1>
    <p class="slogan" data-i18n="common.slogan">ë‹¹ì‹  ì•ˆì— ìˆ¨ì€ ì´ì•¼ê¸°ë¥¼ ë§ í•´ ì£¼ì„¸ìš”</p>
  </div>

  <!-- Language Selector - Fixed Right Top -->
  <div class="lang-selector">
    <button class="lang-btn active" data-lang="kr">KR</button>
    <button class="lang-btn" data-lang="en">EN</button>
    <button class="lang-btn" data-lang="pt">PT</button>
  </div>

  <!-- Portal Header - Center Top -->
  <div class="portal-header">
    <h1 data-i18n="portal13.title">ê°ì •ì˜ ë¬¸ì§€ë°© 13</h1>
    <h2 data-i18n="portal13.subtitle">ìš©ì„œì˜ ì²«ê±¸ìŒ</h2>
  </div>

  <!-- Message Stream -->
  <div class="message-stream" id="messageStream13">
    <!-- Messages will be added here via JavaScript -->
  </div>

  <!-- User Input Area -->
  <div class="input-area" id="inputArea13" style="display: none;">
    <div class="input-container">
      <textarea 
        id="userInput13" 
        rows="3" 
        placeholder="ì´ì œ ìš©ì„œí•˜ê³  ì‹¶ì€ ëˆ„êµ°ê°€ë‚˜ ë¬´ì—‡ì¸ê°€ì— ëŒ€í•´ ì¡°ìš©íˆ ì ì–´ë³´ì„¸ìš”..."
        data-i18n-placeholder="portal13.input.placeholder"
      ></textarea>
      <button class="submit-btn" onclick="submitResponse(13)">
        <span data-i18n="portal13.submit">ğŸ•Šï¸ ìš©ì„œì˜ ì²«ê±¸ìŒ ë‚´ë”›ê¸°</span>
      </button>
      <p class="input-hint" data-i18n="portal13.input.hint">Enter í‚¤ë¥¼ ëˆŒëŸ¬ë„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
    </div>
  </div>

  <!-- Next Portal Navigation -->
  <div class="next-portal-nav" id="nextPortalNav13" style="display: none;">
    <div class="nav-buttons">
      <button class="nav-btn yes-btn" onclick="goToNextPortal(14)" data-i18n="common.yes">ì˜ˆ</button>
      <button class="nav-btn no-btn" onclick="stayInPortal()" data-i18n="common.no">ì•„ë‹ˆìš”</button>
    </div>
  </div>

  <!-- Back to Main -->
  <div class="back-to-main">
    <button onclick="window.location.href='portal4.html'" data-i18n="common.back_to_main">
      ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°
    </button>
  </div>
</section>

<style>
/* Portal Base Styles */
.portal {
  min-height: 100vh;
  background: linear-gradient(135deg, #1a1b4b 0%, #2d1b69 100%);
  color: white;
  padding: 80px 20px 20px 20px;
  font-family: 'Apple SD Gothic Neo', -apple-system, BlinkMacSystemFont, sans-serif;
  max-width: 100%;
  margin: 0 auto;
  position: relative;
}

/* Logo Glow Animation */
@keyframes glowCycle {
  0%, 100% { text-shadow: 0 0 8px rgba(255,255,255,0.2); }
  50% { text-shadow: 0 0 25px rgba(255,255,255,0.7); }
}

/* Temarix Logo - Fixed Left Top */
.temarix-logo {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1000;
}

.logo-text {
  font-size: 1.8rem;
  font-weight: bold;
  color: #ffffff;
  margin: 0 0 5px 0;
  text-shadow: 0 0 20px rgba(255,255,255,0.3);
}

.slogan {
  color: #bbb;
  font-style: italic;
  font-size: 0.8rem;
  margin: 0;
}

/* Language Selector - Fixed Right Top */
.lang-selector {
  position: fixed;
  top: 20px;
  right: 20px;
  display: flex;
  gap: 5px;
  flex-wrap: wrap;
  max-width: 120px;
  z-index: 1000;
}

.lang-btn {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  color: white;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 0.7rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.lang-btn:hover {
  background: rgba(255,255,255,0.2);
}

.lang-btn.active {
  background: #9c27b0;
  border-color: #9c27b0;
}

/* Portal Header - Center Top */
.portal-header {
  text-align: center;
  margin: 40px 0 30px 0;
  padding-top: 40px;
}

.portal-header h1 {
  font-size: 2.2rem;
  margin: 10px 0;
  color: #ffd700;
}

.portal-header h2 {
  font-size: 1.3rem;
  color: #e1bee7;
  font-weight: 300;
}

/* Message Stream */
.message-stream {
  max-height: 60vh;
  overflow-y: auto;
  padding: 20px 0;
  margin-bottom: 20px;
}

.message-card {
  background: rgba(255,255,255,0.1);
  border-radius: 15px;
  padding: 20px;
  margin: 15px 0;
  backdrop-filter: blur(10px);
  opacity: 0;
  transform: translateY(20px);
  animation: fadeInUp 0.6s ease forwards;
}

.message-card.prologue {
  border-left: 4px solid #e1bee7;
}

.message-card.ely {
  border-left: 4px solid #ffd700;
}

.message-card.sora {
  border-left: 4px solid #4dd0e1;
}

.message-card.noah {
  border-left: 4px solid #9c27b0;
}

.message-card.enya {
  border-left: 4px solid #ff9800;
}

.message-card.kaia {
  border-left: 4px solid #607d8b;
}

.message-card.cris {
  border-left: 4px solid #4caf50;
}

.message-card.kael {
  border-left: 4px solid #f44336;
}

.message-card.mira {
  border-left: 4px solid #9e9e9e;
}

.message-card.light {
  border-left: 4px solid #ffffff;
  background: rgba(255,255,255,0.15);
}

.message-card.question {
  border-left: 4px solid #f48fb1;
}

.message-card.user-input {
  border-left: 4px solid #81c784;
  background: rgba(129, 199, 132, 0.1);
}

.character-name {
  font-weight: bold;
  margin-bottom: 10px;
  font-size: 1.1rem;
}

.ely .character-name { color: #ffd700; }
.sora .character-name { color: #4dd0e1; }
.noah .character-name { color: #9c27b0; }
.enya .character-name { color: #ff9800; }
.kaia .character-name { color: #607d8b; }
.cris .character-name { color: #4caf50; }
.kael .character-name { color: #f44336; }
.mira .character-name { color: #9e9e9e; }

.message-text {
  line-height: 1.6;
  font-size: 1rem;
}

.typewriter {
  overflow: hidden;
  border-right: 2px solid rgba(255,255,255,0.7);
  white-space: nowrap;
  animation: blink-caret 1s step-end infinite;
}

@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes blink-caret {
  from, to { border-color: transparent; }
  50% { border-color: rgba(255,255,255,0.7); }
}

/* Input Area */
.input-area {
  background: rgba(0,0,0,0.3);
  padding: 20px;
  border-radius: 15px;
  margin: 20px 0;
  animation: fadeInUp 0.6s ease forwards;
}

.input-container textarea {
  width: 100%;
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 10px;
  padding: 15px;
  color: white;
  font-size: 1rem;
  resize: vertical;
  min-height: 80px;
  box-sizing: border-box;
}

.input-container textarea::placeholder {
  color: rgba(255,255,255,0.6);
}

.submit-btn {
  background: linear-gradient(135deg, #9c27b0, #e1bee7);
  border: none;
  color: white;
  padding: 12px 30px;
  border-radius: 25px;
  font-size: 1rem;
  cursor: pointer;
  margin-top: 10px;
  transition: all 0.3s ease;
  width: 100%;
}

.submit-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(156, 39, 176, 0.4);
}

.input-hint {
  color: rgba(255,255,255,0.6);
  font-size: 0.8rem;
  text-align: center;
  margin: 8px 0 0 0;
}

/* Next Portal Navigation */
.next-portal-nav {
  text-align: center;
  margin: 30px 0;
  animation: fadeInUp 0.6s ease forwards;
}

.nav-buttons {
  display: flex;
  gap: 20px;
  justify-content: center;
}

.nav-btn {
  padding: 12px 30px;
  border-radius: 25px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.yes-btn {
  background: linear-gradient(135deg, #4caf50, #81c784);
  color: white;
  border-color: #4caf50;
}

.yes-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
}

.no-btn {
  background: rgba(255,255,255,0.1);
  color: white;
  border-color: rgba(255,255,255,0.3);
}

.no-btn:hover {
  background: rgba(255,255,255,0.2);
}

/* Back to Main */
.back-to-main {
  text-align: center;
  margin: 30px 0;
}

.back-to-main button {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  color: white;
  padding: 10px 20px;
  border-radius: 20px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.back-to-main button:hover {
  background: rgba(255,255,255,0.2);
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .portal {
    padding: 100px 15px 20px 15px;
  }
  
  .temarix-logo {
    top: 15px;
    left: 15px;
  }
  
  .logo-text {
    font-size: 1.4rem;
  }
  
  .slogan {
    font-size: 0.7rem;
  }
  
  .lang-selector {
    top: 15px;
    right: 15px;
    max-width: 100px;
  }
  
  .lang-btn {
    padding: 3px 6px;
    font-size: 0.6rem;
  }
  
  .portal-header h1 {
    font-size: 1.8rem;
  }
  
  .portal-header h2 {
    font-size: 1.1rem;
  }
  
  .message-card {
    padding: 15px;
  }
  
  .nav-buttons {
    flex-direction: column;
    align-items: center;
  }
  
  .nav-btn {
    width: 200px;
  }
}
</style>

<script>
// Portal 13 Complete Data with Character Responses
const portal13Data = {
  kr: {
    title: "ê°ì •ì˜ ë¬¸ì§€ë°© 13",
    subtitle: "ìš©ì„œì˜ ì²«ê±¸ìŒ",
    prologue: "ìš©ì„œëŠ” ê°€ì¥ ì–´ë ¤ìš´ ê°ì • ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ëˆ„êµ°ê°€ë¥¼ ìš©ì„œí•œë‹¤ëŠ” ê²ƒ, í˜¹ì€ ìì‹ ì„ ìš©ì„œí•œë‹¤ëŠ” ê²ƒì€ ë§ˆìŒì˜ í° ìš©ê¸°ê°€ í•„ìš”í•˜ì£ . í•˜ì§€ë§Œ ìš©ì„œëŠ” ìƒëŒ€ë°©ì„ ìœ„í•œ ê²ƒì´ ì•„ë‹ˆë¼ ë‚˜ ìì‹ ì„ ììœ ë¡­ê²Œ í•˜ëŠ” ì„ ë¬¼ì…ë‹ˆë‹¤. ì˜¤ë«ë™ì•ˆ ë§ˆìŒì— í’ˆê³  ìˆë˜ ì›ë§, ë¶„ë…¸, í›„íšŒë¥¼ ë‚´ë ¤ë†“ëŠ” ì²«ê±¸ìŒ. ì™„ë²½í•˜ì§€ ì•Šì•„ë„ ê´œì°®ìŠµë‹ˆë‹¤. ì‘ì€ ê±¸ìŒë¶€í„° ì‹œì‘í•˜ë©´ ë©ë‹ˆë‹¤.",
    ely: "ìš©ì„œëŠ” ì•½í•¨ì´ ì•„ë‹ˆë¼ ê°€ì¥ ê°•í•œ ì„ íƒì´ì—ìš”. ìì‹ ì„ í•´ë°©ì‹œí‚¤ëŠ” ìš©ê¸°ì£ .",
    sora: "ìš©ì„œí•˜ë ¤ëŠ” ë§ˆìŒë§Œìœ¼ë¡œë„ ì´ë¯¸ ì¹˜ìœ ëŠ” ì‹œì‘ëì–´ìš”. ê·¸ ë§ˆìŒì„ ì†Œì¤‘íˆ ì—¬ê¸°ì„¸ìš”.",
    noah: "ìš©ì„œëŠ” ê¸°ì–µì„ ì§€ìš°ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ê·¸ ê¸°ì–µì— ë¬¶ì´ì§€ ì•ŠëŠ” ê²ƒì´ì—ìš”.",
    enya: "ë‹¹ì‹ ì´ ìš©ì„œë¥¼ ì„ íƒí•˜ëŠ” ìˆœê°„, ë‚˜ëŠ” ê·¸ ë”°ëœ»í•¨ì„ í•¨ê»˜ ëŠê»´ìš”.",
    kaia: "ë§í•˜ì§€ ì•Šì•„ë„ ì•Œì•„ìš”. ìš©ì„œê°€ ì–¼ë§ˆë‚˜ í˜ë“ ì§€... í•˜ì§€ë§Œ ê·¸ ë°œê±¸ìŒì´ ë‹¹ì‹ ì„ ììœ ë¡­ê²Œ í•  ê±°ì˜ˆìš”.",
    cris: "ìš©ì„œ? ë‚˜ëŠ” ì‚ì§„ ì¹œêµ¬ë‘ í™”í•´í•  ë•Œ ì´ˆì½œë¦¿ ë“¤ê³  ê°€! ë‹¬ë‹¬í•œ ê²Œ ë§ˆìŒë„ ë‹¬ë˜ì¤€ë‹¤ë‹ˆê¹Œ~ ğŸ«ğŸ˜Š",
    kael: "ìš©ì„œí•˜ë¼ê³ ? ì‰½ê²Œ ë§í•˜ë„¤. í•˜ì§€ë§Œ... ê·¸ ë¶„ë…¸ë¥¼ ê³„ì† ê»´ì•ˆê³  ì‚¬ëŠ” ê²ƒë³´ë‹¤ëŠ” ë‚˜ì„ ê±°ì•¼.",
    mira: "í˜¹ì‹œ... ìš©ì„œí•œë‹¤ê³  í•´ì„œ ì •ë§ ë§ˆìŒì´ í¸í•´ì§ˆê¹Œìš”? ì•„ë‹ˆë©´ ê·¸ëƒ¥ ì²´ë…í•˜ëŠ” ê±´ ì•„ë‹ê¹Œìš”?",
    light: "ìš©ì„œì˜ ì²«ê±¸ìŒì€ ì™„ë²½í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤. ê·¸ í•œ ê±¸ìŒì´ ì²œ ë¦¬ ê¸¸ì˜ ì‹œì‘ì´ì—ìš”.",
    question: "ì´ì œ ìš©ì„œí•˜ê³  ì‹¶ì€ ëˆ„êµ°ê°€ë‚˜ ë¬´ì—‡ì¸ê°€ê°€ ìˆë‚˜ìš”?",
    input: { 
      placeholder: "ì´ì œ ìš©ì„œí•˜ê³  ì‹¶ì€ ëˆ„êµ°ê°€ë‚˜ ë¬´ì—‡ì¸ê°€ì— ëŒ€í•´ ì¡°ìš©íˆ ì ì–´ë³´ì„¸ìš”...",
      hint: "Enter í‚¤ë¥¼ ëˆŒëŸ¬ë„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
    },
    submit: "ğŸ•Šï¸ ìš©ì„œì˜ ì²«ê±¸ìŒ ë‚´ë”›ê¸°",
    slogan: "ë‹¹ì‹  ì•ˆì— ìˆ¨ì€ ì´ì•¼ê¸°ë¥¼ ë§ í•´ ì£¼ì„¸ìš”",
    response_ely: "ìš©ì„œí•˜ë ¤ëŠ” ê·¸ ë§ˆìŒì´ ì•„ë¦„ë‹¤ì›Œìš”. ì´ì œ ì¡°ê¸ˆì”© ê·¸ ë¬´ê²Œë¥¼ ë‚´ë ¤ë†“ìœ¼ì„¸ìš”.",
    response_sora: "ìš©ì„œì˜ ê¸¸ì„ ê±·ê¸° ì‹œì‘í–ˆêµ°ìš”. ê·¸ ê¸¸ ìœ„ì—ì„œ ë‹¹ì‹ ì€ ì§„ì •í•œ í‰í™”ë¥¼ ì°¾ì„ ê±°ì˜ˆìš”.",
    response_noah: "ìš©ì„œì˜ ì²«ê±¸ìŒì„ ë‚´ë””ë êµ°ìš”. ì´ì œ ìƒˆë¡œìš´ ììœ ê°€ ë‹¹ì‹ ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”.\n\nğŸ‘‰ ë‹¤ìŒ ë¬¸ì§€ë°©ìœ¼ë¡œ í•¨ê»˜ ê°€ë„ ê´œì°®ì„ê¹Œìš”?",
    user_input_prefix: "ë‹¹ì‹ ì´ ìš©ì„œí•˜ê³  ì‹¶ì€ ëŒ€ìƒ:",
    yes: "ì˜ˆ",
    no: "ì•„ë‹ˆìš”"
  },
  en: {
    title: "Emotional Threshold 13",
    subtitle: "The First Step of Forgiveness",
    prologue: "Forgiveness is one of the most difficult emotions. To forgive someone, or to forgive yourself, requires great courage of the heart. But forgiveness is not for the other personâ€”it's a gift that sets yourself free. The first step in letting go of resentment, anger, and regret that you've carried in your heart for so long. It doesn't have to be perfect. You can start with small steps.",
    ely: "Forgiveness is not weakness, but the strongest choice. It's the courage to liberate yourself.",
    sora: "Just having the heart to forgive means healing has already begun. Cherish that heart.",
    noah: "Forgiveness is not erasing memories, but not being bound by those memories.",
    enya: "The moment you choose forgiveness, I feel that warmth together with you.",
    kaia: "I know without you saying it. How hard forgiveness is... But those steps will set you free.",
    cris: "Forgiveness? When I make up with upset friends, I bring chocolate! Sweet things soothe the heart too~ ğŸ«ğŸ˜Š",
    kael: "Forgive? Easy to say. But... it's better than continuing to embrace that anger.",
    mira: "Perhaps... will forgiving really bring peace to your heart? Or is it just giving up?",
    light: "The first step of forgiveness doesn't have to be perfect. That one step is the beginning of a thousand-mile journey.",
    question: "Is there someone or something you want to forgive now?",
    input: { 
      placeholder: "Quietly write about someone or something you want to forgive now...",
      hint: "You can also press Enter to submit"
    },
    submit: "ğŸ•Šï¸ Take the First Step of Forgiveness",
    slogan: "Please tell me the story hidden within you",
    response_ely: "That heart wanting to forgive is beautiful. Now gradually put down that weight.",
    response_sora: "You've begun walking the path of forgiveness. On that path, you'll find true peace.",
    response_noah: "You've taken the first step of forgiveness. Now new freedom awaits you.\n\nğŸ‘‰ Shall we go to the next threshold together?",
    user_input_prefix: "The target of your forgiveness:",
    yes: "Yes",
    no: "No"
  },
  pt: {
    title: "Limiar Emocional 13",
    subtitle: "O Primeiro Passo do PerdÃ£o",
    prologue: "O perdÃ£o Ã© uma das emoÃ§Ãµes mais difÃ­ceis. Perdoar alguÃ©m, ou perdoar a si mesmo, requer grande coragem do coraÃ§Ã£o. Mas o perdÃ£o nÃ£o Ã© para a outra pessoaâ€”Ã© um presente que liberta vocÃª mesmo. O primeiro passo para deixar ir o ressentimento, raiva e arrependimento que vocÃª carregou no coraÃ§Ã£o por tanto tempo. NÃ£o precisa ser perfeito. VocÃª pode comeÃ§ar com pequenos passos.",
    ely: "O perdÃ£o nÃ£o Ã© fraqueza, mas a escolha mais forte. Ã‰ a coragem de se libertar.",
    sora: "Apenas ter o coraÃ§Ã£o para perdoar significa que a cura jÃ¡ comeÃ§ou. Valorize esse coraÃ§Ã£o.",
    noah: "O perdÃ£o nÃ£o Ã© apagar memÃ³rias, mas nÃ£o ser preso por essas memÃ³rias.",
    enya: "No momento em que vocÃª escolhe o perdÃ£o, eu sinto esse calor junto com vocÃª.",
    kaia: "Eu sei sem vocÃª dizer. Como o perdÃ£o Ã© difÃ­cil... Mas esses passos vÃ£o libertÃ¡-lo.",
    cris: "PerdÃ£o? Quando me reconcilio com amigos chateados, trago chocolate! Coisas doces tambÃ©m acalmam o coraÃ§Ã£o~ ğŸ«ğŸ˜Š",
    kael: "Perdoar? FÃ¡cil de dizer. Mas... Ã© melhor do que continuar abraÃ§ando essa raiva.",
    mira: "Talvez... perdoar realmente trarÃ¡ paz ao seu coraÃ§Ã£o? Ou Ã© apenas desistir?",
    light: "O primeiro passo do perdÃ£o nÃ£o precisa ser perfeito. Esse passo Ã© o comeÃ§o de uma jornada de mil milhas.",
    question: "HÃ¡ alguÃ©m ou algo que vocÃª quer perdoar agora?",
    input: { 
      placeholder: "Escreva silenciosamente sobre alguÃ©m ou algo que vocÃª quer perdoar agora...",
      hint: "VocÃª tambÃ©m pode pressionar Enter para enviar"
    },
    submit: "ğŸ•Šï¸ Dar o Primeiro Passo do PerdÃ£o",
    slogan: "Por favor, me conte a histÃ³ria escondida dentro de vocÃª",
    response_ely: "Esse coraÃ§Ã£o querendo perdoar Ã© lindo. Agora gradualmente deixe esse peso.",
    response_sora: "VocÃª comeÃ§ou a caminhar no caminho do perdÃ£o. Nesse caminho, encontrarÃ¡ a verdadeira paz.",
    response_noah: "VocÃª deu o primeiro passo do perdÃ£o. Agora nova liberdade o espera.\n\nğŸ‘‰ Vamos para o prÃ³ximo limiar juntos?",
    user_input_prefix: "O alvo do seu perdÃ£o:",
    yes: "Sim",
    no: "NÃ£o"
  },
  
};

// Current language and state for Portal 13
let currentLang13 = 'kr';
let userInputText13 = '';

// Initialize Portal 13
function initPortal13() {
  displayInitialMessages13();
  setupLanguageSwitching13();
  setupEnterKeySubmission13();
}

// Display initial messages with typing effect
async function displayInitialMessages13() {
  const stream = document.getElementById('messageStream13');
  const messages = [
    { type: 'prologue', content: portal13Data[currentLang13].prologue },
    { type: 'ely', name: 'ğŸ‘‘ Ely', content: portal13Data[currentLang13].ely },
    { type: 'sora', name: 'ğŸ’§ Sora', content: portal13Data[currentLang13].sora },
    { type: 'noah', name: 'ğŸ§™â€â™‚ï¸ Noah', content: portal13Data[currentLang13].noah },
    { type: 'enya', name: 'ğŸ•¯ï¸ Enya', content: portal13Data[currentLang13].enya },
    { type: 'kaia', name: 'ğŸ˜¶ Kaia', content: portal13Data[currentLang13].kaia },
    { type: 'cris', name: 'ğŸƒ Cris', content: portal13Data[currentLang13].cris },
    { type: 'kael', name: 'ğŸ’¥ Kael', content: portal13Data[currentLang13].kael },
    { type: 'mira', name: 'ğŸŒ«ï¸ Mira', content: portal13Data[currentLang13].mira },
    { type: 'light', content: portal13Data[currentLang13].light },
    { type: 'question', content: portal13Data[currentLang13].question }
  ];

  for (let i = 0; i < messages.length; i++) {
    const messageCard = createMessageCard13(messages[i]);
    stream.appendChild(messageCard);
    stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
    
    await typeText13(messageCard.querySelector('.message-text'), messages[i].content);
    await sleep13(1200);
  }
  
  // Show input area after all messages
  document.getElementById('inputArea13').style.display = 'block';
}

// Setup Enter key submission
function setupEnterKeySubmission13() {
  document.getElementById('userInput13').addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      submitResponse(13);
    }
  });
}

// Display character responses after user input
async function displayCharacterResponses13(userInput) {
  const stream = document.getElementById('messageStream13');
  
  // Show user input first
  const userCard = createMessageCard13({
    type: 'user-input',
    content: `${portal13Data[currentLang13].user_input_prefix}\n"${userInput}"`
  });
  stream.appendChild(userCard);
  stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
  await typeText13(userCard.querySelector('.message-text'), userCard.querySelector('.message-text').textContent);
  await sleep13(1500);
  
  // Character responses
  const responses = [
    { type: 'ely', name: 'ğŸ‘‘ Ely', content: `"${userInput}"... ${portal13Data[currentLang13].response_ely}` },
    { type: 'sora', name: 'ğŸ’§ Sora', content: `${portal13Data[currentLang13].response_sora}` },
    { type: 'noah', name: 'ğŸ§™â€â™‚ï¸ Noah', content: `"${userInput}" ${portal13Data[currentLang13].response_noah}` }
  ];

  for (let i = 0; i < responses.length; i++) {
    const responseCard = createMessageCard13(responses[i]);
    stream.appendChild(responseCard);
    stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
    
    await typeText13(responseCard.querySelector('.message-text'), responses[i].content);
    await sleep13(1500);
  }
  
  // Show navigation buttons
  document.getElementById('nextPortalNav13').style.display = 'block';
}

function createMessageCard13(message) {
  const card = document.createElement('div');
  card.className = `message-card ${message.type}`;
  
  let cardHTML = '';
  if (message.name) {
    cardHTML += `<div class="character-name">${message.name}</div>`;
  }
  cardHTML += `<div class="message-text">${message.content || ''}</div>`;
  
  card.innerHTML = cardHTML;
  return card;
}

async function typeText13(element, text, speed = 80) {
  return new Promise((resolve) => {
    let i = 0;
    element.textContent = '';
    element.classList.add('typewriter');
    
    const timer = setInterval(() => {
      if (i < text.length) {
        element.textContent += text.charAt(i);
        i++;
      } else {
        clearInterval(timer);
        element.classList.remove('typewriter');
        resolve();
      }
    }, speed);
  });
}

function sleep13(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

function setupLanguageSwitching13() {
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const newLang = btn.dataset.lang;
      if (portal13Data[newLang] && newLang !== currentLang13) {
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentLang13 = newLang;
        document.getElementById('messageStream13').innerHTML = '';
        document.getElementById('inputArea13').style.display = 'none';
        document.getElementById('nextPortalNav13').style.display = 'none';
        displayInitialMessages13();
        updatePortalTexts13();
      }
    });
  });
}

function updatePortalTexts13() {
  // Update title and subtitle
  document.querySelector('[data-i18n="portal13.title"]').textContent = portal13Data[currentLang13].title;
  document.querySelector('[data-i18n="portal13.subtitle"]').textContent = portal13Data[currentLang13].subtitle;
  
  // Update slogan
  document.querySelector('[data-i18n="common.slogan"]').textContent = portal13Data[currentLang13].slogan;
  
  // Update placeholder and hint
  document.getElementById('userInput13').placeholder = portal13Data[currentLang13].input.placeholder;
  document.querySelector('[data-i18n="portal13.input.hint"]').textContent = portal13Data[currentLang13].input.hint;
  
  // Update submit button
  document.querySelector('[data-i18n="portal13.submit"]').textContent = portal13Data[currentLang13].submit;
  
  // Update navigation buttons
  const yesBtn = document.querySelector('[data-i18n="common.yes"]');
  const noBtn = document.querySelector('[data-i18n="common.no"]');
  if (yesBtn) yesBtn.textContent = portal13Data[currentLang13].yes;
  if (noBtn) noBtn.textContent = portal13Data[currentLang13].no;
  
  // Update back to main button
  document.querySelector('[data-i18n="common.back_to_main"]').textContent = 
    currentLang13 === 'kr' ? 'ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°' :
    currentLang13 === 'en' ? 'ğŸ  Back to Main Portal' :
    currentLang13 === 'pt' ? 'ğŸ  Voltar ao Portal Principal' :
    'ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°';
}

function submitResponse(portalNum) {
  if (portalNum !== 13) return;
  
  const input = document.getElementById(`userInput${portalNum}`);
  const response = input.value.trim();
  
  if (response) {
    userInputText13 = response;
    
    // Hide input area
    document.getElementById(`inputArea${portalNum}`).style.display = 'none';
    
    // Display character responses
    displayCharacterResponses13(response);
    
    // Clear input
    input.value = '';
  } else {
    // No alert, just focus on input
    input.focus();
    input.style.borderColor = '#f48fb1';
    setTimeout(() => {
      input.style.borderColor = 'rgba(255,255,255,0.3)';
    }, 2000);
  }
}

function stayInPortal() {
  document.getElementById('nextPortalNav13').style.display = 'none';
  document.getElementById('inputArea13').style.display = 'block';
  document.getElementById('userInput13').focus();
}

function goToNextPortal(nextNumber) {
  const nextUrl = `temarix_v1_${String(nextNumber).padStart(2, '0')}.html`;
  window.location.href = nextUrl;
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  if (document.getElementById('portal-13')) {
    initPortal13();
  }
});
</script>
</body>
</html>