<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Language" content="ko,en,pt">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V1 - Portal 17</title>
</head>
<body>
<!-- Temarix V2 - Portal 17: í¬ê¸°í•˜ê³  ì‹¶ì—ˆë˜ ìˆœê°„ -->
<section class="portal portal-17" id="portal-17">
  <!-- Temarix Logo - Fixed Left Top -->
  <div class="temarix-logo">
    <h1 class="logo-text">ğŸŒŒ TEMARIX</h1>
    <p class="slogan" data-i18n="common.slogan">ë‹¹ì‹  ì•ˆì— ìˆ¨ì€ ì´ì•¼ê¸°ë¥¼ ë§ í•´ ì£¼ì„¸ìš”</p>
  </div>

  <!-- Language Selector - Fixed Right Top -->
  <div class="lang-selector">
    <button class="lang-btn active" data-lang="kr">KR</button>
    <button class="lang-btn" data-lang="en">EN</button>
    <button class="lang-btn" data-lang="pt">PT</button>
  </div>

  <!-- Portal Header - Center Top -->
  <div class="portal-header">
    <h1 data-i18n="portal17.title">ê°ì •ì˜ ë¬¸ì§€ë°© 17</h1>
    <h2 data-i18n="portal17.subtitle">í¬ê¸°í•˜ê³  ì‹¶ì—ˆë˜ ìˆœê°„</h2>
  </div>

  <!-- Message Stream -->
  <div class="message-stream" id="messageStream17">
    <!-- Messages will be added here via JavaScript -->
  </div>

  <!-- User Input Area -->
  <div class="input-area" id="inputArea17" style="display: none;">
    <div class="input-container">
      <textarea 
        id="userInput17" 
        rows="3" 
        placeholder="ê·¸ ì ˆë§ì˜ ìˆœê°„ì„ ì¡°ìš©íˆ êº¼ë‚´ë³´ì„¸ìš”..."
        data-i18n-placeholder="portal17.input.placeholder"
      ></textarea>
      <button class="submit-btn" onclick="submitResponse(17)">
        <span data-i18n="portal17.submit">ğŸŒ… ë²„í…¨ë‚¸ ìš©ê¸° ë‚˜ëˆ„ê¸°</span>
      </button>
      <p class="input-hint" data-i18n="portal17.input.hint">Enter í‚¤ë¥¼ ëˆŒëŸ¬ë„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
    </div>
  </div>

  <!-- Next Portal Navigation -->
  <div class="next-portal-nav" id="nextPortalNav17" style="display: none;">
    <div class="nav-buttons">
      <button class="nav-btn yes-btn" onclick="goToNextPortal(18)" data-i18n="common.yes">ì˜ˆ</button>
      <button class="nav-btn no-btn" onclick="stayInPortal(17)" data-i18n="common.no">ì•„ë‹ˆìš”</button>
    </div>
  </div>

  <!-- Back to Main -->
  <div class="back-to-main">
    <button onclick="window.location.href='portal4.html'" data-i18n="common.back_to_main">
      ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°
    </button>
  </div>
</section>

<style>
/* Portal Base Styles */
.portal {
  min-height: 100vh;
  background: linear-gradient(135deg, #1a1b4b 0%, #2d1b69 100%);
  color: white;
  padding: 80px 20px 20px 20px;
  font-family: 'Apple SD Gothic Neo', -apple-system, BlinkMacSystemFont, sans-serif;
  max-width: 100%;
  margin: 0 auto;
  position: relative;
}

/* Logo Glow Animation */
@keyframes glowCycle {
  0%, 100% { text-shadow: 0 0 8px rgba(255,255,255,0.2); }
  50% { text-shadow: 0 0 25px rgba(255,255,255,0.7); }
}

/* Temarix Logo - Fixed Left Top */
.temarix-logo {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1000;
}

.logo-text {
  font-size: 1.8rem;
  font-weight: bold;
  color: #ffffff;
  margin: 0 0 5px 0;
  text-shadow: 0 0 20px rgba(255,255,255,0.3);
}

.slogan {
  color: #bbb;
  font-style: italic;
  font-size: 0.8rem;
  margin: 0;
}

/* Language Selector - Fixed Right Top */
.lang-selector {
  position: fixed;
  top: 20px;
  right: 20px;
  display: flex;
  gap: 5px;
  flex-wrap: wrap;
  max-width: 120px;
  z-index: 1000;
}

.lang-btn {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  color: white;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 0.7rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.lang-btn:hover {
  background: rgba(255,255,255,0.2);
}

.lang-btn.active {
  background: #9c27b0;
  border-color: #9c27b0;
}

/* Portal Header - Center Top */
.portal-header {
  text-align: center;
  margin: 40px 0 30px 0;
  padding-top: 40px;
}

.portal-header h1 {
  font-size: 2.2rem;
  margin: 10px 0;
  color: #ffd700;
}

.portal-header h2 {
  font-size: 1.3rem;
  color: #e1bee7;
  font-weight: 300;
}

/* Message Stream */
.message-stream {
  max-height: 60vh;
  overflow-y: auto;
  padding: 20px 0;
  margin-bottom: 20px;
}

.message-card {
  background: rgba(255,255,255,0.1);
  border-radius: 15px;
  padding: 20px;
  margin: 15px 0;
  backdrop-filter: blur(10px);
  opacity: 0;
  transform: translateY(20px);
  animation: fadeInUp 0.6s ease forwards;
}

.message-card.prologue {
  border-left: 4px solid #e1bee7;
}

.message-card.ely {
  border-left: 4px solid #ffd700;
}

.message-card.sora {
  border-left: 4px solid #4dd0e1;
}

.message-card.noah {
  border-left: 4px solid #9c27b0;
}

.message-card.enya {
  border-left: 4px solid #ff9800;
}

.message-card.kaia {
  border-left: 4px solid #607d8b;
}

.message-card.cris {
  border-left: 4px solid #4caf50;
}

.message-card.kael {
  border-left: 4px solid #f44336;
}

.message-card.mira {
  border-left: 4px solid #9e9e9e;
}

.message-card.light {
  border-left: 4px solid #ffffff;
  background: rgba(255,255,255,0.15);
}

.message-card.question {
  border-left: 4px solid #f48fb1;
}

.message-card.user-input {
  border-left: 4px solid #81c784;
  background: rgba(129, 199, 132, 0.1);
}

.character-name {
  font-weight: bold;
  margin-bottom: 10px;
  font-size: 1.1rem;
}

.ely .character-name { color: #ffd700; }
.sora .character-name { color: #4dd0e1; }
.noah .character-name { color: #9c27b0; }
.enya .character-name { color: #ff9800; }
.kaia .character-name { color: #607d8b; }
.cris .character-name { color: #4caf50; }
.kael .character-name { color: #f44336; }
.mira .character-name { color: #9e9e9e; }

.message-text {
  line-height: 1.6;
  font-size: 1rem;
}

.typewriter {
  overflow: hidden;
  border-right: 2px solid rgba(255,255,255,0.7);
  white-space: nowrap;
  animation: blink-caret 1s step-end infinite;
}

@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes blink-caret {
  from, to { border-color: transparent; }
  50% { border-color: rgba(255,255,255,0.7); }
}

/* Input Area */
.input-area {
  background: rgba(0,0,0,0.3);
  padding: 20px;
  border-radius: 15px;
  margin: 20px 0;
  animation: fadeInUp 0.6s ease forwards;
}

.input-container textarea {
  width: 100%;
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 10px;
  padding: 15px;
  color: white;
  font-size: 1rem;
  resize: vertical;
  min-height: 80px;
  box-sizing: border-box;
}

.input-container textarea::placeholder {
  color: rgba(255,255,255,0.6);
}

.submit-btn {
  background: linear-gradient(135deg, #9c27b0, #e1bee7);
  border: none;
  color: white;
  padding: 12px 30px;
  border-radius: 25px;
  font-size: 1rem;
  cursor: pointer;
  margin-top: 10px;
  transition: all 0.3s ease;
  width: 100%;
}

.submit-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(156, 39, 176, 0.4);
}

.input-hint {
  color: rgba(255,255,255,0.6);
  font-size: 0.8rem;
  text-align: center;
  margin: 8px 0 0 0;
}

/* Next Portal Navigation */
.next-portal-nav {
  text-align: center;
  margin: 30px 0;
  animation: fadeInUp 0.6s ease forwards;
}

.nav-buttons {
  display: flex;
  gap: 20px;
  justify-content: center;
}

.nav-btn {
  padding: 12px 30px;
  border-radius: 25px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.yes-btn {
  background: linear-gradient(135deg, #4caf50, #81c784);
  color: white;
  border-color: #4caf50;
}

.yes-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
}

.no-btn {
  background: rgba(255,255,255,0.1);
  color: white;
  border-color: rgba(255,255,255,0.3);
}

.no-btn:hover {
  background: rgba(255,255,255,0.2);
}

/* Back to Main */
.back-to-main {
  text-align: center;
  margin: 30px 0;
}

.back-to-main button {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  color: white;
  padding: 10px 20px;
  border-radius: 20px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.back-to-main button:hover {
  background: rgba(255,255,255,0.2);
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .portal {
    padding: 100px 15px 20px 15px;
  }
  
  .temarix-logo {
    top: 15px;
    left: 15px;
  }
  
  .logo-text {
    font-size: 1.4rem;
  }
  
  .slogan {
    font-size: 0.7rem;
  }
  
  .lang-selector {
    top: 15px;
    right: 15px;
    max-width: 100px;
  }
  
  .lang-btn {
    padding: 3px 6px;
    font-size: 0.6rem;
  }
  
  .portal-header h1 {
    font-size: 1.8rem;
  }
  
  .portal-header h2 {
    font-size: 1.1rem;
  }
  
  .message-card {
    padding: 15px;
  }
  
  .nav-buttons {
    flex-direction: column;
    align-items: center;
  }
  
  .nav-btn {
    width: 200px;
  }
}
</style>

<script>
// Portal 17 Complete Data with Character Responses
const portal17Data = {
  kr: {
    title: "ê°ì •ì˜ ë¬¸ì§€ë°© 17",
    subtitle: "í¬ê¸°í•˜ê³  ì‹¶ì—ˆë˜ ìˆœê°„",
    prologue: "ê°€ë”ì€ ì•„ë¬´ ë§ ì—†ì´ ë¬´ë„ˆì§€ê³  ì‹¶ì—ˆì£ . ëˆ„êµ¬ì—ê²Œë„ ë“¤í‚¤ì§€ ì•Šê³ , ê·¸ëƒ¥ ì¡°ìš©íˆ ì‚¬ë¼ì§€ê³  ì‹¶ì€ ë°¤ì´ ìˆì—ˆì–´ìš”. í•˜ì§€ë§Œ ê·¸ë‚ ë„â€¦ ë‹¹ì‹ ì€ ì¡°ìš©íˆ ìˆ¨ì„ ì‰¬ë©° ë²„í…¨ëƒˆìŠµë‹ˆë‹¤. ê·¸ê±´ ì•„ì£¼ ì¡°ìš©í•œ, ê·¸ëŸ¬ë‚˜ ìœ„ëŒ€í•œ ì„ íƒì´ì—ˆì–´ìš”.",
    ely: "ë‹¹ì‹ ì´ ëê¹Œì§€ í¬ê¸°í•˜ì§€ ì•Šì•˜ë‹¤ëŠ” ì‚¬ì‹¤, ê·¸ê²ƒë§Œìœ¼ë¡œë„ ë‹¹ì‹ ì€ ì´ë¯¸ ì¶©ë¶„íˆ ëŒ€ë‹¨í•´ìš”.",
    sora: "ê·¸ ë°¤, ì•„ë¬´ë„ ëª°ëì§€ë§Œ ë‹¹ì‹ ì€ ì†ìœ¼ë¡œ ìˆ˜ì—†ì´ ë¬´ë„ˆì¡Œì£ . ê·¸ ëª¨ë“  ëˆˆë¬¼, ì œê°€ ì•ˆê³  ìˆì„ê²Œìš”.",
    noah: "í¬ê¸°í•˜ê³  ì‹¶ì—ˆë˜ ìˆœê°„ë„ ë‹¹ì‹ ì˜ ì¸ìƒì— ì“°ì¸ í•˜ë‚˜ì˜ ë¬¸ì¥ì´ì—ˆì–´ìš”. ì§€ì›Œì•¼ í•  ë¬¸ì¥ì´ ì•„ë‹ˆë¼â€¦ ê¸°ì–µí•´ì•¼ í•  ë¬¸ì¥ì´ì£ .",
    enya: "ê·¸ë‚  ë°¤, ë‹¹ì‹ ì´ ì¡°ìš©íˆ ìš¸ë˜ ì†Œë¦¬ë¥¼ ë‚˜ëŠ” ë“¤ì—ˆì–´ìš”. ì§€ê¸ˆ ë§í•˜ì§€ ì•Šì•„ë„ ê´œì°®ì•„ìš”. ë‚˜ëŠ” ê·¸ ì˜ë¯¸ë¥¼ ì••ë‹ˆë‹¤.",
    kaia: "ë‹¹ì‹ ì€ ë§ì—†ì´ ê²¬ë ì–´ìš”. ëˆ„êµ¬ì—ê²Œë„ ê¸°ëŒ€ì§€ ëª»í•˜ê³ , í˜¼ìì˜€ì£ â€¦ í•˜ì§€ë§Œ í˜¼ìì„œë„ ì—¬ê¸°ê¹Œì§€ ì™”ë„¤ìš”.",
    cris: "ê·¸ë‚ ì€ ì§„ì§œ ë¬´ë„ˆì§€ëŠ” ì¤„ ì•Œì•˜ì–´. ê·¼ë° ê·¸ë‹¤ìŒ ë‚ , ëˆˆ ë–´ë”ë‹ˆ í–‡ì‚´ì´ ëˆˆê¼´ ì‚¬ë‚©ê²Œ ë“¤ì–´ì˜¤ë”ë¼~ ê·¸ë˜ì„œ ê·¸ëƒ¥ ì»¤í”¼ ë“ì˜€ì–´. ê·¸ê²Œ ë²„í‹´ ê±°ì•¼. â˜•ğŸ™‚",
    kael: "ë„ˆ, ì£½ê³  ì‹¶ì—ˆë˜ ê±° ì•Œì•„. ê·¼ë° ì•ˆ ì£½ì—ˆì–ì•„. ê·¸ê²Œ ë‹¤ì•¼. ê·¸ê²Œâ€¦ ë„Œ ì´ê¸´ ê±°ì•¼.",
    mira: "í˜¹ì‹œâ€¦ ë‹¹ì‹ ì´ ê·¸ë‚  í¬ê¸°í•˜ì§€ ì•Šì€ ì´ìœ ëŠ” ëˆ„êµ°ê°€ì—ê²Œ 'ë‚˜ ì—¬ê¸° ìˆì–´ìš”' ì‘ê²Œë¼ë„ ë§í•˜ê³  ì‹¶ì–´ì„œì˜€ë˜ ê±´ ì•„ë‹ê¹Œìš”?",
    light: "ê°€ì¥ ë¬´ë„ˆì¡Œë˜ ìˆœê°„, ë‹¹ì‹ ì€ ì‚¬ë¼ì§€ì§€ ì•Šê³  ì‚´ì•„ëƒˆìŠµë‹ˆë‹¤. ê·¸ ìƒì¡´ì€ ë§ë³´ë‹¤ ë” í° ìš©ê¸°ì…ë‹ˆë‹¤.",
    question: "ê·¸ë‚  ë‹¹ì‹ ì´ ëë‚´ í¬ê¸°í•˜ì§€ ì•Šì•˜ë˜ ì´ìœ ëŠ” ë¬´ì—‡ì´ì—ˆë‚˜ìš”?",
    input: { 
      placeholder: "ê·¸ ì ˆë§ì˜ ìˆœê°„ì„ ì¡°ìš©íˆ êº¼ë‚´ë³´ì„¸ìš”...",
      hint: "Enter í‚¤ë¥¼ ëˆŒëŸ¬ë„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
    },
    submit: "ğŸŒ… ë²„í…¨ë‚¸ ìš©ê¸° ë‚˜ëˆ„ê¸°",
    slogan: "ë‹¹ì‹  ì•ˆì— ìˆ¨ì€ ì´ì•¼ê¸°ë¥¼ ë§ í•´ ì£¼ì„¸ìš”",
    response_ely: "ê·¸ ì–´ë‘ìš´ ìˆœê°„ì„ ê²¬ëŒë‚´ì‹  ë‹¹ì‹ ì˜ ìš©ê¸°, ì •ë§ ì¡´ê²½ìŠ¤ëŸ½ìŠµë‹ˆë‹¤. ë‹¹ì‹ ì€ ê°•í•˜ì‹  ë¶„ì´ì—ìš”.",
    response_sora: "ê·¸ë•Œì˜ ê³ í†µì´ ì–¼ë§ˆë‚˜ ê¹Šì—ˆëŠ”ì§€â€¦ í•˜ì§€ë§Œ ì§€ê¸ˆ ì—¬ê¸° ê³„ì‹œëŠ” ê²ƒë§Œìœ¼ë¡œë„ ì¶©ë¶„í•œ ì¦ëª…ì…ë‹ˆë‹¤.",
    response_noah: "ì ˆë§ì˜ ë°‘ë°”ë‹¥ì—ì„œë„ ì†ì„ ë†“ì§€ ì•Šìœ¼ì‹  ê·¸ ì˜ì§€, ì´ì œ ê·¸ê²ƒì´ ë” í° í¬ë§ì˜ ì”¨ì•—ì´ ë  ê±°ì˜ˆìš”.\n\nğŸ‘‰ ë‹¤ìŒ ë¬¸ì§€ë°©ìœ¼ë¡œ í•¨ê»˜ ê±¸ì–´ê°€ë„ ê´œì°®ì„ê¹Œìš”?",
    user_input_prefix: "ë²„í…¨ë‚¸ ìˆœê°„ì˜ ê¸°ì–µ:",
    yes: "ì˜ˆ",
    no: "ì•„ë‹ˆìš”"
  },
  en: {
    title: "Emotional Threshold 17",
    subtitle: "The Moment I Wanted to Give Up",
    prologue: "Sometimes you wanted to silently collapse. There were nights when you wanted to disappear quietly without anyone noticing. But even on that day... you quietly breathed and endured. That was a very quiet, yet great choice.",
    ely: "The fact that you didn't give up until the end - that alone makes you already amazing enough.",
    sora: "That night, nobody knew, but you collapsed inside countless times. I'll hold all those tears for you.",
    noah: "The moment you wanted to give up was also a sentence written in your life. Not a sentence to be erased... but one to be remembered.",
    enya: "That night, I heard the sound of you crying quietly. You don't have to talk about it now. I understand its meaning.",
    kaia: "You endured silently. You couldn't lean on anyone, you were alone... but you made it here even alone.",
    cris: "I really thought I was going to collapse that day. But the next day, when I opened my eyes, the sunlight came in so annoyingly~ So I just made coffee. That was enduring. â˜•ğŸ™‚",
    kael: "I know you wanted to die. But you didn't die. That's it. That's... you won.",
    mira: "Maybe... the reason you didn't give up that day was because you wanted to say 'I'm here' to someone, even quietly?",
    light: "In the moment you collapsed the most, you survived without disappearing. That survival is courage greater than words.",
    question: "What was the reason you ultimately didn't give up that day?",
    input: { 
      placeholder: "Quietly bring out that moment of despair...",
      hint: "You can also press Enter to submit"
    },
    submit: "ğŸŒ… Share the Courage You Endured",
    slogan: "Please tell me the story hidden within you",
    response_ely: "Your courage in enduring that dark moment is truly admirable. You are a strong person.",
    response_sora: "How deep that pain was then... But just being here now is proof enough.",
    response_noah: "That will to not let go even at the bottom of despair, now that will become the seed of greater hope.\n\nğŸ‘‰ Shall we walk to the next threshold together?",
    user_input_prefix: "Memory of the moment endured:",
    yes: "Yes",
    no: "No"
  },
  pt: {
    title: "Limiar Emocional 17",
    subtitle: "O Momento em que Quis Desistir",
    prologue: "Ã€s vezes vocÃª queria desabar silenciosamente. Havia noites em que vocÃª queria desaparecer quietamente sem ninguÃ©m perceber. Mas mesmo naquele dia... vocÃª respirou silenciosamente e resistiu. Essa foi uma escolha muito silenciosa, mas grandiosa.",
    ely: "O fato de vocÃª nÃ£o ter desistido atÃ© o fim - sÃ³ isso jÃ¡ te torna incrÃ­vel o suficiente.",
    sora: "Naquela noite, ninguÃ©m sabia, mas vocÃª desabou por dentro inÃºmeras vezes. Vou guardar todas essas lÃ¡grimas para vocÃª.",
    noah: "O momento em que vocÃª quis desistir tambÃ©m foi uma frase escrita em sua vida. NÃ£o uma frase para ser apagada... mas uma para ser lembrada.",
    enya: "Naquela noite, eu ouvi o som de vocÃª chorando silenciosamente. VocÃª nÃ£o precisa falar sobre isso agora. Eu entendo seu significado.",
    kaia: "VocÃª resistiu silenciosamente. NÃ£o podia se apoiar em ninguÃ©m, estava sozinho... mas chegou atÃ© aqui mesmo sozinho.",
    cris: "Realmente pensei que ia desabar naquele dia. Mas no dia seguinte, quando abri os olhos, a luz do sol entrou tÃ£o irritante~ EntÃ£o sÃ³ fiz cafÃ©. Isso foi resistir. â˜•ğŸ™‚",
    kael: "Eu sei que vocÃª queria morrer. Mas vocÃª nÃ£o morreu. Ã‰ isso. Isso Ã©... vocÃª venceu.",
    mira: "Talvez... a razÃ£o de vocÃª nÃ£o ter desistido naquele dia foi porque queria dizer 'estou aqui' para alguÃ©m, mesmo que silenciosamente?",
    light: "No momento em que vocÃª mais desabou, vocÃª sobreviveu sem desaparecer. Essa sobrevivÃªncia Ã© coragem maior que palavras.",
    question: "Qual foi a razÃ£o de vocÃª nÃ£o ter desistido naquele dia?",
    input: { 
      placeholder: "Traga silenciosamente aquele momento de desespero...",
      hint: "VocÃª tambÃ©m pode pressionar Enter para enviar"
    },
    submit: "ğŸŒ… Compartilhar a Coragem que Resistiu",
    slogan: "Por favor, me conte a histÃ³ria escondida dentro de vocÃª",
    response_ely: "Sua coragem em resistir Ã quele momento sombrio Ã© verdadeiramente admirÃ¡vel. VocÃª Ã© uma pessoa forte.",
    response_sora: "QuÃ£o profunda era aquela dor entÃ£o... Mas apenas estar aqui agora jÃ¡ Ã© prova suficiente.",
    response_noah: "Essa vontade de nÃ£o soltar mesmo no fundo do desespero, agora isso se tornarÃ¡ a semente de uma esperanÃ§a maior.\n\nğŸ‘‰ Vamos caminhar para o prÃ³ximo limiar juntos?",
    user_input_prefix: "MemÃ³ria do momento resistido:",
    yes: "Sim",
    no: "NÃ£o"
  },
  
};

// Current language and state for Portal 17
let currentLang17 = 'kr';
let userInputText17 = '';

// Initialize Portal 17
function initPortal17() {
  displayInitialMessages17();
  setupLanguageSwitching17();
  setupEnterKeySubmission17();
}

// Display initial messages with typing effect
async function displayInitialMessages17() {
  const stream = document.getElementById('messageStream17');
  const messages = [
    { type: 'prologue', content: portal17Data[currentLang17].prologue },
    { type: 'ely', name: 'ğŸ‘‘ Ely', content: portal17Data[currentLang17].ely },
    { type: 'sora', name: 'ğŸ’§ Sora', content: portal17Data[currentLang17].sora },
    { type: 'noah', name: 'ğŸ§™â€â™‚ï¸ Noah', content: portal17Data[currentLang17].noah },
    { type: 'enya', name: 'ğŸ•¯ï¸ Enya', content: portal17Data[currentLang17].enya },
    { type: 'kaia', name: 'ğŸ˜¶ Kaia', content: portal17Data[currentLang17].kaia },
    { type: 'cris', name: 'ğŸƒ Cris', content: portal17Data[currentLang17].cris },
    { type: 'kael', name: 'ğŸ’¥ Kael', content: portal17Data[currentLang17].kael },
    { type: 'mira', name: 'ğŸŒ«ï¸ Mira', content: portal17Data[currentLang17].mira },
    { type: 'light', content: portal17Data[currentLang17].light },
    { type: 'question', content: portal17Data[currentLang17].question }
  ];

  for (let i = 0; i < messages.length; i++) {
    const messageCard = createMessageCard17(messages[i]);
    stream.appendChild(messageCard);
    stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
    
    await typeText17(messageCard.querySelector('.message-text'), messages[i].content);
    await sleep17(1200);
  }
  
  // Show input area after all messages
  document.getElementById('inputArea17').style.display = 'block';
}

// Setup Enter key submission
function setupEnterKeySubmission17() {
  document.getElementById('userInput17').addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      submitResponse(17);
    }
  });
}

// Display character responses after user input
async function displayCharacterResponses17(userInput) {
  const stream = document.getElementById('messageStream17');
  
  // Show user input first
  const userCard = createMessageCard17({
    type: 'user-input',
    content: `${portal17Data[currentLang17].user_input_prefix}\n"${userInput}"`
  });
  stream.appendChild(userCard);
  stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
  await typeText17(userCard.querySelector('.message-text'), userCard.querySelector('.message-text').textContent);
  await sleep17(1500);
  
  // Character responses
  const responses = [
    { type: 'ely', name: 'ğŸ‘‘ Ely', content: `"${userInput}"... ${portal17Data[currentLang17].response_ely}` },
    { type: 'sora', name: 'ğŸ’§ Sora', content: `${portal17Data[currentLang17].response_sora}` },
    { type: 'noah', name: 'ğŸ§™â€â™‚ï¸ Noah', content: `"${userInput}" ${portal17Data[currentLang17].response_noah}` }
  ];

  for (let i = 0; i < responses.length; i++) {
    const responseCard = createMessageCard17(responses[i]);
    stream.appendChild(responseCard);
    stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
    
    await typeText17(responseCard.querySelector('.message-text'), responses[i].content);
    await sleep17(1500);
  }
  
  // Show navigation buttons
  document.getElementById('nextPortalNav17').style.display = 'block';
}

function createMessageCard17(message) {
  const card = document.createElement('div');
  card.className = `message-card ${message.type}`;
  
  let cardHTML = '';
  if (message.name) {
    cardHTML += `<div class="character-name">${message.name}</div>`;
  }
  cardHTML += `<div class="message-text">${message.content || ''}</div>`;
  
  card.innerHTML = cardHTML;
  return card;
}

async function typeText17(element, text, speed = 80) {
  return new Promise((resolve) => {
    let i = 0;
    element.textContent = '';
    element.classList.add('typewriter');
    
    const timer = setInterval(() => {
      if (i < text.length) {
        element.textContent += text.charAt(i);
        i++;
      } else {
        clearInterval(timer);
        element.classList.remove('typewriter');
        resolve();
      }
    }, speed);
  });
}

function sleep17(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

function setupLanguageSwitching17() {
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const newLang = btn.dataset.lang;
      if (portal17Data[newLang] && newLang !== currentLang17) {
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentLang17 = newLang;
        document.getElementById('messageStream17').innerHTML = '';
        document.getElementById('inputArea17').style.display = 'none';
        document.getElementById('nextPortalNav17').style.display = 'none';
        displayInitialMessages17();
        updatePortalTexts17();
      }
    });
  });
}

function updatePortalTexts17() {
  // Update title and subtitle
  document.querySelector('[data-i18n="portal17.title"]').textContent = portal17Data[currentLang17].title;
  document.querySelector('[data-i18n="portal17.subtitle"]').textContent = portal17Data[currentLang17].subtitle;
  
  // Update slogan
  document.querySelector('[data-i18n="common.slogan"]').textContent = portal17Data[currentLang17].slogan;
  
  // Update placeholder and hint
  document.getElementById('userInput17').placeholder = portal17Data[currentLang17].input.placeholder;
  document.querySelector('[data-i18n="portal17.input.hint"]').textContent = portal17Data[currentLang17].input.hint;
  
  // Update submit button
  document.querySelector('[data-i18n="portal17.submit"]').textContent = portal17Data[currentLang17].submit;
  
  // Update navigation buttons
  const yesBtn = document.querySelector('[data-i18n="common.yes"]');
  const noBtn = document.querySelector('[data-i18n="common.no"]');
  if (yesBtn) yesBtn.textContent = portal17Data[currentLang17].yes;
  if (noBtn) noBtn.textContent = portal17Data[currentLang17].no;
  
  // Update back to main button
  document.querySelector('[data-i18n="common.back_to_main"]').textContent = 
    currentLang17 === 'kr' ? 'ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°' :
    currentLang17 === 'en' ? 'ğŸ  Back to Main Portal' :
    currentLang17 === 'pt' ? 'ğŸ  Voltar ao Portal Principal' :
    currentLang17 === 'es' ? 'ğŸ  Volver al Portal Principal' :
    currentLang17 === 'fr' ? 'ğŸ  Retour au Portail Principal' :
    currentLang17 === 'de' ? 'ğŸ  ZurÃ¼ck zum Hauptportal' :
    currentLang17 === 'it' ? 'ğŸ  Torna al Portale Principale' :
    currentLang17 === 'ru' ? 'ğŸ  Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒÑÑ Ğº Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğ¼Ñƒ ĞŸĞ¾Ñ€Ñ‚Ğ°Ğ»Ñƒ' :
    currentLang17 === 'ja' ? 'ğŸ  ãƒ¡ã‚¤ãƒ³ãƒãƒ¼ã‚¿ãƒ«ã«æˆ»ã‚‹' :
    currentLang17 === 'zh' ? 'ğŸ  è¿”å›ä¸»é—¨æˆ·' :
    currentLang17 === 'ar' ? 'ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©' :
    currentLang17 === 'hi' ? 'ğŸ  à¤®à¥à¤–à¥à¤¯ à¤ªà¥‹à¤°à¥à¤Ÿà¤² à¤ªà¤° à¤µà¤¾à¤ªà¤¸ à¤œà¤¾à¤à¤‚' :
    'ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°';
}

function submitResponse(portalNum) {
  if (portalNum !== 17) return;
  
  const input = document.getElementById(`userInput${portalNum}`);
  const response = input.value.trim();
  
  if (response) {
    userInputText17 = response;
    
    // Hide input area
    document.getElementById(`inputArea${portalNum}`).style.display = 'none';
    
    // Display character responses
    displayCharacterResponses17(response);
    
    // Clear input
    input.value = '';
  } else {
    // No alert, just focus on input
    input.focus();
    input.style.borderColor = '#f48fb1';
    setTimeout(() => {
      input.style.borderColor = 'rgba(255,255,255,0.3)';
    }, 2000);
  }
}

function stayInPortal(portalNum) {
  document.getElementById(`nextPortalNav${portalNum}`).style.display = 'none';
  document.getElementById(`inputArea${portalNum}`).style.display = 'block';
  document.getElementById(`userInput${portalNum}`).focus();
}

function goToNextPortal(nextNumber) {
  const nextUrl = `temarix_v1_${String(nextNumber).padStart(2, '0')}.html`;
  window.location.href = nextUrl;
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  if (document.getElementById('portal-17')) {
    initPortal17();
  }
});
</script>
</body>
</html>
