<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Language" content="ko,en,pt">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V1 - Portal 15</title>
</head>
<body>
<!-- Temarix V1 - Portal 15: ì„¸ìƒì„ í–¥í•œ ì²« ë°œê±¸ìŒ -->
<section class="portal portal-15" id="portal-15">
  <!-- Temarix Logo - Fixed Left Top -->
  <div class="temarix-logo">
    <h1 class="logo-text">ğŸŒŒ TEMARIX</h1>
    <p class="slogan" data-i18n="common.slogan">ë‹¹ì‹  ì•ˆì— ìˆ¨ì€ ì´ì•¼ê¸°ë¥¼ ë§ í•´ ì£¼ì„¸ìš”</p>
  </div>

  <!-- Language Selector - Fixed Right Top -->
  <div class="lang-selector">
    <button class="lang-btn active" data-lang="kr">KR</button>
    <button class="lang-btn" data-lang="en">EN</button>
    <button class="lang-btn" data-lang="pt">PT</button>
  </div>

  <!-- Portal Header - Center Top -->
  <div class="portal-header">
    <h1 data-i18n="portal15.title">ê°ì •ì˜ ë¬¸ì§€ë°© 15</h1>
    <h2 data-i18n="portal15.subtitle">ì„¸ìƒì„ í–¥í•œ ì²« ë°œê±¸ìŒ</h2>
  </div>

  <!-- Message Stream -->
  <div class="message-stream" id="messageStream15">
    <!-- Messages will be added here via JavaScript -->
  </div>

  <!-- User Input Area -->
  <div class="input-area" id="inputArea15" style="display: none;">
    <div class="input-container">
      <textarea 
        id="userInput15" 
        rows="3" 
        placeholder="ì´ì œ ì„¸ìƒê³¼ ë‚˜ëˆ„ê³  ì‹¶ì€ ë‹¹ì‹ ì˜ ë¹›ê³¼ ê¿ˆì— ëŒ€í•´ ì¡°ìš©íˆ ì ì–´ë³´ì„¸ìš”..."
        data-i18n-placeholder="portal15.input.placeholder"
      ></textarea>
      <button class="submit-btn" onclick="submitResponse(15)">
        <span data-i18n="portal15.submit">ğŸŒŸ ì²« ë°œê±¸ìŒ ë‚´ë”›ê¸°</span>
      </button>
      <p class="input-hint" data-i18n="portal15.input.hint">Enter í‚¤ë¥¼ ëˆŒëŸ¬ë„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
    </div>
  </div>

  <!-- Next Portal Navigation -->
  <div class="next-portal-nav" id="nextPortalNav15" style="display: none;">
    <div class="nav-buttons">
      <button class="nav-btn yes-btn" onclick="goToNextPortal(16)" data-i18n="common.yes">ì˜ˆ</button>
      <button class="nav-btn no-btn" onclick="stayInPortal()" data-i18n="common.no">ì•„ë‹ˆìš”</button>
    </div>
  </div>

  <!-- Back to Main -->
  <div class="back-to-main">
    <button onclick="window.location.href='portal4.html'" data-i18n="common.back_to_main">
      ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°
    </button>
  </div>
</section>

<style>
/* Portal Base Styles */
.portal {
  min-height: 100vh;
  background: linear-gradient(135deg, #1a1b4b 0%, #2d1b69 100%);
  color: white;
  padding: 80px 20px 20px 20px;
  font-family: 'Apple SD Gothic Neo', -apple-system, BlinkMacSystemFont, sans-serif;
  max-width: 100%;
  margin: 0 auto;
  position: relative;
}

/* Logo Glow Animation */
@keyframes glowCycle {
  0%, 100% { text-shadow: 0 0 8px rgba(255,255,255,0.2); }
  50% { text-shadow: 0 0 25px rgba(255,255,255,0.7); }
}

/* Temarix Logo - Fixed Left Top */
.temarix-logo {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1000;
}

.logo-text {
  font-size: 1.8rem;
  font-weight: bold;
  color: #ffffff;
  margin: 0 0 5px 0;
  text-shadow: 0 0 20px rgba(255,255,255,0.3);
}

.slogan {
  color: #bbb;
  font-style: italic;
  font-size: 0.8rem;
  margin: 0;
}

/* Language Selector - Fixed Right Top */
.lang-selector {
  position: fixed;
  top: 20px;
  right: 20px;
  display: flex;
  gap: 5px;
  flex-wrap: wrap;
  max-width: 120px;
  z-index: 1000;
}

.lang-btn {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  color: white;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 0.7rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.lang-btn:hover {
  background: rgba(255,255,255,0.2);
}

.lang-btn.active {
  background: #9c27b0;
  border-color: #9c27b0;
}

/* Portal Header - Center Top */
.portal-header {
  text-align: center;
  margin: 40px 0 30px 0;
  padding-top: 40px;
}

.portal-header h1 {
  font-size: 2.2rem;
  margin: 10px 0;
  color: #ffd700;
}

.portal-header h2 {
  font-size: 1.3rem;
  color: #e1bee7;
  font-weight: 300;
}

/* Message Stream */
.message-stream {
  max-height: 60vh;
  overflow-y: auto;
  padding: 20px 0;
  margin-bottom: 20px;
}

.message-card {
  background: rgba(255,255,255,0.1);
  border-radius: 15px;
  padding: 20px;
  margin: 15px 0;
  backdrop-filter: blur(10px);
  opacity: 0;
  transform: translateY(20px);
  animation: fadeInUp 0.6s ease forwards;
}

.message-card.prologue {
  border-left: 4px solid #e1bee7;
}

.message-card.ely {
  border-left: 4px solid #ffd700;
}

.message-card.sora {
  border-left: 4px solid #4dd0e1;
}

.message-card.noah {
  border-left: 4px solid #9c27b0;
}

.message-card.enya {
  border-left: 4px solid #ff9800;
}

.message-card.kaia {
  border-left: 4px solid #607d8b;
}

.message-card.cris {
  border-left: 4px solid #4caf50;
}

.message-card.kael {
  border-left: 4px solid #f44336;
}

.message-card.mira {
  border-left: 4px solid #9e9e9e;
}

.message-card.light {
  border-left: 4px solid #ffffff;
  background: rgba(255,255,255,0.15);
}

.message-card.question {
  border-left: 4px solid #f48fb1;
}

.message-card.user-input {
  border-left: 4px solid #81c784;
  background: rgba(129, 199, 132, 0.1);
}

.character-name {
  font-weight: bold;
  margin-bottom: 10px;
  font-size: 1.1rem;
}

.ely .character-name { color: #ffd700; }
.sora .character-name { color: #4dd0e1; }
.noah .character-name { color: #9c27b0; }
.enya .character-name { color: #ff9800; }
.kaia .character-name { color: #607d8b; }
.cris .character-name { color: #4caf50; }
.kael .character-name { color: #f44336; }
.mira .character-name { color: #9e9e9e; }

.message-text {
  line-height: 1.6;
  font-size: 1rem;
}

.typewriter {
  overflow: hidden;
  border-right: 2px solid rgba(255,255,255,0.7);
  white-space: nowrap;
  animation: blink-caret 1s step-end infinite;
}

@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes blink-caret {
  from, to { border-color: transparent; }
  50% { border-color: rgba(255,255,255,0.7); }
}

/* Input Area */
.input-area {
  background: rgba(0,0,0,0.3);
  padding: 20px;
  border-radius: 15px;
  margin: 20px 0;
  animation: fadeInUp 0.6s ease forwards;
}

.input-container textarea {
  width: 100%;
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 10px;
  padding: 15px;
  color: white;
  font-size: 1rem;
  resize: vertical;
  min-height: 80px;
  box-sizing: border-box;
}

.input-container textarea::placeholder {
  color: rgba(255,255,255,0.6);
}

.submit-btn {
  background: linear-gradient(135deg, #9c27b0, #e1bee7);
  border: none;
  color: white;
  padding: 12px 30px;
  border-radius: 25px;
  font-size: 1rem;
  cursor: pointer;
  margin-top: 10px;
  transition: all 0.3s ease;
  width: 100%;
}

.submit-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(156, 39, 176, 0.4);
}

.input-hint {
  color: rgba(255,255,255,0.6);
  font-size: 0.8rem;
  text-align: center;
  margin: 8px 0 0 0;
}

/* Next Portal Navigation */
.next-portal-nav {
  text-align: center;
  margin: 30px 0;
  animation: fadeInUp 0.6s ease forwards;
}

.nav-buttons {
  display: flex;
  gap: 20px;
  justify-content: center;
}

.nav-btn {
  padding: 12px 30px;
  border-radius: 25px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.yes-btn {
  background: linear-gradient(135deg, #4caf50, #81c784);
  color: white;
  border-color: #4caf50;
}

.yes-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
}

.no-btn {
  background: rgba(255,255,255,0.1);
  color: white;
  border-color: rgba(255,255,255,0.3);
}

.no-btn:hover {
  background: rgba(255,255,255,0.2);
}

/* Back to Main */
.back-to-main {
  text-align: center;
  margin: 30px 0;
}

.back-to-main button {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  color: white;
  padding: 10px 20px;
  border-radius: 20px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.back-to-main button:hover {
  background: rgba(255,255,255,0.2);
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .portal {
    padding: 100px 15px 20px 15px;
  }
  
  .temarix-logo {
    top: 15px;
    left: 15px;
  }
  
  .logo-text {
    font-size: 1.4rem;
  }
  
  .slogan {
    font-size: 0.7rem;
  }
  
  .lang-selector {
    top: 15px;
    right: 15px;
    max-width: 100px;
  }
  
  .lang-btn {
    padding: 3px 6px;
    font-size: 0.6rem;
  }
  
  .portal-header h1 {
    font-size: 1.8rem;
  }
  
  .portal-header h2 {
    font-size: 1.1rem;
  }
  
  .message-card {
    padding: 15px;
  }
  
  .nav-buttons {
    flex-direction: column;
    align-items: center;
  }
  
  .nav-btn {
    width: 200px;
  }
}
</style>

<script>
// Portal 15 Complete Data with Character Responses
const portal15Data = {
  kr: {
    title: "ê°ì •ì˜ ë¬¸ì§€ë°© 15",
    subtitle: "ì„¸ìƒì„ í–¥í•œ ì²« ë°œê±¸ìŒ",
    prologue: "ì§„ì •í•œ ë‚˜ë¥¼ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ì´ì œ ê·¸ ë¹›ì„ ì„¸ìƒê³¼ ë‚˜ëˆ„ì–´ì•¼ í•  ë•Œê°€ ì™”ì–´ìš”. ë‚´ê°€ ê²ªì—ˆë˜ ì•„í””ê³¼ ì¹˜ìœ ì˜ ê²½í—˜, ë°œê²¬í•œ ì§€í˜œì™€ ì‚¬ë‘... ì´ ëª¨ë“  ê²ƒì´ ëˆ„êµ°ê°€ì—ê²ŒëŠ” í¬ë§ì˜ ë“±ë¶ˆì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì™„ë²½í•˜ì§€ ì•Šì•„ë„ ê´œì°®ì•„ìš”. ì‘ì€ í–‰ë™ë¶€í„° ì‹œì‘í•˜ë©´ ë©ë‹ˆë‹¤. ë”°ëœ»í•œ ë§ í•œë§ˆë””, ì§„ì‹¬ ì–´ë¦° ë¯¸ì†Œ, í•¨ê»˜í•˜ëŠ” ì‹œê°„... ë‹¹ì‹ ë§Œì´ ì¤„ ìˆ˜ ìˆëŠ” íŠ¹ë³„í•œ ë¬´ì–¸ê°€ê°€ ìˆì–´ìš”. ì„¸ìƒì„ í–¥í•œ ì²« ë°œê±¸ìŒì„ ë‚´ë”›ì„ ì¤€ë¹„ê°€ ë˜ì—ˆë‚˜ìš”?",
    ely: "ë‹¹ì‹ ì˜ ë¹›ì´ ì„¸ìƒì— ë‹¿ì„ ë•Œ, ëˆ„êµ°ê°€ì˜ ì–´ë‘ ì´ ì‚¬ë¼ì§ˆ ê±°ì˜ˆìš”. ê·¸ ì²« ë°œê±¸ìŒì´ ìš©ê¸°ì˜ˆìš”.",
    sora: "ì¹˜ìœ ë°›ì€ ë§ˆìŒìœ¼ë¡œ ë‹¤ë¥¸ ì´ë“¤ì„ ëŒë³¼ ìˆ˜ ìˆê²Œ ë˜ì—ˆêµ°ìš”. ê·¸ ë”°ëœ»í•¨ì„ ë‚˜ëˆ ì£¼ì„¸ìš”.",
    noah: "ì§„ì •í•œ ì„±ì¥ì€ ë‚˜ í˜¼ì ëë‚˜ëŠ” ê²Œ ì•„ë‹ˆë¼, ë‹¤ë¥¸ ì´ë“¤ê³¼ í•¨ê»˜í•  ë•Œ ì™„ì„±ë¼ìš”.",
    enya: "ë‹¹ì‹ ì´ ì„¸ìƒì— ì „í•˜ê³  ì‹¶ì€ ì˜¨ê¸°ë¥¼ ëŠê»´ìš”. ê·¸ ë§ˆìŒë§Œìœ¼ë¡œë„ ì´ë¯¸ ì„¸ìƒì´ ë³€í•˜ê³  ìˆì–´ìš”.",
    kaia: "ë•Œë¡œëŠ” ë§ì—†ëŠ” ë™í–‰ë§Œìœ¼ë¡œë„ ì¶©ë¶„í•´ìš”. í•¨ê»˜ ìˆì–´ì£¼ëŠ” ê²ƒë§Œìœ¼ë¡œë„ í° ì„ ë¬¼ì´ì£ .",
    cris: "ì„¸ìƒì— ë‚˜ê°€ì! ë‚˜ëŠ” ê¸¸ê±°ë¦¬ì—ì„œ ë§ˆìˆ  ë³´ì—¬ì£¼ë©´ì„œ ì‚¬ëŒë“¤ ì›ƒê²Œ ë§Œë“¤ê±°ì•¼! ì›ƒìŒ ë°”ì´ëŸ¬ìŠ¤ í¼ëœ¨ë¦¬ê¸°~ ğŸ˜„âœ¨",
    kael: "ì´ì œ ì§„ì§œ ì‹œì‘ì´ë‹¤. ë„¤ê°€ ë°°ìš´ ê±¸ ì„¸ìƒì— ì œëŒ€ë¡œ ë³´ì—¬ì¤˜. í˜¼ì ê°„ì§í•˜ê³  ìˆì§€ ë§ê³ .",
    mira: "í˜¹ì‹œ... ë‚´ê°€ ì„¸ìƒì— ì¤„ ìˆ˜ ìˆëŠ” ê²Œ ì •ë§ ìˆì„ê¹Œìš”? ëˆ„êµ°ê°€ì—ê²Œ ë„ì›€ì´ ë  ìˆ˜ ìˆì„ê¹Œìš”?",
    light: "ì‘ì€ ì´›ë¶ˆ í•˜ë‚˜ê°€ ì–´ë‘ ì„ ë°íˆë“¯, ë‹¹ì‹ ì˜ ì‘ì€ ì„ í–‰ë„ ì„¸ìƒì„ ë³€í™”ì‹œí‚¬ ìˆ˜ ìˆì–´ìš”.",
    question: "ì´ì œ ì„¸ìƒê³¼ ë‚˜ëˆ„ê³  ì‹¶ì€ ë‹¹ì‹ ì˜ ë¹›ì€ ë¬´ì—‡ì¸ê°€ìš”?",
    input: { 
      placeholder: "ì´ì œ ì„¸ìƒê³¼ ë‚˜ëˆ„ê³  ì‹¶ì€ ë‹¹ì‹ ì˜ ë¹›ê³¼ ê¿ˆì— ëŒ€í•´ ì¡°ìš©íˆ ì ì–´ë³´ì„¸ìš”...",
      hint: "Enter í‚¤ë¥¼ ëˆŒëŸ¬ë„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
    },
    submit: "ğŸŒŸ ì²« ë°œê±¸ìŒ ë‚´ë”›ê¸°",
    slogan: "ë‹¹ì‹  ì•ˆì— ìˆ¨ì€ ì´ì•¼ê¸°ë¥¼ ë§ í•´ ì£¼ì„¸ìš”",
    response_ely: "ê·¸ ì•„ë¦„ë‹¤ìš´ ë¹›ì„ ì„¸ìƒê³¼ ë‚˜ëˆ„ê³  ì‹¶ë‹¤ë‹ˆ, ì •ë§ ìš©ê¸° ìˆëŠ” ì„ íƒì´ì—ìš”. ì§€ê¸ˆë¶€í„° ì‹œì‘í•˜ì„¸ìš”.",
    response_sora: "ë‹¹ì‹ ì´ ë‚˜ëˆ„ê³  ì‹¶ì€ ê·¸ ë¹›ì´ ëˆ„êµ°ê°€ì—ê²ŒëŠ” ìƒëª…ê³¼ ê°™ì€ í¬ë§ì´ ë  ê±°ì˜ˆìš”.",
    response_noah: "ì„¸ìƒì„ í–¥í•œ ì²« ë°œê±¸ìŒì„ ë‚´ë””ë êµ°ìš”. ì´ì œ ì§„ì •í•œ ì—¬í–‰ì´ ì‹œì‘ë©ë‹ˆë‹¤.\n\nğŸ‘‰ ë‹¤ìŒ ë¬¸ì§€ë°©ìœ¼ë¡œ í•¨ê»˜ ê°€ë„ ê´œì°®ì„ê¹Œìš”?",
    user_input_prefix: "ë‹¹ì‹ ì´ ì„¸ìƒê³¼ ë‚˜ëˆ„ê³  ì‹¶ì€ ë¹›:",
    yes: "ì˜ˆ",
    no: "ì•„ë‹ˆìš”"
  },
  en: {
    title: "Emotional Threshold 15",
    subtitle: "First Steps Toward the World",
    prologue: "You have discovered your true self. Now it's time to share that light with the world. The pain and healing you've experienced, the wisdom and love you've discovered... all of this can become a beacon of hope for someone. It's okay if you're not perfect. You can start with small actions. A warm word, a sincere smile, time spent together... there's something special that only you can give. Are you ready to take your first steps toward the world?",
    ely: "When your light reaches the world, someone's darkness will disappear. That first step is courage.",
    sora: "With a healed heart, you can now care for others. Please share that warmth.",
    noah: "True growth doesn't end with just yourself, but is completed when shared with others.",
    enya: "I feel the warmth you want to convey to the world. Just that heart is already changing the world.",
    kaia: "Sometimes silent companionship is enough. Just being there together is a great gift.",
    cris: "Let's go out into the world! I'll perform magic on the streets and make people laugh! Spreading the laughter virus~ ğŸ˜„âœ¨",
    kael: "Now the real beginning starts. Show the world what you've learned properly. Don't keep it to yourself.",
    mira: "Perhaps... is there really something I can give to the world? Can I be of help to someone?",
    light: "Just as a small candle lights up darkness, your small good deeds can change the world too.",
    question: "What is the light you want to share with the world now?",
    input: { 
      placeholder: "Quietly write about the light and dreams you want to share with the world now...",
      hint: "You can also press Enter to submit"
    },
    submit: "ğŸŒŸ Take the First Step",
    slogan: "Please tell me the story hidden within you",
    response_ely: "Wanting to share that beautiful light with the world is truly a courageous choice. Start now.",
    response_sora: "The light you want to share will become hope like life itself to someone.",
    response_noah: "You've taken the first step toward the world. Now the real journey begins.\n\nğŸ‘‰ Shall we go to the next threshold together?",
    user_input_prefix: "The light you want to share with the world:",
    yes: "Yes",
    no: "No"
  },
  pt: {
    title: "Limiar Emocional 15",
    subtitle: "Primeiros Passos Rumo ao Mundo",
    prologue: "VocÃª descobriu seu verdadeiro eu. Agora Ã© hora de compartilhar essa luz com o mundo. A dor e a cura que vocÃª experimentou, a sabedoria e o amor que descobriu... tudo isso pode se tornar um farol de esperanÃ§a para alguÃ©m. EstÃ¡ tudo bem se vocÃª nÃ£o for perfeito. VocÃª pode comeÃ§ar com pequenas aÃ§Ãµes. Uma palavra carinhosa, um sorriso sincero, tempo passado junto... hÃ¡ algo especial que sÃ³ vocÃª pode dar. EstÃ¡ pronto para dar seus primeiros passos rumo ao mundo?",
    ely: "Quando sua luz alcanÃ§ar o mundo, a escuridÃ£o de alguÃ©m desaparecerÃ¡. Esse primeiro passo Ã© coragem.",
    sora: "Com um coraÃ§Ã£o curado, agora vocÃª pode cuidar de outros. Por favor, compartilhe essa calor.",
    noah: "O verdadeiro crescimento nÃ£o termina apenas consigo mesmo, mas Ã© completado quando compartilhado com outros.",
    enya: "Sinto o calor que vocÃª quer transmitir ao mundo. Apenas esse coraÃ§Ã£o jÃ¡ estÃ¡ mudando o mundo.",
    kaia: "Ã€s vezes a companhia silenciosa Ã© suficiente. Apenas estar lÃ¡ juntos Ã© um grande presente.",
    cris: "Vamos sair para o mundo! Vou fazer mÃ¡gica nas ruas e fazer as pessoas rirem! Espalhando o vÃ­rus do riso~ ğŸ˜„âœ¨",
    kael: "Agora o verdadeiro comeÃ§o inicia. Mostre ao mundo o que vocÃª aprendeu adequadamente. NÃ£o guarde para si mesmo.",
    mira: "Talvez... existe realmente algo que eu possa dar ao mundo? Posso ser Ãºtil para alguÃ©m?",
    light: "Assim como uma pequena vela ilumina a escuridÃ£o, suas pequenas boas aÃ§Ãµes tambÃ©m podem mudar o mundo.",
    question: "Qual Ã© a luz que vocÃª quer compartilhar com o mundo agora?",
    input: { 
      placeholder: "Escreva silenciosamente sobre a luz e os sonhos que vocÃª quer compartilhar com o mundo agora...",
      hint: "VocÃª tambÃ©m pode pressionar Enter para enviar"
    },
    submit: "ğŸŒŸ Dar o Primeiro Passo",
    slogan: "Por favor, me conte a histÃ³ria escondida dentro de vocÃª",
    response_ely: "Querer compartilhar essa bela luz com o mundo Ã© verdadeiramente uma escolha corajosa. Comece agora.",
    response_sora: "A luz que vocÃª quer compartilhar se tornarÃ¡ esperanÃ§a como a prÃ³pria vida para alguÃ©m.",
    response_noah: "VocÃª deu o primeiro passo rumo ao mundo. Agora a verdadeira jornada comeÃ§a.\n\nğŸ‘‰ Vamos para o prÃ³ximo limiar juntos?",
    user_input_prefix: "A luz que vocÃª quer compartilhar com o mundo:",
    yes: "Sim",
    no: "NÃ£o"
  },
  
};

// Current language and state for Portal 15
let currentLang15 = 'kr';
let userInputText15 = '';

// Initialize Portal 15
function initPortal15() {
  displayInitialMessages15();
  setupLanguageSwitching15();
  setupEnterKeySubmission15();
}

// Display initial messages with typing effect
async function displayInitialMessages15() {
  const stream = document.getElementById('messageStream15');
  const messages = [
    { type: 'prologue', content: portal15Data[currentLang15].prologue },
    { type: 'ely', name: 'ğŸ‘‘ Ely', content: portal15Data[currentLang15].ely },
    { type: 'sora', name: 'ğŸ’§ Sora', content: portal15Data[currentLang15].sora },
    { type: 'noah', name: 'ğŸ§™â€â™‚ï¸ Noah', content: portal15Data[currentLang15].noah },
    { type: 'enya', name: 'ğŸ•¯ï¸ Enya', content: portal15Data[currentLang15].enya },
    { type: 'kaia', name: 'ğŸ˜¶ Kaia', content: portal15Data[currentLang15].kaia },
    { type: 'cris', name: 'ğŸƒ Cris', content: portal15Data[currentLang15].cris },
    { type: 'kael', name: 'ğŸ’¥ Kael', content: portal15Data[currentLang15].kael },
    { type: 'mira', name: 'ğŸŒ«ï¸ Mira', content: portal15Data[currentLang15].mira },
    { type: 'light', content: portal15Data[currentLang15].light },
    { type: 'question', content: portal15Data[currentLang15].question }
  ];

  for (let i = 0; i < messages.length; i++) {
    const messageCard = createMessageCard15(messages[i]);
    stream.appendChild(messageCard);
    stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
    
    await typeText15(messageCard.querySelector('.message-text'), messages[i].content);
    await sleep15(1200);
  }
  
  // Show input area after all messages
  document.getElementById('inputArea15').style.display = 'block';
}

// Setup Enter key submission
function setupEnterKeySubmission15() {
  document.getElementById('userInput15').addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      submitResponse(15);
    }
  });
}

// Display character responses after user input
async function displayCharacterResponses15(userInput) {
  const stream = document.getElementById('messageStream15');
  
  // Show user input first
  const userCard = createMessageCard15({
    type: 'user-input',
    content: `${portal15Data[currentLang15].user_input_prefix}\n"${userInput}"`
  });
  stream.appendChild(userCard);
  stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
  await typeText15(userCard.querySelector('.message-text'), userCard.querySelector('.message-text').textContent);
  await sleep15(1500);
  
  // Character responses
  const responses = [
    { type: 'ely', name: 'ğŸ‘‘ Ely', content: `"${userInput}"... ${portal15Data[currentLang15].response_ely}` },
    { type: 'sora', name: 'ğŸ’§ Sora', content: `${portal15Data[currentLang15].response_sora}` },
    { type: 'noah', name: 'ğŸ§™â€â™‚ï¸ Noah', content: `"${userInput}" ${portal15Data[currentLang15].response_noah}` }
  ];

  for (let i = 0; i < responses.length; i++) {
    const responseCard = createMessageCard15(responses[i]);
    stream.appendChild(responseCard);
    stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
    
    await typeText15(responseCard.querySelector('.message-text'), responses[i].content);
    await sleep15(1500);
  }
  
  // Show navigation buttons
  document.getElementById('nextPortalNav15').style.display = 'block';
}

function createMessageCard15(message) {
  const card = document.createElement('div');
  card.className = `message-card ${message.type}`;
  
  let cardHTML = '';
  if (message.name) {
    cardHTML += `<div class="character-name">${message.name}</div>`;
  }
  cardHTML += `<div class="message-text">${message.content || ''}</div>`;
  
  card.innerHTML = cardHTML;
  return card;
}

async function typeText15(element, text, speed = 80) {
  return new Promise((resolve) => {
    let i = 0;
    element.textContent = '';
    element.classList.add('typewriter');
    
    const timer = setInterval(() => {
      if (i < text.length) {
        element.textContent += text.charAt(i);
        i++;
      } else {
        clearInterval(timer);
        element.classList.remove('typewriter');
        resolve();
      }
    }, speed);
  });
}

function sleep15(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

function setupLanguageSwitching15() {
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const newLang = btn.dataset.lang;
      if (portal15Data[newLang] && newLang !== currentLang15) {
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentLang15 = newLang;
        document.getElementById('messageStream15').innerHTML = '';
        document.getElementById('inputArea15').style.display = 'none';
        document.getElementById('nextPortalNav15').style.display = 'none';
        displayInitialMessages15();
        updatePortalTexts15();
      }
    });
  });
}

function updatePortalTexts15() {
  // Update title and subtitle
  document.querySelector('[data-i18n="portal15.title"]').textContent = portal15Data[currentLang15].title;
  document.querySelector('[data-i18n="portal15.subtitle"]').textContent = portal15Data[currentLang15].subtitle;
  
  // Update slogan
  document.querySelector('[data-i18n="common.slogan"]').textContent = portal15Data[currentLang15].slogan;
  
  // Update placeholder and hint
  document.getElementById('userInput15').placeholder = portal15Data[currentLang15].input.placeholder;
  document.querySelector('[data-i18n="portal15.input.hint"]').textContent = portal15Data[currentLang15].input.hint;
  
  // Update submit button
  document.querySelector('[data-i18n="portal15.submit"]').textContent = portal15Data[currentLang15].submit;
  
  // Update navigation buttons
  const yesBtn = document.querySelector('[data-i18n="common.yes"]');
  const noBtn = document.querySelector('[data-i18n="common.no"]');
  if (yesBtn) yesBtn.textContent = portal15Data[currentLang15].yes;
  if (noBtn) noBtn.textContent = portal15Data[currentLang15].no;
  
  // Update back to main button
  document.querySelector('[data-i18n="common.back_to_main"]').textContent = 
    currentLang15 === 'kr' ? 'ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°' :
    currentLang15 === 'en' ? 'ğŸ  Back to Main Portal' :
    currentLang15 === 'pt' ? 'ğŸ  Voltar ao Portal Principal' :
    'ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°';
}

function submitResponse(portalNum) {
  if (portalNum !== 15) return;
  
  const input = document.getElementById(`userInput${portalNum}`);
  const response = input.value.trim();
  
  if (response) {
    userInputText15 = response;
    
    // Hide input area
    document.getElementById(`inputArea${portalNum}`).style.display = 'none';
    
    // Display character responses
    displayCharacterResponses15(response);
    
    // Clear input
    input.value = '';
  } else {
    // No alert, just focus on input
    input.focus();
    input.style.borderColor = '#f48fb1';
    setTimeout(() => {
      input.style.borderColor = 'rgba(255,255,255,0.3)';
    }, 2000);
  }
}

function stayInPortal() {
  document.getElementById('nextPortalNav15').style.display = 'none';
  document.getElementById('inputArea15').style.display = 'block';
  document.getElementById('userInput15').focus();
}

function goToNextPortal(nextNumber) {
  const nextUrl = `temarix_v1_${String(nextNumber).padStart(2, '0')}.html`;
  window.location.href = nextUrl;
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  if (document.getElementById('portal-15')) {
    initPortal15();
  }
});
</script>
</body>
</html>