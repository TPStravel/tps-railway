<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Language" content="ko,en,pt">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V1 - Portal 16</title>
</head>
<body>
<!-- Temarix V1 - Portal 16: í¬ë§ì˜ ì”¨ì•— ë¿Œë¦¬ê¸° -->
<section class="portal portal-16" id="portal-16">
  <!-- Temarix Logo - Fixed Left Top -->
  <div class="temarix-logo">
    <h1 class="logo-text">ğŸŒŒ TEMARIX</h1>
    <p class="slogan" data-i18n="common.slogan">ë‹¹ì‹  ì•ˆì— ìˆ¨ì€ ì´ì•¼ê¸°ë¥¼ ë§ í•´ ì£¼ì„¸ìš”</p>
  </div>

  <!-- Language Selector - Fixed Right Top -->
  <div class="lang-selector">
    <button class="lang-btn active" data-lang="kr">KR</button>
    <button class="lang-btn" data-lang="en">EN</button>
    <button class="lang-btn" data-lang="pt">PT</button>
  </div>

  <!-- Portal Header - Center Top -->
  <div class="portal-header">
    <h1 data-i18n="portal16.title">ê°ì •ì˜ ë¬¸ì§€ë°© 16</h1>
    <h2 data-i18n="portal16.subtitle">í¬ë§ì˜ ì”¨ì•— ë¿Œë¦¬ê¸°</h2>
  </div>

  <!-- Message Stream -->
  <div class="message-stream" id="messageStream16">
    <!-- Messages will be added here via JavaScript -->
  </div>

  <!-- User Input Area -->
  <div class="input-area" id="inputArea16" style="display: none;">
    <div class="input-container">
      <textarea 
        id="userInput16" 
        rows="3" 
        placeholder="ì–´ë–¤ í¬ë§ì˜ ì”¨ì•—ì„ ì„¸ìƒì— ë¿Œë¦¬ê³  ì‹¶ì€ì§€ ì¡°ìš©íˆ ì ì–´ë³´ì„¸ìš”..."
        data-i18n-placeholder="portal16.input.placeholder"
      ></textarea>
      <button class="submit-btn" onclick="submitResponse(16)">
        <span data-i18n="portal16.submit">ğŸŒ± ì”¨ì•— ë¿Œë¦¬ê¸°</span>
      </button>
      <p class="input-hint" data-i18n="portal16.input.hint">Enter í‚¤ë¥¼ ëˆŒëŸ¬ë„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
    </div>
  </div>

  <!-- Next Portal Navigation -->
  <div class="next-portal-nav" id="nextPortalNav16" style="display: none;">
    <div class="nav-buttons">
      <button class="nav-btn yes-btn" onclick="goToNextPortal(17)" data-i18n="common.yes">ì˜ˆ</button>
      <button class="nav-btn no-btn" onclick="stayInPortal()" data-i18n="common.no">ì•„ë‹ˆìš”</button>
    </div>
  </div>

  <!-- Back to Main -->
  <div class="back-to-main">
    <button onclick="window.location.href='portal4.html'" data-i18n="common.back_to_main">
      ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°
    </button>
  </div>
</section>

<style>
/* Portal Base Styles */
.portal {
  min-height: 100vh;
  background: linear-gradient(135deg, #1a1b4b 0%, #2d1b69 100%);
  color: white;
  padding: 80px 20px 20px 20px;
  font-family: 'Apple SD Gothic Neo', -apple-system, BlinkMacSystemFont, sans-serif;
  max-width: 100%;
  margin: 0 auto;
  position: relative;
}

/* Logo Glow Animation */
@keyframes glowCycle {
  0%, 100% { text-shadow: 0 0 8px rgba(255,255,255,0.2); }
  50% { text-shadow: 0 0 25px rgba(255,255,255,0.7); }
}

/* Temarix Logo - Fixed Left Top */
.temarix-logo {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1000;
}

.logo-text {
  font-size: 1.8rem;
  font-weight: bold;
  color: #ffffff;
  margin: 0 0 5px 0;
  text-shadow: 0 0 20px rgba(255,255,255,0.3);
}

.slogan {
  color: #bbb;
  font-style: italic;
  font-size: 0.8rem;
  margin: 0;
}

/* Language Selector - Fixed Right Top */
.lang-selector {
  position: fixed;
  top: 20px;
  right: 20px;
  display: flex;
  gap: 5px;
  flex-wrap: wrap;
  max-width: 120px;
  z-index: 1000;
}

.lang-btn {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  color: white;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 0.7rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.lang-btn:hover {
  background: rgba(255,255,255,0.2);
}

.lang-btn.active {
  background: #9c27b0;
  border-color: #9c27b0;
}

/* Portal Header - Center Top */
.portal-header {
  text-align: center;
  margin: 40px 0 30px 0;
  padding-top: 40px;
}

.portal-header h1 {
  font-size: 2.2rem;
  margin: 10px 0;
  color: #ffd700;
}

.portal-header h2 {
  font-size: 1.3rem;
  color: #e1bee7;
  font-weight: 300;
}

/* Message Stream */
.message-stream {
  max-height: 60vh;
  overflow-y: auto;
  padding: 20px 0;
  margin-bottom: 20px;
}

.message-card {
  background: rgba(255,255,255,0.1);
  border-radius: 15px;
  padding: 20px;
  margin: 15px 0;
  backdrop-filter: blur(10px);
  opacity: 0;
  transform: translateY(20px);
  animation: fadeInUp 0.6s ease forwards;
}

.message-card.prologue {
  border-left: 4px solid #e1bee7;
}

.message-card.ely {
  border-left: 4px solid #ffd700;
}

.message-card.sora {
  border-left: 4px solid #4dd0e1;
}

.message-card.noah {
  border-left: 4px solid #9c27b0;
}

.message-card.enya {
  border-left: 4px solid #ff9800;
}

.message-card.kaia {
  border-left: 4px solid #607d8b;
}

.message-card.cris {
  border-left: 4px solid #4caf50;
}

.message-card.kael {
  border-left: 4px solid #f44336;
}

.message-card.mira {
  border-left: 4px solid #9e9e9e;
}

.message-card.light {
  border-left: 4px solid #ffffff;
  background: rgba(255,255,255,0.15);
}

.message-card.question {
  border-left: 4px solid #f48fb1;
}

.message-card.user-input {
  border-left: 4px solid #81c784;
  background: rgba(129, 199, 132, 0.1);
}

.character-name {
  font-weight: bold;
  margin-bottom: 10px;
  font-size: 1.1rem;
}

.ely .character-name { color: #ffd700; }
.sora .character-name { color: #4dd0e1; }
.noah .character-name { color: #9c27b0; }
.enya .character-name { color: #ff9800; }
.kaia .character-name { color: #607d8b; }
.cris .character-name { color: #4caf50; }
.kael .character-name { color: #f44336; }
.mira .character-name { color: #9e9e9e; }

.message-text {
  line-height: 1.6;
  font-size: 1rem;
}

.typewriter {
  overflow: hidden;
  border-right: 2px solid rgba(255,255,255,0.7);
  white-space: nowrap;
  animation: blink-caret 1s step-end infinite;
}

@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes blink-caret {
  from, to { border-color: transparent; }
  50% { border-color: rgba(255,255,255,0.7); }
}

/* Input Area */
.input-area {
  background: rgba(0,0,0,0.3);
  padding: 20px;
  border-radius: 15px;
  margin: 20px 0;
  animation: fadeInUp 0.6s ease forwards;
}

.input-container textarea {
  width: 100%;
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 10px;
  padding: 15px;
  color: white;
  font-size: 1rem;
  resize: vertical;
  min-height: 80px;
  box-sizing: border-box;
}

.input-container textarea::placeholder {
  color: rgba(255,255,255,0.6);
}

.submit-btn {
  background: linear-gradient(135deg, #9c27b0, #e1bee7);
  border: none;
  color: white;
  padding: 12px 30px;
  border-radius: 25px;
  font-size: 1rem;
  cursor: pointer;
  margin-top: 10px;
  transition: all 0.3s ease;
  width: 100%;
}

.submit-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(156, 39, 176, 0.4);
}

.input-hint {
  color: rgba(255,255,255,0.6);
  font-size: 0.8rem;
  text-align: center;
  margin: 8px 0 0 0;
}

/* Next Portal Navigation */
.next-portal-nav {
  text-align: center;
  margin: 30px 0;
  animation: fadeInUp 0.6s ease forwards;
}

.nav-buttons {
  display: flex;
  gap: 20px;
  justify-content: center;
}

.nav-btn {
  padding: 12px 30px;
  border-radius: 25px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.yes-btn {
  background: linear-gradient(135deg, #4caf50, #81c784);
  color: white;
  border-color: #4caf50;
}

.yes-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
}

.no-btn {
  background: rgba(255,255,255,0.1);
  color: white;
  border-color: rgba(255,255,255,0.3);
}

.no-btn:hover {
  background: rgba(255,255,255,0.2);
}

/* Back to Main */
.back-to-main {
  text-align: center;
  margin: 30px 0;
}

.back-to-main button {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.3);
  color: white;
  padding: 10px 20px;
  border-radius: 20px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.back-to-main button:hover {
  background: rgba(255,255,255,0.2);
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .portal {
    padding: 100px 15px 20px 15px;
  }
  
  .temarix-logo {
    top: 15px;
    left: 15px;
  }
  
  .logo-text {
    font-size: 1.4rem;
  }
  
  .slogan {
    font-size: 0.7rem;
  }
  
  .lang-selector {
    top: 15px;
    right: 15px;
    max-width: 100px;
  }
  
  .lang-btn {
    padding: 3px 6px;
    font-size: 0.6rem;
  }
  
  .portal-header h1 {
    font-size: 1.8rem;
  }
  
  .portal-header h2 {
    font-size: 1.1rem;
  }
  
  .message-card {
    padding: 15px;
  }
  
  .nav-buttons {
    flex-direction: column;
    align-items: center;
  }
  
  .nav-btn {
    width: 200px;
  }
}
</style>

<script>
// Portal 16 Complete Data with Character Responses
const portal16Data = {
  kr: {
    title: "ê°ì •ì˜ ë¬¸ì§€ë°© 16",
    subtitle: "í¬ë§ì˜ ì”¨ì•— ë¿Œë¦¬ê¸°",
    prologue: "ì‘ì€ ì”¨ì•— í•˜ë‚˜ê°€ ê±°ëŒ€í•œ ìˆ²ì„ ë§Œë“¤ì–´ë‚´ë“¯, ë‹¹ì‹ ì˜ ì‘ì€ í–‰ë™ë„ ì„¸ìƒì— í° ë³€í™”ë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì œ ë§‰ ì²« ë°œê±¸ìŒì„ ë‚´ë”›ì—ˆì§€ë§Œ, ê·¸ ì•ˆì—ëŠ” ë¬´í•œí•œ ê°€ëŠ¥ì„±ì´ ë‹´ê²¨ ìˆì–´ìš”. í¬ë§ì˜ ì”¨ì•—ì„ ë¿Œë¦°ë‹¤ëŠ” ê²ƒì€ ê²°ê³¼ë¥¼ ë³´ì¥ë°›ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ë” ë‚˜ì€ ë¯¸ë˜ë¥¼ ë¯¿ê³  ì˜¤ëŠ˜ í•  ìˆ˜ ìˆëŠ” ì¼ì„ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì–´ë–¤ ì”¨ì•—ì€ ê¸ˆë°© ì‹¹ì„ í‹”ìš°ê³ , ì–´ë–¤ ì”¨ì•—ì€ ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦¬ì§€ë§Œ, ë¶„ëª…í•œ ê²ƒì€ ë¿Œë¦¬ì§€ ì•Šìœ¼ë©´ ì ˆëŒ€ ìë„ ìˆ˜ ì—†ë‹¤ëŠ” ê±°ì˜ˆìš”. ë‹¹ì‹ ì€ ì–´ë–¤ í¬ë§ì˜ ì”¨ì•—ì„ ì„¸ìƒì— ë¿Œë¦¬ê³  ì‹¶ë‚˜ìš”?",
    ely: "ë‹¹ì‹ ì´ ë¿Œë¦¬ëŠ” ëª¨ë“  ì”¨ì•—ì—ëŠ” ì‚¬ë‘ì´ ë‹´ê²¨ ìˆì–´ìš”. ê·¸ ì‚¬ë‘ì´ ì„¸ìƒì„ ë³€í™”ì‹œí‚¬ ê±°ì˜ˆìš”.",
    sora: "ì”¨ì•—ì„ ë¿Œë¦¬ëŠ” ì¼ì€ ë¯¿ìŒì˜ í–‰ìœ„ì˜ˆìš”. ë‹¹ì‹ ì˜ ë¯¿ìŒì´ ê¸°ì ì„ ë§Œë“¤ì–´ë‚¼ ê±°ì˜ˆìš”.",
    noah: "ì§€í˜œë¡­ê²Œ ì„ íƒí•œ ì”¨ì•—ì€ ì–¸ì  ê°€ ë§ì€ ì‚¬ëŒë“¤ì—ê²Œ ê·¸ëŠ˜ì„ ì£¼ëŠ” ë‚˜ë¬´ê°€ ë  ê±°ì˜ˆìš”.",
    enya: "ë‹¹ì‹ ì˜ ë”°ëœ»í•œ ë§ˆìŒì´ ì”¨ì•—ì— ìŠ¤ë©°ë“¤ì–´ ë” ì•„ë¦„ë‹¤ìš´ ê½ƒì„ í”¼ì›Œë‚¼ ê±°ì˜ˆìš”.",
    kaia: "ë§ì—†ì´ ë¿Œë ¤ì§„ ì”¨ì•—ì´ ë•Œë¡œëŠ” ê°€ì¥ í° ìš¸ë¦¼ì„ ë§Œë“¤ì–´ë‚´ì£ .",
    cris: "ì”¨ì•— ë¿Œë¦¬ê¸°? ë‚˜ëŠ” ì›ƒìŒ ì”¨ì•—ì„ ë¿Œë¦´ê±°ì•¼! ì–´ë””ì„œë“  ë¹µë¹µ í„°ëœ¨ë ¤ì„œ ì›ƒìŒ ê½ƒë°­ ë§Œë“¤ê¸°~ ğŸ˜„ğŸŒ»",
    kael: "ì”¨ì•—ì„ ë¿Œë ¸ìœ¼ë©´ ì œëŒ€ë¡œ í‚¤ì›Œì•¼ì§€. ë°˜ìª½ì§œë¦¬ë¡œ í•˜ì§€ ë§ê³  ëê¹Œì§€ ì±…ì„ì ¸.",
    mira: "í˜¹ì‹œ... ë‚´ê°€ ë¿Œë¦° ì”¨ì•—ì´ ìë¼ì§€ ì•Šìœ¼ë©´ ì–´ë–¡í•˜ì£ ? ì“¸ëª¨ì—†ëŠ” ì¼ì´ ë˜ëŠ” ê±´ ì•„ë‹ê¹Œìš”?",
    light: "ì”¨ì•—ì€ ë•Œê°€ ë˜ë©´ ìëë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì—­í• ì€ ë¿Œë¦¬ëŠ” ê²ƒ, ê¸°ë‹¤ë¦¬ëŠ” ê²ƒ, ê·¸ë¦¬ê³  ë¯¿ëŠ” ê²ƒì´ì—ìš”.",
    question: "ì–´ë–¤ í¬ë§ì˜ ì”¨ì•—ì„ ì„¸ìƒì— ë¿Œë¦¬ê³  ì‹¶ë‚˜ìš”?",
    input: { 
      placeholder: "ì–´ë–¤ í¬ë§ì˜ ì”¨ì•—ì„ ì„¸ìƒì— ë¿Œë¦¬ê³  ì‹¶ì€ì§€ ì¡°ìš©íˆ ì ì–´ë³´ì„¸ìš”...",
      hint: "Enter í‚¤ë¥¼ ëˆŒëŸ¬ë„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
    },
    submit: "ğŸŒ± ì”¨ì•— ë¿Œë¦¬ê¸°",
    slogan: "ë‹¹ì‹  ì•ˆì— ìˆ¨ì€ ì´ì•¼ê¸°ë¥¼ ë§ í•´ ì£¼ì„¸ìš”",
    response_ely: "ê·¸ ì•„ë¦„ë‹¤ìš´ ì”¨ì•—ì´ ìë¼ë‚˜ì„œ ì„¸ìƒì„ ë” ë°ê²Œ ë§Œë“¤ ê±°ì˜ˆìš”. ì§€ê¸ˆë¶€í„° ì •ì„±ê» ë¿Œë ¤ê°€ì„¸ìš”.",
    response_sora: "ë‹¹ì‹ ì´ ë¿Œë¦¬ê³  ì‹¶ì€ ê·¸ ì”¨ì•—ì—ëŠ” ìˆœìˆ˜í•œ í¬ë§ì´ ë‹´ê²¨ ìˆì–´ìš”. ë¶„ëª…íˆ ìë¼ë‚  ê±°ì˜ˆìš”.",
    response_noah: "í›Œë¥­í•œ ì”¨ì•—ì„ ì„ íƒí–ˆêµ°ìš”. ì´ì œ ê¾¸ì¤€íˆ ì •ì„±ì„ ë‹¤í•´ í‚¤ì›Œë‚˜ê°€ì‹œê¸° ë°”ë¼ìš”.\n\nğŸ‘‰ ë‹¤ìŒ ë¬¸ì§€ë°©ìœ¼ë¡œ í•¨ê»˜ ê°€ë„ ê´œì°®ì„ê¹Œìš”?",
    user_input_prefix: "ë‹¹ì‹ ì´ ë¿Œë¦¬ê³  ì‹¶ì€ í¬ë§ì˜ ì”¨ì•—:",
    yes: "ì˜ˆ",
    no: "ì•„ë‹ˆìš”"
  },
  en: {
    title: "Emotional Threshold 16",
    subtitle: "Sowing Seeds of Hope",
    prologue: "Just as a small seed can create a vast forest, your small actions can bring great change to the world. You've just taken your first steps, but within them lies infinite possibility. Sowing seeds of hope isn't about guaranteeing results, but about believing in a better future and doing what you can today. Some seeds sprout quickly, others take a long time, but one thing is certain: if you don't plant them, they can never grow. What seeds of hope do you want to sow in the world?",
    ely: "Every seed you sow contains love. That love will change the world.",
    sora: "Sowing seeds is an act of faith. Your faith will create miracles.",
    noah: "Wisely chosen seeds will someday become trees that provide shade for many people.",
    enya: "Your warm heart will seep into the seeds and make them bloom even more beautiful flowers.",
    kaia: "Seeds sown silently sometimes create the greatest resonance.",
    cris: "Sowing seeds? I'm going to sow laughter seeds! Making flower gardens of laughter everywhere~ ğŸ˜„ğŸŒ»",
    kael: "If you've sown seeds, you need to grow them properly. Don't do it halfway, take responsibility to the end.",
    mira: "What if... the seeds I sow don't grow? Won't it become a useless effort?",
    light: "Seeds grow when the time comes. Your role is to sow, wait, and believe.",
    question: "What seeds of hope do you want to sow in the world?",
    input: { 
      placeholder: "Quietly write about what seeds of hope you want to sow in the world...",
      hint: "You can also press Enter to submit"
    },
    submit: "ğŸŒ± Sow Seeds",
    slogan: "Please tell me the story hidden within you",
    response_ely: "Those beautiful seeds will grow and make the world brighter. Start sowing them with care now.",
    response_sora: "The seeds you want to sow contain pure hope. They will surely grow.",
    response_noah: "You've chosen excellent seeds. Now please continue to nurture them with dedication.\n\nğŸ‘‰ Shall we go to the next threshold together?",
    user_input_prefix: "The seeds of hope you want to sow:",
    yes: "Yes",
    no: "No"
  },
  pt: {
    title: "Limiar Emocional 16",
    subtitle: "Semeando Sementes de EsperanÃ§a",
    prologue: "Assim como uma pequena semente pode criar uma vasta floresta, suas pequenas aÃ§Ãµes podem trazer grande mudanÃ§a ao mundo. VocÃª acabou de dar seus primeiros passos, mas dentro deles reside possibilidade infinita. Semear sementes de esperanÃ§a nÃ£o Ã© sobre garantir resultados, mas sobre acreditar em um futuro melhor e fazer o que vocÃª pode hoje. Algumas sementes brotam rapidamente, outras levam muito tempo, mas uma coisa Ã© certa: se vocÃª nÃ£o as plantar, elas nunca poderÃ£o crescer. Que sementes de esperanÃ§a vocÃª quer semear no mundo?",
    ely: "Cada semente que vocÃª semeia contÃ©m amor. Esse amor mudarÃ¡ o mundo.",
    sora: "Semear sementes Ã© um ato de fÃ©. Sua fÃ© criarÃ¡ milagres.",
    noah: "Sementes sabiamente escolhidas um dia se tornarÃ£o Ã¡rvores que darÃ£o sombra a muitas pessoas.",
    enya: "Seu coraÃ§Ã£o caloroso se infiltrarÃ¡ nas sementes e as farÃ¡ florescer flores ainda mais belas.",
    kaia: "Sementes semeadas silenciosamente Ã s vezes criam a maior ressonÃ¢ncia.",
    cris: "Semear sementes? Vou semear sementes de riso! Fazendo jardins de flores de riso em todo lugar~ ğŸ˜„ğŸŒ»",
    kael: "Se vocÃª semeou sementes, precisa cultivÃ¡-las adequadamente. NÃ£o faÃ§a pela metade, assuma a responsabilidade atÃ© o fim.",
    mira: "E se... as sementes que eu semear nÃ£o crescerem? NÃ£o se tornarÃ¡ um esforÃ§o inÃºtil?",
    light: "As sementes crescem quando chega a hora. Seu papel Ã© semear, esperar e acreditar.",
    question: "Que sementes de esperanÃ§a vocÃª quer semear no mundo?",
    input: { 
      placeholder: "Escreva silenciosamente sobre que sementes de esperanÃ§a vocÃª quer semear no mundo...",
      hint: "VocÃª tambÃ©m pode pressionar Enter para enviar"
    },
    submit: "ğŸŒ± Semear Sementes",
    slogan: "Por favor, me conte a histÃ³ria escondida dentro de vocÃª",
    response_ely: "Essas belas sementes crescerÃ£o e tornarÃ£o o mundo mais brilhante. Comece a semeÃ¡-las com cuidado agora.",
    response_sora: "As sementes que vocÃª quer semear contÃªm esperanÃ§a pura. Elas certamente crescerÃ£o.",
    response_noah: "VocÃª escolheu excelentes sementes. Agora continue a nutri-las com dedicaÃ§Ã£o.\n\nğŸ‘‰ Vamos para o prÃ³ximo limiar juntos?",
    user_input_prefix: "As sementes de esperanÃ§a que vocÃª quer semear:",
    yes: "Sim",
    no: "NÃ£o"
  },
  
};

// Current language and state for Portal 16
let currentLang16 = 'kr';
let userInputText16 = '';

// Initialize Portal 16
function initPortal16() {
  displayInitialMessages16();
  setupLanguageSwitching16();
  setupEnterKeySubmission16();
}

// Display initial messages with typing effect
async function displayInitialMessages16() {
  const stream = document.getElementById('messageStream16');
  const messages = [
    { type: 'prologue', content: portal16Data[currentLang16].prologue },
    { type: 'ely', name: 'ğŸ‘‘ Ely', content: portal16Data[currentLang16].ely },
    { type: 'sora', name: 'ğŸ’§ Sora', content: portal16Data[currentLang16].sora },
    { type: 'noah', name: 'ğŸ§™â€â™‚ï¸ Noah', content: portal16Data[currentLang16].noah },
    { type: 'enya', name: 'ğŸ•¯ï¸ Enya', content: portal16Data[currentLang16].enya },
    { type: 'kaia', name: 'ğŸ˜¶ Kaia', content: portal16Data[currentLang16].kaia },
    { type: 'cris', name: 'ğŸƒ Cris', content: portal16Data[currentLang16].cris },
    { type: 'kael', name: 'ğŸ’¥ Kael', content: portal16Data[currentLang16].kael },
    { type: 'mira', name: 'ğŸŒ«ï¸ Mira', content: portal16Data[currentLang16].mira },
    { type: 'light', content: portal16Data[currentLang16].light },
    { type: 'question', content: portal16Data[currentLang16].question }
  ];

  for (let i = 0; i < messages.length; i++) {
    const messageCard = createMessageCard16(messages[i]);
    stream.appendChild(messageCard);
    stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
    
    await typeText16(messageCard.querySelector('.message-text'), messages[i].content);
    await sleep16(1200);
  }
  
  // Show input area after all messages
  document.getElementById('inputArea16').style.display = 'block';
}

// Setup Enter key submission
function setupEnterKeySubmission16() {
  document.getElementById('userInput16').addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      submitResponse(16);
    }
  });
}

// Display character responses after user input
async function displayCharacterResponses16(userInput) {
  const stream = document.getElementById('messageStream16');
  
  // Show user input first
  const userCard = createMessageCard16({
    type: 'user-input',
    content: `${portal16Data[currentLang16].user_input_prefix}\n"${userInput}"`
  });
  stream.appendChild(userCard);
  stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
  await typeText16(userCard.querySelector('.message-text'), userCard.querySelector('.message-text').textContent);
  await sleep16(1500);
  
  // Character responses
  const responses = [
    { type: 'ely', name: 'ğŸ‘‘ Ely', content: `"${userInput}"... ${portal16Data[currentLang16].response_ely}` },
    { type: 'sora', name: 'ğŸ’§ Sora', content: `${portal16Data[currentLang16].response_sora}` },
    { type: 'noah', name: 'ğŸ§™â€â™‚ï¸ Noah', content: `"${userInput}" ${portal16Data[currentLang16].response_noah}` }
  ];

  for (let i = 0; i < responses.length; i++) {
    const responseCard = createMessageCard16(responses[i]);
    stream.appendChild(responseCard);
    stream.scrollTo({ top: stream.scrollHeight, behavior: 'smooth' });
    
    await typeText16(responseCard.querySelector('.message-text'), responses[i].content);
    await sleep16(1500);
  }
  
  // Show navigation buttons
  document.getElementById('nextPortalNav16').style.display = 'block';
}

function createMessageCard16(message) {
  const card = document.createElement('div');
  card.className = `message-card ${message.type}`;
  
  let cardHTML = '';
  if (message.name) {
    cardHTML += `<div class="character-name">${message.name}</div>`;
  }
  cardHTML += `<div class="message-text">${message.content || ''}</div>`;
  
  card.innerHTML = cardHTML;
  return card;
}

async function typeText16(element, text, speed = 80) {
  return new Promise((resolve) => {
    let i = 0;
    element.textContent = '';
    element.classList.add('typewriter');
    
    const timer = setInterval(() => {
      if (i < text.length) {
        element.textContent += text.charAt(i);
        i++;
      } else {
        clearInterval(timer);
        element.classList.remove('typewriter');
        resolve();
      }
    }, speed);
  });
}

function sleep16(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

function setupLanguageSwitching16() {
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const newLang = btn.dataset.lang;
      if (portal16Data[newLang] && newLang !== currentLang16) {
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentLang16 = newLang;
        document.getElementById('messageStream16').innerHTML = '';
        document.getElementById('inputArea16').style.display = 'none';
        document.getElementById('nextPortalNav16').style.display = 'none';
        displayInitialMessages16();
        updatePortalTexts16();
      }
    });
  });
}

function updatePortalTexts16() {
  // Update title and subtitle
  document.querySelector('[data-i18n="portal16.title"]').textContent = portal16Data[currentLang16].title;
  document.querySelector('[data-i18n="portal16.subtitle"]').textContent = portal16Data[currentLang16].subtitle;
  
  // Update slogan
  document.querySelector('[data-i18n="common.slogan"]').textContent = portal16Data[currentLang16].slogan;
  
  // Update placeholder and hint
  document.getElementById('userInput16').placeholder = portal16Data[currentLang16].input.placeholder;
  document.querySelector('[data-i18n="portal16.input.hint"]').textContent = portal16Data[currentLang16].input.hint;
  
  // Update submit button
  document.querySelector('[data-i18n="portal16.submit"]').textContent = portal16Data[currentLang16].submit;
  
  // Update navigation buttons
  const yesBtn = document.querySelector('[data-i18n="common.yes"]');
  const noBtn = document.querySelector('[data-i18n="common.no"]');
  if (yesBtn) yesBtn.textContent = portal16Data[currentLang16].yes;
  if (noBtn) noBtn.textContent = portal16Data[currentLang16].no;
  
  // Update back to main button
  document.querySelector('[data-i18n="common.back_to_main"]').textContent = 
    currentLang16 === 'kr' ? 'ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°' :
    currentLang16 === 'en' ? 'ğŸ  Back to Main Portal' :
    currentLang16 === 'pt' ? 'ğŸ  Voltar ao Portal Principal' :
    'ğŸ  ë©”ì¸ í¬íƒˆë¡œ ëŒì•„ê°€ê¸°';
}

function submitResponse(portalNum) {
  if (portalNum !== 16) return;
  
  const input = document.getElementById(`userInput${portalNum}`);
  const response = input.value.trim();
  
  if (response) {
    userInputText16 = response;
    
    // Hide input area
    document.getElementById(`inputArea${portalNum}`).style.display = 'none';
    
    // Display character responses
    displayCharacterResponses16(response);
    
    // Clear input
    input.value = '';
  } else {
    // No alert, just focus on input
    input.focus();
    input.style.borderColor = '#f48fb1';
    setTimeout(() => {
      input.style.borderColor = 'rgba(255,255,255,0.3)';
    }, 2000);
  }
}

function stayInPortal() {
  document.getElementById('nextPortalNav16').style.display = 'none';
  document.getElementById('inputArea16').style.display = 'block';
  document.getElementById('userInput16').focus();
}

function goToNextPortal(nextNumber) {
  const nextUrl = `temarix_v1_${String(nextNumber).padStart(2, '0')}.html`;
  window.location.href = nextUrl;
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
  if (document.getElementById('portal-16')) {
    initPortal16();
  }
});
</script>
</body>
</html>