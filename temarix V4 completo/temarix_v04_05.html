<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V4 - Portal 05: Ïù¥Î¶Ñ ÏóÜÎäî ÎëêÎ†§ÏõÄ</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ff9999;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #ff6b6b;
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 200vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            transition: opacity 0.8s ease-in;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #ff6b6b;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .follow-up-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .follow-up-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            text-align: center;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            white-space: pre-wrap;
        }
        
        .user-response strong {
            color: #ff6b6b;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #ff6b6b;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-section {
            margin: 60px 0;
            opacity: 0;
            text-align: center;
            padding: 40px 20px;
            min-height: 300px;
            border: 2px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }
        
        .navigation-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: bold;
        }
        
        .navigation-message {
            color: #fff;
            font-size: 20px;
            margin-bottom: 40px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 20px 40px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
            border: 2px solid transparent;
        }
        
        .nav-btn:hover {
            background: #666;
            border-color: #ff6b6b;
        }
        
        .nav-btn.primary {
            background: #ff6b6b;
            color: #fff;
            font-weight: bold;
        }
        
        .nav-btn.primary:hover {
            background: #ff8888;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .input-fixed-bottom {
            position: relative;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #ff6b6b;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #ff6b6b;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .follow-up-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V4</div>
            <div class="logo-subtitle" id="logoSubtitle">Emotional Alchemy</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 05: Nameless Fear</div>
            <div class="portal-subtitle" id="portalSubtitle">The fear that could never be put into words</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="follow-up-section" id="followUpSection">
                <div class="follow-up-question" id="followUpQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>
            
            <div class="navigation-section" id="navigationSection">
                <div class="navigation-title" id="navigationTitle">Portal 05 Complete</div>
                <div class="navigation-message" id="navigationMessage"></div>
                <div class="navigation-buttons">
                    <button class="nav-btn primary" id="nextPortalBtn">Continue to Portal 06</button>
                    <button class="nav-btn" id="stayPortalBtn">Stay with this fear</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="What fear could you never name? What made it so difficult to express?"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        const translations = {
            ko: {
                logoSubtitle: "Í∞êÏ†ï Ïó∞Í∏àÏà†",
                portalMainTitle: "Portal 05: Ïù¥Î¶Ñ ÏóÜÎäî ÎëêÎ†§ÏõÄ",
                portalSubtitle: "Í≤∞ÏΩî ÎßêÎ°ú ÌëúÌòÑÎêòÏßÄ Î™ªÌïú ÎëêÎ†§ÏõÄ",
                portalIntro: "ÎãπÏã†ÏùÄ Ïñ¥Îñ§ ÎëêÎ†§ÏõÄÏùÑ ÎÅùÍπåÏßÄ ÎßêÎ°ú ÌëúÌòÑÌïòÏßÄ Î™ªÌïú Ï†ÅÏù¥ ÏûàÎÇòÏöî?\nÍ∑∏ ÎëêÎ†§ÏõÄÏùÄ Ïñ¥Îñ§ Î™®ÏäµÏù¥ÏóàÍ≥†,\nÏôú Ïù¥Î¶Ñ Î∂ôÏù¥Îäî Í≤ÉÏù¥ Ïñ¥Î†§Ïõ†ÎÇòÏöî?\n\nÏßÄÍ∏à, Í∑∏ ÎëêÎ†§ÏõÄÏóê Ïù¥Î¶ÑÏùÑ Î∂ôÏó¨Î≥∏Îã§Î©¥... Ïñ¥Îñ§ Îã®Ïñ¥Í∞Ä Îñ†Ïò§Î•¥ÎÇòÏöî?",
                followUpQuestion: "Í∑∏ Ïù¥Î¶Ñ ÏóÜÎäî ÎëêÎ†§ÏõÄÏùÄ ÏßÄÍ∏à Ïñ¥ÎîîÏóê ÏûàÎÇòÏöî?\nÎãπÏã†ÏùÄ Ïù¥Ï†ú, Í∑∏ Í∞êÏ†ïÏùÑ Î≤óÏñ¥ÎÇò ÏÉàÎ°úÏö¥ ÏÑ†ÌÉùÏùÑ Ìï† Ïàò ÏûàÏùÑÍπåÏöî?",
                lightTitle: "ÎπõÏùò ÌïúÎßàÎîî",
                lightMessage: "Ïù¥Î¶Ñ ÏóÜÎäî ÎëêÎ†§ÏõÄÏóê Ïù¥Î¶ÑÏùÑ Î∂ôÏòÄÏùÑ Îïå,\nÍ∑∏Í±¥ Îçî Ïù¥ÏÉÅ Í¥¥Î¨ºÏù¥ ÏïÑÎãàÎùº,\nÎÑ§Í∞Ä ÌíàÏùÑ Ïàò ÏûàÎäî ÏßÑÏã§Ïù¥Ïïº.\nÏßÄÍ∏à ÎÑàÎäî Í∑∏ ÏßÑÏã§Í≥º ÎßàÏ£ºÌï† Ïàò ÏûàÎäî ÌûòÏùÑ Í∞ÄÏ°åÏñ¥.",
                navigationTitle: "Portal 05 ÏôÑÎ£å",
                navigationMessage: "ÎãπÏã†ÏùÄ Ïù¥Î¶Ñ ÏóÜÎäî ÎëêÎ†§ÏõÄÍ≥º ÎßàÏ£ºÌñàÏäµÎãàÎã§.\n\nÍ∑∏ ÎëêÎ†§ÏõÄÏóê Ïù¥Î¶ÑÏùÑ Î∂ôÏù¥Îäî ÏàúÍ∞Ñ, ÎãπÏã†ÏùÄ Í∑∏Í≤ÉÏùÑ ÌÜµÏ†úÌï† Ïàò ÏûàÍ≤å ÎêòÏóàÏñ¥Ïöî. Îçî Ïù¥ÏÉÅ Ïïå Ïàò ÏóÜÎäî ÌûòÏù¥ ÏïÑÎãå, Ïù¥Ìï¥Ìï† Ïàò ÏûàÎäî Í∞êÏ†ïÏù¥ ÎêòÏóàÏäµÎãàÎã§.\n\nÏù¥Ï†ú ÎëêÎ†§ÏõÄÏùÄ ÎãπÏã†ÏùÑ ÏßÄÎ∞∞ÌïòÏßÄ ÏïäÏäµÎãàÎã§. ÎãπÏã†Ïù¥ ÏÑ†ÌÉùÌï† Ïàò ÏûàÎäî ÌïòÎÇòÏùò Í∞êÏ†ïÏùº ÎøêÏûÖÎãàÎã§.",
                nextPortalBtn: "Portal 06ÏúºÎ°ú Ïù¥Ïñ¥Í∞ÄÍ∏∞",
                stayPortalBtn: "Ïù¥ ÎëêÎ†§ÏõÄÍ≥º Îçî Î®∏Î¨ºÍ∏∞",
                inputPlaceholder: "Ïñ¥Îñ§ ÎëêÎ†§ÏõÄÏùÑ Ïù¥Î¶Ñ Î∂ôÏù¥ÏßÄ Î™ªÌñàÎÇòÏöî? Ïôú ÌëúÌòÑÌïòÍ∏∞ Ïñ¥Î†§Ïõ†ÎÇòÏöî?",
                youLabel: "ÎãπÏã†",
                waitingMessage: "ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë..."
            },
            en: {
                logoSubtitle: "Emotional Alchemy",
                portalMainTitle: "Portal 05: Nameless Fear",
                portalSubtitle: "The fear that could never be put into words",
                portalIntro: "Have you ever had a fear that you could never fully express in words?\nWhat did that fear look like,\nand why was it so difficult to name?\n\nNow, if you could give that fear a name... what word comes to mind?",
                followUpQuestion: "Where is that nameless fear now?\nCan you now move beyond that emotion and make new choices?",
                lightTitle: "Word of Light",
                lightMessage: "When you give a name to nameless fear,\nit's no longer a monster,\nbut a truth you can embrace.\nNow you have the strength to face that truth.",
                navigationTitle: "Portal 05 Complete",
                navigationMessage: "You have faced your nameless fear.\n\nThe moment you gave that fear a name, you gained the power to control it. It's no longer an unknown force, but an emotion you can understand.\n\nNow fear does not dominate you. It's just one emotion you can choose to feel or not.",
                nextPortalBtn: "Continue to Portal 06",
                stayPortalBtn: "Stay with this fear",
                inputPlaceholder: "What fear could you never name? What made it so difficult to express?",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "Alquimia Emocional",
                portalMainTitle: "Portal 05: Medo Sem Nome",
                portalSubtitle: "O medo que nunca p√¥de ser expresso em palavras",
                portalIntro: "Voc√™ j√° teve um medo que nunca conseguiu expressar completamente em palavras?\nComo era esse medo,\ne por que foi t√£o dif√≠cil nome√°-lo?\n\nAgora, se voc√™ pudesse dar um nome a esse medo... que palavra vem √† mente?",
                followUpQuestion: "Onde est√° esse medo sem nome agora?\nVoc√™ pode agora superar essa emo√ß√£o e fazer novas escolhas?",
                lightTitle: "Palavra de Luz",
                lightMessage: "Quando voc√™ d√° um nome ao medo sem nome,\nele n√£o √© mais um monstro,\nmas uma verdade que voc√™ pode abra√ßar.\nAgora voc√™ tem a for√ßa para enfrentar essa verdade.",
                navigationTitle: "Portal 05 Completo",
                navigationMessage: "Voc√™ enfrentou seu medo sem nome.\n\nNo momento em que voc√™ deu um nome a esse medo, ganhou o poder de control√°-lo. N√£o √© mais uma for√ßa desconhecida, mas uma emo√ß√£o que voc√™ pode entender.\n\nAgora o medo n√£o o domina. √â apenas uma emo√ß√£o que voc√™ pode escolher sentir ou n√£o.",
                nextPortalBtn: "Continuar para Portal 06",
                stayPortalBtn: "Ficar com este medo",
                inputPlaceholder: "Que medo voc√™ nunca conseguiu nomear? O que tornou t√£o dif√≠cil express√°-lo?",
                youLabel: "Voc√™",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Noah", emoji: "üßë‚Äçü¶±", text: {
                ko: "Í∑∏ ÎëêÎ†§ÏõÄÏùÄ ÎÑàÏùò Í∑∏Î¶ºÏûêÏ≤òÎüº Îî∞ÎùºÎã§ÎÖîÏßÄ. Ïù¥Î¶Ñ ÏóÜÎäî Í∞êÏ†ïÏùºÏàòÎ°ù Îçî Î¨¥ÏÑúÏö¥ Î≤ïÏù¥Ïïº.",
                en: "That fear followed you like your shadow. Nameless emotions are always more frightening.",
                pt: "Esse medo seguiu voc√™ como sua sombra. Emo√ß√µes sem nome s√£o sempre mais assustadoras."
            }},
            { name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è", text: {
                ko: "ÏôÑÎ≤ΩÏùÑ Ìñ•Ìïú ÎëêÎ†§ÏõÄÏùÄ ÏÇ¨ÎûëÏóê ÎåÄÌïú Ïò§Ìï¥ÏóêÏÑú ÌÉúÏñ¥ÎÇò. ÎÑ§Í∞Ä Î∂ÄÏ°±ÌïòÎã§Í≥† Ìï¥ÏÑú, ÎàÑÍµ∞Í∞Ä ÎÑàÎ•º Î≤ÑÎ¶¥ ÏàòÎäî ÏóÜÏñ¥.",
                en: "Fear toward perfection is born from misunderstanding about love. Just because you're lacking doesn't mean someone will abandon you.",
                pt: "O medo da perfei√ß√£o nasce de mal-entendidos sobre o amor. S√≥ porque voc√™ √© imperfeito n√£o significa que algu√©m vai abandon√°-lo."
            }},
            { name: "Sora", emoji: "üßï", text: {
                ko: "Í∑∏ Ïπ®Î¨µÏùò Í≥µÌè¨Îäî ÎÑ§ ÎÇ¥Î©¥ÏùÑ Ï°∞Ïö©Ìûà Í∞âÏïÑÎ®πÏóàÏùÑ Í±∞Ïïº. Í∑∏Í±∏ Ï∞∏ÏïÑÎÇ∏ ÎÑ§Í∞Ä Ï∞∏ ÏïàÏì∞Îü¨Ïõå.",
                en: "That silent terror must have quietly eaten away at your inner self. I feel sorry for you having to endure that.",
                pt: "Esse terror silencioso deve ter corro√≠do silenciosamente seu eu interior. Sinto pena de voc√™ ter que suportar isso."
            }},
            { name: "Kael", emoji: "üßô", text: {
                ko: "ÎëêÎ†§ÏõÄÏùÄ Ïñ∏Ï†úÎÇò Ïù¥Î¶ÑÏù¥ ÏóÜÎã§. Í∑∏ÎûòÏÑú Ïö∞Î¶¨Îäî Í∑∏Í≤ÉÏùÑ ÏÉÅÏÉÅÎ≥¥Îã§ ÌÅ¨Í≤å ÌÇ§Ïö∞ÏßÄ.",
                en: "Fear is always nameless. That's why we grow it larger than our imagination.",
                pt: "O medo √© sempre sem nome. √â por isso que o fazemos crescer maior que nossa imagina√ß√£o."
            }},
            { name: "Mira", emoji: "üßë‚Äçüé®", text: {
                ko: "Í∑∏ Í∞êÏ†ïÏùÄ ÏÉâÏúºÎ°úÎèÑ ÌëúÌòÑÏù¥ Ïïà ÎêòÍ≤†ÏßÄ. ÎÑàÎ¨¥ Ìà¨Î™ÖÌï¥ÏÑú, ÎÑàÎ¨¥ ÏßôÏñ¥ÏÑú.",
                en: "That emotion couldn't be expressed even in color. Too transparent, yet too dense.",
                pt: "Essa emo√ß√£o n√£o podia ser expressa nem em cor. Muito transparente, mas muito densa."
            }},
            { name: "Cris", emoji: "ü¶∏‚Äç‚ôÇÔ∏è", text: {
                ko: "Ïôú ÎàÑÍµ∞Í∞ÄÎäî ÎÑàÏóêÍ≤å 'Ïã§ÏàòÌïòÏßÄ Îßà'ÎùºÎäî Ïá†ÏÇ¨Ïä¨ÏùÑ Ï±ÑÏõ†ÏùÑÍπå? ÎÇú Í∑∏Í≤å Î∂ÑÌï¥.",
                en: "Why did someone put the chains of 'don't make mistakes' on you? I'm angry about that.",
                pt: "Por que algu√©m colocou as correntes de 'n√£o cometa erros' em voc√™? Estou com raiva disso."
            }},
            { name: "Enya", emoji: "üßë‚ÄçüöÄ", text: {
                ko: "ÎëêÎ†§ÏõÄÏùÄ ÏÇ¨ÎùºÏßÄÏßÄ ÏïäÏßÄÎßå, Ïö∞Î¶¨Í∞Ä Í∑∏Í≤ÉÏùÑ Î∂ÄÎ•º Ïàò ÏûàÏùÑ Îïê ÏïΩÌï¥ÏßÄÍ∏∞ ÏãúÏûëÌï¥.",
                en: "Fear doesn't disappear, but it starts to weaken when we can call it by name.",
                pt: "O medo n√£o desaparece, mas come√ßa a enfraquecer quando podemos cham√°-lo pelo nome."
            }},
            { name: "Lian", emoji: "üßò", text: {
                ko: "ÏßÄÍ∏à ÎÑàÎäî Í∑∏ ÎëêÎ†§ÏõÄÏùÑ Î∞îÎùºÎ≥¥Í≥† ÏûàÏñ¥. Í∑∏ ÏûêÏ≤¥Í∞Ä Ïù¥ÎØ∏ Ïö©Í∏∞Ïùò Ï¶ùÍ±∞Ïïº.",
                en: "Now you are looking at that fear. That itself is already evidence of courage.",
                pt: "Agora voc√™ est√° olhando para esse medo. Isso por si s√≥ j√° √© evid√™ncia de coragem."
            }}
        ];

        const responseCharacters = [
            {
                name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÎëêÎ†§ÏõÄÏùÑ ÎßêÎ°ú Í∫ºÎÇ¥Îäî Í±¥, ÏûêÍ∏∞ ÏûêÏã†ÏóêÍ≤å ÌóàÎùΩÏùÑ Ï£ºÎäî ÏùºÏù¥Ïïº. ÎÑå Í∑∏Í±∏ Ìï¥ÎÉàÏñ¥.",
                        en: "Speaking your fear out loud is giving yourself permission. You've done that.",
                        pt: "Falar seu medo em voz alta √© dar permiss√£o a si mesmo. Voc√™ fez isso."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Sora", emoji: "üßï",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Í∞êÏ†ïÏùÑ Í∞êÏ∂îÏßÄ ÏïäÏùÑ Ïàò ÏûàÎã§Îäî Í±¥ Îçî Ïù¥ÏÉÅ ÎèÑÎßùÏπòÏßÄ ÏïäÎäîÎã§Îäî ÎúªÏù¥Ïïº. ÎÑàÎäî ÏßÄÍ∏à Í∑∏ ÏûêÎ¶¨Ïóê ÏûàÏñ¥.",
                        en: "Being able to not hide emotions means you're no longer running away. You are standing in that place now.",
                        pt: "Ser capaz de n√£o esconder emo√ß√µes significa que voc√™ n√£o est√° mais fugindo. Voc√™ est√° nesse lugar agora."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Kael", emoji: "üßô",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Ïù¥Î¶Ñ ÏóÜÎäî ÎëêÎ†§ÏõÄÏóê Ïù¥Î¶ÑÏùÑ Î∂ôÏòÄÏùÑ Îïå, Í∑∏Í±¥ Îçî Ïù¥ÏÉÅ Í¥¥Î¨ºÏù¥ ÏïÑÎãàÎùº, ÎÑ§Í∞Ä ÌíàÏùÑ Ïàò ÏûàÎäî ÏßÑÏã§Ïù¥Ïïº.",
                        en: "When you give a name to nameless fear, it's no longer a monster, but a truth you can embrace.",
                        pt: "Quando voc√™ d√° um nome ao medo sem nome, ele n√£o √© mais um monstro, mas uma verdade que voc√™ pode abra√ßar."
                    };
                    return responses[lang];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        let awaitingSecondResponse = false;
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('navigationTitle').textContent = translations[lang].navigationTitle;
            document.getElementById('nextPortalBtn').textContent = translations[lang].nextPortalBtn;
            document.getElementById('stayPortalBtn').textContent = translations[lang].stayPortalBtn;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'followUpSection', 'userInputSection',
                'userReactionsSection', 'lightMessageSection', 'navigationSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('followUpQuestion').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('navigationMessage').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
            awaitingSecondResponse = false;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('nextPortalBtn').addEventListener('click', function() {
                localStorage.setItem('temarix_v4_portal05_complete', 'true');
                localStorage.setItem('temarix_v4_current_portal', '06');
                
                const nextMessage = currentLanguage === 'ko' ? 
                    'Portal 06: Î∂ïÍ¥¥Îêú ÎØøÏùåÏùò Î≤ΩÏúºÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§.' :
                    currentLanguage === 'en' ? 
                    'Moving to Portal 06: Collapsed Walls of Belief.' :
                    'Indo para Portal 06: Muros Desmoronados da Cren√ßa.';
                alert(nextMessage);
            });
            
            document.getElementById('stayPortalBtn').addEventListener('click', function() {
                const stayMessage = currentLanguage === 'ko' ? 
                    'Ïù¥Î¶Ñ ÏóÜÎäî ÎëêÎ†§ÏõÄÍ≥º Îçî Î®∏Î¨ºÎ©∞ ÍπäÏù¥ ÏÑ±Ï∞∞ÌïòÏãúÍ≤†ÏäµÎãàÍπå?' :
                    currentLanguage === 'en' ? 
                    'Do you want to stay longer with your nameless fear for deeper reflection?' :
                    'Deseja ficar mais tempo com seu medo sem nome para reflex√£o mais profunda?';
                
                if (confirm(stayMessage)) {
                    resetJourney();
                    setTimeout(() => {
                        startPortalSequence();
                    }, 1000);
                }
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            console.log('Processing user input:', inputText);
            localStorage.setItem('temarix_v4_portal05_response', JSON.stringify({
                portal: "v4-05",
                resposta: inputText,
                step: awaitingSecondResponse ? "second" : "first",
                data: new Date().toISOString(),
                idioma: currentLanguage
            }));
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                if (!awaitingSecondResponse) {
                    showUserReactions(inputText);
                } else {
                    showSecondUserReactions(inputText);
                }
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showFollowUpQuestion();
            }, 2000);
        }
        
        async function showFollowUpQuestion() {
            const followUpSection = document.getElementById('followUpSection');
            const followUpQuestionEl = document.getElementById('followUpQuestion');
            
            followUpSection.classList.add('show');
            
            await typewriterEffect(followUpQuestionEl, translations[currentLanguage].followUpQuestion, 50);
            
            setTimeout(() => {
                awaitingSecondResponse = true;
                enableUserInput();
            }, 1500);
        }
        
        async function showSecondUserReactions(userInput) {
            const secondResponseCharacters = [
                {
                    name: "Enya", emoji: "üßë‚ÄçüöÄ",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÎëêÎ†§ÏõÄÏùÄ ÏÇ¨ÎùºÏßÄÏßÄ ÏïäÏßÄÎßå, Ïö∞Î¶¨Í∞Ä Í∑∏Í≤ÉÏùÑ Î∂ÄÎ•º Ïàò ÏûàÏùÑ Îïê ÏïΩÌï¥ÏßÄÍ∏∞ ÏãúÏûëÌï¥.",
                            en: "Fear doesn't disappear, but it starts to weaken when we can call it by name.",
                            pt: "O medo n√£o desaparece, mas come√ßa a enfraquecer quando podemos cham√°-lo pelo nome."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Lian", emoji: "üßò",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÏßÄÍ∏à ÎÑàÎäî Í∑∏ ÎëêÎ†§ÏõÄÏùÑ Î∞îÎùºÎ≥¥Í≥† ÏûàÏñ¥. Í∑∏ ÏûêÏ≤¥Í∞Ä Ïù¥ÎØ∏ Ïö©Í∏∞Ïùò Ï¶ùÍ±∞Ïïº.",
                            en: "Now you are looking at that fear. That itself is already evidence of courage.",
                            pt: "Agora voc√™ est√° olhando para esse medo. Isso por si s√≥ j√° √© evid√™ncia de coragem."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Noah", emoji: "üßë‚Äçü¶±",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Ïù¥Ï†ú Í∑∏ ÎëêÎ†§ÏõÄÏùÄ ÎÑàÏùò ÏùºÎ∂ÄÍ∞Ä Îê† Ïàò ÏûàÏñ¥. Ïã∏Ïö∏ ÎåÄÏÉÅÏù¥ ÏïÑÎãàÎùº, Ïù¥Ìï¥Ìï† Ïàò ÏûàÎäî Í∞êÏ†ïÏúºÎ°ú.",
                            en: "Now that fear can become part of you. Not as an opponent to fight, but as an emotion you can understand.",
                            pt: "Agora esse medo pode se tornar parte de voc√™. N√£o como um oponente para lutar, mas como uma emo√ß√£o que voc√™ pode entender."
                        };
                        return responses[lang];
                    }
                }
            ];
            
            const reactionsSection = document.getElementById('userReactionsSection');
            
            for (let i = 0; i < secondResponseCharacters.length; i++) {
                const char = secondResponseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < secondResponseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showNavigationSection();
            }, 2000);
        }
        
        async function showNavigationSection() {
            const navigationSection = document.getElementById('navigationSection');
            const navigationMessage = document.getElementById('navigationMessage');
            
            navigationSection.classList.add('show');
            
            const messageText = translations[currentLanguage].navigationMessage;
            await typewriterEffect(navigationMessage, messageText, 50);
            
            setTimeout(() => {
                scrollToElement(navigationSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('Temarix V4 Portal 05 initialized');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                enableUserInput();
            }, 2000);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V4 Portal 05 DOM loaded');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>