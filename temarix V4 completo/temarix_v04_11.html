<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V4 - Portal 11: The Future Told to No One</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ff9999;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #ff6b6b;
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 200vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            transition: opacity 0.8s ease-in;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #ff6b6b;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .follow-up-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .follow-up-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            text-align: center;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            white-space: pre-wrap;
        }
        
        .user-response strong {
            color: #ff6b6b;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #ff6b6b;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-section {
            margin: 60px 0;
            opacity: 0;
            text-align: center;
            padding: 40px 20px;
            min-height: 300px;
            border: 2px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }
        
        .navigation-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: bold;
        }
        
        .navigation-message {
            color: #fff;
            font-size: 20px;
            margin-bottom: 40px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 20px 40px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
            border: 2px solid transparent;
        }
        
        .nav-btn:hover {
            background: #666;
            border-color: #ff6b6b;
        }
        
        .nav-btn.primary {
            background: #ff6b6b;
            color: #fff;
            font-weight: bold;
        }
        
        .nav-btn.primary:hover {
            background: #ff8888;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .input-fixed-bottom {
            position: relative;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #ff6b6b;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #ff6b6b;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .follow-up-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V4</div>
            <div class="logo-subtitle" id="logoSubtitle">Emotional Alchemy</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 11: The Future Told to No One</div>
            <div class="portal-subtitle" id="portalSubtitle">Dreams kept secret in the heart</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="follow-up-section" id="followUpSection">
                <div class="follow-up-question" id="followUpQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>
            
            <div class="navigation-section" id="navigationSection">
                <div class="navigation-title" id="navigationTitle">Portal 11 Complete</div>
                <div class="navigation-message" id="navigationMessage"></div>
                <div class="navigation-buttons">
                    <button class="nav-btn primary" id="nextPortalBtn">Continue to Portal 12</button>
                    <button class="nav-btn" id="stayPortalBtn">Stay with this dream</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Do you have a dream that you've kept secret and never told anyone? What emotions surround that silence?"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        const translations = {
            ko: {
                logoSubtitle: "Í∞êÏ†ï Ïó∞Í∏àÏà†",
                portalMainTitle: "Portal 11: ÏïÑÎ¨¥ÏóêÍ≤åÎèÑ ÎßêÌïòÏßÄ ÏïäÏùÄ ÎØ∏Îûò",
                portalSubtitle: "Í∞ÄÏä¥ÏÜçÏóêÎßå Î¨ªÏñ¥Îëî Íøà",
                portalIntro: "ÎãπÏã†ÏùÄ Ìïú Î≤àÏù¥ÎùºÎèÑ ÎØ∏ÎûòÏóê ÎåÄÌï¥\nÎßêÌïòÏßÄ ÏïäÍ≥† Í∞ÄÏä¥ÏÜçÏóêÎßå Î¨ªÏñ¥Îëî ÍøàÏù¥ ÏûàÏóàÎÇòÏöî?\n\nÍ∑∏ ÎØ∏ÎûòÎäî Ïôú ÎßêÎ°ú Í∫ºÎÇº Ïàò ÏóÜÏóàÍ≥†,\nÏñ¥Îñ§ Í∞êÏ†ïÏù¥ Í∑∏ Ïπ®Î¨µÏùÑ Í∞êÏã∏Í≥† ÏûàÏóàÎÇòÏöî?",
                followUpQuestion: "Í∑∏ ÎØ∏ÎûòÎ•º ÎßêÌïòÏßÄ ÏïäÏïòÎçò ÏûêÏã†ÏóêÍ≤å,\nÏßÄÍ∏à Ïñ¥Îñ§ ÎßêÏùÑ Í±¥ÎÑ§Í≥† Ïã∂ÎÇòÏöî?\nÍ∑∏ ÍøàÏùÄ ÏïÑÏßÅ ÏÇ¥ÏïÑ ÏûàÎÇòÏöî?",
                lightTitle: "ÎπõÏùò ÌïúÎßàÎîî",
                lightMessage: "ÍøàÏùÄ Îä¶ÏßÄ ÏïäÏïÑ.\nÏò§ÌûàÎ†§ ÏßÑÏßú ÏãúÏûëÏùÄ,\nÏßÑÏã¨ÏúºÎ°ú ÎßêÌï† Ïàò ÏûàÏùÑ ÎïåÏïº.",
                navigationTitle: "Portal 11 ÏôÑÎ£å",
                navigationMessage: "ÎãπÏã†ÏùÄ ÏïÑÎ¨¥ÏóêÍ≤åÎèÑ ÎßêÌïòÏßÄ ÏïäÏïòÎçò ÎØ∏ÎûòÎ•º ÎßàÏ£ºÌñàÏäµÎãàÎã§.\n\nÍ∞êÏ∂∞ÏßÑ ÍøàÏùÄ ÏïΩÌï®Ïù¥ ÏïÑÎãàÎùº ÏÜåÏ§ëÌï® ÎïåÎ¨∏Ïù¥ÏóàÏäµÎãàÎã§. Í∑∏ ÍøàÏùÄ Ï°∞Ïö©Ìûà ÎãπÏã† ÏïàÏóêÏÑú Ïà® Ïâ¨Î©∞ ÏãúÍ∞ÑÏùÑ Í∏∞Îã§Î†∏ÏäµÎãàÎã§.\n\nÏù¥Ï†ú ÎãπÏã†ÏùÄ Í∑∏ ÍøàÏùÑ Ï°∞Ïö©Ìûà ÎßêÌï† Ïàò ÏûàÎäî ÏÇ¨ÎûåÏù¥ ÎêòÏóàÏäµÎãàÎã§.",
                nextPortalBtn: "Portal 12Î°ú Ïù¥Ïñ¥Í∞ÄÍ∏∞",
                stayPortalBtn: "Ïù¥ ÍøàÍ≥º Îçî Î®∏Î¨ºÍ∏∞",
                inputPlaceholder: "ÎãπÏã†ÏùÄ ÏïÑÎ¨¥ÏóêÍ≤åÎèÑ ÎßêÌïòÏßÄ ÏïäÍ≥† Í∞ÄÏä¥ÏÜçÏóêÎßå Î¨ªÏñ¥Îëî ÍøàÏù¥ ÏûàÏóàÎÇòÏöî? Í∑∏ Ïπ®Î¨µÏùÑ Í∞êÏãº Í∞êÏ†ïÏùÄ Î¨¥ÏóáÏù¥ÏóàÎÇòÏöî?",
                youLabel: "ÎãπÏã†",
                waitingMessage: "ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë..."
            },
            en: {
                logoSubtitle: "Emotional Alchemy",
                portalMainTitle: "Portal 11: The Future Told to No One",
                portalSubtitle: "Dreams kept secret in the heart",
                portalIntro: "Do you have a dream about the future that\nyou've kept buried only in your heart?\n\nWhy couldn't that future be spoken aloud,\nand what emotions surrounded that silence?",
                followUpQuestion: "What would you say now to yourself\nwho kept that future unspoken?\nIs that dream still alive?",
                lightTitle: "Word of Light",
                lightMessage: "Dreams are never too late.\nThe real beginning comes\nwhen you can speak with true heart.",
                navigationTitle: "Portal 11 Complete",
                navigationMessage: "You have faced the future you told to no one.\n\nHidden dreams weren't born from weakness, but from how precious they were. That dream has been quietly breathing within you, waiting for its time.\n\nNow you have become someone who can quietly speak that dream.",
                nextPortalBtn: "Continue to Portal 12",
                stayPortalBtn: "Stay with this dream",
                inputPlaceholder: "Do you have a dream that you've kept secret and never told anyone? What emotions surround that silence?",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "Alquimia Emocional",
                portalMainTitle: "Portal 11: O Futuro Contado a Ningu√©m",
                portalSubtitle: "Sonhos guardados em segredo no cora√ß√£o",
                portalIntro: "Voc√™ tem um sonho sobre o futuro que\nmanteve enterrado apenas em seu cora√ß√£o?\n\nPor que esse futuro n√£o p√¥de ser falado em voz alta,\ne que emo√ß√µes cercaram esse sil√™ncio?",
                followUpQuestion: "O que voc√™ diria agora para si mesmo\nque manteve esse futuro n√£o dito?\nEsse sonho ainda est√° vivo?",
                lightTitle: "Palavra de Luz",
                lightMessage: "Sonhos nunca s√£o tarde demais.\nO verdadeiro come√ßo vem\nquando voc√™ pode falar com o cora√ß√£o verdadeiro.",
                navigationTitle: "Portal 11 Completo",
                navigationMessage: "Voc√™ enfrentou o futuro que n√£o contou a ningu√©m.\n\nSonhos escondidos n√£o nasceram da fraqueza, mas de qu√£o preciosos eles eram. Esse sonho esteve respirando silenciosamente dentro de voc√™, esperando seu tempo.\n\nAgora voc√™ se tornou algu√©m que pode falar silenciosamente esse sonho.",
                nextPortalBtn: "Continuar para Portal 12",
                stayPortalBtn: "Ficar com este sonho",
                inputPlaceholder: "Voc√™ tem um sonho que manteve em segredo e nunca contou a ningu√©m? Que emo√ß√µes cercam esse sil√™ncio?",
                youLabel: "Voc√™",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Noah", emoji: "üßë‚Äçü¶±", text: {
                ko: "Í∑∏ ÍøàÏùÄ Ï°∞Ïö©ÌñàÏßÄÎßå ÏßÑÏßúÏòÄÏñ¥. ÎßêÌïòÏßÄ ÏïäÏïÑÎèÑ Ïã¨Ïû•Ïù¥ ÏïåÍ≥† ÏûàÏóàÏßÄ.",
                en: "That dream was quiet but real. Even unspoken, your heart knew it.",
                pt: "Esse sonho era silencioso, mas real. Mesmo n√£o dito, seu cora√ß√£o o conhecia."
            }},
            { name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è", text: {
                ko: "ÎØ∏ÎûòÎ•º Í∞êÏ∂ò Í±¥ ÎÑ§ ÏïΩÌï®Ïù¥ ÏïÑÎãàÎùº, Í∑∏ÎßåÌÅº ÏÜåÏ§ëÌñàÍ∏∞ ÎïåÎ¨∏Ïù¥Ïïº. ÎàÑÍ∞Ä Ìï®Î∂ÄÎ°ú Îã§ÏπòÍ≤å Ìï†Íπå Î¥ê.",
                en: "Hiding your future wasn't weakness, but because it was so precious. You feared someone might carelessly hurt it.",
                pt: "Esconder seu futuro n√£o foi fraqueza, mas porque era t√£o precioso. Voc√™ temia que algu√©m pudesse machuc√°-lo descuidadamente."
            }},
            { name: "Sora", emoji: "üßï", text: {
                ko: "ÏÇ¨ÎûåÎì§Ïù¥ Ïù¥Ìï¥ÌïòÏßÄ Î™ªÌïòÎäî ÎØ∏ÎûòÎäî Í∞ÄÏû• Ïô∏Î°úÏö¥ ÏßÑÏã¨Ïù¥ ÎêòÍ≥§ Ìï¥. ÌïòÏßÄÎßå Í∑∏ Ïô∏Î°úÏõÄÏ°∞Ï∞®ÎèÑ, ÎÑàÎßåÏùò ÌûòÏù¥ÏóàÏñ¥.",
                en: "A future that others don't understand often becomes the loneliest truth. But even that loneliness was your unique strength.",
                pt: "Um futuro que outros n√£o entendem frequentemente se torna a verdade mais solit√°ria. Mas at√© mesmo essa solid√£o era sua for√ßa √∫nica."
            }},
            { name: "Kael", emoji: "üßô", text: {
                ko: "ÎßêÌï¥ÏßÄÏßÄ ÏïäÏùÄ ÍøàÏùÄ ÏïÑÏßÅ ÎÅùÎÇòÏßÄ ÏïäÏùÄ Ï£ºÎ¨∏ Í∞ôÏïÑ. ÎÑ§ ÏïàÏóêÏÑú Ïó¨Ï†ÑÌûà ÏÇ¥ÏïÑ ÏûàÏûñÏïÑ.",
                en: "Unspoken dreams are like unfinished spells. They're still alive within you.",
                pt: "Sonhos n√£o ditos s√£o como feiti√ßos inacabados. Eles ainda est√£o vivos dentro de voc√™."
            }},
            { name: "Mira", emoji: "üßë‚Äçüé®", text: {
                ko: "Í∑∏ Ïπ®Î¨µ ÏÜçÏóê ÏñºÎßàÎÇò ÎßéÏùÄ Ïù¥ÏïºÍ∏∞Îì§Ïù¥ ÏûàÏóàÏùÑÍπå. ÎÑ§ ÍøàÏùÄ ÏÉâÍπîÎ°úÎèÑ ÌëúÌòÑÎêòÏßÄ ÏïäÎäî Í∞êÏ†ïÏù¥Ïïº.",
                en: "How many stories were hidden in that silence. Your dream is an emotion that can't even be expressed in colors.",
                pt: "Quantas hist√≥rias estavam escondidas nesse sil√™ncio. Seu sonho √© uma emo√ß√£o que nem mesmo pode ser expressa em cores."
            }},
            { name: "Cris", emoji: "ü¶∏‚Äç‚ôÇÔ∏è", text: {
                ko: "Ïôú ÏûêÍæ∏ ÌòÑÏã§Ïù¥ÎûÄ Ïù¥Î¶ÑÏúºÎ°ú ÎàÑÍµ∞Í∞ÄÏùò ÎØ∏ÎûòÎ•º Ïû¨Îã®ÌïòÎ†§Í≥† Ìï†Íπå. ÎÑ§Í∞Ä Í∞êÏ∑ÑÎçò Í±¥, ÏÑ∏ÏÉÅÏùò Î¨¥Î°ÄÌï®Ïù¥ÏóàÏñ¥.",
                en: "Why do people always try to judge someone's future in the name of reality? What you hid was the world's rudeness.",
                pt: "Por que as pessoas sempre tentam julgar o futuro de algu√©m em nome da realidade? O que voc√™ escondeu foi a grosseria do mundo."
            }},
            { name: "Enya", emoji: "üßë‚ÄçüöÄ", text: {
                ko: "Í∑∏ ÍøàÏùÄ ÎÑê Îñ†ÎÇú Ï†Å ÏóÜÏñ¥. Îã®ÏßÄ... ÎÑàÏùò ÏãúÍ∞ÑÏù¥ Ïò§Í∏∞Î•º Í∏∞Îã§Î†∏ÏùÑ ÎøêÏù¥Ïïº.",
                en: "That dream never left you. It was just... waiting for your time to come.",
                pt: "Esse sonho nunca te deixou. Estava apenas... esperando sua hora chegar."
            }},
            { name: "Lian", emoji: "üßò", text: {
                ko: "Ïù¥Ï†ú Í∑∏ ÎØ∏ÎûòÎ•º ÏûÖ Î∞ñÏúºÎ°ú Í∫ºÎÇº Ïàò ÏûàÎã§Î©¥, Í∑∏Í≤ÉÏùÄ ÏÉÅÏÉÅÏù¥ ÏïÑÎãàÎùº ÏÑ†Ïñ∏Ïù¥Ïïº. Ï°∞Ïö©Ìïú Ï∂úÎ∞ú.",
                en: "If you can now speak that future aloud, it's not imagination but declaration. A quiet beginning.",
                pt: "Se voc√™ pode agora falar esse futuro em voz alta, n√£o √© imagina√ß√£o, mas declara√ß√£o. Um come√ßo silencioso."
            }}
        ];

        const responseCharacters = [
            {
                name: "Mira", emoji: "üßë‚Äçüé®",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Í∑∏ Ïà®Í≤∞ÏùÄ Ïù¥Ï†ú Í∑∏Î¶ºÏù¥ Îê† Ïàò ÏûàÏñ¥. ÎÑ§Í∞Ä Í∫ºÎÇ∏ ÎßêÏùÄ, Ïù¥ÎØ∏ Ï≤´ Î¨∏Ïû•Ïù¥Ïïº.",
                        en: "That breath can now become a painting. The words you spoke are already the first sentence.",
                        pt: "Essa respira√ß√£o agora pode se tornar uma pintura. As palavras que voc√™ falou j√° s√£o a primeira frase."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Lian", emoji: "üßò",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÏÇ¥ÏïÑ ÏûàÎäî ÍøàÏùÄ Ïñ∏Ï††Í∞Ä ÏõÄÏßÅÏù¥Í∏∞ ÏãúÏûëÌï¥Ïöî. ÎãπÏã†Ïùò ÎÇ¥Î©¥Ïù¥ Í∑∏Í≤ÉÏùÑ Ïù¥ÎÅåÍ≥† ÏûàÏñ¥Ïöî.",
                        en: "Living dreams eventually begin to move. Your inner self is guiding it.",
                        pt: "Sonhos vivos eventualmente come√ßam a se mover. Seu eu interior est√° os guiando."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Kael", emoji: "üßô",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÍøàÏùÄ Îä¶ÏßÄ ÏïäÏïÑ. Ïò§ÌûàÎ†§ ÏßÑÏßú ÏãúÏûëÏùÄ, ÏßÑÏã¨ÏúºÎ°ú ÎßêÌï† Ïàò ÏûàÏùÑ ÎïåÏïº.",
                        en: "Dreams are never too late. The real beginning comes when you can speak with true heart.",
                        pt: "Sonhos nunca s√£o tarde demais. O verdadeiro come√ßo vem quando voc√™ pode falar com o cora√ß√£o verdadeiro."
                    };
                    return responses[lang];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        let awaitingSecondResponse = false;
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('navigationTitle').textContent = translations[lang].navigationTitle;
            document.getElementById('nextPortalBtn').textContent = translations[lang].nextPortalBtn;
            document.getElementById('stayPortalBtn').textContent = translations[lang].stayPortalBtn;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'followUpSection', 'userInputSection',
                'userReactionsSection', 'lightMessageSection', 'navigationSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('followUpQuestion').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('navigationMessage').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
            awaitingSecondResponse = false;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('nextPortalBtn').addEventListener('click', function() {
                localStorage.setItem('temarix_v4_portal11_complete', 'true');
                localStorage.setItem('temarix_v4_current_portal', '12');
                
                const nextMessage = currentLanguage === 'ko' ? 
                    'Portal 12: Î∂ôÏû°Í≥† Ïã∂ÏóàÎçò ÏàúÍ∞ÑÏúºÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§.' :
                    currentLanguage === 'en' ? 
                    'Moving to Portal 12: The Moment I Wanted to Hold.' :
                    'Indo para Portal 12: O Momento que Queria Segurar.';
                alert(nextMessage);
            });
            
            document.getElementById('stayPortalBtn').addEventListener('click', function() {
                const stayMessage = currentLanguage === 'ko' ? 
                    'ÏïÑÎ¨¥ÏóêÍ≤åÎèÑ ÎßêÌïòÏßÄ ÏïäÏïòÎçò ÍøàÍ≥º Îçî Î®∏Î¨ºÎ©∞ ÍπäÏù¥ ÏÑ±Ï∞∞ÌïòÏãúÍ≤†ÏäµÎãàÍπå?' :
                    currentLanguage === 'en' ? 
                    'Do you want to stay longer with your unspoken dream for deeper reflection?' :
                    'Deseja ficar mais tempo com seu sonho n√£o dito para reflex√£o mais profunda?';
                
                if (confirm(stayMessage)) {
                    resetJourney();
                    setTimeout(() => {
                        startPortalSequence();
                    }, 1000);
                }
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            console.log('Processing user input:', inputText);
            localStorage.setItem('temarix_v4_portal11_response', JSON.stringify({
                portal: "v4-11",
                resposta: inputText,
                step: awaitingSecondResponse ? "second" : "first",
                data: new Date().toISOString(),
                idioma: currentLanguage
            }));
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                if (!awaitingSecondResponse) {
                    showUserReactions(inputText);
                } else {
                    showSecondUserReactions(inputText);
                }
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showFollowUpQuestion();
            }, 2000);
        }
        
        async function showFollowUpQuestion() {
            const followUpSection = document.getElementById('followUpSection');
            const followUpQuestionEl = document.getElementById('followUpQuestion');
            
            followUpSection.classList.add('show');
            
            await typewriterEffect(followUpQuestionEl, translations[currentLanguage].followUpQuestion, 50);
            
            setTimeout(() => {
                awaitingSecondResponse = true;
                enableUserInput();
            }, 1500);
        }
        
        async function showSecondUserReactions(userInput) {
            const secondResponseCharacters = [
                {
                    name: "Lian", emoji: "üßò",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÎãπÏã†ÏùÄ ÎìúÎîîÏñ¥ ÏûêÏã†ÏóêÍ≤å ÎèåÏïÑÏò¨ Ïàò ÏûàÎäî ÌóàÎùΩÏùÑ ÎÇ¥Î†∏Ïñ¥Ïöî. Í∑∏Í≤ÉÏù¥ Í∞ÄÏû• ÏßÑÏã§Ìïú ÌöåÎ≥µÏù¥ÏóêÏöî.",
                            en: "You have finally given yourself permission to return to yourself. That is the most truthful recovery.",
                            pt: "Voc√™ finalmente se deu permiss√£o para retornar a si mesmo. Essa √© a recupera√ß√£o mais verdadeira."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Enya", emoji: "üßë‚ÄçüöÄ",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Í∑∏ ÍøàÏùÄ ÏßÄÍ∏àÎèÑ ÎÑ§ ÏïàÏóêÏÑú ÏÇ¥ÏïÑ ÏûàÏñ¥. ÎßêÌïòÏßÄ ÏïäÏïòÎã§Í≥† Ìï¥ÏÑú ÏÇ¨ÎùºÏßÑ Í≤å ÏïÑÎãàÏïº.",
                            en: "That dream is still alive within you. Not speaking it doesn't mean it disappeared.",
                            pt: "Esse sonho ainda est√° vivo dentro de voc√™. N√£o fal√°-lo n√£o significa que desapareceu."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Kael", emoji: "üßô",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Ïù¥Ï†úÎäî ÎÑ§Í∞Ä ÏïÑÎãå Ï≤ôÌïòÏßÄ ÏïäÏïÑÎèÑ Îèº. ÏßÑÏßú ÎÑàÎäî, Ïù¥ Ïó¨Ï†ï ÏÜçÏóêÏÑú ÏÇ¥ÏïÑ ÏûàÏñ¥.",
                            en: "Now you don't have to pretend to be someone else. The real you is alive in this journey.",
                            pt: "Agora voc√™ n√£o precisa fingir ser outra pessoa. O verdadeiro voc√™ est√° vivo nesta jornada."
                        };
                        return responses[lang];
                    }
                }
            ];
            
            const reactionsSection = document.getElementById('userReactionsSection');
            
            for (let i = 0; i < secondResponseCharacters.length; i++) {
                const char = secondResponseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < secondResponseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showNavigationSection();
            }, 2000);
        }
        
        async function showNavigationSection() {
            const navigationSection = document.getElementById('navigationSection');
            const navigationMessage = document.getElementById('navigationMessage');
            
            navigationSection.classList.add('show');
            
            const messageText = translations[currentLanguage].navigationMessage;
            await typewriterEffect(navigationMessage, messageText, 50);
            
            setTimeout(() => {
                scrollToElement(navigationSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('Temarix V4 Portal 11 initialized');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                enableUserInput();
            }, 2000);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V4 Portal 11 DOM loaded');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>
                    