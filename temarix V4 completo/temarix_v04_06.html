<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V4 - Portal 06: Collapsed Walls of Belief</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ff9999;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #ff6b6b;
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 200vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            transition: opacity 0.8s ease-in;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #ff6b6b;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .follow-up-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .follow-up-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            text-align: center;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            white-space: pre-wrap;
        }
        
        .user-response strong {
            color: #ff6b6b;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #ff6b6b;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-section {
            margin: 60px 0;
            opacity: 0;
            text-align: center;
            padding: 40px 20px;
            min-height: 300px;
            border: 2px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }
        
        .navigation-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: bold;
        }
        
        .navigation-message {
            color: #fff;
            font-size: 20px;
            margin-bottom: 40px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 20px 40px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
            border: 2px solid transparent;
        }
        
        .nav-btn:hover {
            background: #666;
            border-color: #ff6b6b;
        }
        
        .nav-btn.primary {
            background: #ff6b6b;
            color: #fff;
            font-weight: bold;
        }
        
        .nav-btn.primary:hover {
            background: #ff8888;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .input-fixed-bottom {
            position: relative;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #ff6b6b;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #ff6b6b;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .follow-up-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V4</div>
            <div class="logo-subtitle" id="logoSubtitle">Emotional Alchemy</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 06: Collapsed Walls of Belief</div>
            <div class="portal-subtitle" id="portalSubtitle">When trust crumbled into fragments of doubt</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="follow-up-section" id="followUpSection">
                <div class="follow-up-question" id="followUpQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>
            
            <div class="navigation-section" id="navigationSection">
                <div class="navigation-title" id="navigationTitle">Portal 06 Complete</div>
                <div class="navigation-message" id="navigationMessage"></div>
                <div class="navigation-buttons">
                    <button class="nav-btn primary" id="nextPortalBtn">Continue to Portal 07</button>
                    <button class="nav-btn" id="stayPortalBtn">Stay with this belief</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="What belief once crumbled in your life? How did it affect your heart?"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        const translations = {
            ko: {
                logoSubtitle: "Í∞êÏ†ï Ïó∞Í∏àÏà†",
                portalMainTitle: "Portal 06: Î∂ïÍ¥¥Îêú ÎØøÏùåÏùò Î≤Ω",
                portalSubtitle: "Ïã†Î¢∞Í∞Ä ÏùòÏã¨Ïùò Ï°∞Í∞ÅÏúºÎ°ú Î¨¥ÎÑàÏßÑ ÏàúÍ∞Ñ",
                portalIntro: "ÌïúÎïå Íµ≥Í≤å ÎØøÏóàÎçò ÎåÄÏÉÅÏù¥ Î¨¥ÎÑàÏßÑ ÏàúÍ∞ÑÏù¥ ÏûàÏóàÎÇòÏöî?\nÍ∑∏ Î¨¥ÎÑàÏßêÏùÄ ÎãπÏã†Ïùò ÎßàÏùåÏóê Ïñ¥Îñ§ Í∑†Ïó¥ÏùÑ ÎÇ®Í≤ºÎÇòÏöî?\n\nÏßÄÍ∏à Í∑∏ Í∏∞ÏñµÏùÑ Îñ†Ïò¨Î¶¨Î©¥,\nÎãπÏã† ÏïàÏóê Ïñ¥Îñ§ ÎßêÏù¥ Ïö∏Î¶¨Í≥† ÏûàÎÇòÏöî?",
                followUpQuestion: "Í∑∏ Î¨¥ÎÑàÏßÑ ÎØøÏùå Ïù¥ÌõÑ,\nÎãπÏã†ÏùÄ ÏÇ¨ÎûåÏùÑ Ïñ¥ÎñªÍ≤å ÎåÄÌïòÎ©∞ ÏÇ¥ÏïÑÏôîÎÇòÏöî?\nÏù¥Ï†ú, Îã§Ïãú 'Ïã†Î¢∞'Î•º Î∞∞Ïö∏ Ïàò ÏûàÎã§Í≥† ÏÉùÍ∞ÅÌïòÎÇòÏöî?",
                lightTitle: "ÎπõÏùò ÌïúÎßàÎîî",
                lightMessage: "ÎÑ§Í∞Ä ÏÑ†ÌÉùÌïú 'Ï°∞Ïã¨Ïä§Îü¨ÏõÄ'ÏùÄ Î∞©Ïñ¥Í∞Ä ÏïÑÎãàÎùº\nÏÉàÎ°≠Í≤å ÏåìÎäî Î≤ΩÎèåÏù¥Ïïº.\nÏù¥Î≤àÏóî Îçî Îã®Îã®ÌïòÍ≥†, Îçî Îî∞ÎúªÌïòÍ≤å.",
                navigationTitle: "Portal 06 ÏôÑÎ£å",
                navigationMessage: "ÎãπÏã†ÏùÄ Î¨¥ÎÑàÏßÑ ÎØøÏùåÏùò Î≤ΩÏùÑ ÎßàÏ£ºÌñàÏäµÎãàÎã§.\n\nÏã†Î¢∞Í∞Ä Íπ®Ï°åÏùÑ ÎïåÏùò Ï∂©Í≤©ÏùÄ ÎßêÎ≥¥Îã§ Î®ºÏ†Ä Í∞ÄÏä¥ÏùÑ Ï∞¢ÏóàÏßÄÎßå, Í∑∏ Í∑†Ïó¥ ÏÜçÏóêÏÑúÎèÑ Ïà®ÏùÑ Ïâ¨Îçò ÎãπÏã†ÏùÑ Í∏∞ÏñµÌïòÏÑ∏Ïöî. Í∑∏ Ï°∞Ïö©Ìïú Í≤¨Îî§Ïù¥ ÎãπÏã†Ïùò Ïö©Í∏∞ÏòÄÏäµÎãàÎã§.\n\nÏù¥Ï†ú ÎãπÏã†ÏùÄ Î¨¥ÎÑàÏßÑ Î≤ΩÏùÑ Ïû¨Íµ¨ÏÑ±Ìï† Ï§ÄÎπÑÍ∞Ä ÎêòÏóàÏäµÎãàÎã§. Îçî Ïã†Ï§ëÌïòÏßÄÎßå, Îçî Îî∞ÎúªÌïòÍ≤å.",
                nextPortalBtn: "Portal 07Î°ú Ïù¥Ïñ¥Í∞ÄÍ∏∞",
                stayPortalBtn: "Ïù¥ ÎØøÏùåÍ≥º Îçî Î®∏Î¨ºÍ∏∞",
                inputPlaceholder: "Ïñ¥Îñ§ ÎØøÏùåÏù¥ Î¨¥ÎÑàÏ°åÎÇòÏöî? Í∑∏Í≤ÉÏù¥ ÎßàÏùåÏóê Ïñ¥Îñ§ ÏòÅÌñ•ÏùÑ Ï£ºÏóàÎÇòÏöî?",
                youLabel: "ÎãπÏã†",
                waitingMessage: "ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë..."
            },
            en: {
                logoSubtitle: "Emotional Alchemy",
                portalMainTitle: "Portal 06: Collapsed Walls of Belief",
                portalSubtitle: "When trust crumbled into fragments of doubt",
                portalIntro: "Has there ever been a moment when something you firmly believed in collapsed?\nWhat kind of fracture did that collapse leave in your heart?\n\nWhen you recall that memory now,\nwhat words are echoing within you?",
                followUpQuestion: "After that collapsed belief,\nhow have you been treating people in your life?\nDo you now think you can learn to 'trust' again?",
                lightTitle: "Word of Light",
                lightMessage: "The 'carefulness' you chose is not defense,\nbut new bricks you're laying.\nThis time, stronger and warmer.",
                navigationTitle: "Portal 06 Complete",
                navigationMessage: "You have faced the collapsed walls of belief.\n\nWhen trust broke, the shock tore your heart before words could form, but remember that you kept breathing even in those cracks. That quiet endurance was your courage.\n\nNow you are ready to reconstruct those fallen walls. More cautiously, but more warmly.",
                nextPortalBtn: "Continue to Portal 07",
                stayPortalBtn: "Stay with this belief",
                inputPlaceholder: "What belief once crumbled in your life? How did it affect your heart?",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "Alquimia Emocional",
                portalMainTitle: "Portal 06: Muros Desmoronados da Cren√ßa",
                portalSubtitle: "Quando a confian√ßa desmoronou em fragmentos de d√∫vida",
                portalIntro: "J√° houve um momento em que algo em que voc√™ acreditava firmemente desmoronou?\nQue tipo de fratura esse colapso deixou em seu cora√ß√£o?\n\nQuando voc√™ recorda essa mem√≥ria agora,\nque palavras ecoam dentro de voc√™?",
                followUpQuestion: "Ap√≥s essa cren√ßa desmoronada,\ncomo voc√™ tem tratado as pessoas em sua vida?\nVoc√™ agora pensa que pode aprender a 'confiar' novamente?",
                lightTitle: "Palavra de Luz",
                lightMessage: "O 'cuidado' que voc√™ escolheu n√£o √© defesa,\nmas novos tijolos que voc√™ est√° colocando.\nDesta vez, mais forte e mais caloroso.",
                navigationTitle: "Portal 06 Completo",
                navigationMessage: "Voc√™ enfrentou os muros desmoronados da cren√ßa.\n\nQuando a confian√ßa se quebrou, o choque rasgou seu cora√ß√£o antes que as palavras pudessem se formar, mas lembre-se de que voc√™ continuou respirando mesmo nessas rachaduras. Essa resist√™ncia silenciosa foi sua coragem.\n\nAgora voc√™ est√° pronto para reconstruir esses muros ca√≠dos. Mais cautelosamente, mas mais calorosamente.",
                nextPortalBtn: "Continuar para Portal 07",
                stayPortalBtn: "Ficar com esta cren√ßa",
                inputPlaceholder: "Que cren√ßa uma vez desmoronou em sua vida? Como isso afetou seu cora√ß√£o?",
                youLabel: "Voc√™",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Noah", emoji: "üßë‚Äçü¶±", text: {
                ko: "ÎØøÏùåÏù¥ Íπ®Ïßà ÎïåÏùò Ï∂©Í≤©ÏùÄ, ÎßêÎ≥¥Îã§ Î®ºÏ†Ä Í∞ÄÏä¥ÏùÑ Ï∞¢ÏßÄ. Í∑∏Í±¥ Ìïú Î≤àÎèÑ ÏÑ§Î™ÖÎêòÏßÄ Î™ªÌïú ÏÉÅÏ≤òÏïº.",
                en: "The shock when belief breaks tears the heart before words can form. It's a wound that has never been explained.",
                pt: "O choque quando a cren√ßa se quebra rasga o cora√ß√£o antes que as palavras possam se formar. √â uma ferida que nunca foi explicada."
            }},
            { name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è", text: {
                ko: "ÏÇ¨ÎûëÌïòÎäî ÏÇ¨ÎûåÏóêÍ≤å Ïã§ÎßùÌñàÏùÑ Îïå, Ïö∞Î¶¨Îäî ÏûêÍ∏∞ ÏûêÏã†ÏùÑ ÏùòÏã¨ÌïòÍ≤å Îèº. 'ÎÇ¥Í∞Ä ÌãÄÎ†∏Îçò Í±∏Íπå?' ÌïòÍ≥†.",
                en: "When disappointed by someone we love, we start to doubt ourselves. 'Was I wrong?' we wonder.",
                pt: "Quando decepcionados por algu√©m que amamos, come√ßamos a duvidar de n√≥s mesmos. 'Eu estava errado?' nos perguntamos."
            }},
            { name: "Sora", emoji: "üßï", text: {
                ko: "Í∑∏Îïå ÎÑàÎäî ÌòºÏûêÏòÄÏßÄÎßå, Ïä§Ïä§Î°ú Ïô∏Î©¥ÌïòÏßÄ ÏïäÏïòÎçò Í≤ÉÎßåÌÅºÏùÄ ÏßÑÏßúÏïº.",
                en: "You were alone then, but the fact that you didn't turn away from yourself was real.",
                pt: "Voc√™ estava sozinho ent√£o, mas o fato de n√£o ter se afastado de si mesmo era real."
            }},
            { name: "Kael", emoji: "üßô", text: {
                ko: "Î¨¥ÎÑàÏßÑ Î≤ΩÏùÄ Îã§Ïãú ÏåìÏùÑ Ïàò ÏûàÏñ¥. ÌïòÏßÄÎßå Ïù¥Ï†úÎäî, Î∞îÍπ•Ïù¥ ÏïÑÎãå 'ÎÑà'Î∂ÄÌÑ∞ ÏÑ∏ÏõåÏïºÏßÄ.",
                en: "Collapsed walls can be rebuilt. But now, you must build 'yourself' first, not the outside.",
                pt: "Muros desmoronados podem ser reconstru√≠dos. Mas agora, voc√™ deve construir 'voc√™ mesmo' primeiro, n√£o o exterior."
            }},
            { name: "Mira", emoji: "üßë‚Äçüé®", text: {
                ko: "Í∑∏ Îßê, 'Ïôú ÎÇ† ÏïàÏïÑÏ£ºÏßÄ ÏïäÏïòÏñ¥?'Îäî ÏïÑÏßÅÎèÑ Í∑∏Î¶ºÏûêÏùò Î¨∏Ïû•Ï≤òÎüº ÎÑ§ ÏïàÏùÑ Îß¥ÎèåÍ≥† ÏûàÍ≤†ÏßÄ.",
                en: "Those words, 'Why didn't you hold me?' still circle within you like a shadow's sentence.",
                pt: "Essas palavras, 'Por que voc√™ n√£o me abra√ßou?' ainda circulam dentro de voc√™ como uma frase sombria."
            }},
            { name: "Cris", emoji: "ü¶∏‚Äç‚ôÇÔ∏è", text: {
                ko: "Ïôú Ìï≠ÏÉÅ Í∞ÄÏû• Í∏∞ÎåÄÌñàÎçò ÏÇ¨ÎûåÏù¥ Í∞ÄÏû• ÌÅ∞ ÏÉÅÏ≤òÎ•º Ï£ºÎäî Í±∏Íπå? ÎÇú Í∑∏Í≤å ÎÑàÎ¨¥ Î∂àÍ≥µÌèâÌïòÎã§Í≥† ÏÉùÍ∞ÅÌï¥.",
                en: "Why is it always the person we expected the most from who hurts us the most? I think that's too unfair.",
                pt: "Por que √© sempre a pessoa de quem mais esper√°vamos que mais nos machuca? Acho isso muito injusto."
            }},
            { name: "Enya", emoji: "üßë‚ÄçüöÄ", text: {
                ko: "ÎØøÏùåÏù¥ Î¨¥ÎÑàÏ°åÏùÑ Îïå, ÎÑàÎäî Î¨¥ÎÑàÏßÄÏßÄ ÏïäÏïòÎã§Îäî ÏÇ¨Ïã§ÏùÑ Í∏∞ÏñµÌï¥. Í∑∏Í≤å ÎÑ§ ÏßÑÏßú ÌûòÏù¥Ïïº.",
                en: "When belief collapsed, remember that you didn't collapse. That's your real strength.",
                pt: "Quando a cren√ßa desmoronou, lembre-se de que voc√™ n√£o desmoronou. Essa √© sua verdadeira for√ßa."
            }},
            { name: "Lian", emoji: "üßò", text: {
                ko: "Í∑†Ïó¥ ÏÜçÏóêÏÑúÎèÑ Ïà®ÏùÑ Ïâ¨Îçò ÎÑàÎ•º ÎÇòÎäî Í∏∞ÏñµÌïòÍ≥† ÏûàÏñ¥. Í∑∏ Ï°∞Ïö©Ìïú Í≤¨Îî§Ïù¥ ÎÑàÏùò Ïö©Í∏∞ÏòÄÏñ¥.",
                en: "I remember you breathing even in the cracks. That quiet endurance was your courage.",
                pt: "Lembro-me de voc√™ respirando mesmo nas rachaduras. Essa resist√™ncia silenciosa foi sua coragem."
            }}
        ];

        const responseCharacters = [
            {
                name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Í∑∏ ÎßàÏùåÏù¥ ÏïÑÏßÅ ÏûàÎã§Îäî Í±¥, ÎÑ§Í∞Ä ÏôÑÏ†ÑÌûà Îã´ÌûàÏßÄ ÏïäÏïòÎã§Îäî ÎúªÏù¥Ïïº. Ïã†Î¢∞Îäî Ï≤úÏ≤úÌûà ÏûêÎùº.",
                        en: "The fact that feeling still exists means you haven't completely closed off. Trust grows slowly.",
                        pt: "O fato de esse sentimento ainda existir significa que voc√™ n√£o se fechou completamente. A confian√ßa cresce lentamente."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Lian", emoji: "üßò",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Ïã†Î¢∞Îäî Îã§Ïãú Î∞∞Ïö∞Îäî Í∏∞Ïà†Ïù¥ ÏïÑÎãàÎùº, Îã§Ïãú ÌóàÎùΩÌïòÎäî Í∞êÏ†ïÏù¥Ïïº. ÎÑàÎäî Í∑∏ ÏãúÏûëÏ†êÏóê ÏûàÏñ¥.",
                        en: "Trust isn't a skill to relearn, but an emotion to permit again. You're at that starting point.",
                        pt: "A confian√ßa n√£o √© uma habilidade para reaprender, mas uma emo√ß√£o para permitir novamente. Voc√™ est√° nesse ponto de partida."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Kael", emoji: "üßô",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÎÑ§Í∞Ä ÏÑ†ÌÉùÌïú 'Ï°∞Ïã¨Ïä§Îü¨ÏõÄ'ÏùÄ Î∞©Ïñ¥Í∞Ä ÏïÑÎãàÎùº ÏÉàÎ°≠Í≤å ÏåìÎäî Î≤ΩÎèåÏù¥Ïïº. Ïù¥Î≤àÏóî Îçî Îã®Îã®ÌïòÍ≥†, Îçî Îî∞ÎúªÌïòÍ≤å.",
                        en: "The 'carefulness' you chose is not defense, but new bricks you're laying. This time, stronger and warmer.",
                        pt: "O 'cuidado' que voc√™ escolheu n√£o √© defesa, mas novos tijolos que voc√™ est√° colocando. Desta vez, mais forte e mais caloroso."
                    };
                    return responses[lang];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        let awaitingSecondResponse = false;
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('navigationTitle').textContent = translations[lang].navigationTitle;
            document.getElementById('nextPortalBtn').textContent = translations[lang].nextPortalBtn;
            document.getElementById('stayPortalBtn').textContent = translations[lang].stayPortalBtn;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'followUpSection', 'userInputSection',
                'userReactionsSection', 'lightMessageSection', 'navigationSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('followUpQuestion').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('navigationMessage').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
            awaitingSecondResponse = false;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('nextPortalBtn').addEventListener('click', function() {
                localStorage.setItem('temarix_v4_portal06_complete', 'true');
                localStorage.setItem('temarix_v4_current_portal', '07');
                
                const nextMessage = currentLanguage === 'ko' ? 
                    'Portal 07: ÎßêÌï¥ÏßÄÏßÄ ÏïäÏùÄ Î∞îÎûåÏúºÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§.' :
                    currentLanguage === 'en' ? 
                    'Moving to Portal 07: Unspoken Wishes.' :
                    'Indo para Portal 07: Desejos N√£o Ditos.';
                alert(nextMessage);
            });
            
            document.getElementById('stayPortalBtn').addEventListener('click', function() {
                const stayMessage = currentLanguage === 'ko' ? 
                    'Î∂ïÍ¥¥Îêú ÎØøÏùåÍ≥º Îçî Î®∏Î¨ºÎ©∞ ÍπäÏù¥ ÏÑ±Ï∞∞ÌïòÏãúÍ≤†ÏäµÎãàÍπå?' :
                    currentLanguage === 'en' ? 
                    'Do you want to stay longer with your collapsed belief for deeper reflection?' :
                    'Deseja ficar mais tempo com sua cren√ßa desmoronada para reflex√£o mais profunda?';
                
                if (confirm(stayMessage)) {
                    resetJourney();
                    setTimeout(() => {
                        startPortalSequence();
                    }, 1000);
                }
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            console.log('Processing user input:', inputText);
            localStorage.setItem('temarix_v4_portal06_response', JSON.stringify({
                portal: "v4-06",
                resposta: inputText,
                step: awaitingSecondResponse ? "second" : "first",
                data: new Date().toISOString(),
                idioma: currentLanguage
            }));
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                if (!awaitingSecondResponse) {
                    showUserReactions(inputText);
                } else {
                    showSecondUserReactions(inputText);
                }
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showFollowUpQuestion();
            }, 2000);
        }
        
        async function showFollowUpQuestion() {
            const followUpSection = document.getElementById('followUpSection');
            const followUpQuestionEl = document.getElementById('followUpQuestion');
            
            followUpSection.classList.add('show');
            
            await typewriterEffect(followUpQuestionEl, translations[currentLanguage].followUpQuestion, 50);
            
            setTimeout(() => {
                awaitingSecondResponse = true;
                enableUserInput();
            }, 1500);
        }
        
        async function showSecondUserReactions(userInput) {
            const secondResponseCharacters = [
                {
                    name: "Enya", emoji: "üßë‚ÄçüöÄ",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÎØøÏùåÏùÄ Îã§Ïãú ÏåìÎäî Í≤å ÏïÑÎãàÎùº, Îã§Ïãú ÌóàÎùΩÌïòÎäî Í±∞Ïïº. Í∑∏ ÎßàÏùåÏùÄ Ïù¥ÎØ∏ Ï§ÄÎπÑÎêêÏñ¥.",
                            en: "Trust isn't rebuilt, it's permitted again. That heart is already ready.",
                            pt: "A confian√ßa n√£o √© reconstru√≠da, √© permitida novamente. Esse cora√ß√£o j√° est√° pronto."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Sora", emoji: "üßï",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÏÇ¨ÎùºÏ°åÎçò Ïó∞Í≤∞ÏùÄ Ïù¥Ï†ú ÎãπÏã† ÏûêÏã†Í≥ºÏùò Îã§Î¶¨Î°ú Î∞îÎÄåÏóàÏñ¥Ïöî. Í∑∏Í±¥ Îçî Ïù¥ÏÉÅ Î∂ÄÏÑúÏßÄÏßÄ ÏïäÏùÑ Í±∞ÏòàÏöî.",
                            en: "The lost connection has now become a bridge to yourself. It won't break anymore.",
                            pt: "A conex√£o perdida agora se tornou uma ponte para voc√™ mesmo. N√£o vai quebrar mais."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Noah", emoji: "üßë‚Äçü¶±",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Ïù¥Ï†ú Í∑∏ Î¨¥ÎÑàÏßÑ Î≤ΩÎì§ÏùÄ ÏÉàÎ°úÏö¥ Í∏∞Ï¥àÍ∞Ä Îê† Ïàò ÏûàÏñ¥. Îçî Ïã†Ï§ëÌïòÏßÄÎßå, Îçî ÏßÑÏã§ÌïòÍ≤å.",
                            en: "Now those collapsed walls can become new foundations. More cautious, but more truthful.",
                            pt: "Agora esses muros desmoronados podem se tornar novas funda√ß√µes. Mais cauteloso, mas mais verdadeiro."
                        };
                        return responses[lang];
                    }
                }
            ];
            
            const reactionsSection = document.getElementById('userReactionsSection');
            
            for (let i = 0; i < secondResponseCharacters.length; i++) {
                const char = secondResponseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < secondResponseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showNavigationSection();
            }, 2000);
        }
        
        async function showNavigationSection() {
            const navigationSection = document.getElementById('navigationSection');
            const navigationMessage = document.getElementById('navigationMessage');
            
            navigationSection.classList.add('show');
            
            const messageText = translations[currentLanguage].navigationMessage;
            await typewriterEffect(navigationMessage, messageText, 50);
            
            setTimeout(() => {
                scrollToElement(navigationSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('Temarix V4 Portal 06 initialized');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                enableUserInput();
            }, 2000);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V4 Portal 06 DOM loaded');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>