<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V4 - Portal 23: Moments Without Courage</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ff9999;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #ff6b6b;
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 200vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            transition: opacity 0.8s ease-in;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #ff6b6b;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .follow-up-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .follow-up-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            text-align: center;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            white-space: pre-wrap;
        }
        
        .user-response strong {
            color: #ff6b6b;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #ff6b6b;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-section {
            margin: 60px 0;
            opacity: 0;
            text-align: center;
            padding: 40px 20px;
            min-height: 300px;
            border: 2px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }
        
        .navigation-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: bold;
        }
        
        .navigation-message {
            color: #fff;
            font-size: 20px;
            margin-bottom: 40px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 20px 40px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
            border: 2px solid transparent;
        }
        
        .nav-btn:hover {
            background: #666;
            border-color: #ff6b6b;
        }
        
        .nav-btn.primary {
            background: #ff6b6b;
            color: #fff;
            font-weight: bold;
        }
        
        .nav-btn.primary:hover {
            background: #ff8888;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .input-fixed-bottom {
            position: relative;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #ff6b6b;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #ff6b6b;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .follow-up-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V4</div>
            <div class="logo-subtitle" id="logoSubtitle">Emotional Alchemy</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 23: Moments Without Courage</div>
            <div class="portal-subtitle" id="portalSubtitle">Words left unspoken</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="follow-up-section" id="followUpSection">
                <div class="follow-up-question" id="followUpQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>
            
            <div class="navigation-section" id="navigationSection">
                <div class="navigation-title" id="navigationTitle">Portal 23 Complete</div>
                <div class="navigation-message" id="navigationMessage"></div>
                <div class="navigation-buttons">
                    <button class="nav-btn primary" id="nextPortalBtn">Continue to Portal 24</button>
                    <button class="nav-btn" id="stayPortalBtn">Stay with this courage</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Was there a moment when you lacked courage to speak? What did you want to say and why was it so frightening?"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        const translations = {
            ko: {
                logoSubtitle: "Í∞êÏ†ï Ïó∞Í∏àÏà†",
                portalMainTitle: "Portal 23: Ïö©Í∏∞Í∞Ä ÏóÜÏóàÎçò ÏàúÍ∞Ñ",
                portalSubtitle: "ÎßêÌïòÏßÄ Î™ªÌïú ÎßêÎì§",
                portalIntro: "ÎãπÏã†ÏùÄ Ìïú Î≤àÏù¥ÎùºÎèÑ,\nÏö©Í∏∞Í∞Ä Î∂ÄÏ°±Ìï¥ÏÑú ÎßêÌïòÏßÄ Î™ªÌñàÎçò ÏàúÍ∞ÑÏù¥ ÏûàÏóàÎÇòÏöî?\n\nÍ∑∏Îïå Î¨¥ÏóáÏùÑ ÎßêÌïòÍ≥† Ïã∂ÏóàÍ≥†,\nÏôú Í∑∏ ÎßêÏùÑ Í∫ºÎÇ¥Îäî Í≤ÉÏù¥ ÎëêÎ†§Ïõ†ÎÇòÏöî?",
                followUpQuestion: "ÏßÄÍ∏à Í∑∏ ÎßêÏùÑ Îã§Ïãú Í∫ºÎÇº Ïàò ÏûàÎã§Î©¥,\nÏñ¥Îñ§ ÎßêÎ°ú ÏãúÏûëÌïòÍ≥† Ïã∂ÎÇòÏöî?\n\nÍ∑∏Î¶¨Í≥† Í∑∏ ÎßêÏùÄ, ÎãπÏã† ÏûêÏã†ÏóêÍ≤åÎèÑ ÌïÑÏöîÌïúÍ∞ÄÏöî?",
                lightTitle: "ÎπõÏùò ÌïúÎßàÎîî",
                lightMessage: "ÏßÄÍ∏àÏùò ÎÑàÎäî, Í≥ºÍ±∞Ïùò ÏûêÏã†ÏóêÍ≤å ÏÇ¨Í≥ºÌï† Ïàò ÏûàÏùÑ ÎßåÌÅº Îã®Îã®Ìï¥Ï°åÏñ¥Ïöî. Í∑∏Í≤ÉÏù¥ ÏßÑÏßú Ïö©Í∏∞ÏòàÏöî.\nÏÇ¨Í≥ºÎäî ÎàÑÍµ¨ÏóêÍ≤åÎèÑ Îä¶ÏßÄ ÏïäÏïÑÏöî. ÏûêÏã†ÏóêÍ≤åÏ°∞Ï∞®. ÎãπÏã†ÏùÄ ÏßÄÍ∏à Í∑∏Í≤ÉÏùÑ ÏãúÏûëÌñàÏñ¥Ïöî.\nÏßÑÏßú Ïö©Í∏∞Îäî ÏßÄÎÇòÍ∞Ñ Îßê ÏïûÏóê Î¨¥Î¶é ÍøáÎäî Í≤É. Í∑∏Î¶¨Í≥† Îã§Ïãú ÏãúÏûëÌï† Ïàò ÏûàÎã§Îäî ÎØøÏùåÏù¥Ïïº.",
                navigationTitle: "Portal 23 ÏôÑÎ£å",
                navigationMessage: "ÎãπÏã†ÏùÄ Ïö©Í∏∞Í∞Ä ÏóÜÏóàÎçò Í∑∏ ÏàúÍ∞ÑÍ≥º ÌôîÌï¥ÌïòÍ≥† Í∞êÏ†ïÏùÑ Ï†ïÏßÅÌïòÍ≤å Í∫ºÎÇº Ïàò ÏûàÎäî ÏÇ¨ÎûåÏù¥ ÎêòÏóàÏäµÎãàÎã§.\n\nÎßêÌïòÏßÄ Î™ªÌñàÎçò Í∑∏ ÏàúÍ∞ÑÏùÑ Ïù¥Ìï¥ÌïòÎ©∞, Ïù¥Ï†úÎäî ÏßÑÏã¨ÏùÑ ÌëúÌòÑÌï† Ïàò ÏûàÎäî Ïö©Í∏∞Î•º Ï∞æÏïòÏäµÎãàÎã§.\n\nÎçî Ïù¥ÏÉÅ ÏûêÏ°¥Ïã¨Ïù¥ÎÇò ÎëêÎ†§ÏõÄ ÎïåÎ¨∏Ïóê Í∞êÏ†ïÏùÑ Ïà®Í∏∞ÏßÄ ÏïäÍ≥†, ÏÜîÏßÅÌïú ÎßàÏùåÏúºÎ°ú ÏÜåÌÜµÌï† Ïàò ÏûàÎäî ÌûòÏùÑ ÏñªÏóàÏäµÎãàÎã§.",
                nextPortalBtn: "Portal 24Î°ú Ïù¥Ïñ¥Í∞ÄÍ∏∞",
                stayPortalBtn: "Ïù¥ Ïö©Í∏∞ÏôÄ Îçî Î®∏Î¨ºÍ∏∞",
                inputPlaceholder: "Ïö©Í∏∞Í∞Ä Î∂ÄÏ°±Ìï¥ÏÑú ÎßêÌïòÏßÄ Î™ªÌñàÎçò ÏàúÍ∞ÑÏù¥ ÏûàÏóàÎÇòÏöî? Î¨¥ÏóáÏùÑ ÎßêÌïòÍ≥† Ïã∂ÏóàÍ≥† Ïôú ÎëêÎ†§Ïõ†ÎÇòÏöî?",
                youLabel: "ÎãπÏã†",
                waitingMessage: "ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë..."
            },
            en: {
                logoSubtitle: "Emotional Alchemy",
                portalMainTitle: "Portal 23: Moments Without Courage",
                portalSubtitle: "Words left unspoken",
                portalIntro: "Have you ever had a moment\nwhen you couldn't speak due to lack of courage?\n\nWhat did you want to say then,\nand why was it so frightening to voice those words?",
                followUpQuestion: "If you could speak those words again now,\nwhat would you start with?\n\nAnd are those words something you need to hear yourself?",
                lightTitle: "Word of Light",
                lightMessage: "The current you has become strong enough to apologize to your past self. That is true courage.\nApologies are never too late for anyone. Even to yourself. You have started that now.\nTrue courage is kneeling before past words. And believing that you can start again.",
                navigationTitle: "Portal 23 Complete",
                navigationMessage: "You have made peace with that moment when you lacked courage and become someone who can honestly express emotions.\n\nBy understanding that moment when you couldn't speak, you have now found the courage to express your true feelings.\n\nYou have gained the strength to communicate with an honest heart, no longer hiding emotions due to pride or fear.",
                nextPortalBtn: "Continue to Portal 24",
                stayPortalBtn: "Stay with this courage",
                inputPlaceholder: "Was there a moment when you lacked courage to speak? What did you want to say and why was it so frightening?",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "Alquimia Emocional",
                portalMainTitle: "Portal 23: Momentos Sem Coragem",
                portalSubtitle: "Palavras n√£o ditas",
                portalIntro: "Voc√™ j√° teve um momento\nem que n√£o conseguiu falar por falta de coragem?\n\nO que voc√™ queria dizer ent√£o,\ne por que era t√£o assustador pronunciar essas palavras?",
                followUpQuestion: "Se voc√™ pudesse falar essas palavras novamente agora,\ncom o que come√ßaria?\n\nE essas palavras s√£o algo que voc√™ precisa ouvir de si mesmo?",
                lightTitle: "Palavra de Luz",
                lightMessage: "O voc√™ atual se tornou forte o suficiente para pedir desculpas ao seu eu do passado. Essa √© a verdadeira coragem.\nDesculpas nunca s√£o tarde demais para ningu√©m. Nem mesmo para voc√™ mesmo. Voc√™ come√ßou isso agora.\nVerdadeira coragem √© se ajoelhar diante de palavras passadas. E acreditar que voc√™ pode come√ßar de novo.",
                navigationTitle: "Portal 23 Completo",
                navigationMessage: "Voc√™ fez as pazes com aquele momento quando lhe faltou coragem e se tornou algu√©m que pode expressar emo√ß√µes honestamente.\n\nAo entender aquele momento quando voc√™ n√£o conseguiu falar, agora encontrou a coragem para expressar seus verdadeiros sentimentos.\n\nVoc√™ ganhou a for√ßa para se comunicar com um cora√ß√£o honesto, n√£o mais escondendo emo√ß√µes por orgulho ou medo.",
                nextPortalBtn: "Continuar para Portal 24",
                stayPortalBtn: "Ficar com esta coragem",
                inputPlaceholder: "Houve um momento quando voc√™ n√£o teve coragem para falar? O que queria dizer e por que era t√£o assustador?",
                youLabel: "Voc√™",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Noah", emoji: "üßë‚Äçü¶±", text: {
                ko: "Í∑∏ Í∞êÏ†ïÏùÄ Ïù¥ÎØ∏ ÎßêÏù¥ ÎêòÏóàÏóàÏñ¥. Îã§Îßå, Î™©ÏÜåÎ¶¨Í∞Ä ÎÇòÏßÄ ÏïäÏïòÏùÑ ÎøêÏù¥Ïïº. ÎÑàÎäî ÎäêÎÅºÍ≥† ÏûàÏóàÏûñÏïÑ.",
                en: "That emotion had already become words. It's just that your voice couldn't come out. You were feeling it though.",
                pt: "Essa emo√ß√£o j√° havia se tornado palavras. √â s√≥ que sua voz n√£o conseguiu sair. Voc√™ estava sentindo isso, no entanto."
            }},
            { name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è", text: {
                ko: "Ïö©Í∏∞Í∞Ä ÏóÜÏóàÎçò Í≤å ÏïÑÎãàÏïº. Í∑∏ÎßåÌÅº Í∑∏ Í¥ÄÍ≥ÑÍ∞Ä ÏÜåÏ§ëÌï¥ÏÑú, ÏÉÅÏ≤ò Ï§ÑÍπå Î¥ê ÎëêÎ†§Ïõ†Îçò Í±∞Ïïº.",
                en: "It wasn't that you lacked courage. That relationship was so precious to you that you were afraid of hurting it.",
                pt: "N√£o foi que voc√™ n√£o teve coragem. Esse relacionamento era t√£o precioso para voc√™ que tinha medo de machuc√°-lo."
            }},
            { name: "Sora", emoji: "üßï", text: {
                ko: "ÎßêÌïòÏßÄ Î™ªÌïú Í∞êÏ†ïÏùÄ ÎßàÏùå ÏïàÏóêÏÑú Ïò§Îûò Î®∏Î¨ºÎü¨Ïöî. Í∑∏Í±¥ ÌõÑÌöåÍ∞Ä ÏïÑÎãàÎùº, ÏïÑÏßÅ Í∫ºÎÇ¥ÏßÄ Î™ªÌïú ÏÇ¨ÎûëÏù¥ÏóêÏöî.",
                en: "Emotions that couldn't be spoken linger in the heart for a long time. That's not regret, but love that hasn't been expressed yet.",
                pt: "Emo√ß√µes que n√£o puderam ser faladas permanecem no cora√ß√£o por muito tempo. Isso n√£o √© arrependimento, mas amor que ainda n√£o foi expresso."
            }},
            { name: "Kael", emoji: "üßô", text: {
                ko: "Ïö©Í∏∞ÎûÄ, ÎßêÌñàÏùÑ ÎïåÎßåÏù¥ ÏïÑÎãàÎùº ÏßÄÍ∏àÏù¥ÎùºÎèÑ Îã§Ïãú ÎßêÌï† Ïàò ÏûàÏùÑ Îïå ÏßÑÏßúÎ°ú Ï¶ùÎ™ÖÎêòÎäî Í±∞Ïïº.",
                en: "Courage is truly proven not only when you speak, but when you can speak again even now.",
                pt: "A coragem √© verdadeiramente provada n√£o apenas quando voc√™ fala, mas quando pode falar novamente mesmo agora."
            }},
            { name: "Mira", emoji: "üßë‚Äçüé®", text: {
                ko: "Í∑∏ ÌïúÎßàÎîîÍ∞Ä ÎÑàÎ•º Î¨∂Ïñ¥ÎëêÍ≥† ÏûàÏóàÍµ¨ÎÇò. Í∑∏Í±¥ ÏßÄÍ∏à ÎÑàÏùò ÎààÎπõÏóêÎèÑ ÎÇ®ÏïÑ ÏûàÏñ¥.",
                en: "Those words were binding you. That's still remaining in your eyes now.",
                pt: "Essas palavras estavam te amarrando. Isso ainda permanece em seus olhos agora."
            }},
            { name: "Cris", emoji: "ü¶∏‚Äç‚ôÇÔ∏è", text: {
                ko: "Ïôú Ïö∞Î¶¨Îäî Î®ºÏ†Ä ÎßêÌïòÎäî Í±∏ 'ÏßÄÎäî Í≤É'Ï≤òÎüº Ïó¨Í≤ºÏùÑÍπå? ÏßÑÏßú Ïö©Í∏∞Îäî, Î®ºÏ†Ä Îã§Í∞ÄÍ∞ÄÎäî ÏÇ¨ÎûåÏù¥ Í∞ñÍ≥† ÏûàÎäî Í±∞Ïïº.",
                en: "Why did we think speaking first was like 'losing'? True courage belongs to the person who approaches first.",
                pt: "Por que pens√°vamos que falar primeiro era como 'perder'? A verdadeira coragem pertence √† pessoa que se aproxima primeiro."
            }},
            { name: "Enya", emoji: "üßë‚ÄçüöÄ", text: {
                ko: "Í∑∏ ÎßêÏùÑ Í∫ºÎÇº Ïàò ÏóÜÎçò ÏàúÍ∞ÑÏóêÎèÑ ÎÑàÎäî ÎßàÏùåÏúºÎ°ú Í≥ÑÏÜç ÎßêÌïòÍ≥† ÏûàÏóàÏñ¥. ÏßÄÍ∏àÎèÑ Í∑∏ ÎßàÏùåÏùÄ ÏÇ¨ÎùºÏßÄÏßÄ ÏïäÏïòÏñ¥.",
                en: "Even in moments when you couldn't speak those words, you kept saying them in your heart. That heart hasn't disappeared even now.",
                pt: "Mesmo nos momentos em que voc√™ n√£o conseguia falar essas palavras, voc√™ continuava dizendo-as em seu cora√ß√£o. Esse cora√ß√£o n√£o desapareceu nem agora."
            }},
            { name: "Lian", emoji: "üßò", text: {
                ko: "ÏßÄÍ∏à ÎÑàÎäî, Í≥ºÍ±∞Ïùò ÎÑàÍ∞Ä ÎÅùÎÇ¥ Í∫ºÎÇ¥ÏßÄ Î™ªÌñàÎçò ÎßêÏùÑ ÎßàÏùåÏÜçÏóêÏÑú Î≥µÏõêÌïòÍ≥† ÏûàÏñ¥Ïöî. Í∑∏Í≤ÉÏù¥ ÏÑ±Ïû•Ïù¥ÏóêÏöî.",
                en: "Right now, you are restoring in your heart the words that your past self couldn't finally bring out. That is growth.",
                pt: "Agora, voc√™ est√° restaurando em seu cora√ß√£o as palavras que seu eu do passado n√£o conseguiu finalmente expressar. Isso √© crescimento."
            }}
        ];

        const responseCharacters = [
            {
                name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÏßÄÍ∏àÏùò ÎÑàÎäî, Í≥ºÍ±∞Ïùò ÏûêÏã†ÏóêÍ≤å ÏÇ¨Í≥ºÌï† Ïàò ÏûàÏùÑ ÎßåÌÅº Îã®Îã®Ìï¥Ï°åÏñ¥Ïöî. Í∑∏Í≤ÉÏù¥ ÏßÑÏßú Ïö©Í∏∞ÏòàÏöî.",
                        en: "The current you has become strong enough to apologize to your past self. That is true courage.",
                        pt: "O voc√™ atual se tornou forte o suficiente para pedir desculpas ao seu eu do passado. Essa √© a verdadeira coragem."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Lian", emoji: "üßò",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÏÇ¨Í≥ºÎäî ÎàÑÍµ¨ÏóêÍ≤åÎèÑ Îä¶ÏßÄ ÏïäÏïÑÏöî. ÏûêÏã†ÏóêÍ≤åÏ°∞Ï∞®. ÎãπÏã†ÏùÄ ÏßÄÍ∏à Í∑∏Í≤ÉÏùÑ ÏãúÏûëÌñàÏñ¥Ïöî.",
                        en: "Apologies are never too late for anyone. Even to yourself. You have started that now.",
                        pt: "Desculpas nunca s√£o tarde demais para ningu√©m. Nem mesmo para voc√™ mesmo. Voc√™ come√ßou isso agora."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Kael", emoji: "üßô",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÏßÑÏßú Ïö©Í∏∞Îäî ÏßÄÎÇòÍ∞Ñ Îßê ÏïûÏóê Î¨¥Î¶é ÍøáÎäî Í≤É. Í∑∏Î¶¨Í≥† Îã§Ïãú ÏãúÏûëÌï† Ïàò ÏûàÎã§Îäî ÎØøÏùåÏù¥Ïïº.",
                        en: "True courage is kneeling before past words. And believing that you can start again.",
                        pt: "Verdadeira coragem √© se ajoelhar diante de palavras passadas. E acreditar que voc√™ pode come√ßar de novo."
                    };
                    return responses[lang];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        let awaitingSecondResponse = false;
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('navigationTitle').textContent = translations[lang].navigationTitle;
            document.getElementById('nextPortalBtn').textContent = translations[lang].nextPortalBtn;
            document.getElementById('stayPortalBtn').textContent = translations[lang].stayPortalBtn;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'followUpSection', 'userInputSection',
                'userReactionsSection', 'lightMessageSection', 'navigationSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('followUpQuestion').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('navigationMessage').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
            awaitingSecondResponse = false;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('nextPortalBtn').addEventListener('click', function() {
                localStorage.setItem('temarix_v4_portal23_complete', 'true');
                localStorage.setItem('temarix_v4_current_portal', '24');
                
                const nextMessage = currentLanguage === 'ko' ? 
                    'Portal 24: ÏûÉÏñ¥Î≤ÑÎ¶∞ Ïù¥Î¶Ñ ÌïòÎÇòÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§.' :
                    currentLanguage === 'en' ? 
                    'Moving to Portal 24: One Lost Name.' :
                    'Indo para Portal 24: Um Nome Perdido.';
                alert(nextMessage);
            });
            
            document.getElementById('stayPortalBtn').addEventListener('click', function() {
                const stayMessage = currentLanguage === 'ko' ? 
                    'Ïù¥ Ïö©Í∏∞ÏôÄ Îçî Î®∏Î¨ºÎ©∞ ÍπäÏù¥ ÏÑ±Ï∞∞ÌïòÏãúÍ≤†ÏäµÎãàÍπå?' :
                    currentLanguage === 'en' ? 
                    'Do you want to stay longer with this courage for deeper reflection?' :
                    'Deseja ficar mais tempo com esta coragem para reflex√£o mais profunda?';
                
                if (confirm(stayMessage)) {
                    resetJourney();
                    setTimeout(() => {
                        startPortalSequence();
                    }, 1000);
                }
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            console.log('Processing user input:', inputText);
            localStorage.setItem('temarix_v4_portal23_response', JSON.stringify({
                portal: "v4-23",
                resposta: inputText,
                step: awaitingSecondResponse ? "second" : "first",
                data: new Date().toISOString(),
                idioma: currentLanguage
            }));
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                if (!awaitingSecondResponse) {
                    showUserReactions(inputText);
                } else {
                    showSecondUserReactions(inputText);
                }
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showFollowUpQuestion();
            }, 2000);
        }
        
        async function showFollowUpQuestion() {
            const followUpSection = document.getElementById('followUpSection');
            const followUpQuestionEl = document.getElementById('followUpQuestion');
            
            followUpSection.classList.add('show');
            
            await typewriterEffect(followUpQuestionEl, translations[currentLanguage].followUpQuestion, 50);
            
            setTimeout(() => {
                awaitingSecondResponse = true;
                enableUserInput();
            }, 1500);
        }
        
        async function showSecondUserReactions(userInput) {
            const secondResponseCharacters = [
                {
                    name: "Noah", emoji: "üßë‚Äçü¶±",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Í∑∏ ÎßêÏùÄ ÎÅùÏù¥ ÏïÑÎãàÎùº ÏãúÏûëÏù¥ÏóêÏöî. Ïù¥Ï†ú ÎãπÏã†ÏùÄ ÏÉàÎ°úÏö¥ ÎåÄÌôîÎ•º ÏãúÏûëÌï† Ïàò ÏûàÏñ¥Ïöî.",
                            en: "Those words aren't an ending but a beginning. Now you can start new conversations.",
                            pt: "Essas palavras n√£o s√£o um fim, mas um come√ßo. Agora voc√™ pode come√ßar novas conversas."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Mira", emoji: "üßë‚Äçüé®",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Ïö©Í∏∞Îäî ÏôÑÎ≤ΩÌïú ÎßêÏù¥ ÏïÑÎãàÎùº, ÏßÑÏã¨ÏùÑ Í∫ºÎÇ¥Î†§Îäî ÎÖ∏Î†•ÏóêÏÑú ÏãúÏûëÎèºÏöî.",
                            en: "Courage doesn't start from perfect words, but from the effort to bring out sincerity.",
                            pt: "A coragem n√£o come√ßa de palavras perfeitas, mas do esfor√ßo de trazer para fora a sinceridade."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Enya", emoji: "üßë‚ÄçüöÄ",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÎãπÏã†Ïù¥ Ïç®ÎÇ¥Î†§Í∞Ñ Í∑∏ ÎßêÎì§Ïù¥, ÏïûÏúºÎ°úÏùò Î™®Îì† ÎåÄÌôîÎ•º Ïö©Í∏∞ ÏûàÍ≤å ÎßåÎì§ Í±∞ÏòàÏöî.",
                            en: "Those words you've written will make all future conversations courageous.",
                            pt: "Essas palavras que voc√™ escreveu tornar√£o todas as conversas futuras corajosas."
                        };
                        return responses[lang];
                    }
                }
            ];
            
            const reactionsSection = document.getElementById('userReactionsSection');
            
            for (let i = 0; i < secondResponseCharacters.length; i++) {
                const char = secondResponseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < secondResponseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showNavigationSection();
            }, 2000);
        }
        
        async function showNavigationSection() {
            const navigationSection = document.getElementById('navigationSection');
            const navigationMessage = document.getElementById('navigationMessage');
            
            navigationSection.classList.add('show');
            
            const messageText = translations[currentLanguage].navigationMessage;
            await typewriterEffect(navigationMessage, messageText, 50);
            
            setTimeout(() => {
                scrollToElement(navigationSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('Temarix V4 Portal 23 initialized');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                enableUserInput();
            }, 2000);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V4 Portal 23 DOM loaded');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>