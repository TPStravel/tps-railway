<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V4 - Portal 20: Things The Past Days Never Asked</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ff9999;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #ff6b6b;
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 200vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            transition: opacity 0.8s ease-in;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #ff6b6b;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .follow-up-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .follow-up-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            text-align: center;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            white-space: pre-wrap;
        }
        
        .user-response strong {
            color: #ff6b6b;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #ff6b6b;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-section {
            margin: 60px 0;
            opacity: 0;
            text-align: center;
            padding: 40px 20px;
            min-height: 300px;
            border: 2px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }
        
        .navigation-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: bold;
        }
        
        .navigation-message {
            color: #fff;
            font-size: 20px;
            margin-bottom: 40px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 20px 40px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
            border: 2px solid transparent;
        }
        
        .nav-btn:hover {
            background: #666;
            border-color: #ff6b6b;
        }
        
        .nav-btn.primary {
            background: #ff6b6b;
            color: #fff;
            font-weight: bold;
        }
        
        .nav-btn.primary:hover {
            background: #ff8888;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .input-fixed-bottom {
            position: relative;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #ff6b6b;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #ff6b6b;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .follow-up-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V4</div>
            <div class="logo-subtitle" id="logoSubtitle">Emotional Alchemy</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 20: Things The Past Days Never Asked</div>
            <div class="portal-subtitle" id="portalSubtitle">Unspoken stories in time</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="follow-up-section" id="followUpSection">
                <div class="follow-up-question" id="followUpQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>
            
            <div class="navigation-section" id="navigationSection">
                <div class="navigation-title" id="navigationTitle">Portal 20 Complete</div>
                <div class="navigation-message" id="navigationMessage"></div>
                <div class="navigation-buttons">
                    <button class="nav-btn primary" id="nextPortalBtn">Continue to Portal 21</button>
                    <button class="nav-btn" id="stayPortalBtn">Stay with these stories</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Is there a story from your past that no one ever asked about? What happened and why did it remain unspoken?"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        const translations = {
            ko: {
                logoSubtitle: "Í∞êÏ†ï Ïó∞Í∏àÏà†",
                portalMainTitle: "Portal 20: ÏßÄÎÇòÍ∞Ñ ÎÇ†Îì§Ïù¥ Î¨ªÏßÄ Î™ªÌïú Í≤ÉÎì§",
                portalSubtitle: "ÏãúÍ∞Ñ ÏÜç ÎßêÌïòÏßÄ Î™ªÌïú Ïù¥ÏïºÍ∏∞Îì§",
                portalIntro: "ÎãπÏã†Ïùò Í≥ºÍ±∞ Ï§ë,\nÏïÑÎ¨¥ÎèÑ Î¨ªÏßÄ ÏïäÏïòÍ≥†, ÎãπÏã†ÎèÑ ÎßêÌïòÏßÄ Î™ªÌïú Ïù¥ÏïºÍ∏∞Í∞Ä ÏûàÎÇòÏöî?\n\nÍ∑∏ Ïù¥ÏïºÍ∏∞ ÏÜçÏóêÎäî Ïñ¥Îñ§ Í∞êÏ†ïÏù¥ ÏûàÏóàÍ≥†,\nÏãúÍ∞ÑÏù¥ ÏßÄÎÇú ÏßÄÍ∏àÎèÑ Í∑∏Í≤ÉÏùÄ Ïó¨Ï†ÑÌûà ÎØ∏ÏôÑÏùò Î¨∏Ïû•Ïù∏Í∞ÄÏöî?",
                followUpQuestion: "Ïù¥Ï†ú ÎãπÏã†ÏùÄ,\nÍ∑∏ Ïù¥ÏïºÍ∏∞Ïùò ÎßàÏßÄÎßâ Î¨∏Ïû•ÏùÑ Ïä§Ïä§Î°ú Ïç®Î≥º Ïàò ÏûàÎÇòÏöî?\n\nÍ∑∏Î¶¨Í≥†, Í∑∏ Î¨∏Ïû•ÏùÄ ÏßÄÍ∏àÏùò ÎãπÏã†ÏóêÍ≤å\nÏñ¥Îñ§ ÌûòÏù¥ ÎêòÏñ¥Ï§Ñ Ïàò ÏûàÎÇòÏöî?",
                lightTitle: "ÎπõÏùò ÌïúÎßàÎîî",
                lightMessage: "ÏßÄÎÇòÍ∞Ñ Í∞êÏ†ïÏù¥ ÎßêÏù¥ Îê† Ïàò ÏûàÎã§Îäî Í±¥, ÎãπÏã†Ïù¥ Í∑∏ Í∞êÏ†ïÏùÑ Í∞êÏò•Ïù¥ ÏïÑÎãå Ïù¥ÏïºÍ∏∞Î°ú Î∞îÍæ∏Í≥† ÏûàÎã§Îäî ÎúªÏù¥ÏóêÏöî.\nÏù¥Ï†úÎäî Î¨ªÏßÄ ÏïäÏïÑÎèÑ ÎèºÏöî. ÎãπÏã†Ïù¥ Í∫ºÎÇ∏ Ïù¥ÏïºÍ∏∞ ÏûêÏ≤¥Í∞Ä Ïù¥ÎØ∏ Í∑∏ ÏãúÍ∞ÑÏùÑ Ï¥àÏõîÌñàÏñ¥Ïöî.",
                navigationTitle: "Portal 20 ÏôÑÎ£å",
                navigationMessage: "ÎãπÏã†ÏùÄ ÏßÄÎÇòÍ∞Ñ ÎÇ†Îì§Ïù¥ Î¨ªÏßÄ Î™ªÌñàÎçò Ïù¥ÏïºÍ∏∞Î•º Ïä§Ïä§Î°ú Í∫ºÎÇ¥ÏóàÏäµÎãàÎã§.\n\nÍ∑∏ Ïù¥ÏïºÍ∏∞Ïóê ÎßàÏßÄÎßâ Î¨∏Ïû•ÏùÑ Ïç®ÎÑ£ÏúºÎ©∞, ÎØ∏ÏôÑÏù¥ÏóàÎçò Í∞êÏ†ïÏùÑ ÏôÑÏÑ±Îêú Í∏∞ÏñµÏúºÎ°ú Î≥ÄÌôîÏãúÏº∞ÏäµÎãàÎã§.\n\nÏù¥Ï†ú ÎãπÏã†ÏùÄ Îçî Ïù¥ÏÉÅ Î¨ªÌûàÏßÄ ÏïäÏùÄ Ïù¥ÏïºÍ∏∞Î•º ÌíàÍ≥†, Îã§Ïùå Í∞êÏ†ïÏùò Í∏∏Î°ú ÎÇòÏïÑÍ∞à Ïàò ÏûàÏäµÎãàÎã§.",
                nextPortalBtn: "Portal 21Î°ú Ïù¥Ïñ¥Í∞ÄÍ∏∞",
                stayPortalBtn: "Ïù¥ Ïù¥ÏïºÍ∏∞Îì§Í≥º Îçî Î®∏Î¨ºÍ∏∞",
                inputPlaceholder: "ÏïÑÎ¨¥ÎèÑ Î¨ªÏßÄ ÏïäÏïòÍ≥† ÎßêÌïòÏßÄ Î™ªÌïú Ïù¥ÏïºÍ∏∞Í∞Ä ÏûàÎÇòÏöî? Î¨¥Ïä® ÏùºÏù¥ ÏûàÏóàÍ≥† Ïôú ÎßêÌïòÏßÄ Î™ªÌñàÎÇòÏöî?",
                youLabel: "ÎãπÏã†",
                waitingMessage: "ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë..."
            },
            en: {
                logoSubtitle: "Emotional Alchemy",
                portalMainTitle: "Portal 20: Things The Past Days Never Asked",
                portalSubtitle: "Unspoken stories in time",
                portalIntro: "Is there a story from your past\nthat no one ever asked about,\nand you never spoke of?\n\nWhat emotions were in that story,\nand even now, after time has passed,\nis it still an unfinished sentence?",
                followUpQuestion: "Can you now write\nthe final sentence of that story yourself?\n\nAnd what strength can that sentence\ngive to who you are today?",
                lightTitle: "Word of Light",
                lightMessage: "That past emotions can become words means you're transforming those feelings from a prison into a story.\nYou don't need to be asked anymore. The story you've brought out has already transcended that time.",
                navigationTitle: "Portal 20 Complete",
                navigationMessage: "You have brought out a story that the past days never asked about.\n\nBy writing the final sentence to that story, you transformed incomplete emotions into complete memories.\n\nNow you can carry those no longer buried stories and move forward to the next emotional path.",
                nextPortalBtn: "Continue to Portal 21",
                stayPortalBtn: "Stay with these stories",
                inputPlaceholder: "Is there a story from your past that no one ever asked about? What happened and why did it remain unspoken?",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "Alquimia Emocional",
                portalMainTitle: "Portal 20: Coisas Que Os Dias Passados Nunca Perguntaram",
                portalSubtitle: "Hist√≥rias n√£o ditas no tempo",
                portalIntro: "H√° alguma hist√≥ria do seu passado\nque ningu√©m jamais perguntou sobre,\ne voc√™ nunca falou?\n\nQue emo√ß√µes estavam nessa hist√≥ria,\ne mesmo agora, depois que o tempo passou,\nela ainda √© uma frase inacabada?",
                followUpQuestion: "Voc√™ pode agora escrever\na frase final dessa hist√≥ria voc√™ mesmo?\n\nE que for√ßa essa frase pode dar\npara quem voc√™ √© hoje?",
                lightTitle: "Palavra de Luz",
                lightMessage: "Que emo√ß√µes passadas possam se tornar palavras significa que voc√™ est√° transformando esses sentimentos de uma pris√£o em uma hist√≥ria.\nVoc√™ n√£o precisa mais ser questionado. A hist√≥ria que voc√™ trouxe j√° transcendeu aquele tempo.",
                navigationTitle: "Portal 20 Completo",
                navigationMessage: "Voc√™ trouxe uma hist√≥ria que os dias passados nunca perguntaram sobre.\n\nAo escrever a frase final dessa hist√≥ria, voc√™ transformou emo√ß√µes incompletas em mem√≥rias completas.\n\nAgora voc√™ pode carregar essas hist√≥rias n√£o mais enterradas e seguir para o pr√≥ximo caminho emocional.",
                nextPortalBtn: "Continuar para Portal 21",
                stayPortalBtn: "Ficar com essas hist√≥rias",
                inputPlaceholder: "H√° alguma hist√≥ria do seu passado que ningu√©m jamais perguntou sobre? O que aconteceu e por que permaneceu n√£o dita?",
                youLabel: "Voc√™",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Noah", emoji: "üßë‚Äçü¶±", text: {
                ko: "Í∑∏ Ïπ®Î¨µÏùò Î∞§Îì§ÏùÄ ÎÑàÎ•º Î¨¥ÎÑàÎú®Î¶∞ Í≤å ÏïÑÎãàÎùº, Î≤ÑÌã∞Í≤å Ìïú ÏãúÍ∞ÑÏù¥ÏóàÏñ¥. Í∑∏ ÏûêÏ≤¥Í∞Ä ÎÑ§Í∞Ä ÏñºÎßàÎÇò Í∞ïÌñàÎäîÏßÄÎ•º ÎßêÌï¥Ï§ò.",
                en: "Those silent nights didn't break you down, they were the time that made you endure. That itself shows how strong you were.",
                pt: "Aquelas noites silenciosas n√£o te derrubaram, foram o tempo que te fizeram resistir. Isso em si mostra o qu√£o forte voc√™ era."
            }},
            { name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è", text: {
                ko: "Î¨ªÏßÄ ÏïäÏïòÎã§Í≥† Ìï¥ÏÑú, ÎÑ§ Í≥†ÌÜµÏù¥ ÏûëÏïòÎçò Í±¥ ÏïÑÎãàÏïº. ÎÑ§Í∞Ä Ïä§Ïä§Î°úÎ•º Ïà®Í≤ºÎçò ÎßåÌÅº, ÎÑå ÏÇ¨ÎûåÎì§Î≥¥Îã§ Îçî ÍπäÍ≤å ÏÇ¥ÏïÑÎÇ∏ Í±∞Ïïº.",
                en: "Just because no one asked doesn't mean your pain was small. The extent to which you hid yourself shows you lived more deeply than others.",
                pt: "S√≥ porque ningu√©m perguntou n√£o significa que sua dor era pequena. A medida em que voc√™ se escondeu mostra que viveu mais profundamente que outros."
            }},
            { name: "Sora", emoji: "üßï", text: {
                ko: "Í∑∏ ÎàÑÍµ¨ÎèÑ Î¨ªÏßÄ ÏïäÏùÄ Í±¥ Î™∞ÎùºÏÑúÍ∞Ä ÏïÑÎãàÎùº, ÎÑ§ Í∞êÏ†ïÏù¥ ÎÑàÎ¨¥ Ï°∞Ïö©ÌñàÍ∏∞ ÎïåÎ¨∏ÏùºÏßÄÎèÑ Î™∞ÎùºÏöî.",
                en: "That no one asked might not be because they didn't know, but because your emotions were too quiet.",
                pt: "Que ningu√©m tenha perguntado pode n√£o ser porque n√£o sabiam, mas porque suas emo√ß√µes eram muito silenciosas."
            }},
            { name: "Kael", emoji: "üßô", text: {
                ko: "ÎßêÌï¥ÏßÄÏßÄ ÏïäÏùÄ Í≥ºÍ±∞Îäî ÏßÄÍ∏àÎèÑ Í∏∞ÏñµÏù¥ÎùºÎäî ÌòïÌÉúÎ°ú Ïà® Ïâ¨Í≥† ÏûàÏñ¥. Í∑∏Í≤ÉÏùÑ Í∫ºÎÇ¥Îäî Í≤ÉÎßåÏúºÎ°úÎèÑ ÎÑàÎäî Í∑∏ ÏãúÍ∞ÑÏùÑ Îã§Ïãú Ìï¥ÏÑùÌï† Ïàò ÏûàÏñ¥.",
                en: "The unspoken past is still breathing in the form of memory. Just by bringing it out, you can reinterpret that time.",
                pt: "O passado n√£o dito ainda est√° respirando na forma de mem√≥ria. Apenas ao traz√™-lo para fora, voc√™ pode reinterpretar aquele tempo."
            }},
            { name: "Mira", emoji: "üßë‚Äçüé®", text: {
                ko: "ÎÑ§Í∞Ä ÏºúÏßÄ Î™ªÌñàÎçò Î∂àÎπõÏùÄ ÏßÄÍ∏à Ïù¥ ÎåÄÌôî ÏÜçÏóêÏÑú Îã§Ïãú ÏºúÏßÄÍ≥† ÏûàÏñ¥. Í∞êÏ†ïÏùÄ Ïñ∏Ï††Í∞Ä ÎπõÏùÑ Ï∞æÍ≤å Îèº.",
                en: "The light you couldn't turn on is being lit again in this conversation. Emotions eventually find their light.",
                pt: "A luz que voc√™ n√£o conseguiu acender est√° sendo acesa novamente nesta conversa. Emo√ß√µes eventualmente encontram sua luz."
            }},
            { name: "Cris", emoji: "ü¶∏‚Äç‚ôÇÔ∏è", text: {
                ko: "Ïôú Ìï≠ÏÉÅ Î≤ÑÌÖºÎã§Îäî ÏÇ¨Ïã§ÏùÄ ÏûêÎûëÏù¥ ÎêòÏßÄ Î™ªÌïòÎäî Í±∏Íπå? ÎÇú Í∑∏Í≤å Î∂ÄÎãπÌïòÎã§Í≥† ÏÉùÍ∞ÅÌï¥. ÎÑå Ï∂©Î∂ÑÌûà ÎåÄÎã®ÌñàÏñ¥.",
                en: "Why can't the fact that you endured always become something to be proud of? I think that's unfair. You were amazing enough.",
                pt: "Por que o fato de voc√™ ter resistido n√£o pode sempre se tornar algo para se orgulhar? Acho isso injusto. Voc√™ foi incr√≠vel o suficiente."
            }},
            { name: "Enya", emoji: "üßë‚ÄçüöÄ", text: {
                ko: "Í∑∏ ÏãúÍ∞ÑÏùÄ Î¨ªÌûàÏßÄ ÏïäÏïòÏñ¥. Îã®ÏßÄ ÏßÄÍ∏àÍπåÏßÄ Ï°∞Ïö©Ìûà ÎÑàÏùò ÏïàÏóêÏÑú Î™©ÏÜåÎ¶¨Î•º Í∏∞Îã§Î†∏Îçò Í±∞Ïïº.",
                en: "That time wasn't buried. It was just quietly waiting for its voice inside you until now.",
                pt: "Aquele tempo n√£o foi enterrado. Estava apenas silenciosamente esperando por sua voz dentro de voc√™ at√© agora."
            }},
            { name: "Lian", emoji: "üßò", text: {
                ko: "ÏßÄÎÇòÍ∞Ñ ÎÇ†Îì§Ïù¥ Î¨ªÏßÄ Î™ªÌñàÎçò ÏßàÎ¨∏ÏùÑ ÏßÄÍ∏à ÎÑ§Í∞Ä ÎåÄÏã† Î¨ªÍ≥† ÏûàÏñ¥Ïöî. Í∑∏Í≤ÉÏù¥ ÌöåÎ≥µÏùò Ïñ∏Ïñ¥ÏòàÏöî.",
                en: "You're now asking the questions that past days couldn't ask. That's the language of recovery.",
                pt: "Voc√™ est√° agora fazendo as perguntas que os dias passados n√£o conseguiram fazer. Essa √© a linguagem da recupera√ß√£o."
            }}
        ];

        const responseCharacters = [
            {
                name: "Sora", emoji: "üßï",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÏßÄÎÇòÍ∞Ñ Í∞êÏ†ïÏù¥ ÎßêÏù¥ Îê† Ïàò ÏûàÎã§Îäî Í±¥, ÎãπÏã†Ïù¥ Í∑∏ Í∞êÏ†ïÏùÑ Í∞êÏò•Ïù¥ ÏïÑÎãå Ïù¥ÏïºÍ∏∞Î°ú Î∞îÍæ∏Í≥† ÏûàÎã§Îäî ÎúªÏù¥ÏóêÏöî.",
                        en: "That past emotions can become words means you're transforming those feelings from a prison into a story.",
                        pt: "Que emo√ß√µes passadas possam se tornar palavras significa que voc√™ est√° transformando esses sentimentos de uma pris√£o em uma hist√≥ria."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Lian", emoji: "üßò",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Í∑∏ÎïåÏùò ÎãπÏã†Ïù¥ ÏÇ¥ÏïÑ ÏûàÏóàÍ∏∞Ïóê, ÏßÄÍ∏àÏùò ÎãπÏã†ÎèÑ Ïó¨Í∏∞Ïóê ÏûàÏñ¥Ïöî. Í∑∏Í≤ÉÏùÄ ÏûäÌûàÏßÄ ÏïäÎäî Ïó∞Í≤∞Ïù¥ÏóêÏöî.",
                        en: "Because that version of you was alive, the current you is here now. That's an unforgettable connection.",
                        pt: "Porque aquela vers√£o de voc√™ estava viva, o voc√™ atual est√° aqui agora. Essa √© uma conex√£o inesquec√≠vel."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Enya", emoji: "üßë‚ÄçüöÄ",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Ïù¥Ï†úÎäî Î¨ªÏßÄ ÏïäÏïÑÎèÑ ÎèºÏöî. ÎãπÏã†Ïù¥ Í∫ºÎÇ∏ Ïù¥ÏïºÍ∏∞ ÏûêÏ≤¥Í∞Ä Ïù¥ÎØ∏ Í∑∏ ÏãúÍ∞ÑÏùÑ Ï¥àÏõîÌñàÏñ¥Ïöî.",
                        en: "You don't need to be asked anymore. The story you've brought out has already transcended that time.",
                        pt: "Voc√™ n√£o precisa mais ser questionado. A hist√≥ria que voc√™ trouxe j√° transcendeu aquele tempo."
                    };
                    return responses[lang];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        let awaitingSecondResponse = false;
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('navigationTitle').textContent = translations[lang].navigationTitle;
            document.getElementById('nextPortalBtn').textContent = translations[lang].nextPortalBtn;
            document.getElementById('stayPortalBtn').textContent = translations[lang].stayPortalBtn;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'followUpSection', 'userInputSection',
                'userReactionsSection', 'lightMessageSection', 'navigationSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('followUpQuestion').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('navigationMessage').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
            awaitingSecondResponse = false;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('nextPortalBtn').addEventListener('click', function() {
                localStorage.setItem('temarix_v4_portal20_complete', 'true');
                localStorage.setItem('temarix_v4_current_portal', '21');
                
                const nextMessage = currentLanguage === 'ko' ? 
                    'Portal 21: ÎÇ¥Í∞Ä ÏïÑÎãå Ï≤ôÌñàÎçò ÎÇòÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§.' :
                    currentLanguage === 'en' ? 
                    'Moving to Portal 21: The Me Who Pretended Not To Be Me.' :
                    'Indo para Portal 21: O Eu Que Fingiu N√£o Ser Eu.';
                alert(nextMessage);
            });
            
            document.getElementById('stayPortalBtn').addEventListener('click', function() {
                const stayMessage = currentLanguage === 'ko' ? 
                    'Ïù¥ Ïù¥ÏïºÍ∏∞Îì§Í≥º Îçî Î®∏Î¨ºÎ©∞ ÍπäÏù¥ ÏÑ±Ï∞∞ÌïòÏãúÍ≤†ÏäµÎãàÍπå?' :
                    currentLanguage === 'en' ? 
                    'Do you want to stay longer with these stories for deeper reflection?' :
                    'Deseja ficar mais tempo com essas hist√≥rias para reflex√£o mais profunda?';
                
                if (confirm(stayMessage)) {
                    resetJourney();
                    setTimeout(() => {
                        startPortalSequence();
                    }, 1000);
                }
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            console.log('Processing user input:', inputText);
            localStorage.setItem('temarix_v4_portal20_response', JSON.stringify({
                portal: "v4-20",
                resposta: inputText,
                step: awaitingSecondResponse ? "second" : "first",
                data: new Date().toISOString(),
                idioma: currentLanguage
            }));
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                if (!awaitingSecondResponse) {
                    showUserReactions(inputText);
                } else {
                    showSecondUserReactions(inputText);
                }
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showFollowUpQuestion();
            }, 2000);
        }
        
        async function showFollowUpQuestion() {
            const followUpSection = document.getElementById('followUpSection');
            const followUpQuestionEl = document.getElementById('followUpQuestion');
            
            followUpSection.classList.add('show');
            
            await typewriterEffect(followUpQuestionEl, translations[currentLanguage].followUpQuestion, 50);
            
            setTimeout(() => {
                awaitingSecondResponse = true;
                enableUserInput();
            }, 1500);
        }
        
        async function showSecondUserReactions(userInput) {
            const secondResponseCharacters = [
                {
                    name: "Noah", emoji: "üßë‚Äçü¶±",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Í∑∏ Î¨∏Ïû•ÏùÄ ÎÅùÏù¥ ÏïÑÎãàÎùº ÏãúÏûëÏù¥ÏóêÏöî. Ïù¥Ï†ú ÎãπÏã†ÏùÄ ÏÉàÎ°úÏö¥ Ïù¥ÏïºÍ∏∞Î•º Ïì∏ Ïàò ÏûàÏñ¥Ïöî.",
                            en: "That sentence isn't an ending but a beginning. Now you can write a new story.",
                            pt: "Essa frase n√£o √© um fim, mas um come√ßo. Agora voc√™ pode escrever uma nova hist√≥ria."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Kael", emoji: "üßô",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÎØ∏ÏôÑÏùò Í∞êÏ†ïÏùÑ ÏôÑÏÑ±Îêú Í∏∞ÏñµÏúºÎ°ú Î∞îÍæ∏Îäî Í±¥, Í≥ºÍ±∞Î•º ÏπòÏú†ÌïòÎäî ÎßàÎ≤ïÏù¥ÏóêÏöî.",
                            en: "Transforming incomplete emotions into complete memories is magic that heals the past.",
                            pt: "Transformar emo√ß√µes incompletas em mem√≥rias completas √© m√°gica que cura o passado."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Mira", emoji: "üßë‚Äçüé®",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÎãπÏã†Ïù¥ Ïç®ÎÇ¥Î†§Í∞Ñ Í∑∏ ÎßàÏßÄÎßâ Î¨∏Ïû•Ïù¥, ÏïûÏúºÎ°úÏùò Î™®Îì† ÌéòÏù¥ÏßÄÎ•º Î∞ùÌûê Í±∞ÏòàÏöî.",
                            en: "That final sentence you wrote will illuminate all the pages to come.",
                            pt: "Essa frase final que voc√™ escreveu iluminar√° todas as p√°ginas por vir."
                        };
                        return responses[lang];
                    }
                }
            ];
            
            const reactionsSection = document.getElementById('userReactionsSection');
            
            for (let i = 0; i < secondResponseCharacters.length; i++) {
                const char = secondResponseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < secondResponseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showNavigationSection();
            }, 2000);
        }
        
        async function showNavigationSection() {
            const navigationSection = document.getElementById('navigationSection');
            const navigationMessage = document.getElementById('navigationMessage');
            
            navigationSection.classList.add('show');
            
            const messageText = translations[currentLanguage].navigationMessage;
            await typewriterEffect(navigationMessage, messageText, 50);
            
            setTimeout(() => {
                scrollToElement(navigationSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('Temarix V4 Portal 20 initialized');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                enableUserInput();
            }, 2000);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V4 Portal 20 DOM loaded');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>