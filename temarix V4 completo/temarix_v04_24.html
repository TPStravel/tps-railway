<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V4 - Portal 24: One Lost Name</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ff9999;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #ff6b6b;
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 200vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            transition: opacity 0.8s ease-in;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #ff6b6b;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .follow-up-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .follow-up-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            text-align: center;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            white-space: pre-wrap;
        }
        
        .user-response strong {
            color: #ff6b6b;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #ff6b6b;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-section {
            margin: 60px 0;
            opacity: 0;
            text-align: center;
            padding: 40px 20px;
            min-height: 300px;
            border: 2px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }
        
        .navigation-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: bold;
        }
        
        .navigation-message {
            color: #fff;
            font-size: 20px;
            margin-bottom: 40px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 20px 40px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
            border: 2px solid transparent;
        }
        
        .nav-btn:hover {
            background: #666;
            border-color: #ff6b6b;
        }
        
        .nav-btn.primary {
            background: #ff6b6b;
            color: #fff;
            font-weight: bold;
        }
        
        .nav-btn.primary:hover {
            background: #ff8888;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .input-fixed-bottom {
            position: relative;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #ff6b6b;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #ff6b6b;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .follow-up-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V4</div>
            <div class="logo-subtitle" id="logoSubtitle">Emotional Alchemy</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 24: One Lost Name</div>
            <div class="portal-subtitle" id="portalSubtitle">Forgotten echoes</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="follow-up-section" id="followUpSection">
                <div class="follow-up-question" id="followUpQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>
            
            <div class="navigation-section" id="navigationSection">
                <div class="navigation-title" id="navigationTitle">Portal 24 Complete</div>
                <div class="navigation-message" id="navigationMessage"></div>
                <div class="navigation-buttons">
                    <button class="nav-btn primary" id="nextPortalBtn">Continue to Portal 25</button>
                    <button class="nav-btn" id="stayPortalBtn">Stay with this memory</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Is there a lost name from your past? Whose name was it and why did it fade from your life?"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        const translations = {
            ko: {
                logoSubtitle: "Í∞êÏ†ï Ïó∞Í∏àÏà†",
                portalMainTitle: "Portal 24: ÏûÉÏñ¥Î≤ÑÎ¶∞ Ïù¥Î¶Ñ ÌïòÎÇò",
                portalSubtitle: "ÏûäÌûå Ïö∏Î¶ºÎì§",
                portalIntro: "ÏßÄÎÇòÏò® ÏÇ∂ ÏÜçÏóêÏÑú,\nÎãπÏã†Ïù¥ ÏûäÏñ¥Î≤ÑÎ¶∞ 'Ïù¥Î¶Ñ ÌïòÎÇò'Í∞Ä ÏûàÎã§Î©¥,\nÍ∑∏Í±¥ ÎàÑÍµ¨Ïùò Ïù¥Î¶ÑÏù¥ÏóàÎÇòÏöî?\n\nÍ∑∏ Ïù¥Î¶ÑÏùÄ Ïôú ÏûäÌûàÍ≤å ÎêòÏóàÍ≥†,\nÏßÄÍ∏à ÎãπÏã† ÏïàÏóê Ïñ¥Îñ§ Í∞êÏ†ïÏúºÎ°ú ÎÇ®ÏïÑ ÏûàÎÇòÏöî?",
                followUpQuestion: "Í∑∏ Ïù¥Î¶ÑÏóêÍ≤å,\nÏßÄÍ∏à Îã® Ìïú Î¨∏Ïû•ÏùÑ Ï†ÑÌïúÎã§Î©¥\nÏñ¥Îñ§ ÎßêÏùÑ Ìï¥Ï£ºÍ≥† Ïã∂ÎÇòÏöî?",
                lightTitle: "ÎπõÏùò ÌïúÎßàÎîî",
                lightMessage: "Í∞êÏ†ïÏùÄ ÌùêÎ•¥Í≥† ÌùòÎü¨ Í≤∞Íµ≠ ÎßêÏù¥ ÎèºÏöî. ÎãπÏã†ÏùÄ ÏßÄÍ∏à, Í∑∏ ÎßêÏùÑ ÏôÑÏÑ±ÌñàÏñ¥Ïöî.\nÏûÉÏñ¥Î≤ÑÎ¶∞ Ïù¥Î¶ÑÏùÄ Îã§Ïãú Î∂ÄÎ•º Ïàò ÏûàÏùÑ Îïå ÎßàÏùåÏùò Ï°∞Í∞ÅÏù¥ ÎèåÏïÑÏò§Îäî Í±∞ÏòàÏöî.\nÎãπÏã†ÏùÄ ÏßÄÍ∏à, ÎèåÏïÑÏò§Îäî Ï§ëÏù¥ÏóêÏöî.",
                navigationTitle: "Portal 24 ÏôÑÎ£å",
                navigationMessage: "ÎãπÏã†ÏùÄ ÏûÉÏñ¥Î≤ÑÎ¶∞ Ïù¥Î¶ÑÏùÑ ÌÜµÌï¥ ÏûêÏã† ÏïàÏùò ÏûäÌûå Í∞êÏ†ïÏùÑ Í∫ºÎÉàÏäµÎãàÎã§.\n\nÍ∑∏ Ïù¥Î¶ÑÏùÑ Îã§Ïãú Î∂ÄÎ•¥Î©∞, Í≥ºÍ±∞Ïùò ÏÜåÏ§ëÌïú Í¥ÄÍ≥ÑÏôÄ ÌôîÌï¥Ìï† Ïàò ÏûàÍ≤å ÎêòÏóàÏäµÎãàÎã§.\n\nÏù¥Ï†ú ÎãπÏã†ÏùÄ Í∏∞Ïñµ ÏÜçÏóê Î¨ªÌûå Í∞êÏ†ïÎì§ÏùÑ Ïù∏Ï†ïÌïòÍ≥†, Í∑∏Í≤ÉÎì§Í≥º Ìï®Íªò ÏÑ±Ïû•Ìï† Ïàò ÏûàÎäî ÌûòÏùÑ ÏñªÏóàÏäµÎãàÎã§.",
                nextPortalBtn: "Portal 25Î°ú Ïù¥Ïñ¥Í∞ÄÍ∏∞",
                stayPortalBtn: "Ïù¥ Í∏∞ÏñµÍ≥º Îçî Î®∏Î¨ºÍ∏∞",
                inputPlaceholder: "Í≥ºÍ±∞ÏóêÏÑú ÏûÉÏñ¥Î≤ÑÎ¶∞ Ïù¥Î¶ÑÏù¥ ÏûàÎÇòÏöî? ÎàÑÍµ¨Ïùò Ïù¥Î¶ÑÏù¥ÏóàÍ≥† Ïôú ÎãπÏã† ÏÇ∂ÏóêÏÑú ÏÇ¨ÎùºÏ°åÎÇòÏöî?",
                youLabel: "ÎãπÏã†",
                waitingMessage: "ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë..."
            },
            en: {
                logoSubtitle: "Emotional Alchemy",
                portalMainTitle: "Portal 24: One Lost Name",
                portalSubtitle: "Forgotten echoes",
                portalIntro: "Throughout your life,\nis there 'one lost name' that you have forgotten?\nWhose name was it?\n\nWhy did that name fade away,\nand what emotions does it remain as within you now?",
                followUpQuestion: "To that name,\nif you could say just one sentence now,\nwhat would you want to tell them?",
                lightTitle: "Word of Light",
                lightMessage: "Emotions flow and flow until they finally become words. You have now completed those words.\nWhen a lost name can be called again, pieces of the heart return.\nYou are now in the process of returning.",
                navigationTitle: "Portal 24 Complete",
                navigationMessage: "Through a lost name, you have brought out forgotten emotions within yourself.\n\nBy calling that name again, you have become able to reconcile with precious relationships from the past.\n\nNow you have gained the strength to acknowledge emotions buried in memory and grow together with them.",
                nextPortalBtn: "Continue to Portal 25",
                stayPortalBtn: "Stay with this memory",
                inputPlaceholder: "Is there a lost name from your past? Whose name was it and why did it fade from your life?",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "Alquimia Emocional",
                portalMainTitle: "Portal 24: Um Nome Perdido",
                portalSubtitle: "Ecos esquecidos",
                portalIntro: "Ao longo de sua vida,\nexiste 'um nome perdido' que voc√™ esqueceu?\nDe quem era esse nome?\n\nPor que esse nome desapareceu,\ne que emo√ß√µes ele permanece como dentro de voc√™ agora?",
                followUpQuestion: "Para esse nome,\nse voc√™ pudesse dizer apenas uma frase agora,\no que gostaria de dizer?",
                lightTitle: "Palavra de Luz",
                lightMessage: "As emo√ß√µes fluem e fluem at√© finalmente se tornarem palavras. Voc√™ agora completou essas palavras.\nQuando um nome perdido pode ser chamado novamente, peda√ßos do cora√ß√£o retornam.\nVoc√™ est√° agora no processo de retornar.",
                navigationTitle: "Portal 24 Completo",
                navigationMessage: "Atrav√©s de um nome perdido, voc√™ trouxe emo√ß√µes esquecidas de dentro de si.\n\nAo chamar esse nome novamente, voc√™ se tornou capaz de se reconciliar com relacionamentos preciosos do passado.\n\nAgora voc√™ ganhou a for√ßa para reconhecer emo√ß√µes enterradas na mem√≥ria e crescer junto com elas.",
                nextPortalBtn: "Continuar para Portal 25",
                stayPortalBtn: "Ficar com esta mem√≥ria",
                inputPlaceholder: "Existe um nome perdido do seu passado? De quem era e por que desapareceu da sua vida?",
                youLabel: "Voc√™",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Noah", emoji: "üßë‚Äçü¶±", text: {
                ko: "Í∑∏ Ïù¥Î¶ÑÏùÄ ÏûäÌûå Í≤å ÏïÑÎãàÏïº. Îã®ÏßÄ, ÎÑ§ Í∏∞ÏñµÏùò ÏïàÏ™ΩÏóêÏÑú Ï°∞Ïö©Ìûà Ïà® Ïâ¨Í≥† ÏûàÏóàÎçò Í±∞Ïïº.",
                en: "That name wasn't forgotten. It was just quietly breathing inside your memory.",
                pt: "Esse nome n√£o foi esquecido. Estava apenas respirando silenciosamente dentro de sua mem√≥ria."
            }},
            { name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è", text: {
                ko: "Ïù¥Î¶Ñ ÌïòÎÇòÍ∞Ä ÏÇ∂Ïùò Ï°∞Í∞ÅÏù¥ ÎêòÍ∏∞ÎèÑ Ìï¥Ïöî. Í∑∏ Ï°∞Í∞ÅÏù¥ Îπ†ÏßÑ ÏûêÎ¶¨Ïóî ÏÑ§Î™ÖÌï† Ïàò ÏóÜÎäî Í∞êÏ†ïÏù¥ ÎÇ®ÏïòÏùÑ Í±∞Ïïº.",
                en: "One name can become a piece of life. Where that piece is missing, unexplainable emotions must remain.",
                pt: "Um nome pode se tornar um peda√ßo da vida. Onde essa pe√ßa est√° faltando, emo√ß√µes inexplic√°veis devem permanecer."
            }},
            { name: "Sora", emoji: "üßï", text: {
                ko: "Í∑∏ ÏïÑÏù¥Ïùò Ïù¥Î¶ÑÏùÑ Îñ†Ïò¨Î¶¨Îäî Í±¥, ÎÑ§Í∞Ä ÏûäÏßÄ ÏïäÏïòÎã§Îäî Ï¶ùÍ±∞Ïïº. Í∑∏Î¶¨Í≥† Í∑∏ Í∞êÏ†ïÏùÄ ÏïÑÏßÅÎèÑ Îî∞ÎúªÌï¥Ïöî.",
                en: "Remembering that child's name is proof that you haven't forgotten. And that emotion is still warm.",
                pt: "Lembrar do nome dessa crian√ßa √© prova de que voc√™ n√£o esqueceu. E essa emo√ß√£o ainda est√° quente."
            }},
            { name: "Kael", emoji: "üßô", text: {
                ko: "ÏûÉÏñ¥Î≤ÑÎ¶∞ Ïù¥Î¶ÑÏùÄ Í≥ºÍ±∞Í∞Ä ÏïÑÎãàÎùº ÎÑàÏùò ÏùºÎ∂ÄÏïº. ÎÑàÎäî Í∑∏ Ï°∞Í∞ÅÏùÑ ÏßÄÍ∏à ÎêòÏ∞æÍ≥† ÏûàÎäî Í±∞Ïïº.",
                en: "A lost name isn't the past but a part of you. You're now reclaiming that piece.",
                pt: "Um nome perdido n√£o √© o passado, mas uma parte de voc√™. Voc√™ est√° agora recuperando essa pe√ßa."
            }},
            { name: "Mira", emoji: "üßë‚Äçüé®", text: {
                ko: "Í∑∏ Ïù¥Î¶ÑÏùÄ Îã®ÏàúÌïú Í∏∞ÏñµÏù¥ ÏïÑÎãàÎùº, ÎÑàÏùò ÏãúÏ†à ÌïòÎÇòÏòÄÍ≤†ÏßÄ. Í∑∏ ÏãúÏ†àÏùò Í∞êÏ†ïÏù¥ ÏßÄÍ∏àÎèÑ ÌùêÎ•¥Í≥† ÏûàÏñ¥.",
                en: "That name wasn't just a simple memory, but one of your seasons. The emotions from that time are still flowing.",
                pt: "Esse nome n√£o era apenas uma mem√≥ria simples, mas uma de suas esta√ß√µes. As emo√ß√µes daquele tempo ainda est√£o fluindo."
            }},
            { name: "Cris", emoji: "ü¶∏‚Äç‚ôÇÔ∏è", text: {
                ko: "ÏÇ¨ÎûåÎì§ÏùÄ Ïôú Í∑∏Î†áÍ≤å ÏâΩÍ≤å ÏÇ¨ÎùºÏßÄÎäî Í±∏Íπå? ÎÇ®Í≤®ÏßÑ ÎßàÏùåÏùÄ Ïñ∏Ï†úÎÇò Ïù¥Î¶ÑÎ∂ÄÌÑ∞ ÏßÄÏõåÏ†∏.",
                en: "Why do people disappear so easily? The hearts left behind always have their names erased first.",
                pt: "Por que as pessoas desaparecem t√£o facilmente? Os cora√ß√µes deixados para tr√°s sempre t√™m seus nomes apagados primeiro."
            }},
            { name: "Enya", emoji: "üßë‚ÄçüöÄ", text: {
                ko: "Í∑∏ Ïù¥Î¶ÑÏùÑ Îã§Ïãú Î∂àÎ†ÄÎã§Îäî Í±¥ ÎÑàÏùò ÎßàÏùåÏù¥ Í∑∏ Í∏∞ÏñµÍ≥º ÌôîÌï¥ÌïòÍ≥† Ïã∂Îã§Îäî Ïã†Ìò∏Ïïº.",
                en: "Calling that name again is a signal that your heart wants to reconcile with that memory.",
                pt: "Chamar esse nome novamente √© um sinal de que seu cora√ß√£o quer se reconciliar com essa mem√≥ria."
            }},
            { name: "Lian", emoji: "üßò", text: {
                ko: "ÏßÄÍ∏à ÎãπÏã†ÏùÄ Í∑∏ ÏûÉÏñ¥Î≤ÑÎ¶∞ Ïù¥Î¶ÑÏùÑ ÌÜµÌï¥ ÏûêÏã† ÏïàÏùò ÏûäÌûå Í∞êÏ†ïÏùÑ Í∫ºÎÇ¥Í≥† ÏûàÏñ¥Ïöî. Í∑∏Í±¥ ÏïÑÎ¶ÑÎã§Ïö¥ ÌöåÎ≥µÏù¥ÏóêÏöî.",
                en: "Right now you are bringing out forgotten emotions within yourself through that lost name. That is beautiful recovery.",
                pt: "Agora voc√™ est√° trazendo emo√ß√µes esquecidas dentro de voc√™ atrav√©s desse nome perdido. Essa √© uma bela recupera√ß√£o."
            }}
        ];

        const responseCharacters = [
            {
                name: "Sora", emoji: "üßï",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Í∑∏ Ìïú Î¨∏Ïû•ÏùÄ Ïù¥Î¶ÑÎ≥¥Îã§ Îçî Ïò§Îûò ÎÇ®ÏùÑ Í±∞ÏòàÏöî. Í∑∏Í±¥ ÏßÑÏã¨Ïùò Ï¶ùÍ±∞ÎãàÍπåÏöî.",
                        en: "That one sentence will last longer than the name. Because it's proof of sincerity.",
                        pt: "Essa frase durar√° mais que o nome. Porque √© prova de sinceridade."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Lian", emoji: "üßò",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Í∞êÏ†ïÏùÄ ÌùêÎ•¥Í≥† ÌùòÎü¨ Í≤∞Íµ≠ ÎßêÏù¥ ÎèºÏöî. ÎãπÏã†ÏùÄ ÏßÄÍ∏à, Í∑∏ ÎßêÏùÑ ÏôÑÏÑ±ÌñàÏñ¥Ïöî.",
                        en: "Emotions flow and flow until they finally become words. You have now completed those words.",
                        pt: "As emo√ß√µes fluem e fluem at√© finalmente se tornarem palavras. Voc√™ agora completou essas palavras."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Enya", emoji: "üßë‚ÄçüöÄ",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÏûÉÏñ¥Î≤ÑÎ¶∞ Ïù¥Î¶ÑÏùÄ Îã§Ïãú Î∂ÄÎ•º Ïàò ÏûàÏùÑ Îïå ÎßàÏùåÏùò Ï°∞Í∞ÅÏù¥ ÎèåÏïÑÏò§Îäî Í±∞ÏòàÏöî. ÎãπÏã†ÏùÄ ÏßÄÍ∏à, ÎèåÏïÑÏò§Îäî Ï§ëÏù¥ÏóêÏöî.",
                        en: "When a lost name can be called again, pieces of the heart return. You are now in the process of returning.",
                        pt: "Quando um nome perdido pode ser chamado novamente, peda√ßos do cora√ß√£o retornam. Voc√™ est√° agora no processo de retornar."
                    };
                    return responses[lang];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        let awaitingSecondResponse = false;
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('navigationTitle').textContent = translations[lang].navigationTitle;
            document.getElementById('nextPortalBtn').textContent = translations[lang].nextPortalBtn;
            document.getElementById('stayPortalBtn').textContent = translations[lang].stayPortalBtn;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'followUpSection', 'userInputSection',
                'userReactionsSection', 'lightMessageSection', 'navigationSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('followUpQuestion').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('navigationMessage').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
            awaitingSecondResponse = false;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('nextPortalBtn').addEventListener('click', function() {
                localStorage.setItem('temarix_v4_portal24_complete', 'true');
                localStorage.setItem('temarix_v4_current_portal', '25');
                
                const nextMessage = currentLanguage === 'ko' ? 
                    'Portal 25: Îã§Ïãú ÎÇòÏóêÍ≤åÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§.' :
                    currentLanguage === 'en' ? 
                    'Moving to Portal 25: Back to Myself.' :
                    'Indo para Portal 25: De Volta para Mim Mesmo.';
                alert(nextMessage);
            });
            
            document.getElementById('stayPortalBtn').addEventListener('click', function() {
                const stayMessage = currentLanguage === 'ko' ? 
                    'Ïù¥ Í∏∞ÏñµÍ≥º Îçî Î®∏Î¨ºÎ©∞ ÍπäÏù¥ ÏÑ±Ï∞∞ÌïòÏãúÍ≤†ÏäµÎãàÍπå?' :
                    currentLanguage === 'en' ? 
                    'Do you want to stay longer with this memory for deeper reflection?' :
                    'Deseja ficar mais tempo com esta mem√≥ria para reflex√£o mais profunda?';
                
                if (confirm(stayMessage)) {
                    resetJourney();
                    setTimeout(() => {
                        startPortalSequence();
                    }, 1000);
                }
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            console.log('Processing user input:', inputText);
            localStorage.setItem('temarix_v4_portal24_response', JSON.stringify({
                portal: "v4-24",
                resposta: inputText,
                step: awaitingSecondResponse ? "second" : "first",
                data: new Date().toISOString(),
                idioma: currentLanguage
            }));
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                if (!awaitingSecondResponse) {
                    showUserReactions(inputText);
                } else {
                    showSecondUserReactions(inputText);
                }
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showFollowUpQuestion();
            }, 2000);
        }
        
        async function showFollowUpQuestion() {
            const followUpSection = document.getElementById('followUpSection');
            const followUpQuestionEl = document.getElementById('followUpQuestion');
            
            followUpSection.classList.add('show');
            
            await typewriterEffect(followUpQuestionEl, translations[currentLanguage].followUpQuestion, 50);
            
            setTimeout(() => {
                awaitingSecondResponse = true;
                enableUserInput();
            }, 1500);
        }
        
        async function showSecondUserReactions(userInput) {
            const secondResponseCharacters = [
                {
                    name: "Noah", emoji: "üßë‚Äçü¶±",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Í∑∏ ÎßêÏùÄ Í∑∏ Ïù¥Î¶ÑÏóêÍ≤å ÎèÑÏ∞©ÌñàÏñ¥. ÏãúÍ∞ÑÏùÑ ÎÑòÏñ¥ÏÑú, ÎßàÏùåÏùÑ ÎÑòÏñ¥ÏÑú.",
                            en: "Those words have reached that name. Beyond time, beyond heart.",
                            pt: "Essas palavras chegaram at√© esse nome. Al√©m do tempo, al√©m do cora√ß√£o."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Mira", emoji: "üßë‚Äçüé®",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Ïù¥Ï†ú Í∑∏ Ïù¥Î¶ÑÏùÄ Îã§Ïãú ÏÉâÏùÑ Í∞ÄÏ°åÏñ¥Ïöî. ÎãπÏã†Ïùò ÎßàÏùå ÏÜçÏóêÏÑú ÏÇ¥ÏïÑÎÇòÍ≥† ÏûàÏñ¥Ïöî.",
                            en: "Now that name has color again. It's coming alive in your heart.",
                            pt: "Agora esse nome tem cor novamente. Est√° ganhando vida em seu cora√ß√£o."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Kael", emoji: "üßô",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÏûÉÏñ¥Î≤ÑÎ¶∞ Ïù¥Î¶ÑÏùÑ ÎêòÏ∞æÎäîÎã§Îäî Í±¥, ÏûêÏã†Ïùò ÏùºÎ∂ÄÎ•º ÎêòÏ∞æÎäî Í≤ÉÍ≥º Í∞ôÏïÑ.",
                            en: "Reclaiming a lost name is like reclaiming a part of yourself.",
                            pt: "Recuperar um nome perdido √© como recuperar uma parte de si mesmo."
                        };
                        return responses[lang];
                    }
                }
            ];
            
            const reactionsSection = document.getElementById('userReactionsSection');
            
            for (let i = 0; i < secondResponseCharacters.length; i++) {
                const char = secondResponseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < secondResponseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showNavigationSection();
            }, 2000);
        }
        
        async function showNavigationSection() {
            const navigationSection = document.getElementById('navigationSection');
            const navigationMessage = document.getElementById('navigationMessage');
            
            navigationSection.classList.add('show');
            
            const messageText = translations[currentLanguage].navigationMessage;
            await typewriterEffect(navigationMessage, messageText, 50);
            
            setTimeout(() => {
                scrollToElement(navigationSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('Temarix V4 Portal 24 initialized');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                enableUserInput();
            }, 2000);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V4 Portal 24 DOM loaded');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>