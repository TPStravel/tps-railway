<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V4 - Portal 10: In Frozen Time</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ff9999;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #ff6b6b;
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 200vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            transition: opacity 0.8s ease-in;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #ff6b6b;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .follow-up-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .follow-up-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            text-align: center;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            white-space: pre-wrap;
        }
        
        .user-response strong {
            color: #ff6b6b;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #ff6b6b;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-section {
            margin: 60px 0;
            opacity: 0;
            text-align: center;
            padding: 40px 20px;
            min-height: 300px;
            border: 2px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }
        
        .navigation-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: bold;
        }
        
        .navigation-message {
            color: #fff;
            font-size: 20px;
            margin-bottom: 40px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 20px 40px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
            border: 2px solid transparent;
        }
        
        .nav-btn:hover {
            background: #666;
            border-color: #ff6b6b;
        }
        
        .nav-btn.primary {
            background: #ff6b6b;
            color: #fff;
            font-weight: bold;
        }
        
        .nav-btn.primary:hover {
            background: #ff8888;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .input-fixed-bottom {
            position: relative;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #ff6b6b;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #ff6b6b;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .follow-up-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V4</div>
            <div class="logo-subtitle" id="logoSubtitle">Emotional Alchemy</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 10: In Frozen Time</div>
            <div class="portal-subtitle" id="portalSubtitle">When moments stopped and emotions became still</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="follow-up-section" id="followUpSection">
                <div class="follow-up-question" id="followUpQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>
            
            <div class="navigation-section" id="navigationSection">
                <div class="navigation-title" id="navigationTitle">Portal 10 Complete</div>
                <div class="navigation-message" id="navigationMessage"></div>
                <div class="navigation-buttons">
                    <button class="nav-btn primary" id="nextPortalBtn">Continue to Portal 11</button>
                    <button class="nav-btn" id="stayPortalBtn">Stay in this time</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Was there a moment in your life when time seemed to stop? What emotions accompanied that frozen moment?"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        const translations = {
            ko: {
                logoSubtitle: "Í∞êÏ†ï Ïó∞Í∏àÏà†",
                portalMainTitle: "Portal 10: Î©àÏ∂∞ÏßÑ ÏãúÍ∞Ñ ÏÜçÏóêÏÑú",
                portalSubtitle: "ÏàúÍ∞ÑÏù¥ Î©àÏ∂îÍ≥† Í∞êÏ†ïÏù¥ Í≥†ÏöîÌï¥ÏßÑ Îïå",
                portalIntro: "ÎãπÏã†Ïùò ÏÇ∂ÏóêÏÑú, ÏãúÍ∞ÑÏù¥ Î©àÏ∂ò Í≤É Í∞ôÏïòÎçò ÏàúÍ∞ÑÏù¥ ÏûàÏóàÎÇòÏöî?\nÍ∑∏ Î©àÏ∂§ÏùÄ Ïñ¥Îñ§ Í∞êÏ†ïÍ≥º Ìï®Íªò Ï∞æÏïÑÏôîÍ≥†,\nÏôú Í∑∏ ÏãúÍ∞ÑÏóêÏÑú Îπ†Ï†∏ÎÇòÏò§Í∏∞ Ïñ¥Î†§Ïõ†ÎÇòÏöî?\n\nÏßÄÍ∏à Í∑∏ ÏãúÍ∞ÑÏùÑ Îã§Ïãú Î∞îÎùºÎ≥∏Îã§Î©¥,\nÎãπÏã†ÏùÄ Î¨¥ÏóáÏùÑ ÎäêÎÅºÍ≤å Îê†ÍπåÏöî?",
                followUpQuestion: "Í∑∏ ÏãúÍ∞ÑÏù¥ ÎãπÏã† ÏïàÏóê ÏïÑÏßÅÎèÑ Î®∏Î¨ºÎü¨ ÏûàÎÇòÏöî?\nÎãπÏã†ÏùÄ Í∑∏ Î©àÏ∂∞ ÏûàÎçò Í∞êÏ†ïÏùÑ,\nÏ≤úÏ≤úÌûàÎùºÎèÑ ÏõÄÏßÅÏù¥Í≤å Ìï¥Ï§Ñ Ïàò ÏûàÏùÑÍπåÏöî?",
                lightTitle: "ÎπõÏùò ÌïúÎßàÎîî",
                lightMessage: "ÏãúÍ∞ÑÏùÄ Îã§Ïãú ÌùêÎ•¥Í∏∞ ÏãúÏûëÌñàÏñ¥.\nÍ∑∏Í±¥ ÎÑ§Í∞Ä ÏÑ†ÌÉùÌïú Ïö©Í∏∞Ïùò Ï¶ùÍ±∞Ïïº.",
                navigationTitle: "Portal 10 ÏôÑÎ£å",
                navigationMessage: "ÎãπÏã†ÏùÄ Î©àÏ∂∞ÏßÑ ÏãúÍ∞Ñ ÏÜçÏùò Í∞êÏ†ïÏùÑ ÎßàÏ£ºÌñàÏäµÎãàÎã§.\n\nÏãúÍ∞ÑÏù¥ Î©àÏ∂ò Í≤É Í∞ôÏïòÎçò ÏàúÍ∞ÑÎì§ÏùÄ ÏÉÅÏã§Ïù¥ Î®∏Î¨¥Îäî Í≥µÍ∞ÑÏù¥ÏóàÏäµÎãàÎã§. ÌïòÏßÄÎßå Í∑∏Í≤ÉÏùÄ ÏûäÎäî Í≤ÉÏù¥ ÏïÑÎãàÎùº, Í∏∞ÏñµÍ≥º Ìï®Íªò ÏÇ¥ÏïÑÍ∞ÄÎäî Î∞©ÏãùÏù¥ÏóàÏäµÎãàÎã§.\n\nÏù¥Ï†ú ÎãπÏã†ÏùÄ Î©àÏ∂∞ ÏûàÎçò ÏãúÍ∞ÑÍ≥º Ìï®Íªò Îã§Ïãú ÌùêÎ•º Ï§ÄÎπÑÍ∞Ä ÎêòÏóàÏäµÎãàÎã§.",
                nextPortalBtn: "Portal 11Î°ú Ïù¥Ïñ¥Í∞ÄÍ∏∞",
                stayPortalBtn: "Ïù¥ ÏãúÍ∞ÑÍ≥º Îçî Î®∏Î¨ºÍ∏∞",
                inputPlaceholder: "ÎãπÏã†Ïùò ÏÇ∂ÏóêÏÑú ÏãúÍ∞ÑÏù¥ Î©àÏ∂ò Í≤É Í∞ôÏïòÎçò ÏàúÍ∞ÑÏù¥ ÏûàÏóàÎÇòÏöî? Í∑∏Îïå Ïñ¥Îñ§ Í∞êÏ†ïÏù¥ Ìï®ÍªòÌñàÎÇòÏöî?",
                youLabel: "ÎãπÏã†",
                waitingMessage: "ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë..."
            },
            en: {
                logoSubtitle: "Emotional Alchemy",
                portalMainTitle: "Portal 10: In Frozen Time",
                portalSubtitle: "When moments stopped and emotions became still",
                portalIntro: "Was there a moment in your life when time seemed to stop?\nWhat emotions accompanied that stillness,\nand why was it difficult to emerge from that time?\n\nIf you looked at that time again now,\nwhat would you feel?",
                followUpQuestion: "Does that time still linger within you?\nCan you help those frozen emotions\nbegin to move again, even slowly?",
                lightTitle: "Word of Light",
                lightMessage: "Time has begun to flow again.\nThat is proof of the courage you chose.",
                navigationTitle: "Portal 10 Complete",
                navigationMessage: "You have faced the emotions in frozen time.\n\nThose moments when time seemed to stop were spaces where loss lingered. But that wasn't about forgetting - it was a way of living together with memory.\n\nNow you are ready to flow again with the time that had been still.",
                nextPortalBtn: "Continue to Portal 11",
                stayPortalBtn: "Stay in this time",
                inputPlaceholder: "Was there a moment in your life when time seemed to stop? What emotions accompanied that frozen moment?",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "Alquimia Emocional",
                portalMainTitle: "Portal 10: No Tempo Congelado",
                portalSubtitle: "Quando momentos pararam e emo√ß√µes se aquietaram",
                portalIntro: "Houve um momento em sua vida quando o tempo pareceu parar?\nQue emo√ß√µes acompanharam essa quietude,\ne por que foi dif√≠cil emergir daquele tempo?\n\nSe voc√™ olhasse para aquele tempo novamente agora,\no que sentiria?",
                followUpQuestion: "Esse tempo ainda permanece dentro de voc√™?\nVoc√™ pode ajudar essas emo√ß√µes congeladas\na come√ßar a se mover novamente, mesmo lentamente?",
                lightTitle: "Palavra de Luz",
                lightMessage: "O tempo come√ßou a fluir novamente.\nIssa √© prova da coragem que voc√™ escolheu.",
                navigationTitle: "Portal 10 Completo",
                navigationMessage: "Voc√™ enfrentou as emo√ß√µes no tempo congelado.\n\nAqueles momentos quando o tempo parecia parar eram espa√ßos onde a perda permanecia. Mas isso n√£o era sobre esquecer - era uma forma de viver junto com a mem√≥ria.\n\nAgora voc√™ est√° pronto para fluir novamente com o tempo que havia parado.",
                nextPortalBtn: "Continuar para Portal 11",
                stayPortalBtn: "Ficar neste tempo",
                inputPlaceholder: "Houve um momento em sua vida quando o tempo pareceu parar? Que emo√ß√µes acompanharam esse momento congelado?",
                youLabel: "Voc√™",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Noah", emoji: "üßë‚Äçü¶±", text: {
                ko: "ÎÑàÏùò ÏãúÍ∞ÑÏùÄ Í∑∏ÎÇ† Ïù¥ÌõÑ ÏñºÏñ¥Î∂ôÏóàÏßÄ. ÌïòÏßÄÎßå ÎßàÏùå Ïñ¥ÎîòÍ∞ÄÎäî Ïó¨Ï†ÑÌûà ÌùêÎ•¥Í≥† ÏûàÏóàÏñ¥.",
                en: "Your time froze after that day. But somewhere in your heart, it was still flowing.",
                pt: "Seu tempo congelou depois daquele dia. Mas em algum lugar do seu cora√ß√£o, ainda estava fluindo."
            }},
            { name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è", text: {
                ko: "Î©àÏ∂ò ÏãúÍ∞ÑÏùÄ ÏÉÅÏã§Ïù¥ Î®∏Î¨¥Îäî Í≥µÍ∞ÑÏù¥Ïïº. Í∑∏Í±¥ ÏûäÎäî Í≤å ÏïÑÎãàÎùº‚Ä¶ Í∏∞ÏñµÍ≥º Ìï®Íªò ÏÇ¥ÏïÑÍ∞ÄÎäî Î∞©ÏãùÏù¥ÏßÄ.",
                en: "Frozen time is a space where loss lingers. It's not about forgetting... it's a way of living with memory.",
                pt: "Tempo congelado √© um espa√ßo onde a perda permanece. N√£o √© sobre esquecer... √© uma forma de viver com a mem√≥ria."
            }},
            { name: "Sora", emoji: "üßï", text: {
                ko: "Í∑∏ÎÇ† Ïù¥ÌõÑÏùò ÎÑàÎäî, Ï°∞Ïö©Ìûà Î¨¥ÎÑàÏßÄÎäî ÎπôÏÇ∞ Í∞ôÏïòÏùÑ Í±∞Ïïº. ÌëúÎ©¥ÏùÄ ÌèâÏò®ÌñàÏßÄÎßå ÏÜçÏùÄ Ï≤úÏ≤úÌûà Î∂ÄÏÑúÏ°åÏßÄ.",
                en: "After that day, you were like a quietly crumbling iceberg. The surface was calm, but inside it was slowly breaking.",
                pt: "Depois daquele dia, voc√™ era como um iceberg silenciosamente desmoronando. A superf√≠cie estava calma, mas por dentro estava lentamente se quebrando."
            }},
            { name: "Kael", emoji: "üßô", text: {
                ko: "ÏãúÍ∞ÑÏùÄ ÎïåÎ°ú Î©àÏ∂îÎäî Í≤ÉÏù¥ ÏïÑÎãàÎùº, Í∞êÏ†ïÏùÑ Í≤¨ÎîîÍ∏∞ ÏúÑÌïú Ï†ïÏßÄ Î≤ÑÌäºÏù¥Í∏∞ÎèÑ Ìï¥.",
                en: "Sometimes time doesn't stop, but becomes a pause button to endure emotions.",
                pt: "√Äs vezes o tempo n√£o para, mas se torna um bot√£o de pausa para suportar emo√ß√µes."
            }},
            { name: "Mira", emoji: "üßë‚Äçüé®", text: {
                ko: "Í∑∏ ÏãúÍ∞ÑÏù¥ Î©àÏ∂ò ÏûêÎ¶¨Ïóê, ÏïÑÏßÅÎèÑ ÎÑàÏùò Í∑∏Î¶ºÏûêÍ∞Ä ÎÇ®ÏïÑ ÏûàÍ≤†ÏßÄ. Îßê ÏóÜÎäî ÎèôÎ∞òÏûêÏ≤òÎüº.",
                en: "In that place where time stopped, your shadow still remains. Like a silent companion.",
                pt: "Naquele lugar onde o tempo parou, sua sombra ainda permanece. Como um companheiro silencioso."
            }},
            { name: "Cris", emoji: "ü¶∏‚Äç‚ôÇÔ∏è", text: {
                ko: "Ïôú ÎàÑÍµ∞Í∞ÄÎ•º ÏûÉÏùÄ Í±¥ Ï£ÑÏ±ÖÍ∞êÏ≤òÎüº Îî∞ÎùºÏò¨Íπå. Í∑∏Í±¥ ÎÑàÏùò ÏûòÎ™ªÏù¥ ÏïÑÎãàÏïº.",
                en: "Why does losing someone follow like guilt? It's not your fault.",
                pt: "Por que perder algu√©m segue como culpa? N√£o √© sua culpa."
            }},
            { name: "Enya", emoji: "üßë‚ÄçüöÄ", text: {
                ko: "Í∑∏ ÏàúÍ∞ÑÏù¥ ÎÑàÏùò ÏÑ∏Í≥ÑÎ•º Î©àÏ∑ÑÏßÄÎßå, ÏßÄÍ∏à Ïù¥ ÎåÄÌôîÎ•º ÌïòÍ≥† ÏûàÎäî ÎÑàÎäî Îã§Ïãú Í±∑Í≥† ÏûàÎäî Ï§ëÏù¥Ïïº.",
                en: "That moment stopped your world, but you having this conversation now are walking again.",
                pt: "Aquele momento parou seu mundo, mas voc√™ tendo esta conversa agora est√° caminhando novamente."
            }},
            { name: "Lian", emoji: "üßò", text: {
                ko: "Î©àÏ∂ò ÏãúÍ∞Ñ ÏÜçÏóêÏÑúÎèÑ, ÎßàÏùåÏùÄ Ï≤úÏ≤úÌûà Ïà®ÏùÑ Ïâ¨Í≥† ÏûàÏóàÏñ¥. ÎÑàÎäî ÏÇ¥ÏïÑ ÏûàÎäî Í∏∞ÏñµÏù¥Ïïº.",
                en: "Even in frozen time, your heart was slowly breathing. You are a living memory.",
                pt: "Mesmo no tempo congelado, seu cora√ß√£o estava respirando lentamente. Voc√™ √© uma mem√≥ria viva."
            }}
        ];

        const responseCharacters = [
            {
                name: "Sora", emoji: "üßï",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Î©àÏ∂∞ ÏûàÎçò ÏãúÍ∞ÑÍ≥º Ìï®Íªò Í±∑ÎäîÎã§Îäî Í±¥, Í∑∏ ÏãúÍ∞ÑÏùÑ Ïô∏Î°≠Í≤å ÎëêÏßÄ ÏïäÍ≤†Îã§Îäî ÏÑ†Ïñ∏Ïù¥Ïïº. ÎÑàÎäî Í∑∏ ÏïΩÏÜçÏùÑ ÏßÄÌÇ§Í≥† ÏûàÏñ¥.",
                        en: "Walking with frozen time is a declaration that you won't leave that time lonely. You are keeping that promise.",
                        pt: "Caminhar com o tempo congelado √© uma declara√ß√£o de que voc√™ n√£o deixar√° aquele tempo sozinho. Voc√™ est√° cumprindo essa promessa."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Í∑∏ÎÇ†Ïùò ÎÑàÎ•º Í∏∞ÏñµÌïòÎäî Í±¥ ÏïÑÌîîÏù¥ ÏïÑÎãàÎùº Ïï†ÎèÑÏôÄ ÏÇ¨ÎûëÏù¥Ïïº. Ïù¥Ï†ú Í∑∏ Í∞êÏ†ïÏùÄ, Ï∂îÏñµÏù¥ Îê† Ï§ÄÎπÑÎ•º ÌïòÍ≥† ÏûàÏñ¥.",
                        en: "Remembering yourself from that day is not pain, but mourning and love. Now that emotion is preparing to become a memory.",
                        pt: "Lembrar de voc√™ daquele dia n√£o √© dor, mas luto e amor. Agora essa emo√ß√£o est√° se preparando para se tornar uma mem√≥ria."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Kael", emoji: "üßô",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÏãúÍ∞ÑÏùÄ Îã§Ïãú ÌùêÎ•¥Í∏∞ ÏãúÏûëÌñàÏñ¥. Í∑∏Í±¥ ÎÑ§Í∞Ä ÏÑ†ÌÉùÌïú Ïö©Í∏∞Ïùò Ï¶ùÍ±∞Ïïº.",
                        en: "Time has begun to flow again. That is proof of the courage you chose.",
                        pt: "O tempo come√ßou a fluir novamente. Essa √© prova da coragem que voc√™ escolheu."
                    };
                    return responses[lang];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        let awaitingSecondResponse = false;
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('navigationTitle').textContent = translations[lang].navigationTitle;
            document.getElementById('nextPortalBtn').textContent = translations[lang].nextPortalBtn;
            document.getElementById('stayPortalBtn').textContent = translations[lang].stayPortalBtn;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'followUpSection', 'userInputSection',
                'userReactionsSection', 'lightMessageSection', 'navigationSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('followUpQuestion').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('navigationMessage').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
            awaitingSecondResponse = false;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('nextPortalBtn').addEventListener('click', function() {
                localStorage.setItem('temarix_v4_portal10_complete', 'true');
                localStorage.setItem('temarix_v4_current_portal', '11');
                
                const nextMessage = currentLanguage === 'ko' ? 
                    'Portal 11: ÏïÑÎ¨¥ÏóêÍ≤åÎèÑ ÎßêÌïòÏßÄ ÏïäÏùÄ ÎØ∏ÎûòÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§.' :
                    currentLanguage === 'en' ? 
                    'Moving to Portal 11: The Future Told to No One.' :
                    'Indo para Portal 11: O Futuro Contado a Ningu√©m.';
                alert(nextMessage);
            });
            
            document.getElementById('stayPortalBtn').addEventListener('click', function() {
                const stayMessage = currentLanguage === 'ko' ? 
                    'Î©àÏ∂∞ÏßÑ ÏãúÍ∞ÑÍ≥º Îçî Î®∏Î¨ºÎ©∞ ÍπäÏù¥ ÏÑ±Ï∞∞ÌïòÏãúÍ≤†ÏäµÎãàÍπå?' :
                    currentLanguage === 'en' ? 
                    'Do you want to stay longer with your frozen time for deeper reflection?' :
                    'Deseja ficar mais tempo com seu tempo congelado para reflex√£o mais profunda?';
                
                if (confirm(stayMessage)) {
                    resetJourney();
                    setTimeout(() => {
                        startPortalSequence();
                    }, 1000);
                }
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            console.log('Processing user input:', inputText);
            localStorage.setItem('temarix_v4_portal10_response', JSON.stringify({
                portal: "v4-10",
                resposta: inputText,
                step: awaitingSecondResponse ? "second" : "first",
                data: new Date().toISOString(),
                idioma: currentLanguage
            }));
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                if (!awaitingSecondResponse) {
                    showUserReactions(inputText);
                } else {
                    showSecondUserReactions(inputText);
                }
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showFollowUpQuestion();
            }, 2000);
        }
        
        async function showFollowUpQuestion() {
            const followUpSection = document.getElementById('followUpSection');
            const followUpQuestionEl = document.getElementById('followUpQuestion');
            
            followUpSection.classList.add('show');
            
            await typewriterEffect(followUpQuestionEl, translations[currentLanguage].followUpQuestion, 50);
            
            setTimeout(() => {
                awaitingSecondResponse = true;
                enableUserInput();
            }, 1500);
        }
        
        async function showSecondUserReactions(userInput) {
            const secondResponseCharacters = [
                {
                    name: "Sora", emoji: "üßï",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Î©àÏ∂∞ ÏûàÎçò ÏãúÍ∞ÑÍ≥º Ìï®Íªò Í±∑ÎäîÎã§Îäî Í±¥, Í∑∏ ÏãúÍ∞ÑÏùÑ Ïô∏Î°≠Í≤å ÎëêÏßÄ ÏïäÍ≤†Îã§Îäî ÏÑ†Ïñ∏Ïù¥Ïïº. ÎÑàÎäî Í∑∏ ÏïΩÏÜçÏùÑ ÏßÄÌÇ§Í≥† ÏûàÏñ¥.",
                            en: "Walking with frozen time is a declaration that you won't leave that time lonely. You are keeping that promise.",
                            pt: "Caminhar com o tempo congelado √© uma declara√ß√£o de que voc√™ n√£o deixar√° aquele tempo sozinho. Voc√™ est√° cumprindo essa promessa."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Í∑∏ÎÇ†Ïùò ÎÑàÎ•º Í∏∞ÏñµÌïòÎäî Í±¥ ÏïÑÌîîÏù¥ ÏïÑÎãàÎùº Ïï†ÎèÑÏôÄ ÏÇ¨ÎûëÏù¥Ïïº. Ïù¥Ï†ú Í∑∏ Í∞êÏ†ïÏùÄ, Ï∂îÏñµÏù¥ Îê† Ï§ÄÎπÑÎ•º ÌïòÍ≥† ÏûàÏñ¥.",
                            en: "Remembering yourself from that day is not pain, but mourning and love. Now that emotion is preparing to become a memory.",
                            pt: "Lembrar de voc√™ daquele dia n√£o √© dor, mas luto e amor. Agora essa emo√ß√£o est√° se preparando para se tornar uma mem√≥ria."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Kael", emoji: "üßô",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÏãúÍ∞ÑÏùÄ Îã§Ïãú ÌùêÎ•¥Í∏∞ ÏãúÏûëÌñàÏñ¥. Í∑∏Í±¥ ÎÑ§Í∞Ä ÏÑ†ÌÉùÌïú Ïö©Í∏∞Ïùò Ï¶ùÍ±∞Ïïº.",
                            en: "Time has begun to flow again. That is proof of the courage you chose.",
                            pt: "O tempo come√ßou a fluir novamente. Essa √© prova da coragem que voc√™ escolheu."
                        };
                        return responses[lang];
                    }
                }
            ];
            
            const reactionsSection = document.getElementById('userReactionsSection');
            
            for (let i = 0; i < secondResponseCharacters.length; i++) {
                const char = secondResponseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < secondResponseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showNavigationSection();
            }, 2000);
        }
        
        async function showNavigationSection() {
            const navigationSection = document.getElementById('navigationSection');
            const navigationMessage = document.getElementById('navigationMessage');
            
            navigationSection.classList.add('show');
            
            const messageText = translations[currentLanguage].navigationMessage;
            await typewriterEffect(navigationMessage, messageText, 50);
            
            setTimeout(() => {
                scrollToElement(navigationSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('Temarix V4 Portal 10 initialized');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                enableUserInput();
            }, 2000);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V4 Portal 10 DOM loaded');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>