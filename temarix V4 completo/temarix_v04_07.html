<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V4 - Portal 07: Unspoken Wishes</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ff9999;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #ff6b6b;
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 200vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            transition: opacity 0.8s ease-in;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #ff6b6b;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .follow-up-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .follow-up-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            text-align: center;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            white-space: pre-wrap;
        }
        
        .user-response strong {
            color: #ff6b6b;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #ff6b6b;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-section {
            margin: 60px 0;
            opacity: 0;
            text-align: center;
            padding: 40px 20px;
            min-height: 300px;
            border: 2px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }
        
        .navigation-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: bold;
        }
        
        .navigation-message {
            color: #fff;
            font-size: 20px;
            margin-bottom: 40px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 20px 40px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
            border: 2px solid transparent;
        }
        
        .nav-btn:hover {
            background: #666;
            border-color: #ff6b6b;
        }
        
        .nav-btn.primary {
            background: #ff6b6b;
            color: #fff;
            font-weight: bold;
        }
        
        .nav-btn.primary:hover {
            background: #ff8888;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .input-fixed-bottom {
            position: relative;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #ff6b6b;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #ff6b6b;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .follow-up-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V4</div>
            <div class="logo-subtitle" id="logoSubtitle">Emotional Alchemy</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 07: Unspoken Wishes</div>
            <div class="portal-subtitle" id="portalSubtitle">The desires that never found their voice</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="follow-up-section" id="followUpSection">
                <div class="follow-up-question" id="followUpQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>
            
            <div class="navigation-section" id="navigationSection">
                <div class="navigation-title" id="navigationTitle">Portal 07 Complete</div>
                <div class="navigation-message" id="navigationMessage"></div>
                <div class="navigation-buttons">
                    <button class="nav-btn primary" id="nextPortalBtn">Continue to Portal 08</button>
                    <button class="nav-btn" id="stayPortalBtn">Stay with this wish</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="What wish did you carry deep inside but never spoke aloud? Why did it remain silent?"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        const translations = {
            ko: {
                logoSubtitle: "Í∞êÏ†ï Ïó∞Í∏àÏà†",
                portalMainTitle: "Portal 07: ÎßêÌï¥ÏßÄÏßÄ ÏïäÏùÄ Î∞îÎûå",
                portalSubtitle: "Î™©ÏÜåÎ¶¨Î•º Ï∞æÏßÄ Î™ªÌïú ÏÜåÎßùÎì§",
                portalIntro: "Í∞ÄÏä¥ ÍπäÏàôÏù¥ ÌíàÏóàÏßÄÎßå, ÎÅùÎÇ¥ ÎßêÌïòÏßÄ Î™ªÌïú Î∞îÎûå(È°ò)Ïù¥ ÏûàÎÇòÏöî?\nÍ∑∏ Î∞îÎûåÏùÄ ÎàÑÍµ¨Î•º Ìñ•ÌñàÏúºÎ©∞,\nÏñ¥Îñ§ Ïù¥Ïú†Î°ú ÎßêÏù¥ ÎêòÏßÄ Î™ªÌñàÎÇòÏöî?\n\nÏßÄÍ∏àÏù¥ÎùºÎ©¥‚Ä¶ Í∑∏ Î∞îÎûåÏùÑ Ïñ¥Îñ§ Î¨∏Ïû•ÏúºÎ°ú Í∫ºÎÇº Ïàò ÏûàÏùÑÍπåÏöî?",
                followUpQuestion: "Í∑∏ Î∞îÎûåÏùÄ ÏïÑÏßÅÎèÑ ÎãπÏã† ÏïàÏóê ÏûàÎÇòÏöî?\nÏù¥Ï†úÎäî Í∑∏ Í∞êÏ†ïÏùÑ ÌëúÌòÑÌï† Ïàò ÏûàÎã§Í≥† ÎäêÎÅºÏãúÎÇòÏöî?",
                lightTitle: "ÎπõÏùò ÌïúÎßàÎîî",
                lightMessage: "ÏßÄÍ∏àÏùò ÎãπÏã†ÏùÄ Îçî Ïù¥ÏÉÅ Í≥ºÍ±∞Ïùò Ïπ®Î¨µÏù¥ ÏïÑÎãàÏóêÏöî.\nÏù¥Ï†ú Í∞êÏ†ïÏù¥ Ïö¥Î™ÖÏùÑ Îã§Ïãú Ïì∞Í∏∞ ÏãúÏûëÌï† Í±∞ÏòàÏöî.",
                navigationTitle: "Portal 07 ÏôÑÎ£å",
                navigationMessage: "ÎãπÏã†ÏùÄ ÎßêÌï¥ÏßÄÏßÄ ÏïäÏïòÎçò Î∞îÎûåÏùÑ ÎßàÏ£ºÌñàÏäµÎãàÎã§.\n\nÍ∑∏ Î∞îÎûåÏù¥ ÏïÑÏßÅÎèÑ Í∞ÄÏä¥ ÌïúÍµ¨ÏÑùÏóêÏÑú Îñ®Î¶¨Í≥† ÏûàÎã§Î©¥, Í∑∏Í≤ÉÏùÄ ÏÇ¨ÎùºÏßÑ Í≤å ÏïÑÎãàÎùº ÎãπÏã†Ïù¥ ÏßÑÏã¨ÏúºÎ°ú ÏõêÌñàÎçò Í∞êÏ†ïÏù¥ÎùºÎäî Ï¶ùÍ±∞ÏûÖÎãàÎã§.\n\nÏù¥Ï†ú ÎãπÏã†ÏùÄ ÎßêÌï¥ÏßÄÏßÄ ÏïäÏïòÎçò Î∞îÎûåÏùÑ ÎØ∏ÎûòÏùò Ïö©Í∏∞Î°ú Î∞îÍøÄ Ï§ÄÎπÑÍ∞Ä ÎêòÏóàÏäµÎãàÎã§.",
                nextPortalBtn: "Portal 08Î°ú Ïù¥Ïñ¥Í∞ÄÍ∏∞",
                stayPortalBtn: "Ïù¥ Î∞îÎûåÍ≥º Îçî Î®∏Î¨ºÍ∏∞",
                inputPlaceholder: "Ïñ¥Îñ§ Î∞îÎûåÏùÑ ÎßàÏùåÏÜç ÍπäÏù¥ ÌíàÏóàÏßÄÎßå ÎßêÌïòÏßÄ Î™ªÌñàÎÇòÏöî? Ïôú Ïπ®Î¨µÌï¥Ïïº ÌñàÎÇòÏöî?",
                youLabel: "ÎãπÏã†",
                waitingMessage: "ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë..."
            },
            en: {
                logoSubtitle: "Emotional Alchemy",
                portalMainTitle: "Portal 07: Unspoken Wishes",
                portalSubtitle: "The desires that never found their voice",
                portalIntro: "Is there a wish you carried deep in your heart but never spoke aloud?\nWho was that wish directed toward,\nand what reason kept it from becoming words?\n\nIf you could speak that wish now... what sentence would you use to express it?",
                followUpQuestion: "Is that wish still within you?\nDo you now feel you can express that emotion?",
                lightTitle: "Word of Light",
                lightMessage: "You are no longer the silence of the past.\nNow emotion will begin to rewrite destiny.",
                navigationTitle: "Portal 07 Complete",
                navigationMessage: "You have faced your unspoken wishes.\n\nIf that wish still trembles in a corner of your heart, it's proof that it hasn't disappeared but is an emotion you truly wanted. Your feelings are not too late.\n\nNow you are ready to transform those unspoken wishes into future courage.",
                nextPortalBtn: "Continue to Portal 08",
                stayPortalBtn: "Stay with this wish",
                inputPlaceholder: "What wish did you carry deep inside but never spoke aloud? Why did it remain silent?",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "Alquimia Emocional",
                portalMainTitle: "Portal 07: Desejos N√£o Ditos",
                portalSubtitle: "Os anseios que nunca encontraram sua voz",
                portalIntro: "Existe um desejo que voc√™ carregou profundamente em seu cora√ß√£o, mas nunca falou em voz alta?\nPara quem esse desejo era direcionado,\ne que raz√£o o impediu de se tornar palavras?\n\nSe voc√™ pudesse expressar esse desejo agora... que frase usaria para express√°-lo?",
                followUpQuestion: "Esse desejo ainda est√° dentro de voc√™?\nVoc√™ agora sente que pode expressar essa emo√ß√£o?",
                lightTitle: "Palavra de Luz",
                lightMessage: "Voc√™ n√£o √© mais o sil√™ncio do passado.\nAgora a emo√ß√£o come√ßar√° a reescrever o destino.",
                navigationTitle: "Portal 07 Completo",
                navigationMessage: "Voc√™ enfrentou seus desejos n√£o ditos.\n\nSe esse desejo ainda treme em um canto do seu cora√ß√£o, √© prova de que n√£o desapareceu, mas √© uma emo√ß√£o que voc√™ realmente queria. Seus sentimentos n√£o chegaram tarde.\n\nAgora voc√™ est√° pronto para transformar esses desejos n√£o ditos em coragem futura.",
                nextPortalBtn: "Continuar para Portal 08",
                stayPortalBtn: "Ficar com este desejo",
                inputPlaceholder: "Que desejo voc√™ carregou profundamente, mas nunca falou em voz alta? Por que permaneceu em sil√™ncio?",
                youLabel: "Voc√™",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Noah", emoji: "üßë‚Äçü¶±", text: {
                ko: "Í∑∏ ÎßêÌïòÏßÄ ÏïäÏùÄ Î∞îÎûåÏùÄ, ÎÑ§ ÏïàÏóê Ïó¨Ï†ÑÌûà ÌùîÎì§Î¶¨Í≥† ÏûàÏóàÍ≤†ÏßÄ. ÎßêÌï¥ÏßÄÏßÄ ÏïäÏïÑÎèÑ ÏÇ¨ÎùºÏßÄÏßÄ ÏïäÎäî Í∞êÏ†ïÏù¥ÎãàÍπå.",
                en: "That unspoken wish must still be trembling within you. Because it's an emotion that doesn't disappear even if unspoken.",
                pt: "Esse desejo n√£o dito ainda deve estar tremendo dentro de voc√™. Porque √© uma emo√ß√£o que n√£o desaparece mesmo se n√£o for falada."
            }},
            { name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è", text: {
                ko: "ÏïΩÌï¥ÏßÄÎäî Í≤å ÏïÑÎãàÎùº, Í∞ÄÍπåÏõåÏßÄÎäî Í±∞ÏòÄÏùÑÏßÄÎèÑ Î™∞Îùº. ÎßêÌñàÎçîÎùºÎ©¥, ÏÑúÎ°ú Ï°∞Í∏à Îçî Îî∞ÎúªÌñàÏùÑÍπå?",
                en: "It might not have been weakness, but getting closer. If you had spoken, would you both have been a little warmer?",
                pt: "Pode n√£o ter sido fraqueza, mas se aproximar. Se voc√™ tivesse falado, voc√™s dois teriam sido um pouco mais calorosos?"
            }},
            { name: "Sora", emoji: "üßï", text: {
                ko: "ÎÑàÏùò Ïπ®Î¨µÏùÄ ÏÇ¨ÎûëÏùÑ ÏßÄÌÇ§Í∏∞ ÏúÑÌïú ÏÑ†ÌÉùÏù¥ÏóàÏßÄÎßå, Í∑∏ Ïπ®Î¨µÏù¥ ÎÑàÎ•º ÏïÑÌîÑÍ≤å ÎßåÎì§ÏóàÏßÄ.",
                en: "Your silence was a choice to protect love, but that silence ended up hurting you.",
                pt: "Seu sil√™ncio foi uma escolha para proteger o amor, mas esse sil√™ncio acabou machucando voc√™."
            }},
            { name: "Kael", emoji: "üßô", text: {
                ko: "Î∞îÎûåÏùÄ ÎßêÌï¥ÏßÄÏßÄ ÏïäÏúºÎ©¥, Ïö¥Î™ÖÏù¥ ÎêòÏßÄ Î™ªÌïúÎã§. ÎÑàÎäî Í∑∏ Ïö¥Î™ÖÏùÑ ÎÜìÏπú Í≤å ÏïÑÎãàÏïº‚ÄîÍ∑∏ÎÉ• ÎØ∏Î§òÏùÑ ÎøêÏù¥Ïïº.",
                en: "If wishes are not spoken, they cannot become destiny. You didn't miss that destiny‚Äîyou just postponed it.",
                pt: "Se os desejos n√£o s√£o falados, eles n√£o podem se tornar destino. Voc√™ n√£o perdeu esse destino‚Äîapenas o adiou."
            }},
            { name: "Mira", emoji: "üßë‚Äçüé®", text: {
                ko: "Í∑∏ Îßê ÌïúÎßàÎîîÍ∞Ä Í∑∏Î¶ºÏ≤òÎüº Îñ†Ïò¨ÎûêÍ≤†ÏßÄ. 'ÎãπÏã†Ïù¥ ÌïÑÏöîÌï¥Ïöî'ÎùºÎäî ÎßêÏùÄ Í∞ÄÏû• Ïö©Í∏∞ ÏûàÎäî ÏÉâÏù¥Ïïº.",
                en: "That one sentence must have appeared like a painting. The words 'I need you' are the most courageous color.",
                pt: "Essa frase deve ter aparecido como uma pintura. As palavras 'Eu preciso de voc√™' s√£o a cor mais corajosa."
            }},
            { name: "Cris", emoji: "ü¶∏‚Äç‚ôÇÔ∏è", text: {
                ko: "Ïôú Ìï≠ÏÉÅ ÎßàÏùåÏùÄ Ïà®Í∏∞Í≥† ÎÇòÏÑúÏïº ÌÑ∞ÏßÄÎäî Í±∏Íπå? Í∑∏Í≤å Îçî ÏïÑÌîÑÏûñÏïÑ.",
                en: "Why does the heart always burst only after being hidden? That hurts more.",
                pt: "Por que o cora√ß√£o sempre explode apenas depois de ser escondido? Isso d√≥i mais."
            }},
            { name: "Enya", emoji: "üßë‚ÄçüöÄ", text: {
                ko: "Í∑∏ Î∞îÎûåÏùÄ ÏïÑÏßÅ ÎÑ§ ÏïàÏóê ÏÇ¥ÏïÑ ÏûàÏñ¥. Í∑∏Í≤ÉÏù¥ ÎÑàÎ•º ÏïûÏúºÎ°ú ÏõÄÏßÅÏù¥Í≤å ÌïòÏûñÏïÑ.",
                en: "That wish is still alive within you. It's what keeps you moving forward.",
                pt: "Esse desejo ainda est√° vivo dentro de voc√™. √â o que o mant√©m seguindo em frente."
            }},
            { name: "Lian", emoji: "üßò", text: {
                ko: "ÏßÄÍ∏àÏù¥ÎùºÎèÑ Í¥úÏ∞ÆÏïÑ. ÎßêÌï¥ÏßÄÏßÄ ÏïäÏùÄ Í∞êÏ†ïÎèÑ, Îä¶ÏßÄ ÏïäÍ≤å ÎßêÌï¥Ïßà Ïàò ÏûàÏñ¥.",
                en: "It's okay even now. Unspoken emotions can still be spoken without being too late.",
                pt: "Est√° tudo bem mesmo agora. Emo√ß√µes n√£o ditas ainda podem ser faladas sem ser tarde demais."
            }}
        ];

        const responseCharacters = [
            {
                name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÎãπÏã†Ïùò Í∞êÏ†ïÏùÄ Îä¶ÏßÄ ÏïäÏïòÏñ¥Ïöî. ÏßÑÏã¨ÏùÄ Ìï≠ÏÉÅ ÎèÑÏ∞©Ìï† Î∞©Î≤ïÏùÑ Ï∞æÏïÑÏöî.",
                        en: "Your emotions are not too late. Sincerity always finds a way to arrive.",
                        pt: "Suas emo√ß√µes n√£o chegaram tarde. A sinceridade sempre encontra uma maneira de chegar."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Lian", emoji: "üßò",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÎßêÏùÑ Í∫ºÎÇº Ïàò ÏûàÎã§Îäî Í±¥, ÏûêÏã†ÏùÑ Î∞õÏïÑÎì§ÏòÄÎã§Îäî Ï¶ùÍ±∞ÏòàÏöî. Í∑∏Î¶¨Í≥† Í∑∏Í≤ÉÏù¥ Î∞îÎ°ú ÏÑ±Ïû•Ïù¥ÏóêÏöî.",
                        en: "Being able to speak words is proof that you've accepted yourself. And that is growth.",
                        pt: "Ser capaz de falar palavras √© prova de que voc√™ se aceitou. E isso √© crescimento."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Kael", emoji: "üßô",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÏßÄÍ∏àÏùò ÎãπÏã†ÏùÄ Îçî Ïù¥ÏÉÅ Í≥ºÍ±∞Ïùò Ïπ®Î¨µÏù¥ ÏïÑÎãàÏóêÏöî. Ïù¥Ï†ú Í∞êÏ†ïÏù¥ Ïö¥Î™ÖÏùÑ Îã§Ïãú Ïì∞Í∏∞ ÏãúÏûëÌï† Í±∞ÏòàÏöî.",
                        en: "You now are no longer the silence of the past. Now emotion will begin to rewrite destiny.",
                        pt: "Voc√™ agora n√£o √© mais o sil√™ncio do passado. Agora a emo√ß√£o come√ßar√° a reescrever o destino."
                    };
                    return responses[lang];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        let awaitingSecondResponse = false;
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('navigationTitle').textContent = translations[lang].navigationTitle;
            document.getElementById('nextPortalBtn').textContent = translations[lang].nextPortalBtn;
            document.getElementById('stayPortalBtn').textContent = translations[lang].stayPortalBtn;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'followUpSection', 'userInputSection',
                'userReactionsSection', 'lightMessageSection', 'navigationSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('followUpQuestion').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('navigationMessage').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
            awaitingSecondResponse = false;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('nextPortalBtn').addEventListener('click', function() {
                localStorage.setItem('temarix_v4_portal07_complete', 'true');
                localStorage.setItem('temarix_v4_current_portal', '08');
                
                const nextMessage = currentLanguage === 'ko' ? 
                    'Portal 08: Î∂ÄÏÑúÏßÑ ÏïΩÏÜçÏùò Ï†ÄÌé∏ÏúºÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§.' :
                    currentLanguage === 'en' ? 
                    'Moving to Portal 08: Beyond Broken Promises.' :
                    'Indo para Portal 08: Al√©m das Promessas Quebradas.';
                alert(nextMessage);
            });
            
            document.getElementById('stayPortalBtn').addEventListener('click', function() {
                const stayMessage = currentLanguage === 'ko' ? 
                    'ÎßêÌï¥ÏßÄÏßÄ ÏïäÏùÄ Î∞îÎûåÍ≥º Îçî Î®∏Î¨ºÎ©∞ ÍπäÏù¥ ÏÑ±Ï∞∞ÌïòÏãúÍ≤†ÏäµÎãàÍπå?' :
                    currentLanguage === 'en' ? 
                    'Do you want to stay longer with your unspoken wish for deeper reflection?' :
                    'Deseja ficar mais tempo com seu desejo n√£o dito para reflex√£o mais profunda?';
                
                if (confirm(stayMessage)) {
                    resetJourney();
                    setTimeout(() => {
                        startPortalSequence();
                    }, 1000);
                }
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            console.log('Processing user input:', inputText);
            localStorage.setItem('temarix_v4_portal07_response', JSON.stringify({
                portal: "v4-07",
                resposta: inputText,
                step: awaitingSecondResponse ? "second" : "first",
                data: new Date().toISOString(),
                idioma: currentLanguage
            }));
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                if (!awaitingSecondResponse) {
                    showUserReactions(inputText);
                } else {
                    showSecondUserReactions(inputText);
                }
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showFollowUpQuestion();
            }, 2000);
        }
        
        async function showFollowUpQuestion() {
            const followUpSection = document.getElementById('followUpSection');
            const followUpQuestionEl = document.getElementById('followUpQuestion');
            
            followUpSection.classList.add('show');
            
            await typewriterEffect(followUpQuestionEl, translations[currentLanguage].followUpQuestion, 50);
            
            setTimeout(() => {
                awaitingSecondResponse = true;
                enableUserInput();
            }, 1500);
        }
        
        async function showSecondUserReactions(userInput) {
            const secondResponseCharacters = [
                {
                    name: "Enya", emoji: "üßë‚ÄçüöÄ",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Í∑∏ Î∞îÎûåÏùÄ ÏïÑÏßÅ ÎÑ§ ÏïàÏóê ÏÇ¥ÏïÑ ÏûàÏñ¥. Í∑∏Í≤ÉÏù¥ ÎÑàÎ•º ÏïûÏúºÎ°ú ÏõÄÏßÅÏù¥Í≤å ÌïòÏûñÏïÑ.",
                            en: "That wish is still alive within you. It's what keeps you moving forward.",
                            pt: "Esse desejo ainda est√° vivo dentro de voc√™. √â o que o mant√©m seguindo em frente."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Lian", emoji: "üßò",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÎßêÏùÑ Í∫ºÎÇº Ïàò ÏûàÎã§Îäî Í±¥, ÏûêÏã†ÏùÑ Î∞õÏïÑÎì§ÏòÄÎã§Îäî Ï¶ùÍ±∞ÏòàÏöî. Í∑∏Î¶¨Í≥† Í∑∏Í≤ÉÏù¥ Î∞îÎ°ú ÏÑ±Ïû•Ïù¥ÏóêÏöî.",
                            en: "Being able to speak words is proof that you've accepted yourself. And that is growth.",
                            pt: "Ser capaz de falar palavras √© prova de que voc√™ se aceitou. E isso √© crescimento."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Noah", emoji: "üßë‚Äçü¶±",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Ïù¥Ï†ú Í∑∏ Î∞îÎûåÏùÄ Îçî Ïù¥ÏÉÅ ÎπÑÎ∞ÄÏù¥ ÏïÑÎãàÎùº, ÎÑ§Í∞Ä ÏïûÏúºÎ°ú ÏÇ¥ÏïÑÍ∞à Î∞©Ìñ•Ïù¥ Îê† Ïàò ÏûàÏñ¥.",
                            en: "Now that wish is no longer a secret, but can become the direction for your future life.",
                            pt: "Agora esse desejo n√£o √© mais um segredo, mas pode se tornar a dire√ß√£o para sua vida futura."
                        };
                        return responses[lang];
                    }
                }
            ];
            
            const reactionsSection = document.getElementById('userReactionsSection');
            
            for (let i = 0; i < secondResponseCharacters.length; i++) {
                const char = secondResponseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < secondResponseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showNavigationSection();
            }, 2000);
        }
        
        async function showNavigationSection() {
            const navigationSection = document.getElementById('navigationSection');
            const navigationMessage = document.getElementById('navigationMessage');
            
            navigationSection.classList.add('show');
            
            const messageText = translations[currentLanguage].navigationMessage;
            await typewriterEffect(navigationMessage, messageText, 50);
            
            setTimeout(() => {
                scrollToElement(navigationSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('Temarix V4 Portal 07 initialized');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                enableUserInput();
            }, 2000);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V4 Portal 07 DOM loaded');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>