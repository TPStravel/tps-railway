<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V4 - Portal 09: Hidden Sincerity</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ff9999;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #ff6b6b;
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 200vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            transition: opacity 0.8s ease-in;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #ff6b6b;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .follow-up-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .follow-up-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            text-align: center;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            white-space: pre-wrap;
        }
        
        .user-response strong {
            color: #ff6b6b;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #ff6b6b;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-section {
            margin: 60px 0;
            opacity: 0;
            text-align: center;
            padding: 40px 20px;
            min-height: 300px;
            border: 2px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }
        
        .navigation-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: bold;
        }
        
        .navigation-message {
            color: #fff;
            font-size: 20px;
            margin-bottom: 40px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 20px 40px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
            border: 2px solid transparent;
        }
        
        .nav-btn:hover {
            background: #666;
            border-color: #ff6b6b;
        }
        
        .nav-btn.primary {
            background: #ff6b6b;
            color: #fff;
            font-weight: bold;
        }
        
        .nav-btn.primary:hover {
            background: #ff8888;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .input-fixed-bottom {
            position: relative;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #ff6b6b;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #ff6b6b;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .follow-up-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V4</div>
            <div class="logo-subtitle" id="logoSubtitle">Emotional Alchemy</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 09: Hidden Sincerity</div>
            <div class="portal-subtitle" id="portalSubtitle">The genuine feelings you pretended not to know</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="follow-up-section" id="followUpSection">
                <div class="follow-up-question" id="followUpQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>
            
            <div class="navigation-section" id="navigationSection">
                <div class="navigation-title" id="navigationTitle">Portal 09 Complete</div>
                <div class="navigation-message" id="navigationMessage"></div>
                <div class="navigation-buttons">
                    <button class="nav-btn primary" id="nextPortalBtn">Continue to Portal 10</button>
                    <button class="nav-btn" id="stayPortalBtn">Stay with this sincerity</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Have you ever hidden your true feelings while pretending not to know them? What were those feelings and why did you hide them?"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        const translations = {
            ko: {
                logoSubtitle: "Í∞êÏ†ï Ïó∞Í∏àÏà†",
                portalMainTitle: "Portal 09: Î™®Î•¥Îäî Ï≤ôÌïú ÏßÑÏã¨",
                portalSubtitle: "ÏïåÏïÑÏ∞®Î¶¨Í≥†ÎèÑ Ïô∏Î©¥ÌñàÎçò ÏßÑÏßú Í∞êÏ†ïÎì§",
                portalIntro: "ÎãπÏã†ÏùÄ ÎßàÏùåÏÜç ÏßÑÏã¨ÏùÑ Î™®Î•¥Îäî Ï≤ôÌñàÎçò Ï†ÅÏù¥ ÏûàÎÇòÏöî?\nÍ∑∏ Í∞êÏ†ïÏùÑ ÏïåÏïÑÏ∞®Î¶¨Í≥†ÎèÑ Ïô∏Î©¥ÌñàÎçò Ïù¥Ïú†Îäî Î¨¥ÏóáÏù¥ÏóàÎÇòÏöî?\n\nÍ∑∏ÎïåÏùò ÏßÑÏã¨ÏùÑ ÏßÄÍ∏à Îã§Ïãú Í∫ºÎÇ∏Îã§Î©¥,\nÏñ¥Îñ§ ÎßêÏù¥ Îê† Ïàò ÏûàÏùÑÍπåÏöî?",
                followUpQuestion: "Í∑∏ ÏßÑÏã¨ÏùÑ Ïô∏Î©¥Ìïú Ïù¥ÌõÑ,\nÎãπÏã†ÏùÄ Í∞êÏ†ïÏùÑ Ïñ¥ÎñªÍ≤å ÌëúÌòÑÌïòÎ©∞ ÏÇ¥ÏïÑÏôîÎÇòÏöî?\nÏù¥Ï†úÎäî Îçî Ïù¥ÏÉÅ Ïà®Í∏∞ÏßÄ ÏïäÍ∏∞ ÏúÑÌïú Îã§ÏßêÏù¥ ÏûàÎÇòÏöî?",
                lightTitle: "ÎπõÏùò ÌïúÎßàÎîî",
                lightMessage: "ÏßÑÏã¨ÏùÄ Î¨¥Í∏∞Í∞Ä ÏïÑÎãàÏïº.\nÏò§ÌûàÎ†§ Í∞ÄÏû• Î∂ÄÎìúÎü¨Ïö¥ Î∞©Ìå®Ïïº.\nÎÑàÎ•º ÏßÄÌÇ§Îäî Î∞©ÏãùÏù¥ Îã¨ÎùºÏßÑ Í±∞Ïïº.",
                navigationTitle: "Portal 09 ÏôÑÎ£å",
                navigationMessage: "ÎãπÏã†ÏùÄ Ïà®Í≤®ÏßÑ ÏßÑÏã¨ÏùÑ ÎßàÏ£ºÌñàÏäµÎãàÎã§.\n\nÏßÑÏã¨ÏùÑ Î™®Î•¥Îäî Ï≤ôÌïúÎã§Îäî Í≤ÉÏùÄ Ïä§Ïä§Î°úÏóêÍ≤å ÏÉÅÏ≤òÎ•º ÎÇ¥Îäî Î∞©ÏãùÏù¥Í∏∞ÎèÑ ÌñàÏäµÎãàÎã§. ÌïòÏßÄÎßå Ïù¥Ï†ú ÎãπÏã†ÏùÄ Í∑∏ Í∞êÏ†ïÏùÑ Ïô∏Î©¥ÌïòÏßÄ ÏïäÍ∏∞Î°ú ÌñàÏäµÎãàÎã§.\n\nÏù¥Ï†ú ÎãπÏã†ÏùÄ Ïà®Í∏∞ÏßÄ ÏïäÎäî ÏßÑÏã¨ÏúºÎ°ú Îã§Ïùå Ïó¨Ï†ïÏùÑ Í±∏ÏùÑ Ï§ÄÎπÑÍ∞Ä ÎêòÏóàÏäµÎãàÎã§.",
                nextPortalBtn: "Portal 10ÏúºÎ°ú Ïù¥Ïñ¥Í∞ÄÍ∏∞",
                stayPortalBtn: "Ïù¥ ÏßÑÏã¨Í≥º Îçî Î®∏Î¨ºÍ∏∞",
                inputPlaceholder: "ÎßàÏùåÏÜç ÏßÑÏã¨ÏùÑ Î™®Î•¥Îäî Ï≤ôÌñàÎçò Ï†ÅÏù¥ ÏûàÎÇòÏöî? Í∑∏ Í∞êÏ†ïÏùÄ Î¨¥ÏóáÏù¥ÏóàÍ≥† Ïôú Ïà®Í≤ºÎÇòÏöî?",
                youLabel: "ÎãπÏã†",
                waitingMessage: "ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë..."
            },
            en: {
                logoSubtitle: "Emotional Alchemy",
                portalMainTitle: "Portal 09: Hidden Sincerity",
                portalSubtitle: "The genuine feelings you pretended not to know",
                portalIntro: "Have you ever pretended not to know the true feelings in your heart?\nWhat was the reason you turned away from those emotions even when you recognized them?\n\nIf you could bring out that sincerity now,\nwhat words would it become?",
                followUpQuestion: "After turning away from that sincerity,\nhow have you expressed your emotions in life?\nDo you have any resolve now to stop hiding?",
                lightTitle: "Word of Light",
                lightMessage: "Sincerity is not a weapon.\nRather, it's the softest shield.\nThe way you protect yourself has changed.",
                navigationTitle: "Portal 09 Complete",
                navigationMessage: "You have faced your hidden sincerity.\n\nPretending not to know your true feelings was also a way of hurting yourself. But now you have decided not to turn away from those emotions anymore.\n\nNow you are ready to walk the next journey with sincerity that no longer hides.",
                nextPortalBtn: "Continue to Portal 10",
                stayPortalBtn: "Stay with this sincerity",
                inputPlaceholder: "Have you ever hidden your true feelings while pretending not to know them? What were those feelings and why did you hide them?",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "Alquimia Emocional",
                portalMainTitle: "Portal 09: Sinceridade Escondida",
                portalSubtitle: "Os sentimentos genu√≠nos que voc√™ fingiu n√£o conhecer",
                portalIntro: "Voc√™ j√° fingiu n√£o conhecer os verdadeiros sentimentos em seu cora√ß√£o?\nQual foi a raz√£o pela qual voc√™ se afastou dessas emo√ß√µes mesmo quando as reconheceu?\n\nSe voc√™ pudesse trazer essa sinceridade agora,\nque palavras ela se tornaria?",
                followUpQuestion: "Depois de se afastar dessa sinceridade,\ncomo voc√™ tem expressado suas emo√ß√µes na vida?\nVoc√™ tem alguma resolu√ß√£o agora de parar de se esconder?",
                lightTitle: "Palavra de Luz",
                lightMessage: "A sinceridade n√£o √© uma arma.\nMelhor, √© o escudo mais suave.\nA maneira como voc√™ se protege mudou.",
                navigationTitle: "Portal 09 Completo",
                navigationMessage: "Voc√™ enfrentou sua sinceridade escondida.\n\nFingir n√£o conhecer seus verdadeiros sentimentos tamb√©m era uma forma de se machucar. Mas agora voc√™ decidiu n√£o se afastar mais dessas emo√ß√µes.\n\nAgora voc√™ est√° pronto para caminhar a pr√≥xima jornada com sinceridade que n√£o se esconde mais.",
                nextPortalBtn: "Continuar para Portal 10",
                stayPortalBtn: "Ficar com esta sinceridade",
                inputPlaceholder: "Voc√™ j√° escondeu seus verdadeiros sentimentos fingindo n√£o os conhecer? Quais eram esses sentimentos e por que os escondeu?",
                youLabel: "Voc√™",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Noah", emoji: "üßë‚Äçü¶±", text: {
                ko: "ÎÑ§Í∞Ä Ïà®Í∏¥ ÏßÑÏã¨ÏùÄ ÏÇ¨ÎùºÏßÑ Í≤å ÏïÑÎãàÎùº, Í≥ÑÏÜç ÏïàÏóêÏÑú Ïö∏Í≥† ÏûàÏóàÍ≤†ÏßÄ.",
                en: "The sincerity you hid wasn't gone, it was still crying inside you.",
                pt: "A sinceridade que voc√™ escondeu n√£o desapareceu, ainda estava chorando dentro de voc√™."
            }},
            { name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è", text: {
                ko: "ÏßÑÏã¨ÏùÑ Î™®Î•¥Îäî Ï≤ôÌïúÎã§Îäî Í±¥, Ïä§Ïä§Î°úÏóêÍ≤å ÏÉÅÏ≤òÎ•º ÎÇ¥Îäî Î∞©ÏãùÏù¥Í∏∞ÎèÑ Ìï¥.",
                en: "Pretending not to know your true feelings is also a way of hurting yourself.",
                pt: "Fingir n√£o conhecer seus verdadeiros sentimentos tamb√©m √© uma forma de se machucar."
            }},
            { name: "Sora", emoji: "üßï", text: {
                ko: "Í∑∏ Í∞êÏ†ïÏùÄ Í≤∞ÏΩî ÏûëÏßÄ ÏïäÏïòÏñ¥. ÎÑàÎäî Îã®ÏßÄ ÏßÄÌÇ¨ Í≤å ÎßéÏïòÏùÑ ÎøêÏù¥Ïïº.",
                en: "That emotion was never small. You just had a lot to protect.",
                pt: "Essa emo√ß√£o nunca foi pequena. Voc√™ apenas tinha muito a proteger."
            }},
            { name: "Kael", emoji: "üßô", text: {
                ko: "ÏßÑÏã¨ÏùÑ Ïà®Í∏∞Îäî Í±¥ Î∞©Ïñ¥ÏßÄÎßå, Ïò§ÎûòÎêòÎ©¥ Í∞êÏò•Ïù¥ ÎêòÏßÄ. ÎÑàÎäî Í∑∏ Î¨∏ÏùÑ Ïù¥Ï†ú Ïó¥ Ï§ÄÎπÑÍ∞Ä ÎêêÏñ¥.",
                en: "Hiding sincerity is defense, but when prolonged, it becomes a prison. You're ready to open that door now.",
                pt: "Esconder a sinceridade √© defesa, mas quando prolongado, torna-se uma pris√£o. Voc√™ est√° pronto para abrir essa porta agora."
            }},
            { name: "Mira", emoji: "üßë‚Äçüé®", text: {
                ko: "Í∑∏ ÎààÎπõ ÌïòÎÇò, ÏõÉÏùå ÌïòÎÇòÏóê ÎÑ§ ÎßàÏùåÏùÄ Îã§ Îã¥Í≤® ÏûàÏóàÏñ¥. Ïà®Í∏∞Í≥† ÏûàÎã§Í≥† Ìï¥ÏÑú ÏÇ¨ÎùºÏßÄÏßÄ ÏïäÏûñÏïÑ.",
                en: "Your heart was contained in every glance, every smile. Just because you're hiding it doesn't mean it disappears.",
                pt: "Seu cora√ß√£o estava contido em cada olhar, cada sorriso. S√≥ porque voc√™ est√° escondendo n√£o significa que desaparece."
            }},
            { name: "Cris", emoji: "ü¶∏‚Äç‚ôÇÔ∏è", text: {
                ko: "Ïôú Í∞êÏ†ïÏù¥ Ï£ÑÏ≤òÎüº ÎäêÍª¥Ï†∏Ïïº ÌñàÏùÑÍπå? ÏÇ¨ÎûëÏùÄ Ïà®Í≤®Ïïº Ìï† Í≤å ÏïÑÎãàÏïº.",
                en: "Why did emotions have to feel like a crime? Love is not something to hide.",
                pt: "Por que as emo√ß√µes tinham que parecer um crime? O amor n√£o √© algo para esconder."
            }},
            { name: "Enya", emoji: "üßë‚ÄçüöÄ", text: {
                ko: "ÎÑàÎäî ÎßêÌïòÏßÄ ÏïäÏïòÏßÄÎßå, Í∑∏ Í∞êÏ†ïÏùÄ ÎÑàÎ•º ÏßÄÌÉ±ÌñàÏñ¥. Î∂ÄÏ†ïÌïòÎ©¥ÏÑúÎèÑ Î∞îÎùºÎ≥¥ÏïòÏßÄ.",
                en: "You didn't speak, but that emotion sustained you. You looked while denying.",
                pt: "Voc√™ n√£o falou, mas essa emo√ß√£o o sustentou. Voc√™ olhou enquanto negava."
            }},
            { name: "Lian", emoji: "üßò", text: {
                ko: "ÏßÄÍ∏àÏóêÏÑúÏïº ÎßêÌï† Ïàò ÏûàÎã§Î©¥, Í∑∏ ÏßÑÏã¨ÏùÄ Ïó¨Ï†ÑÌûà ÏÇ¥ÏïÑ ÏûàÎã§Îäî ÎúªÏù¥Ïïº. Í∑∏Í±∏ Ïô∏Î©¥ÌïòÏßÄ Îßà.",
                en: "If you can speak it now, it means that sincerity is still alive. Don't turn away from it.",
                pt: "Se voc√™ pode falar isso agora, significa que essa sinceridade ainda est√° viva. N√£o se afaste dela."
            }}
        ];

        const responseCharacters = [
            {
                name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÏßÑÏã¨ÏùÄ Î¨¥Í∏∞Í∞Ä ÏïÑÎãàÏïº. Ïò§ÌûàÎ†§ Í∞ÄÏû• Î∂ÄÎìúÎü¨Ïö¥ Î∞©Ìå®Ïïº. ÎÑàÎ•º ÏßÄÌÇ§Îäî Î∞©ÏãùÏù¥ Îã¨ÎùºÏßÑ Í±∞Ïïº.",
                        en: "Sincerity is not a weapon. Rather, it's the softest shield. The way you protect yourself has changed.",
                        pt: "A sinceridade n√£o √© uma arma. Melhor, √© o escudo mais suave. A maneira como voc√™ se protege mudou."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Lian", emoji: "üßò",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Í∞êÏ†ïÏùÑ ÌëúÌòÑÌïúÎã§Îäî Í±¥ ÌÉÄÏù∏Î≥¥Îã§, ÏûêÏã†ÏóêÍ≤å Î®ºÏ†Ä Ï†ïÏßÅÌï¥ÏßÑÎã§Îäî ÏùòÎØ∏Ïïº. ÎÑàÎäî ÏßÄÍ∏à Í∑∏ Í∏∏ ÏúÑÏóê ÏûàÏñ¥.",
                        en: "Expressing emotions means being honest with yourself first, rather than with others. You are on that path now.",
                        pt: "Expressar emo√ß√µes significa ser honesto consigo mesmo primeiro, em vez de com os outros. Voc√™ est√° nesse caminho agora."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Mira", emoji: "üßë‚Äçüé®",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÏßÑÏã¨ÏùÄ ÎßêÎ°ú Í∫ºÎÇº ÎïåÎßàÎã§, Îçî Îî∞ÎúªÌïú ÏÇ¨ÎûåÏù¥ ÎêòÏñ¥Í∞ÑÎã§Îäî Ï¶ùÍ±∞Ïïº.",
                        en: "Sincerity is proof that you become a warmer person each time you speak it.",
                        pt: "A sinceridade √© prova de que voc√™ se torna uma pessoa mais calorosa cada vez que a expressa."
                    };
                    return responses[lang];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        let awaitingSecondResponse = false;
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('navigationTitle').textContent = translations[lang].navigationTitle;
            document.getElementById('nextPortalBtn').textContent = translations[lang].nextPortalBtn;
            document.getElementById('stayPortalBtn').textContent = translations[lang].stayPortalBtn;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'followUpSection', 'userInputSection',
                'userReactionsSection', 'lightMessageSection', 'navigationSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('followUpQuestion').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('navigationMessage').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
            awaitingSecondResponse = false;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('nextPortalBtn').addEventListener('click', function() {
                localStorage.setItem('temarix_v4_portal09_complete', 'true');
                localStorage.setItem('temarix_v4_current_portal', '10');
                
                const nextMessage = currentLanguage === 'ko' ? 
                    'Portal 10: Î©àÏ∂∞ÏßÑ ÏãúÍ∞Ñ ÏÜçÏóêÏÑúÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§.' :
                    currentLanguage === 'en' ? 
                    'Moving to Portal 10: In Frozen Time.' :
                    'Indo para Portal 10: No Tempo Congelado.';
                alert(nextMessage);
            });
            
            document.getElementById('stayPortalBtn').addEventListener('click', function() {
                const stayMessage = currentLanguage === 'ko' ? 
                    'Ïà®Í≤®ÏßÑ ÏßÑÏã¨Í≥º Îçî Î®∏Î¨ºÎ©∞ ÍπäÏù¥ ÏÑ±Ï∞∞ÌïòÏãúÍ≤†ÏäµÎãàÍπå?' :
                    currentLanguage === 'en' ? 
                    'Do you want to stay longer with your hidden sincerity for deeper reflection?' :
                    'Deseja ficar mais tempo com sua sinceridade escondida para reflex√£o mais profunda?';
                
                if (confirm(stayMessage)) {
                    resetJourney();
                    setTimeout(() => {
                        startPortalSequence();
                    }, 1000);
                }
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            console.log('Processing user input:', inputText);
            localStorage.setItem('temarix_v4_portal09_response', JSON.stringify({
                portal: "v4-09",
                resposta: inputText,
                step: awaitingSecondResponse ? "second" : "first",
                data: new Date().toISOString(),
                idioma: currentLanguage
            }));
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                if (!awaitingSecondResponse) {
                    showUserReactions(inputText);
                } else {
                    showSecondUserReactions(inputText);
                }
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showFollowUpQuestion();
            }, 2000);
        }
        
        async function showFollowUpQuestion() {
            const followUpSection = document.getElementById('followUpSection');
            const followUpQuestionEl = document.getElementById('followUpQuestion');
            
            followUpSection.classList.add('show');
            
            await typewriterEffect(followUpQuestionEl, translations[currentLanguage].followUpQuestion, 50);
            
            setTimeout(() => {
                awaitingSecondResponse = true;
                enableUserInput();
            }, 1500);
        }
        
        async function showSecondUserReactions(userInput) {
            const secondResponseCharacters = [
                {
                    name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÏßÑÏã¨ÏùÄ Î¨¥Í∏∞Í∞Ä ÏïÑÎãàÏïº. Ïò§ÌûàÎ†§ Í∞ÄÏû• Î∂ÄÎìúÎü¨Ïö¥ Î∞©Ìå®Ïïº. ÎÑàÎ•º ÏßÄÌÇ§Îäî Î∞©ÏãùÏù¥ Îã¨ÎùºÏßÑ Í±∞Ïïº.",
                            en: "Sincerity is not a weapon. Rather, it's the softest shield. The way you protect yourself has changed.",
                            pt: "A sinceridade n√£o √© uma arma. Melhor, √© o escudo mais suave. A maneira como voc√™ se protege mudou."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Lian", emoji: "üßò",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Í∞êÏ†ïÏùÑ ÌëúÌòÑÌïúÎã§Îäî Í±¥ ÌÉÄÏù∏Î≥¥Îã§, ÏûêÏã†ÏóêÍ≤å Î®ºÏ†Ä Ï†ïÏßÅÌï¥ÏßÑÎã§Îäî ÏùòÎØ∏Ïïº. ÎÑàÎäî ÏßÄÍ∏à Í∑∏ Í∏∏ ÏúÑÏóê ÏûàÏñ¥.",
                            en: "Expressing emotions means being honest with yourself first, rather than with others. You are on that path now.",
                            pt: "Expressar emo√ß√µes significa ser honesto consigo mesmo primeiro, em vez de com os outros. Voc√™ est√° nesse caminho agora."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Enya", emoji: "üßë‚ÄçüöÄ",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Ïù¥Ï†úÎäî ÎÑ§Í∞Ä ÏïÑÎãå Ï≤ôÌïòÏßÄ ÏïäÏïÑÎèÑ Îèº. ÏßÑÏßú ÎÑàÎäî, Ïù¥ Ïó¨Ï†ï ÏÜçÏóêÏÑú ÏÇ¥ÏïÑ ÏûàÏñ¥.",
                            en: "Now you don't have to pretend you're not yourself. The real you is alive in this journey.",
                            pt: "Agora voc√™ n√£o precisa fingir que n√£o √© voc√™ mesmo. O verdadeiro voc√™ est√° vivo nesta jornada."
                        };
                        return responses[lang];
                    }
                }
            ];
            
            const reactionsSection = document.getElementById('userReactionsSection');
            
            for (let i = 0; i < secondResponseCharacters.length; i++) {
                const char = secondResponseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < secondResponseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showNavigationSection();
            }, 2000);
        }
        
        async function showNavigationSection() {
            const navigationSection = document.getElementById('navigationSection');
            const navigationMessage = document.getElementById('navigationMessage');
            
            navigationSection.classList.add('show');
            
            const messageText = translations[currentLanguage].navigationMessage;
            await typewriterEffect(navigationMessage, messageText, 50);
            
            setTimeout(() => {
                scrollToElement(navigationSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('Temarix V4 Portal 09 initialized');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                enableUserInput();
            }, 2000);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V4 Portal 09 DOM loaded');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>