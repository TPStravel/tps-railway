<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V4 - Portal 21: The Me Who Pretended Not To Be Me</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ff9999;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #ff6b6b;
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 200vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            transition: opacity 0.8s ease-in;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #ff6b6b;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .follow-up-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .follow-up-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            text-align: center;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            white-space: pre-wrap;
        }
        
        .user-response strong {
            color: #ff6b6b;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #ff6b6b;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-section {
            margin: 60px 0;
            opacity: 0;
            text-align: center;
            padding: 40px 20px;
            min-height: 300px;
            border: 2px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }
        
        .navigation-title {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: bold;
        }
        
        .navigation-message {
            color: #fff;
            font-size: 20px;
            margin-bottom: 40px;
            line-height: 1.8;
            white-space: pre-wrap;
            text-align: left;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 20px 40px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
            border: 2px solid transparent;
        }
        
        .nav-btn:hover {
            background: #666;
            border-color: #ff6b6b;
        }
        
        .nav-btn.primary {
            background: #ff6b6b;
            color: #fff;
            font-weight: bold;
        }
        
        .nav-btn.primary:hover {
            background: #ff8888;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .input-fixed-bottom {
            position: relative;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #ff6b6b;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #ff6b6b;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .follow-up-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V4</div>
            <div class="logo-subtitle" id="logoSubtitle">Emotional Alchemy</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 21: The Me Who Pretended Not To Be Me</div>
            <div class="portal-subtitle" id="portalSubtitle">Hiding behind masks</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="follow-up-section" id="followUpSection">
                <div class="follow-up-question" id="followUpQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>
            
            <div class="navigation-section" id="navigationSection">
                <div class="navigation-title" id="navigationTitle">Portal 21 Complete</div>
                <div class="navigation-message" id="navigationMessage"></div>
                <div class="navigation-buttons">
                    <button class="nav-btn primary" id="nextPortalBtn">Continue to Portal 22</button>
                    <button class="nav-btn" id="stayPortalBtn">Stay with these reflections</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="When did you have to hide yourself? What 'pretending' did you choose and for whom?"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        const translations = {
            ko: {
                logoSubtitle: "Í∞êÏ†ï Ïó∞Í∏àÏà†",
                portalMainTitle: "Portal 21: ÎÇ¥Í∞Ä ÏïÑÎãå Ï≤ôÌñàÎçò ÎÇò",
                portalSubtitle: "Í∞ÄÎ©¥ Îí§Ïóê Ïà®ÏùÄ Î™®Ïäµ",
                portalIntro: "ÎãπÏã†ÏùÄ Ïñ∏Ï†ú, Ïä§Ïä§Î°úÎ•º Ïà®Í∏∞Î©∞ ÏÇ¥ÏïÑÏïº ÌñàÎçò Ï†ÅÏù¥ ÏûàÏóàÎÇòÏöî?\n\nÍ∑∏ 'Ï≤ôÌï®'ÏùÄ ÎàÑÍµ¨Î•º ÏúÑÌï¥ ÏÑ†ÌÉùÌïú Í≤ÉÏù¥ÏóàÍ≥†,\nÍ∑∏ÎèôÏïà ÎãπÏã† ÏïàÏóê Ïñ¥Îñ§ Í∞êÏ†ïÏùò ÌãàÏùÑ ÎÇ®Í≤ºÎÇòÏöî?",
                followUpQuestion: "Í∑∏ Í∞ÄÎ©¥ÏùÑ Ïì∞Í≥† ÏÇ¥ÏïòÎçò ÎãπÏã†ÏóêÍ≤å\nÏßÄÍ∏à Ïñ¥Îñ§ ÎßêÏùÑ Ìï¥Ï£ºÍ≥† Ïã∂ÎÇòÏöî?\n\nÍ∑∏Î¶¨Í≥† Ïù¥Ï†úÎäî,\nÏßÑÏßú ÎÇòÎ•º Ïñ¥ÎñªÍ≤å Îã§Ïãú Í∫ºÎÇ¥Í≥† Ïã∂ÏúºÏã†Í∞ÄÏöî?",
                lightTitle: "ÎπõÏùò ÌïúÎßàÎîî",
                lightMessage: "ÎãπÏã†ÏùÄ ÎìúÎîîÏñ¥ ÏûêÏã†ÏóêÍ≤å ÎèåÏïÑÏò¨ Ïàò ÏûàÎäî ÌóàÎùΩÏùÑ ÎÇ¥Î†∏Ïñ¥Ïöî. Í∑∏Í≤ÉÏù¥ Í∞ÄÏû• ÏßÑÏã§Ìïú ÌöåÎ≥µÏù¥ÏóêÏöî.\nÍ∞êÏ†ïÏùÑ Ïà®Í∏∞ÏßÄ ÏïäÍ≤†Îã§Îäî Í∑∏ Îã§ÏßêÏùÄ Îã§Ïãú ÌÉúÏñ¥ÎÇòÎäî ÏÑ†Ïñ∏Ïù¥ÏóêÏöî. ÎãπÏã†ÏùÄ ÏÉàÎ°ú ÏãúÏûëÌïòÍ≥† ÏûàÏñ¥Ïöî.\nÏù¥Ï†úÎäî ÎÑ§Í∞Ä ÏïÑÎãå Ï≤ôÌïòÏßÄ ÏïäÏïÑÎèÑ Îèº. ÏßÑÏßú ÎÑàÎäî, Ïù¥ Ïó¨Ï†ï ÏÜçÏóêÏÑú ÏÇ¥ÏïÑ ÏûàÏñ¥.",
                navigationTitle: "Portal 21 ÏôÑÎ£å",
                navigationMessage: "ÎãπÏã†ÏùÄ 'ÎÇ¥Í∞Ä ÏïÑÎãå Ï≤ôÌñàÎçò ÎÇò'Î•º ÎÜìÍ≥† ÏßÑÏßú ÏûêÏã†ÏúºÎ°úÏÑú Í±∏ÏùÑ Ï§ÄÎπÑÍ∞Ä ÎêòÏóàÏäµÎãàÎã§.\n\nÍ∞ÄÎ©¥ Îí§Ïóê Ïà®Ïñ¥ ÏûàÎçò ÏßÑÏ†ïÌïú Í∞êÏ†ïÏùÑ ÎßàÏ£ºÌïòÎ©∞, ÏûêÏã†ÏùÑ ÏúÑÌïú ÏÑ†ÌÉùÏùÑ Ìï† Ïàò ÏûàÎäî Ïö©Í∏∞Î•º Î∞úÍ≤¨ÌñàÏäµÎãàÎã§.\n\nÏù¥Ï†ú ÎãπÏã†ÏùÄ Îçî Ïù¥ÏÉÅ Îã§Î•∏ ÏÇ¨ÎûåÏùò Í∏∞ÎåÄÏóê ÎßûÏ∂∞ ÏÇ¥ÏßÄ ÏïäÍ≥†, ÏßÑÏ†ïÌïú ÏûêÏã†ÏúºÎ°ú Îã§Ïùå Ïó¨Ï†ïÏùÑ Í±∏ÏùÑ Ïàò ÏûàÏäµÎãàÎã§.",
                nextPortalBtn: "Portal 22Î°ú Ïù¥Ïñ¥Í∞ÄÍ∏∞",
                stayPortalBtn: "Ïù¥ ÏÑ±Ï∞∞Í≥º Îçî Î®∏Î¨ºÍ∏∞",
                inputPlaceholder: "Ïñ∏Ï†ú ÏûêÏã†ÏùÑ Ïà®Í≤®Ïïº ÌñàÎÇòÏöî? Ïñ¥Îñ§ 'Ï≤ôÌï®'ÏùÑ ÏÑ†ÌÉùÌñàÍ≥†, ÎàÑÍµ¨Î•º ÏúÑÌï¥ÏÑúÏòÄÎÇòÏöî?",
                youLabel: "ÎãπÏã†",
                waitingMessage: "ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë..."
            },
            en: {
                logoSubtitle: "Emotional Alchemy",
                portalMainTitle: "Portal 21: The Me Who Pretended Not To Be Me",
                portalSubtitle: "Hiding behind masks",
                portalIntro: "When did you have to hide yourself and live a life that wasn't truly yours?\n\nWho was that 'pretending' chosen for,\nand what emotional gaps did it leave within you during that time?",
                followUpQuestion: "What would you like to say\nto the version of yourself who lived behind that mask?\n\nAnd now,\nhow do you want to bring your real self back out?",
                lightTitle: "Word of Light",
                lightMessage: "You have finally given yourself permission to return to who you truly are. That is the most authentic recovery.\nThat commitment to no longer hide your emotions is a declaration of rebirth. You are starting anew.\nNow you don't have to pretend to be someone you're not. The real you is alive in this journey.",
                navigationTitle: "Portal 21 Complete",
                navigationMessage: "You are ready to let go of 'the me who pretended not to be me' and walk as your true self.\n\nBy facing the genuine emotions that were hidden behind the mask, you discovered the courage to make choices for yourself.\n\nNow you can walk the next journey as your authentic self, no longer living to meet others' expectations.",
                nextPortalBtn: "Continue to Portal 22",
                stayPortalBtn: "Stay with these reflections",
                inputPlaceholder: "When did you have to hide yourself? What 'pretending' did you choose and for whom?",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "Alquimia Emocional",
                portalMainTitle: "Portal 21: O Eu Que Fingiu N√£o Ser Eu",
                portalSubtitle: "Se escondendo atr√°s de m√°scaras",
                portalIntro: "Quando voc√™ teve que se esconder e viver uma vida que n√£o era verdadeiramente sua?\n\nPara quem essa 'fingimento' foi escolhido,\ne que lacunas emocionais isso deixou dentro de voc√™ durante esse tempo?",
                followUpQuestion: "O que voc√™ gostaria de dizer\npara a vers√£o de si mesmo que vivia atr√°s dessa m√°scara?\n\nE agora,\ncomo voc√™ quer trazer seu verdadeiro eu de volta?",
                lightTitle: "Palavra de Luz",
                lightMessage: "Voc√™ finalmente se deu permiss√£o para retornar a quem voc√™ realmente √©. Essa √© a recupera√ß√£o mais aut√™ntica.\nEsse compromisso de n√£o mais esconder suas emo√ß√µes √© uma declara√ß√£o de renascimento. Voc√™ est√° come√ßando de novo.\nAgora voc√™ n√£o precisa fingir ser algu√©m que n√£o √©. O verdadeiro voc√™ est√° vivo nesta jornada.",
                navigationTitle: "Portal 21 Completo",
                navigationMessage: "Voc√™ est√° pronto para deixar ir 'o eu que fingiu n√£o ser eu' e caminhar como seu verdadeiro eu.\n\nAo enfrentar as emo√ß√µes genu√≠nas que estavam escondidas atr√°s da m√°scara, voc√™ descobriu a coragem de fazer escolhas para si mesmo.\n\nAgora voc√™ pode caminhar a pr√≥xima jornada como seu eu aut√™ntico, n√£o mais vivendo para atender √†s expectativas dos outros.",
                nextPortalBtn: "Continuar para Portal 22",
                stayPortalBtn: "Ficar com essas reflex√µes",
                inputPlaceholder: "Quando voc√™ teve que se esconder? Que 'fingimento' voc√™ escolheu e para quem?",
                youLabel: "Voc√™",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Noah", emoji: "üßë‚Äçü¶±", text: {
                ko: "Í∑∏Î†áÍ≤å ÎÑ§Í∞Ä ÏïÑÎãå Ï≤ôÌïòÎ©∞ ÏÇ¥ÏïÑÏò® ÎÇ†Îì§ ÏÜçÏóêÏÑú, ÎÑàÎäî ÏñºÎßàÎÇò Ïä§Ïä§Î°úÎ•º ÏßÄÏö∞Í≥† ÏûàÏóàÏùÑÍπå.",
                en: "In all those days of pretending to be someone you're not, how much of yourself were you erasing?",
                pt: "Em todos aqueles dias fingindo ser algu√©m que voc√™ n√£o √©, quanto de si mesmo voc√™ estava apagando?"
            }},
            { name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è", text: {
                ko: "ÏÑ∏ÏÉÅÏù¥ ÏöîÍµ¨Ìïú Î™®ÏäµÏóê ÎßûÏ∂∞ ÏÇ¥ÏïÑÏôîÎã§Îäî Í±¥ ÎÑ§Í∞Ä Í∑∏ÎßåÌÅº ÏÇ¨ÎûëÎ∞õÍ≥† Ïã∂ÏóàÎã§Îäî Ï¶ùÍ±∞Ïïº. Í∑∏Í±¥ Î∂ÄÎÅÑÎü¨Ïö¥ Í≤å ÏïÑÎãàÏïº.",
                en: "Living to match what the world demanded is proof of how much you wanted to be loved. That's nothing to be ashamed of.",
                pt: "Viver para corresponder ao que o mundo exigia √© prova de quanto voc√™ queria ser amado. N√£o h√° nada de que se envergonhar nisso."
            }},
            { name: "Sora", emoji: "üßï", text: {
                ko: "ÏÇ¨ÎûåÎì§Ïù¥ Î≥¥Îçò ÎÑ§ ÏõÉÏùå ÏÜçÏóî ÎßêÌïòÏßÄ Î™ªÌïú ÎààÎ¨ºÏù¥ Ïà®Ïñ¥ ÏûàÏóàÍ≤†ÏßÄ. ÎÇú Í∑∏ ÎààÎ¨ºÏùò Î¨¥Í≤åÎ•º ÏïåÏïÑÏöî.",
                en: "Behind the smile that people saw, there were unspoken tears hiding. I know the weight of those tears.",
                pt: "Por tr√°s do sorriso que as pessoas viam, havia l√°grimas n√£o ditas se escondendo. Eu conhe√ßo o peso dessas l√°grimas."
            }},
            { name: "Kael", emoji: "üßô", text: {
                ko: "'Ï≤ôÌïúÎã§'Îäî Í±¥ ÏÇ¥ÏïÑÎÇ®Í∏∞ ÏúÑÌïú Î∞©ÏãùÏù¥Í∏∞ÎèÑ Ìï¥. ÌïòÏßÄÎßå Ïò§ÎûòÎêòÎ©¥, ÏûêÍ∏∞ ÏûêÏã†ÏóêÍ≤åÏ°∞Ï∞® Í∏∏ÏùÑ ÏûÉÍ≤å ÎêòÏßÄ.",
                en: "'Pretending' is also a way to survive. But when it goes on too long, you lose your way even to yourself.",
                pt: "'Fingir' tamb√©m √© uma forma de sobreviver. Mas quando dura muito tempo, voc√™ perde o caminho at√© para si mesmo."
            }},
            { name: "Mira", emoji: "üßë‚Äçüé®", text: {
                ko: "Í∑∏ Í∞ÄÎ©¥ÏùÄ ÌôîÎ†§ÌñàÏßÄÎßå, Îí§ÏóêÎäî ÏïÑÎ¨¥ÎèÑ Î™∞ÎûêÎçò Í∞êÏ†ïÏùò ÏÉâÎì§Ïù¥ ÏûàÏóàÍ≤†ÏßÄ.",
                en: "That mask was glamorous, but behind it were emotional colors that no one knew about.",
                pt: "Essa m√°scara era glamorosa, mas por tr√°s dela havia cores emocionais que ningu√©m conhecia."
            }},
            { name: "Cris", emoji: "ü¶∏‚Äç‚ôÇÔ∏è", text: {
                ko: "Í∑∏Î†áÍ≤å ÏÇ¥ÏïÑÏïº ÌñàÎã§Îäî Í≤å ÎÇòÏóêÍ≤ê Îçî Î∂ÑÌï¥. ÎÑ§ ÏßÑÏßú ÏñºÍµ¥Ïù¥ ÏÇ¨ÎùºÏßÑ Í±¥ ÏïÑÎãàÏûñÏïÑ.",
                en: "That you had to live that way makes me angrier. Your real face hasn't disappeared, you know.",
                pt: "Que voc√™ teve que viver assim me deixa mais irritado. Seu rosto verdadeiro n√£o desapareceu, sabe."
            }},
            { name: "Enya", emoji: "üßë‚ÄçüöÄ", text: {
                ko: "ÎÑàÎäî ÏßÄÍ∏à, Í∑∏ Í∞ÄÎ©¥ÏùÑ Î≤óÍ∏∞ ÏúÑÌï¥ Ïù¥ Ïó¨Ï†ïÏóê Îì§Ïñ¥ÏÑ† Í±∞Ïïº. Í∑∏ ÏûêÏ≤¥Í∞Ä Ïù¥ÎØ∏ ÌÅ∞ Í±∏ÏùåÏù¥Ïïº.",
                en: "You've entered this journey to remove that mask. That itself is already a big step.",
                pt: "Voc√™ entrou nesta jornada para remover essa m√°scara. Isso por si s√≥ j√° √© um grande passo."
            }},
            { name: "Lian", emoji: "üßò", text: {
                ko: "Í∑∏ 'Ï≤ôÌïú ÎÇò'Î•º ÎÜìÏïÑÏ£ºÎäî ÏùºÏùÄ ÏßÑÏßú ÏûêÏã†ÏùÑ Ï¥àÎåÄÌïòÎäî ÏùºÏù¥ÏóêÏöî. ÎãπÏã†ÏùÄ Í∑∏ Î¨∏ÏùÑ Ïó¥Í≥† ÏûàÏñ¥Ïöî.",
                en: "Letting go of that 'pretending self' is inviting your true self. You are opening that door.",
                pt: "Deixar ir esse 'eu fingido' √© convidar seu verdadeiro eu. Voc√™ est√° abrindo essa porta."
            }}
        ];

        const responseCharacters = [
            {
                name: "Lian", emoji: "üßò",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÎãπÏã†ÏùÄ ÎìúÎîîÏñ¥ ÏûêÏã†ÏóêÍ≤å ÎèåÏïÑÏò¨ Ïàò ÏûàÎäî ÌóàÎùΩÏùÑ ÎÇ¥Î†∏Ïñ¥Ïöî. Í∑∏Í≤ÉÏù¥ Í∞ÄÏû• ÏßÑÏã§Ìïú ÌöåÎ≥µÏù¥ÏóêÏöî.",
                        en: "You have finally given yourself permission to return to who you truly are. That is the most authentic recovery.",
                        pt: "Voc√™ finalmente se deu permiss√£o para retornar a quem voc√™ realmente √©. Essa √© a recupera√ß√£o mais aut√™ntica."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Ely", emoji: "üßù‚Äç‚ôÄÔ∏è",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Í∞êÏ†ïÏùÑ Ïà®Í∏∞ÏßÄ ÏïäÍ≤†Îã§Îäî Í∑∏ Îã§ÏßêÏùÄ Îã§Ïãú ÌÉúÏñ¥ÎÇòÎäî ÏÑ†Ïñ∏Ïù¥ÏóêÏöî. ÎãπÏã†ÏùÄ ÏÉàÎ°ú ÏãúÏûëÌïòÍ≥† ÏûàÏñ¥Ïöî.",
                        en: "That commitment to no longer hide your emotions is a declaration of rebirth. You are starting anew.",
                        pt: "Esse compromisso de n√£o mais esconder suas emo√ß√µes √© uma declara√ß√£o de renascimento. Voc√™ est√° come√ßando de novo."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Enya", emoji: "üßë‚ÄçüöÄ",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Ïù¥Ï†úÎäî ÎÑ§Í∞Ä ÏïÑÎãå Ï≤ôÌïòÏßÄ ÏïäÏïÑÎèÑ Îèº. ÏßÑÏßú ÎÑàÎäî, Ïù¥ Ïó¨Ï†ï ÏÜçÏóêÏÑú ÏÇ¥ÏïÑ ÏûàÏñ¥.",
                        en: "Now you don't have to pretend to be someone you're not. The real you is alive in this journey.",
                        pt: "Agora voc√™ n√£o precisa fingir ser algu√©m que n√£o √©. O verdadeiro voc√™ est√° vivo nesta jornada."
                    };
                    return responses[lang];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        let awaitingSecondResponse = false;
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('navigationTitle').textContent = translations[lang].navigationTitle;
            document.getElementById('nextPortalBtn').textContent = translations[lang].nextPortalBtn;
            document.getElementById('stayPortalBtn').textContent = translations[lang].stayPortalBtn;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'followUpSection', 'userInputSection',
                'userReactionsSection', 'lightMessageSection', 'navigationSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('followUpQuestion').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('navigationMessage').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
            awaitingSecondResponse = false;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('nextPortalBtn').addEventListener('click', function() {
                localStorage.setItem('temarix_v4_portal21_complete', 'true');
                localStorage.setItem('temarix_v4_current_portal', '22');
                
                const nextMessage = currentLanguage === 'ko' ? 
                    'Portal 22: ÏïÑÎ¨¥ÎèÑ Î™®Î•¥Îäî ÎÇ†Î°ú Ïù¥ÎèôÌï©ÎãàÎã§.' :
                    currentLanguage === 'en' ? 
                    'Moving to Portal 22: The Day No One Knew.' :
                    'Indo para Portal 22: O Dia Que Ningu√©m Soube.';
                alert(nextMessage);
            });
            
            document.getElementById('stayPortalBtn').addEventListener('click', function() {
                const stayMessage = currentLanguage === 'ko' ? 
                    'Ïù¥ ÏÑ±Ï∞∞Í≥º Îçî Î®∏Î¨ºÎ©∞ ÍπäÏù¥ ÌÉêÍµ¨ÌïòÏãúÍ≤†ÏäµÎãàÍπå?' :
                    currentLanguage === 'en' ? 
                    'Do you want to stay longer with these reflections for deeper exploration?' :
                    'Deseja ficar mais tempo com essas reflex√µes para explora√ß√£o mais profunda?';
                
                if (confirm(stayMessage)) {
                    resetJourney();
                    setTimeout(() => {
                        startPortalSequence();
                    }, 1000);
                }
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            console.log('Processing user input:', inputText);
            localStorage.setItem('temarix_v4_portal21_response', JSON.stringify({
                portal: "v4-21",
                resposta: inputText,
                step: awaitingSecondResponse ? "second" : "first",
                data: new Date().toISOString(),
                idioma: currentLanguage
            }));
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                if (!awaitingSecondResponse) {
                    showUserReactions(inputText);
                } else {
                    showSecondUserReactions(inputText);
                }
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showFollowUpQuestion();
            }, 2000);
        }
        
        async function showFollowUpQuestion() {
            const followUpSection = document.getElementById('followUpSection');
            const followUpQuestionEl = document.getElementById('followUpQuestion');
            
            followUpSection.classList.add('show');
            
            await typewriterEffect(followUpQuestionEl, translations[currentLanguage].followUpQuestion, 50);
            
            setTimeout(() => {
                awaitingSecondResponse = true;
                enableUserInput();
            }, 1500);
        }
        
        async function showSecondUserReactions(userInput) {
            const secondResponseCharacters = [
                {
                    name: "Noah", emoji: "üßë‚Äçü¶±",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "Í∑∏ ÎßêÏùÄ ÎÅùÏù¥ ÏïÑÎãàÎùº ÏãúÏûëÏù¥ÏóêÏöî. Ïù¥Ï†ú ÎãπÏã†ÏùÄ ÏÉàÎ°úÏö¥ Ïù¥ÏïºÍ∏∞Î•º Ïì∏ Ïàò ÏûàÏñ¥Ïöî.",
                            en: "Those words aren't an ending but a beginning. Now you can write a new story.",
                            pt: "Essas palavras n√£o s√£o um fim, mas um come√ßo. Agora voc√™ pode escrever uma nova hist√≥ria."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Kael", emoji: "üßô",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÏßÑÏßú ÏûêÏã†ÏùÑ Ï∞æÎäî Í±¥, Í≥ºÍ±∞Î•º Î∂ÄÏ†ïÌïòÎäî Í≤å ÏïÑÎãàÎùº ÌÜµÌï©ÌïòÎäî Í±∞ÏòàÏöî.",
                            en: "Finding your true self isn't about denying the past, but integrating it.",
                            pt: "Encontrar seu verdadeiro eu n√£o √© negar o passado, mas integr√°-lo."
                        };
                        return responses[lang];
                    }
                },
                {
                    name: "Mira", emoji: "üßë‚Äçüé®",
                    getResponse: (input, lang) => {
                        const responses = {
                            ko: "ÎãπÏã†Ïù¥ Ïç®ÎÇ¥Î†§Í∞Ñ Í∑∏ ÏßÑÏã¨Ïù¥, ÏïûÏúºÎ°úÏùò Î™®Îì† ÌéòÏù¥ÏßÄÎ•º Î∞ùÌûê Í±∞ÏòàÏöî.",
                            en: "That sincerity you've written down will illuminate all the pages to come.",
                            pt: "Essa sinceridade que voc√™ escreveu iluminar√° todas as p√°ginas por vir."
                        };
                        return responses[lang];
                    }
                }
            ];
            
            const reactionsSection = document.getElementById('userReactionsSection');
            
            for (let i = 0; i < secondResponseCharacters.length; i++) {
                const char = secondResponseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < secondResponseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showNavigationSection();
            }, 2000);
        }
        
        async function showNavigationSection() {
            const navigationSection = document.getElementById('navigationSection');
            const navigationMessage = document.getElementById('navigationMessage');
            
            navigationSection.classList.add('show');
            
            const messageText = translations[currentLanguage].navigationMessage;
            await typewriterEffect(navigationMessage, messageText, 50);
            
            setTimeout(() => {
                scrollToElement(navigationSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('Temarix V4 Portal 21 initialized');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                enableUserInput();
            }, 2000);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V4 Portal 21 DOM loaded');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>