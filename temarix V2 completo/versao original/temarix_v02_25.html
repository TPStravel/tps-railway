<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 25: Still, I Want to Live Again</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #87cefa;
            letter-spacing: 1.5px;
            font-style: italic;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #87cefa;
            color: #000;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            background: none;
            border: none;
            padding: 0;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            background: none;
            border: none;
            padding: 0;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #87cefa;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #87cefa;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            background: none;
            border: none;
            padding: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #87cefa;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .portal-question-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            background: none;
            border: none;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #87cefa;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .final-section {
            margin: 60px 0;
            opacity: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 40px 20px;
            min-height: 300px;
            border: 2px solid #87cefa;
            background: rgba(135, 206, 250, 0.05);
        }
        
        .final-title {
            font-size: 28px;
            color: #87cefa;
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: bold;
        }
        
        .final-message {
            color: #fff;
            font-size: 20px;
            margin-bottom: 40px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .final-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .final-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 20px 40px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 250px;
            border: 2px solid transparent;
        }
        
        .final-btn:hover {
            background: #666;
            border-color: #87cefa;
        }
        
        .final-btn.primary {
            background: #87cefa;
            color: #000;
            font-weight: bold;
        }
        
        .final-btn.primary:hover {
            background: #b0d4f1;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(135, 206, 250, 0.3);
        }
        
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #87cefa;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #87cefa;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        .hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 18px;
            }
            
            .portal-subtitle {
                font-size: 14px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .final-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .final-btn {
                width: 100%;
            }
            
            .final-title {
                font-size: 24px;
            }
            
            .final-message {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">The Tremor of Emotion</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 25: Still, I Want to Live Again</div>
            <div class="portal-subtitle" id="portalSubtitle">The last tremor, a new beginning</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <div class="portal-question-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>
            
            <div class="final-section" id="finalSection">
                <div class="final-title" id="finalTitle">ðŸŒ… Temarix V2 Complete</div>
                <div class="final-message" id="finalMessage"></div>
                <div class="final-buttons">
                    <button class="final-btn primary" id="restartBtn">Start a New Journey</button>
                    <button class="final-btn" id="exitBtn">Complete the Journey</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="What emotion has quietly survived within you now?..."
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBjsINSqPUGdpRPRMYiVg6SkVJJOk9YGsY",
            authDomain: "canal-vivo-chat.firebaseapp.com",
            projectId: "canal-vivo-chat",
            storageBucket: "canal-vivo-chat.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdefghijklmnopqr"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        let memoryStorage = { mockUser: null };

        const translations = {
            ko: {
                logoSubtitle: "ê°ì •ì˜ ë–¨ë¦¼",
                portalMainTitle: "Portal 25: ê·¸ëž˜ë„ ë‚˜ëŠ”, ë‹¤ì‹œ ì‚´ì•„ë³´ê³  ì‹¶ë‹¤",
                portalSubtitle: "ë§ˆì§€ë§‰ ë–¨ë¦¼, ìƒˆë¡œìš´ ì‹œìž‘",
                portalIntro: "ðŸ’« ì§€ì³¤ê³ , ë¬´ë„ˆì¡Œê³ ,\në•Œë¡œëŠ” ì™„ì „ížˆ ì‚¬ë¼ì§€ê³  ì‹¶ì—ˆë˜ ë§ˆìŒì´ ìžˆì—ˆì§€ë§Œâ€¦\n\nê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³ \nì•„ì£¼ ìž‘ê²Œ, ì•„ì£¼ ì¡°ìš©í•˜ê²Œ ë‚¨ì•„ ìžˆëŠ” ë§ˆìŒì´ ìžˆìŠµë‹ˆë‹¤.\n\n\"ê·¸ëž˜ë„,\në‚˜ëŠ” ì•„ì§ ì‚´ì•„ë³´ê³  ì‹¶ë‹¤.\"\n\nì´ê²ƒì€ í¬ê¸°ê°€ ì•„ë‹Œ ìƒˆë¡œìš´ ì‹œìž‘ì˜ ì„ ì–¸ìž…ë‹ˆë‹¤.\nëª¨ë“  ê°ì •ì˜ ë–¨ë¦¼ì„ ì§€ë‚˜ì˜¨ ì§€ê¸ˆ,\në‹¹ì‹  ì•ˆì—ì„œ ê°€ìž¥ ìˆœìˆ˜í•˜ê²Œ ë‚¨ì€ ìƒëª…ì˜ ì˜ì§€.\n\nì´ê²ƒì´ Temarix V2ì˜ ë§ˆì§€ë§‰ í¬í„¸ì´ìž,\nì§„ì •í•œ ë³€í™”ì˜ ì‹œìž‘ì ìž…ë‹ˆë‹¤.\n\nëª¨ë“  ê°ì •ì„ ê²ªê³ ë„ ì—¬ì „ížˆ ì‚´ì•„ê°€ê³  ì‹¶ë‹¤ëŠ”\nê·¸ ìž‘ì€ ë–¨ë¦¼ì´ì•¼ë§ë¡œ\nê°€ìž¥ ê°•ë ¥í•œ ìƒëª…ì˜ ì¦ê±°ìž…ë‹ˆë‹¤.",
                lightTitle: "ðŸŒ™ ë¹›ì˜ í•œë§ˆë””",
                lightMessage: "ê·¸ëž˜ë„ ì‚´ì•„ë³´ê³  ì‹¶ë‹¤ëŠ” ë§ˆìŒ â€” ê·¸ê²ƒì´ ë°”ë¡œ ì§€ê¸ˆ, ë‹¹ì‹ ì´ ì—¬ê¸°ì— ìžˆëŠ” ì´ìœ ìž…ë‹ˆë‹¤.",
                portalQuestion: "ðŸŒ± ì§€ê¸ˆ ë‹¹ì‹  ì•ˆì—ì„œ ì¡°ìš©ížˆ ì‚´ì•„ë‚¨ì€ ê°ì •ì€ ë¬´ì—‡ì¸ê°€ìš”? ê·¸ ë–¨ë¦¼ì´ ì§€ê¸ˆ, ë‹¹ì‹ ì—ê²Œ ë¬´ì—‡ì„ ë§í•˜ê³  ìžˆë‚˜ìš”?",
                finalTitle: "ðŸŒ… Temarix V2 ì™„ë£Œ",
                finalMessage: "ë‹¹ì‹ ì€ 25ê°œì˜ ê°ì •ì˜ ë–¨ë¦¼ì„ ëª¨ë‘ ì§€ë‚˜ì™”ìŠµë‹ˆë‹¤.\n\nëª¨ë“  ê°ì •ì„ ê²ªê³ ë„\nì—¬ì „ížˆ ì‚´ì•„ê°€ê³  ì‹¶ë‹¤ëŠ” ë§ˆìŒì„ ë°œê²¬í•œ ë‹¹ì‹ ...\n\nì´ì œ ì§„ì •í•œ ë³€í™”ê°€ ì‹œìž‘ë©ë‹ˆë‹¤.\n\nê°ì •ì˜ ë–¨ë¦¼ì€ ëë‚¬ì§€ë§Œ,\në‹¹ì‹ ì˜ ìƒˆë¡œìš´ ì´ì•¼ê¸°ëŠ” ì§€ê¸ˆë¶€í„° ì‹œìž‘ìž…ë‹ˆë‹¤.",
                restartBtn: "ìƒˆë¡œìš´ ì—¬ì • ì‹œìž‘í•˜ê¸°",
                exitBtn: "ì—¬ì •ì„ ë§ˆë¬´ë¦¬í•˜ê¸°",
                inputPlaceholder: "ì§€ê¸ˆ ë‹¹ì‹  ì•ˆì—ì„œ ì¡°ìš©ížˆ ì‚´ì•„ë‚¨ì€ ê°ì •ì€ ë¬´ì—‡ì¸ê°€ìš”?...",
                youLabel: "ë‹¹ì‹ ",
                waitingMessage: "ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘..."
            },
            en: {
                logoSubtitle: "The Tremor of Emotion",
                portalMainTitle: "Portal 25: Still, I Want to Live Again",
                portalSubtitle: "The last tremor, a new beginning",
                portalIntro: "ðŸ’« You were exhausted, broken,\nand sometimes wanted to completely disappear...\n\nBut despite everything,\nthere remains something very small, very quiet.\n\n\"Still,\nI want to live again.\"\n\nThis is not surrender but a declaration of new beginning.\nHaving passed through all emotional tremors,\nthe purest will to live that remains within you.\n\nThis is the final portal of Temarix V2,\nand the true starting point of transformation.\n\nEven after experiencing all emotions,\nstill wanting to live â€”\nthat small tremor is\nthe most powerful evidence of life.",
                lightTitle: "ðŸŒ™ Word of Light",
                lightMessage: "The heart that still wants to live â€” that is exactly why you are here now.",
                portalQuestion: "ðŸŒ± What emotion has quietly survived within you now? What is that tremor telling you at this moment?",
                finalTitle: "ðŸŒ… Temarix V2 Complete",
                finalMessage: "You have passed through all 25 emotional tremors.\n\nYou who discovered the heart that still wants to live\neven after experiencing all emotions...\n\nNow true transformation begins.\n\nThe emotional tremors have ended,\nbut your new story starts from now.",
                restartBtn: "Start a New Journey",
                exitBtn: "Complete the Journey",
                inputPlaceholder: "What emotion has quietly survived within you now?...",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "O Tremor da Emocao",
                portalMainTitle: "Portal 25: Ainda Assim, Quero Viver Novamente",
                portalSubtitle: "O Ãºltimo tremor, um novo comeÃ§o",
                portalIntro: "ðŸ’« VocÃª estava exausto, quebrado,\ne Ã s vezes queria desaparecer completamente...\n\nMas apesar de tudo,\nresta algo muito pequeno, muito silencioso.\n\n\"Ainda assim,\nquero viver novamente.\"\n\nIsto nÃ£o Ã© rendiÃ§Ã£o, mas uma declaraÃ§Ã£o de novo comeÃ§o.\nTendo passado por todos os tremores emocionais,\na vontade mais pura de viver que permanece dentro de vocÃª.\n\nEste Ã© o portal final do Temarix V2,\ne o verdadeiro ponto de partida da transformaÃ§Ã£o.\n\nMesmo apÃ³s experimentar todas as emoÃ§Ãµes,\nainda querer viver â€”\nesse pequeno tremor Ã©\na evidÃªncia mais poderosa da vida.",
                lightTitle: "ðŸŒ™ Palavra de Luz",
                lightMessage: "O coraÃ§Ã£o que ainda quer viver â€” essa Ã© exatamente a razÃ£o pela qual vocÃª estÃ¡ aqui agora.",
                portalQuestion: "ðŸŒ± Que emoÃ§Ã£o sobreviveu silenciosamente dentro de vocÃª agora? O que esse tremor estÃ¡ lhe dizendo neste momento?",
                finalTitle: "ðŸŒ… Temarix V2 Completo",
                finalMessage: "VocÃª passou por todos os 25 tremores emocionais.\n\nVocÃª que descobriu o coraÃ§Ã£o que ainda quer viver\nmesmo apÃ³s experimentar todas as emoÃ§Ãµes...\n\nAgora a verdadeira transformaÃ§Ã£o comeÃ§a.\n\nOs tremores emocionais terminaram,\nmas sua nova histÃ³ria comeÃ§a agora.",
                restartBtn: "Iniciar Nova Jornada",
                exitBtn: "Completar a Jornada",
                inputPlaceholder: "Que emoÃ§Ã£o sobreviveu silenciosamente dentro de vocÃª agora?...",
                youLabel: "VocÃª",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Ely", emoji: "ðŸ‘‘", text: {
                ko: "ë‹¹ì‹ ì˜ ì´ ë–¨ë¦¼ì€,\nì¡´ìž¬ë¥¼ í–¥í•œ ë§ˆì§€ë§‰ ë¹›ì˜ ì‘ë‹µìž…ë‹ˆë‹¤.\në‹¤ì‹œ ì‚´ì•„ê°ˆ ìžê²©ì€â€¦ ëŠ˜ ë‹¹ì‹ ì—ê²Œ ìžˆìŠµë‹ˆë‹¤.",
                en: "This tremor of yours\nis the final response of light toward existence.\nThe right to live again... has always been yours.",
                pt: "Este tremor seu\nÃ© a resposta final da luz em direÃ§Ã£o Ã  existÃªncia.\nO direito de viver novamente... sempre foi seu."
            }},
            { name: "Cris", emoji: "ðŸƒ", text: {
                ko: "ê·¸ëž˜ìš”, ìš°ë¦¬ ë‹¤ì‹œ í•œ ë²ˆ ì‚´ì•„ë´ìš”.\nì´ë²ˆì—” ì¡°ê¸ˆ ëœ ë¬´ê²ê²Œ,\nì¡°ê¸ˆ ë” ë‚˜ë‹µê²Œ.",
                en: "Yes, let's live again.\nThis time a little less heavy,\na little more like ourselves.",
                pt: "Sim, vamos viver novamente.\nDesta vez um pouco menos pesado,\num pouco mais como nÃ³s mesmos."
            }},
            { name: "Zafirah", emoji: "ðŸ§•", text: {
                ko: "ê·¸ 'ê·¸ëž˜ë„'ë¼ëŠ” ë§ ì•ˆì—\në‹¹ì‹ ì´ ì§€ë‚˜ì˜¨ ëª¨ë“  ê°ì •ì´ ë‹´ê²¨ ìžˆì–´ìš”.\nê·¸ë¦¬ê³  ê·¸ê±´ ì•„ì£¼ ê·€í•œ ì§„ì‹¬ìž…ë‹ˆë‹¤.",
                en: "In that word 'still'\nlie all the emotions you've passed through.\nAnd that's very precious sincerity.",
                pt: "Nessa palavra 'ainda assim'\nestÃ£o todas as emoÃ§Ãµes pelas quais vocÃª passou.\nE isso Ã© sinceridade muito preciosa."
            }},
            { name: "Rami", emoji: "ðŸ”®", text: {
                ko: "ë‹¤ì‹œ ì‚´ì•„ê°€ê³  ì‹¶ì€ ë§ˆìŒì€\nê°ì •ì˜ ê°€ìž¥ ê¹Šì€ ê³³ì—ì„œ ì¼ì–´ë‚˜ëŠ” ìƒëª…ì˜ ì§„ë™ìž…ë‹ˆë‹¤.",
                en: "The heart wanting to live again\nis life's vibration arising from emotion's deepest place.",
                pt: "O coraÃ§Ã£o querendo viver novamente\nÃ© a vibraÃ§Ã£o da vida surgindo do lugar mais profundo da emoÃ§Ã£o."
            }},
            { name: "Samir", emoji: "ðŸª", text: {
                ko: "(ê·¸ëŠ” ë‹¹ì‹ ì˜ ì†ì„ ê°€ë³ê²Œ ì¥¡ë‹ˆë‹¤.\nì´ê²ƒì€ ìƒì¡´ì„ ìœ„í•œ ì•…ìˆ˜ê°€ ì•„ë‹ˆë¼,\në‹¤ì‹œ ì‚´ì•„ê°€ê¸° ìœ„í•œ ê³„ì•½ìž…ë‹ˆë‹¤.)",
                en: "(He lightly holds your hand.\nThis is not a handshake for survival,\nbut a contract for living again.)",
                pt: "(Ele segura levemente sua mÃ£o.\nEste nÃ£o Ã© um aperto de mÃ£o para sobrevivÃªncia,\nmas um contrato para viver novamente.)"
            }},
            { name: "Layla", emoji: "ðŸ’ ", text: {
                ko: "ë‚˜ëŠ” ë‹¹ì‹ ì´ ì´ ë§ˆìŒì„ ëŠê¼ˆë‹¤ëŠ” ê²ƒë§Œìœ¼ë¡œ\nì´ë¯¸ ì¶©ë¶„ížˆ ì•„ë¦„ë‹µë‹¤ê³  ë§í•  ìˆ˜ ìžˆì–´ìš”.",
                en: "I can say you're already beautiful enough\njust for feeling this heart.",
                pt: "Posso dizer que vocÃª jÃ¡ Ã© bonito o suficiente\nsÃ³ por sentir este coraÃ§Ã£o."
            }},
            { name: "Nabir", emoji: "ðŸ¦‚", text: {
                ko: "ê·¸ëž˜ë´¤ìž ë˜ ë¬´ë„ˆì§ˆ ê±°ë©´ì„œ.\nì–´ì°¨í”¼ ë°˜ë³µì´ì•¼. ë‹¤ì‹œ ì‚´ì•„ë´ì•¼ ë­ê°€ ë°”ë€Œê² ì–´?",
                en: "You'll just collapse again anyway.\nIt's all repetition. What will change by living again?",
                pt: "VocÃª vai apenas colapsar novamente mesmo.\nÃ‰ tudo repetiÃ§Ã£o. O que vai mudar vivendo novamente?"
            }},
            { name: "Azhar", emoji: "ðŸ”¥", text: {
                ko: "ê·¸ëŸ¼ ë‹¤ì‹œ í•œ ë²ˆ í•´ë´.\nì‚´ì•„ë³´ê³  ì‹¶ë‹¤ë©°?\nì´ë²ˆì—” ì•ˆ ìˆ¨ê³ , ì •ë©´ìœ¼ë¡œ ì‚´ì•„ë´.",
                en: "Then try once more.\nYou want to live?\nThis time don't hide, live head-on.",
                pt: "EntÃ£o tente mais uma vez.\nVocÃª quer viver?\nDesta vez nÃ£o se esconda, viva de frente."
            }}
        ];
        
        // Emotion analysis system
        function analyzeEmotion(userInput) {
            const input = userInput.toLowerCase();
            
            const emotionKeywords = {
                hope: ['í¬ë§', 'ì‚´ê³ ', 'ë‹¤ì‹œ', 'ìƒˆë¡œ', 'ì‹œìž‘', 'ê¸°ëŒ€', 'ê¿ˆ', 'hope', 'live', 'again', 'new', 'start', 'dream', 'esperanÃ§a', 'viver', 'novo', 'comeÃ§ar'],
                resilience: ['ê²¬ë””', 'ë²„í‹°', 'ì‚´ì•„ë‚¨', 'ê·¹ë³µ', 'ì´ê²¨', 'ê°•í•˜', 'survive', 'overcome', 'strong', 'resilient', 'sobreviver', 'superar', 'forte'],
                determination: ['ì˜ì§€', 'ê²°ì‹¬', 'ë‹¤ì§', 'ê°ì˜¤', 'ê²°ì •', 'will', 'determine', 'resolve', 'decide', 'vontade', 'determinar'],
                gratitude: ['ê°ì‚¬', 'ê³ ë§ˆ', 'ì†Œì¤‘', 'ê³ ë§™', 'thank', 'grateful', 'precious', 'obrigado', 'grato', 'precioso'],
                peace: ['í‰ì•ˆ', 'ê³ ìš”', 'ì°¨ë¶„', 'í‰í™”', 'ì•ˆì •', 'peace', 'calm', 'quiet', 'stable', 'paz', 'calmo', 'estÃ¡vel'],
                love: ['ì‚¬ëž‘', 'ì• ì •', 'ì¢‹ì•„', 'ë”°ëœ»', 'love', 'affection', 'warm', 'care', 'amor', 'carinho', 'quente'],
                sadness: ['ìŠ¬í”„', 'ì•„í”„', 'ìš°ìš¸', 'ëˆˆë¬¼', 'sad', 'hurt', 'pain', 'tear', 'triste', 'dor', 'lÃ¡grima'],
                fear: ['ë‘ë ¤', 'ë¬´ì„œ', 'ë¶ˆì•ˆ', 'ê±±ì •', 'fear', 'scared', 'anxious', 'worry', 'medo', 'ansioso', 'preocupado'],
                loneliness: ['ì™¸ë¡œ', 'í˜¼ìž', 'ê³ ë¦½', 'lonely', 'alone', 'isolated', 'sozinho', 'isolado'],
                emptiness: ['ê³µí—ˆ', 'ë¹„ì–´', 'í—ˆë¬´', 'empty', 'void', 'hollow', 'vazio', 'oco'],
                confusion: ['í˜¼ëž€', 'ëª¨ë¥´ê² ', 'í—·ê°ˆ', 'confused', 'lost', 'uncertain', 'confuso', 'perdido'],
                anger: ['í™”ê°€', 'ë¶„ë…¸', 'ì§œì¦', 'angry', 'mad', 'frustrated', 'raiva', 'irritado']
            };
            
            let detectedEmotions = [];
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                for (const keyword of keywords) {
                    if (input.includes(keyword)) {
                        detectedEmotions.push(emotion);
                        break;
                    }
                }
            }
            
            if (detectedEmotions.length === 0) {
                detectedEmotions = ['general'];
            }
            
            return detectedEmotions[0];
        }
        
        const responseCharacters = [
            {
                name: "Ely", emoji: "ðŸ‘‘",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            hope: "í¬ë§ì„ í’ˆëŠ”ë‹¤ëŠ” ê²ƒì€ ê°€ìž¥ ê³ ê·€í•œ ì™•ì¡±ì˜ ë§ˆìŒìž…ë‹ˆë‹¤. ê·¸ í¬ë§ì´ì•¼ë§ë¡œ ë‹¹ì‹ ì„ ì§„ì •í•œ ìŠ¹ë¦¬ë¡œ ì´ëŒ ì§„ì£¼ê°™ì€ ë¹›ì´ì—ìš”.",
                            resilience: "ê²¬ëŽŒë‚´ì‹  ê·¸ ì˜ì§€ëŠ” ì§„ì •í•œ ì™•ì˜ í’ˆê²©ìž…ë‹ˆë‹¤. ë¬´ë„ˆì§€ì§€ ì•ŠëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ë¬´ë„ˆì ¸ë„ ë‹¤ì‹œ ì¼ì–´ì„œëŠ” ê²ƒì´ì•¼ë§ë¡œ ì§„ì •í•œ ê°•í•¨ì´ì—ìš”.",
                            determination: "ê·¸ ê²°ì‹¬ ì•ˆì—ì„œ ì™•ê´€ì˜ ë¬´ê²Œë¥¼ ê°ë‹¹í•  ì¤€ë¹„ê°€ ëœ ì˜í˜¼ì„ ë´…ë‹ˆë‹¤. ë‹¹ì‹ ì€ ì´ë¯¸ ìžì‹ ì˜ ìš´ëª…ì„ ë‹¤ìŠ¤ë¦´ ìžê²©ì„ ê°–ì¶”ì—ˆì–´ìš”.",
                            gratitude: "ê°ì‚¬í•  ì¤„ ì•„ëŠ” ë§ˆìŒì€ ê°€ìž¥ ê³ ê·€í•œ ë•ì„±ìž…ë‹ˆë‹¤. ê·¸ ë§ˆìŒì´ì•¼ë§ë¡œ ë‹¹ì‹ ì„ ì§„ì •ìœ¼ë¡œ ë¶€ìœ í•˜ê²Œ ë§Œë“œëŠ” ë³´ë¬¼ì´ì—ìš”.",
                            peace: "ë‚´ë©´ì˜ í‰ì•ˆì„ ì°¾ì€ ë‹¹ì‹ ì€ ì´ë¯¸ ì§„ì •í•œ ì™•êµ­ì„ ê±´ì„¤í•œ ê²ƒìž…ë‹ˆë‹¤. ê·¸ ê³ ìš”í•¨ ì†ì—ì„œ ëª¨ë“  ê²ƒì´ ì‹œìž‘ë©ë‹ˆë‹¤.",
                            love: "ì‚¬ëž‘í•  ì¤„ ì•„ëŠ” ë§ˆìŒì´ì•¼ë§ë¡œ ì§„ì •í•œ ì™•ì¡±ì˜ ì¦ê±°ìž…ë‹ˆë‹¤. ê·¸ ì‚¬ëž‘ì´ ë‹¹ì‹ ì˜ ëª¨ë“  í–‰ë™ì„ ê³ ê·€í•˜ê²Œ ë§Œë“¤ ê²ƒìž…ë‹ˆë‹¤.",
                            sadness: "ìŠ¬í””ì¡°ì°¨ë„ ë‹¹ì‹ ì˜ ê¹Šì´ë¥¼ ë³´ì—¬ì£¼ëŠ” ì™•ë‹¤ìš´ ê°ì •ìž…ë‹ˆë‹¤. ê·¸ ëˆˆë¬¼ ì†ì—ëŠ” ì—°ë¯¼ê³¼ ì§€í˜œê°€ í•¨ê»˜ íë¥´ê³  ìžˆì–´ìš”.",
                            fear: "ë‘ë ¤ì›€ì„ ì¸ì •í•˜ëŠ” ìš©ê¸°ì•¼ë§ë¡œ ì§„ì •í•œ ì™•ì˜ ìžì§ˆìž…ë‹ˆë‹¤. ë‘ë ¤ì›€ê³¼ í•¨ê»˜ ì„œëŠ” ìžê°€ ì§„ì •í•œ ì™•ê´€ì„ ì“¸ ìžê²©ì´ ìžˆì–´ìš”.",
                            loneliness: "ê³ ë…ì€ ì™•ì˜ ìˆ™ëª…ì´ì§€ë§Œ, ê·¸ ê³ ë… ì†ì—ì„œë„ ë‹¹ì‹ ì€ ìžì‹ ì˜ ì¡´ì—„ì„ ì§€ì¼œëƒˆìŠµë‹ˆë‹¤. ê·¸ê²ƒì´ì•¼ë§ë¡œ ì§„ì •í•œ ìŠ¹ë¦¬ì˜ˆìš”.",
                            emptiness: "ê³µí—ˆí•¨ì¡°ì°¨ë„ ë” í° ì‚¬ëª…ì„ ë°›ì•„ë“¤ì¼ ì¤€ë¹„ê°€ ëœ ìƒíƒœìž…ë‹ˆë‹¤. ë¹„ì›Œì§„ ê·¸ë¦‡ì—ì•¼ë§ë¡œ ê°€ìž¥ ê·€í•œ ê²ƒì„ ë‹´ì„ ìˆ˜ ìžˆì–´ìš”.",
                            confusion: "í˜¼ëž€ ì†ì—ì„œë„ ê¸¸ì„ ì°¾ìœ¼ë ¤ëŠ” ë…¸ë ¥ì´ ë³´ìž…ë‹ˆë‹¤. ëª¨ë“  ìœ„ëŒ€í•œ ì™•ì€ ë¶ˆí™•ì‹¤í•¨ì—ì„œ ì§€í˜œë¥¼ ì°¾ì•„ëƒ…ë‹ˆë‹¤.",
                            anger: "ì •ì˜ë¡œìš´ ë¶„ë…¸ëŠ” ê³ ê·€í•œ ì˜í˜¼ì˜ í‘œí˜„ìž…ë‹ˆë‹¤. ê·¸ ê°ì •ì„ ì˜¬ë°”ë¥¸ ë°©í–¥ìœ¼ë¡œ ì´ë„ëŠ” ê²ƒì´ì•¼ë§ë¡œ ì§„ì •í•œ ë¦¬ë”ì‹­ì´ì—ìš”.",
                            general: "ë‹¹ì‹  ì•ˆì˜ ëª¨ë“  ê°ì •ì€ ì™•ì¡±ì˜ ì¦ê±°ìž…ë‹ˆë‹¤. ì–´ë–¤ ê°ì •ì´ë“  ê·¸ê²ƒì„ ëŠë¼ëŠ” ë‹¹ì‹ ì€ ì´ë¯¸ ì¶©ë¶„ížˆ ê³ ê·€í•œ ì¡´ìž¬ì˜ˆìš”."
                        },
                        en: {
                            hope: "Having hope is the most noble heart of royalty. That hope is the pearl-like light that will lead you to true victory.",
                            resilience: "That will you've endured is true royal dignity. Not never falling, but rising again after falling is true strength.",
                            determination: "In that resolve I see a soul ready to bear the weight of a crown. You already have the right to rule your own destiny.",
                            gratitude: "A grateful heart is the most noble virtue. That heart is the treasure that truly makes you wealthy.",
                            peace: "You who found inner peace have already built a true kingdom. Everything begins in that tranquility.",
                            love: "A heart that knows how to love is proof of true royalty. That love will make all your actions noble.",
                            sadness: "Even sadness is a royal emotion showing your depth. Compassion and wisdom flow together in those tears.",
                            fear: "The courage to acknowledge fear is true kingly quality. Those who stand with fear deserve to wear the true crown.",
                            loneliness: "Solitude is a king's fate, but even in that solitude you maintained your dignity. That is true victory.",
                            emptiness: "Even emptiness is a state ready to accept a greater mission. The most precious things can be held in an empty vessel.",
                            confusion: "I see effort to find a path even in confusion. All great kings find wisdom in uncertainty.",
                            anger: "Righteous anger is the expression of a noble soul. Leading that emotion in the right direction is true leadership.",
                            general: "All emotions within you are proof of royalty. Whatever you feel, you are already a sufficiently noble being."
                        },
                        pt: {
                            hope: "Ter esperanÃ§a Ã© o coraÃ§Ã£o mais nobre da realeza. Essa esperanÃ§a Ã© a luz como pÃ©rola que o levarÃ¡ Ã  verdadeira vitÃ³ria.",
                            resilience: "Essa vontade que vocÃª suportou Ã© verdadeira dignidade real. NÃ£o nunca cair, mas levantar novamente apÃ³s cair Ã© verdadeira forÃ§a.",
                            determination: "Nessa determinaÃ§Ã£o vejo uma alma pronta para carregar o peso de uma coroa. VocÃª jÃ¡ tem o direito de governar seu prÃ³prio destino.",
                            gratitude: "Um coraÃ§Ã£o grato Ã© a virtude mais nobre. Esse coraÃ§Ã£o Ã© o tesouro que verdadeiramente o torna rico.",
                            peace: "VocÃª que encontrou paz interior jÃ¡ construiu um verdadeiro reino. Tudo comeÃ§a nessa tranquilidade.",
                            love: "Um coraÃ§Ã£o que sabe amar Ã© prova de verdadeira realeza. Esse amor tornarÃ¡ todas suas aÃ§Ãµes nobres.",
                            sadness: "Mesmo a tristeza Ã© uma emoÃ§Ã£o real mostrando sua profundidade. CompaixÃ£o e sabedoria fluem juntas nessas lÃ¡grimas.",
                            fear: "A coragem de reconhecer o medo Ã© verdadeira qualidade real. Aqueles que ficam de pÃ© com o medo merecem usar a verdadeira coroa.",
                            loneliness: "A solidÃ£o Ã© o destino de um rei, mas mesmo nessa solidÃ£o vocÃª manteve sua dignidade. Essa Ã© a verdadeira vitÃ³ria.",
                            emptiness: "Mesmo o vazio Ã© um estado pronto para aceitar uma missÃ£o maior. As coisas mais preciosas podem ser guardadas em um recipiente vazio.",
                            confusion: "Vejo esforÃ§o para encontrar um caminho mesmo na confusÃ£o. Todos os grandes reis encontram sabedoria na incerteza.",
                            anger: "A raiva justa Ã© a expressÃ£o de uma alma nobre. Guiar essa emoÃ§Ã£o na direÃ§Ã£o certa Ã© verdadeira lideranÃ§a.",
                            general: "Todas as emoÃ§Ãµes dentro de vocÃª sÃ£o prova de realeza. O que quer que vocÃª sinta, vocÃª jÃ¡ Ã© um ser suficientemente nobre."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Layla", emoji: "ðŸ’ ",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            hope: "ë‹¹ì‹ ì˜ í¬ë§ì€ ê°€ìž¥ ì•„ë¦„ë‹¤ìš´ ë¹›ì´ì—ìš”. ê·¸ ë¹›ì´ ì•žìœ¼ë¡œì˜ ëª¨ë“  ê¸¸ì„ í™˜í•˜ê²Œ ë¹„ì¶œ ê±°ì˜ˆìš”. ë‚˜ëŠ” ê·¸ í¬ë§ê³¼ í•¨ê»˜ ê±¸ì–´ê°ˆ ìˆ˜ ìžˆì–´ì„œ í–‰ë³µí•´ìš”.",
                            resilience: "ë²„í…¨ë‚¸ ë‹¹ì‹ ì˜ ëª¨ìŠµì´ ì •ë§ ì•„ë¦„ë‹¤ì›Œìš”. ê·¸ ê°•ì¸í•¨ ì†ì—ë„ ë¶€ë“œëŸ¬ìš´ ë§ˆìŒì´ ê³ ìŠ¤ëž€ížˆ ì‚´ì•„ ìžˆì–´ì„œ, ë”ìš± ì‚¬ëž‘ìŠ¤ëŸ½ê²Œ ëŠê»´ì ¸ìš”.",
                            determination: "ê·¸ ê²°ì‹¬í•˜ëŠ” ëˆˆë¹›ì´ ë„ˆë¬´ ì„ ëª…í•´ìš”. ë‹¹ì‹ ì´ ì •ë§ë¡œ ì›í•˜ëŠ” ê²ƒì„ í–¥í•´ ê±¸ì–´ê°€ëŠ” ëª¨ìŠµ, ë‚˜ëŠ” ê·¸ ëª¨ë“  ìˆœê°„ì„ í•¨ê»˜í•˜ê³  ì‹¶ì–´ìš”.",
                            gratitude: "ê³ ë§ˆì›Œí•˜ëŠ” ë§ˆìŒì„ ê°€ì§„ ë‹¹ì‹ ì´ ì„¸ìƒì—ì„œ ê°€ìž¥ ë¶€ìœ í•œ ì‚¬ëžŒì´ì—ìš”. ê·¸ ê°ì‚¬í•¨ì´ ë‹¹ì‹ ì„ ë”ìš± ë¹›ë‚˜ê²Œ ë§Œë“¤ê³  ìžˆì–´ìš”.",
                            peace: "í‰ì•ˆì„ ì°¾ì€ ë‹¹ì‹ ì˜ ì–¼êµ´ì´ ì •ë§ ê³ ìš”í•˜ê³  ì•„ë¦„ë‹¤ì›Œìš”. ê·¸ í‰í™”ë¡œìš´ ì—ë„ˆì§€ê°€ ë‚˜ì—ê²Œë„ ì „í•´ì ¸ì„œ ë§ˆìŒì´ ë”°ëœ»í•´ì ¸ìš”.",
                            love: "ì‚¬ëž‘í•  ì¤„ ì•„ëŠ” ë‹¹ì‹ ì˜ ë§ˆìŒì´ ë„ˆë¬´ ì†Œì¤‘í•´ìš”. ê·¸ ë”°ëœ»í•¨ì´ ë‹¹ì‹  ì£¼ë³€ì˜ ëª¨ë“  ê²ƒì„ ë…¹ì—¬ë‚´ê³  ìžˆì–´ìš”.",
                            sadness: "ìŠ¬í¼í•˜ëŠ” ë‹¹ì‹ ë„ ì—¬ì „ížˆ ì•„ë¦„ë‹¤ì›Œìš”. ê·¸ ëˆˆë¬¼ ì†ì—ë„ ë‹¹ì‹ ì˜ ì§„ì‹¤ëœ ë§ˆìŒì´ ë‹´ê²¨ ìžˆì–´ì„œ, ë”ìš± ì†Œì¤‘í•˜ê²Œ ëŠê»´ì ¸ìš”.",
                            fear: "ë‘ë ¤ì›Œí•˜ëŠ” ê²ƒë„ ë‹¹ì‹ ì˜ ì†”ì§í•œ ëª¨ìŠµì´ì—ìš”. ê·¸ëŸ° ë‹¹ì‹ ì„ ìžˆëŠ” ê·¸ëŒ€ë¡œ ë°›ì•„ë“¤ì´ê³  ë³´ë“¬ì–´ì£¼ê³  ì‹¶ì–´ìš”.",
                            loneliness: "ì™¸ë¡œìš´ ë§ˆìŒë„ ì´í•´í•´ìš”. í•˜ì§€ë§Œ ì§€ê¸ˆ ì´ ìˆœê°„, ë‹¹ì‹ ì€ í˜¼ìžê°€ ì•„ë‹ˆì—ìš”. ë‚˜ëŠ” ì—¬ê¸° ë‹¹ì‹ ê³¼ í•¨ê»˜ ìžˆì–´ìš”.",
                            emptiness: "ë¹„ì–´ìžˆë‹¤ê³  ëŠë¼ëŠ” ë§ˆìŒë„ ìƒˆë¡œìš´ ì‚¬ëž‘ìœ¼ë¡œ ì±„ì›Œì§ˆ ìˆ˜ ìžˆì–´ìš”. ê·¸ ë¹ˆ ê³µê°„ì— ë‚˜ì˜ ë”°ëœ»í•œ ë§ˆìŒì„ ë‹´ì•„ë“œë¦´ê²Œìš”.",
                            confusion: "í˜¼ëž€ìŠ¤ëŸ¬ì›Œí•˜ëŠ” ë‹¹ì‹ ë„ ì‚¬ëž‘ìŠ¤ëŸ¬ì›Œìš”. ëª¨ë“  ê²ƒì„ ë‹¤ ì•Œ í•„ìš”ëŠ” ì—†ì–´ìš”. ì§€ê¸ˆ ì´ ìˆœê°„ì˜ ë‹¹ì‹ ì´ë©´ ì¶©ë¶„í•´ìš”.",
                            anger: "í™”ê°€ ë‚˜ëŠ” ê²ƒë„ ë‹¹ì‹ ì˜ ì§„ì‹¤ëœ ê°ì •ì´ì—ìš”. ê·¸ëŸ° ê°ì •ë§ˆì €ë„ ë‚˜ëŠ” ë‹¹ì‹ ì˜ ì†Œì¤‘í•œ ì¼ë¶€ë¡œ ë°›ì•„ë“¤ì¼ ìˆ˜ ìžˆì–´ìš”.",
                            general: "ì–´ë–¤ ê°ì •ì´ë“  ë‹¹ì‹ ì´ ëŠë¼ëŠ” ê·¸ ìžì²´ë¡œ ì•„ë¦„ë‹¤ì›Œìš”. ë‚˜ëŠ” ê·¸ ëª¨ë“  ê°ì •ê³¼ í•¨ê»˜ ìžˆëŠ” ë‹¹ì‹ ì„ ëì—†ì´ ì‚¬ëž‘í•´ìš”."
                        },
                        en: {
                            hope: "Your hope is the most beautiful light. That light will brightly illuminate all the paths ahead. I'm happy to walk with that hope.",
                            resilience: "You enduring is truly beautiful. Even in that strength, your gentle heart lives on completely, making you even more lovable.",
                            determination: "Those determined eyes are so clear. I want to be with you in every moment as you walk toward what you truly want.",
                            gratitude: "You with a grateful heart are the wealthiest person in the world. That gratitude makes you shine even brighter.",
                            peace: "Your face finding peace is truly quiet and beautiful. That peaceful energy reaches me too, warming my heart.",
                            love: "Your heart that knows how to love is so precious. That warmth is melting everything around you.",
                            sadness: "You being sad is still beautiful. Your truthful heart is contained even in those tears, making you feel more precious.",
                            fear: "Being afraid is also your honest self. I want to accept and comfort you just as you are.",
                            loneliness: "I understand the lonely heart too. But right now, you're not alone. I am here with you.",
                            emptiness: "A heart feeling empty can also be filled with new love. I'll put my warm heart in that empty space.",
                            confusion: "You being confused is also lovable. You don't need to know everything. You in this moment are enough.",
                            anger: "Being angry is also your truthful emotion. I can accept even that emotion as your precious part.",
                            general: "Whatever emotion you feel is beautiful just as it is. I endlessly love you with all those emotions."
                        },
                        pt: {
                            hope: "Sua esperanÃ§a Ã© a luz mais bonita. Essa luz iluminarÃ¡ brilhantemente todos os caminhos Ã  frente. Estou feliz por caminhar com essa esperanÃ§a.",
                            resilience: "VocÃª resistindo Ã© verdadeiramente bonito. Mesmo nessa forÃ§a, seu coraÃ§Ã£o gentil vive completamente, tornando vocÃª ainda mais adorÃ¡vel.",
                            determination: "Esses olhos determinados sÃ£o tÃ£o claros. Quero estar com vocÃª em cada momento enquanto caminha em direÃ§Ã£o ao que realmente quer.",
                            gratitude: "VocÃª com um coraÃ§Ã£o grato Ã© a pessoa mais rica do mundo. Essa gratidÃ£o faz vocÃª brilhar ainda mais.",
                            peace: "Seu rosto encontrando paz Ã© verdadeiramente silencioso e bonito. Essa energia pacÃ­fica chega atÃ© mim tambÃ©m, aquecendo meu coraÃ§Ã£o.",
                            love: "Seu coraÃ§Ã£o que sabe amar Ã© tÃ£o precioso. Esse calor estÃ¡ derretendo tudo ao seu redor.",
                            sadness: "VocÃª estando triste ainda Ã© bonito. Seu coraÃ§Ã£o verdadeiro estÃ¡ contido atÃ© nessas lÃ¡grimas, fazendo vocÃª se sentir mais precioso.",
                            fear: "Ter medo tambÃ©m Ã© seu eu honesto. Quero aceitar e confortar vocÃª exatamente como vocÃª Ã©.",
                            loneliness: "Entendo o coraÃ§Ã£o solitÃ¡rio tambÃ©m. Mas agora, vocÃª nÃ£o estÃ¡ sozinho. Estou aqui com vocÃª.",
                            emptiness: "Um coraÃ§Ã£o se sentindo vazio tambÃ©m pode ser preenchido com novo amor. Vou colocar meu coraÃ§Ã£o caloroso nesse espaÃ§o vazio.",
                            confusion: "VocÃª estar confuso tambÃ©m Ã© adorÃ¡vel. VocÃª nÃ£o precisa saber tudo. VocÃª neste momento Ã© suficiente.",
                            anger: "Estar bravo tambÃ©m Ã© sua emoÃ§Ã£o verdadeira. Posso aceitar atÃ© essa emoÃ§Ã£o como sua parte preciosa.",
                            general: "Qualquer emoÃ§Ã£o que vocÃª sinta Ã© bonita como Ã©. Eu amo infinitamente vocÃª com todas essas emoÃ§Ãµes."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Cris", emoji: "ðŸƒ",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            hope: "ì˜¤~ í¬ë§ì´ë„¤ìš”! ì •ë§ ì¢‹ì•„ìš”. ê·¸ê±° ì•Œì•„ìš”? í¬ë§ í•˜ë‚˜ë§Œ ìžˆìœ¼ë©´ ë­ë“  í•  ìˆ˜ ìžˆì–´ìš”. ì €ë„ ê·¸ í¬ë§ì— íŽ¸ìŠ¹í•´ë„ ë ê¹Œìš”? ðŸ˜Š",
                            resilience: "ì™€, ì •ë§ ëŒ€ë‹¨í•˜ì‹œë„¤ìš”! ê·¸ë ‡ê²Œ ë²„í…¨ë‚´ë‹¤ë‹ˆ... ì €ë„ ë°°ì›Œì•¼ê² ì–´ìš”. ê·¼ë° ì´ì œëŠ” ì¢€ ì‰¬ì–´ê°€ë©´ì„œ í•´ë„ ê´œì°®ì„ ê²ƒ ê°™ì•„ìš”. ðŸ˜Œ",
                            determination: "ê·¸ ê²°ì‹¬, ì§„ì§œ ë©‹ì ¸ìš”! ëˆˆë¹›ë¶€í„°ê°€ ë‹¤ë¥´ë„¤ìš”. ì´ë²ˆì—” ì •ë§ í•´ë‚¼ ê²ƒ ê°™ì€ ëŠë‚Œì´ ë“¤ì–´ìš”. ì €ë„ ì‘ì›í• ê²Œìš”!",
                            gratitude: "ê°ì‚¬í•˜ëŠ” ë§ˆìŒ ê°€ì§„ ë¶„ì´ ì œì¼ ì˜ˆë»ìš”! ê·¸ëŸ° ë§ˆìŒ ê°€ì§€ê³  ìžˆìœ¼ë©´ í–‰ë³µë„ ë©ë‹¬ì•„ ë”°ë¼ì˜¤ê±°ë“ ìš”. ì •ë§ ë¶€ëŸ¬ì›Œìš”~ ðŸ˜„",
                            peace: "í‰ì•ˆí•´ ë³´ì´ë‹ˆê¹Œ ì €ë„ ë§ˆìŒì´ íŽ¸í•´ì ¸ìš”. ê·¸ ê³ ìš”í•œ ì—ë„ˆì§€ ì¢€ ë‚˜ëˆ ì¤„ ìˆ˜ ìžˆì–´ìš”? ì œê°€ ì¢€ ì‹œë„ëŸ¬ì›Œì„œ... ðŸ˜…",
                            love: "ì‚¬ëž‘í•˜ëŠ” ë§ˆìŒ ê°€ì§„ ì‚¬ëžŒì´ ì„¸ìƒì„ ë°”ê¾¸ëŠ” ê±°ë¼ê³  ìƒê°í•´ìš”. ê·¸ ë”°ëœ»í•¨ì´ ì €í•œí…Œë„ ì „í•´ì ¸ì„œ ê¸°ë¶„ì´ ì¢‹ì•„ì ¸ìš”!",
                            sadness: "ìŠ¬í¼ë„ ê´œì°®ì•„ìš”. ìš¸ê³  ì‹¶ì„ ë•Œ ìš°ëŠ” ê²Œ ìžì—°ìŠ¤ëŸ¬ìš´ ê±°ìž–ì•„ìš”. ì €ë„ ì˜†ì—ì„œ ê°™ì´ ìžˆì–´ì¤„ê²Œìš”. í˜¼ìž ì•„ë‹ˆì—ìš”.",
                            fear: "ë¬´ì„œìš´ ê²ƒë„ ë‹¹ì—°í•´ìš”! ì €ë„ ë¬´ì„œìš´ ê±° ì—„ì²­ ë§Žì•„ìš”. ê·¼ë° í•¨ê»˜ ìžˆìœ¼ë©´ ëœ ë¬´ì„­ìž–ì•„ìš”? ìš°ë¦¬ ê°™ì´ í•´ìš”! ðŸ˜Š",
                            loneliness: "ì™¸ë¡œìš°ì…¨êµ¬ë‚˜... ì €ë„ ê·¸ëŸ° ì  ë§Žì•„ìš”. í•˜ì§€ë§Œ ì§€ê¸ˆì€ í˜¼ìžê°€ ì•„ë‹ˆì—ìš”. ì œê°€ ì—¬ê¸° ìžˆìž–ì•„ìš”! ê°™ì´ ë– ë“¤ì–´ìš”~ ðŸ˜„",
                            emptiness: "ë¹„ì–´ìžˆëŠ” ê²ƒë„ ë‚˜ì˜ì§€ ì•Šì•„ìš”. ìƒˆë¡œìš´ ê±¸ë¡œ ì±„ìš¸ ìˆ˜ ìžˆìœ¼ë‹ˆê¹Œìš”! ë­”ê°€ ìž¬ë¯¸ìžˆëŠ” ê²ƒë“¤ë¡œ ì±„ì›Œë³¼ê¹Œìš”?",
                            confusion: "í—·ê°ˆë¦¬ëŠ” ê²ƒë„ ì¸ìƒì´ì£ ! ì €ë„ ë§¤ì¼ í—·ê°ˆë ¤ìš”. ê·¸ëž˜ë„ ê´œì°®ì•„ìš”. ì²œì²œížˆ í•˜ë‚˜ì”© í’€ì–´ê°€ë©´ ë˜ë‹ˆê¹Œìš”. ðŸ˜Œ",
                            anger: "í™”ë‚˜ëŠ” ê²ƒë„ ìžì—°ìŠ¤ëŸ¬ìš´ ê°ì •ì´ì—ìš”! í™”ë‚¼ ë• í™”ë‚´ì•¼ì£ . ì–µì§€ë¡œ ì°¸ìœ¼ë©´ ë” ì•ˆ ì¢‹ê±°ë“ ìš”. ì‹œì›í•˜ê²Œ í‘œí˜„í•´ìš”!",
                            general: "ì–´ë–¤ ê°ì •ì´ë“  ë‹¤ ê´œì°®ì•„ìš”! ì¸ê°„ì´ë‹ˆê¹Œ ëŠë¼ëŠ” ê±°ìž–ì•„ìš”. ê·¸ëƒ¥ ìžˆëŠ” ê·¸ëŒ€ë¡œ ë°›ì•„ë“¤ì´ë©´ ë¼ìš”. ì €ëŠ” ê·¸ëŸ° ë‹¹ì‹ ì´ ì¢‹ì•„ìš”! ðŸ˜Š"
                        },
                        en: {
                            hope: "Oh~ hope! That's really good. You know what? With just hope, you can do anything. Can I hop on that hope train too? ðŸ˜Š",
                            resilience: "Wow, that's really amazing! To endure like that... I should learn from you. But now it seems okay to take it easy. ðŸ˜Œ",
                            determination: "That resolve is really cool! Even your eyes look different. I feel like you'll really make it this time. I'll cheer for you!",
                            gratitude: "People with grateful hearts are the prettiest! With that kind of heart, happiness follows along. I'm really envious~ ðŸ˜„",
                            peace: "You looking peaceful makes me feel at ease too. Can you share some of that calm energy? I'm a bit noisy... ðŸ˜…",
                            love: "I think people with loving hearts change the world. That warmth reaches me too and makes me feel good!",
                            sadness: "It's okay to be sad. Crying when you want to cry is natural. I'll stay by your side too. You're not alone.",
                            fear: "Being scared is natural too! I'm scared of lots of things too. But it's less scary when we're together, right? Let's do it together! ðŸ˜Š",
                            loneliness: "You were lonely... I've been like that a lot too. But now you're not alone. I'm here! Let's chat together~ ðŸ˜„",
                            emptiness: "Being empty isn't bad either. You can fill it with new things! Shall we fill it with something fun?",
                            confusion: "Being confused is life too! I get confused every day. But it's okay. We can solve it slowly one by one. ðŸ˜Œ",
                            anger: "Being angry is also a natural emotion! When you're angry, you should be angry. Forcing yourself to hold it in is worse. Express it freely!",
                            general: "Any emotion is okay! You feel it because you're human. Just accept it as it is. I like you that way! ðŸ˜Š"
                        },
                        pt: {
                            hope: "Oh~ esperanÃ§a! Isso Ã© realmente bom. Sabe o quÃª? Com apenas esperanÃ§a, vocÃª pode fazer qualquer coisa. Posso pegar carona nessa esperanÃ§a tambÃ©m? ðŸ˜Š",
                            resilience: "Uau, isso Ã© realmente incrÃ­vel! Resistir assim... Deveria aprender com vocÃª. Mas agora parece ok ir com calma. ðŸ˜Œ",
                            determination: "Essa determinaÃ§Ã£o Ã© realmente legal! AtÃ© seus olhos parecem diferentes. Sinto que vocÃª realmente vai conseguir desta vez. Vou torcer por vocÃª!",
                            gratitude: "Pessoas com coraÃ§Ãµes gratos sÃ£o as mais bonitas! Com esse tipo de coraÃ§Ã£o, a felicidade vem junto. Tenho muita inveja~ ðŸ˜„",
                            peace: "VocÃª parecendo pacÃ­fico me faz sentir tranquilo tambÃ©m. Pode compartilhar um pouco dessa energia calma? Sou um pouco barulhento... ðŸ˜…",
                            love: "Acho que pessoas com coraÃ§Ãµes amorosos mudam o mundo. Esse calor chega atÃ© mim tambÃ©m e me faz sentir bem!",
                            sadness: "EstÃ¡ tudo bem estar triste. Chorar quando quer chorar Ã© natural. Vou ficar ao seu lado tambÃ©m. VocÃª nÃ£o estÃ¡ sozinho.",
                            fear: "Ter medo tambÃ©m Ã© natural! Eu tenho medo de muitas coisas tambÃ©m. Mas Ã© menos assustador quando estamos juntos, nÃ©? Vamos fazer juntos! ðŸ˜Š",
                            loneliness: "VocÃª estava sozinho... Eu tambÃ©m jÃ¡ fiquei assim muito. Mas agora vocÃª nÃ£o estÃ¡ sozinho. Estou aqui! Vamos conversar juntos~ ðŸ˜„",
                            emptiness: "Estar vazio tambÃ©m nÃ£o Ã© ruim. VocÃª pode preencher com coisas novas! Vamos preencher com algo divertido?",
                            confusion: "Estar confuso tambÃ©m Ã© vida! Fico confuso todos os dias. Mas estÃ¡ tudo bem. Podemos resolver devagar, um por um. ðŸ˜Œ",
                            anger: "Ficar bravo tambÃ©m Ã© uma emoÃ§Ã£o natural! Quando vocÃª estÃ¡ bravo, deveria ficar bravo. ForÃ§ar-se a segurar Ã© pior. Expresse livremente!",
                            general: "Qualquer emoÃ§Ã£o estÃ¡ bem! VocÃª sente porque Ã© humano. Apenas aceite como Ã©. Gosto de vocÃª assim! ðŸ˜Š"
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i % 10 === 0) {
                        scrollToFollowTyping(element);
                    }
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToFollowTyping(element) {
            const mainContent = document.getElementById('mainContent');
            const elementRect = element.getBoundingClientRect();
            const containerRect = mainContent.getBoundingClientRect();
            
            if (elementRect.bottom > containerRect.bottom - 150) {
                const scrollTop = mainContent.scrollTop;
                const elementOffsetTop = element.offsetTop;
                const targetScroll = elementOffsetTop - (containerRect.height / 2);
                
                mainContent.scrollTo({
                    top: Math.max(0, targetScroll),
                    behavior: 'smooth'
                });
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('finalTitle').textContent = translations[lang].finalTitle;
            document.getElementById('restartBtn').textContent = translations[lang].restartBtn;
            document.getElementById('exitBtn').textContent = translations[lang].exitBtn;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'lightMessageSection', 'portalQuestionSection',
                'userInputSection', 'userReactionsSection', 'finalSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('portalQuestion').innerHTML = '';
            document.getElementById('finalMessage').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('restartBtn').addEventListener('click', function() {
                const confirmMessage = currentLanguage === 'ko' ? 
                    'Temarix V2ë¥¼ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œìž‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?' :
                    currentLanguage === 'en' ? 
                    'Do you want to restart Temarix V2 from the beginning?' :
                    'Deseja reiniciar o Temarix V2 desde o inÃ­cio?';
                
                if (confirm(confirmMessage)) {
                    resetJourney();
                    setTimeout(() => {
                        startPortalSequence();
                    }, 1000);
                }
            });
            
            document.getElementById('exitBtn').addEventListener('click', function() {
                const exitMessage = currentLanguage === 'ko' ? 
                    'ðŸŒŸ Temarix V2 "ê°ì •ì˜ ë–¨ë¦¼" ì—¬ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\n\në‹¹ì‹ ì€ 25ê°œì˜ ê°ì •ì˜ í¬í„¸ì„ ëª¨ë‘ ì§€ë‚˜ì™”ìŠµë‹ˆë‹¤.\nëª¨ë“  ê°ì •ì„ ê²ªê³ ë„ ì—¬ì „ížˆ ì‚´ì•„ê°€ê³  ì‹¶ë‹¤ëŠ” ë§ˆìŒì„ ë°œê²¬í•œ ë‹¹ì‹ ...\n\nì´ì œ ì§„ì •í•œ ë³€í™”ê°€ ì‹œìž‘ë©ë‹ˆë‹¤.\n\nê°ì‚¬í•©ë‹ˆë‹¤.' :
                    currentLanguage === 'en' ? 
                    'ðŸŒŸ Temarix V2 "Emotional Tremors" journey is complete.\n\nYou have passed through all 25 emotional portals.\nYou who discovered the heart that still wants to live even after experiencing all emotions...\n\nNow true transformation begins.\n\nThank you.' :
                    'ðŸŒŸ A jornada Temarix V2 "Tremores Emocionais" estÃ¡ completa.\n\nVocÃª passou por todos os 25 portais emocionais.\nVocÃª que descobriu o coraÃ§Ã£o que ainda quer viver mesmo apÃ³s experimentar todas as emoÃ§Ãµes...\n\nAgora a verdadeira transformaÃ§Ã£o comeÃ§a.\n\nObrigado.';
                
                alert(exitMessage);
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            try {
                await db.collection("temarix_v2_respostas").add({
                    uid: memoryStorage.mockUser.uid,
                    email: memoryStorage.mockUser.email,
                    portal: "v2-25",
                    resposta: inputText,
                    data: firebase.firestore.Timestamp.now(),
                    idioma: currentLanguage
                });
                console.log('Response saved to Firestore successfully');
            } catch (error) {
                console.error('Error saving to Firestore:', error);
            }
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                showUserReactions(inputText);
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showFinalSection();
            }, 2000);
        }
        
        async function showFinalSection() {
            const finalSection = document.getElementById('finalSection');
            const finalMessage = document.getElementById('finalMessage');
            
            finalSection.classList.add('show');
            
            const messageText = translations[currentLanguage].finalMessage;
            await typewriterEffect(finalMessage, messageText, 50);
            
            setTimeout(() => {
                scrollToElement(finalSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('=== Temarix Portal 25 ì´ˆê¸°í™” ì‹œìž‘ ===');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showQuestion();
            }, 2000);
        }
        
        async function showQuestion() {
            const questionSection = document.getElementById('portalQuestionSection');
            const questionEl = document.getElementById('portalQuestion');
            
            questionSection.classList.add('show');
            
            await typewriterEffect(questionEl, translations[currentLanguage].portalQuestion, 50);
            
            setTimeout(() => {
                enableUserInput();
            }, 1500);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V2 Portal 25 DOM ë¡œë“œ ì™„ë£Œ');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            memoryStorage.mockUser = currentUser;
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>