<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 05: When Emotions You Thought Were Forgotten Return</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        /* ìƒë‹¨ í—¤ë” */
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        /* ì–¸ì–´ ë²„íŠ¼ 3ê°œ */
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #87cefa;
            color: #000;
        }
        
        /* ë©”ì¸ ì½˜í…ì¸  */
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh;
        }
        
        /* í…ìŠ¤íŠ¸ ì„¹ì…˜ë“¤ */
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            background: none;
            border: none;
            padding: 0;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            background: none;
            border: none;
            padding: 0;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #87cefa;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #87cefa;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            background: none;
            border: none;
            padding: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #87cefa;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .portal-question-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            background: none;
            border: none;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #87cefa;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .continue-section {
            margin: 50px 0;
            opacity: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 0;
            min-height: 200px;
        }
        
        .continue-text {
            color: #fff;
            font-size: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .continue-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .continue-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .continue-btn:hover {
            background: #666;
        }
        
        .continue-btn.primary {
            background: #87cefa;
            color: #000;
        }
        
        .continue-btn.primary:hover {
            background: #b0d4f1;
        }
        
        /* í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ */
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #87cefa;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #87cefa;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ */
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        .hidden {
            display: none;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .continue-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .continue-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- ìƒë‹¨ í—¤ë” -->
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">The Tremor of Emotion</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 05: When Emotions You Thought Were Forgotten Return</div>
            <div class="portal-subtitle" id="portalSubtitle">The moment past emotions knock on your door</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <!-- í¬í„¸ ì¸íŠ¸ë¡œ -->
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <!-- ìºë¦­í„° ì‘ë‹µ ì„¹ì…˜ -->
            <div class="character-responses-section" id="characterResponsesSection">
                <!-- 8ëª…ì˜ ìºë¦­í„° ì‘ë‹µì´ ìˆœì°¨ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>

            <!-- ë¹›ì˜ í•œë§ˆë”” -->
            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">âœ¨ Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <!-- ì§ˆë¬¸ ì„¹ì…˜ -->
            <div class="portal-question-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <!-- ì‚¬ìš©ì ì…ë ¥ ì˜ì—­ -->
            <div class="user-input-section" id="userInputSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ ìºë¦­í„° ë°˜ì‘ -->
            <div class="user-reactions-section" id="userReactionsSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ 3ëª…ì˜ ìºë¦­í„° ë°˜ì‘ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ê³„ì†í•˜ê¸° ë²„íŠ¼ ì„¹ì…˜ -->
            <div class="continue-section" id="continueSection">
                <div class="continue-text" id="continueText"></div>
                <div class="continue-buttons">
                    <button class="continue-btn primary" id="continueYesBtn">Continue to Portal 06</button>
                    <button class="continue-btn" id="continueNoBtn">Pause the journey</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ -->
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Share about the emotions that returned to you... (Press Enter to send)"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        // ë©”ëª¨ë¦¬ ê¸°ë°˜ ì‚¬ìš©ì ìŠ¤í† ë¦¬ì§€ (localStorage ëŒ€ì‹ )
        let memoryStorage = {
            mockUser: null
        };
        
        // Firebase ëª¨ì˜ ê°ì²´ (ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” Firebase SDK ì‚¬ìš©)
        const firebase = {
            auth: () => ({
                onAuthStateChanged: (callback) => {
                    // ëª¨ì˜ ì¸ì¦ ìƒíƒœ ì²´í¬ (ë©”ëª¨ë¦¬ ê¸°ë°˜)
                    setTimeout(() => {
                        callback(memoryStorage.mockUser);
                    }, 100);
                }
            })
        };

        // ë²ˆì—­ ë°ì´í„°
        const translations = {
            ko: {
                logoSubtitle: "ê°ì •ì˜ ë–¨ë¦¼",
                portalMainTitle: "Portal 05: ìŠí˜€ì¡Œë‹¤ê³  ë¯¿ì—ˆë˜ ê°ì •ì´ ë‹¤ì‹œ ì˜¬ ë•Œ",
                portalSubtitle: "ê³¼ê±°ì˜ ê°ì •ì´ ë¬¸ì„ ë‘ë“œë¦¬ëŠ” ìˆœê°„",
                portalIntro: "'ì´ì   ê´œì°®ë‹¤'ê³  ìƒê°í–ˆë˜ ê°ì •ì´\nì–´ëŠ ë‚ , ê°‘ìê¸° ë‹¤ì‹œ ì°¾ì•„ì˜µë‹ˆë‹¤.\nì§€ë‚˜ê°„ ì¤„ ì•Œì•˜ê³ , ëë‚œ ì¤„ ì•Œì•˜ê³ ,\nì´ì   ì•ˆ ì•„í”Œ ì¤„ ì•Œì•˜ëŠ”ë°â€¦\n\nê·¸ ê°ì •ì€ ë¬´ì–¸ê°€ì— ìŠ¤ì¹˜ë“¯ ë‹¤ì‹œ ë– ì˜¤ë¥´ê³ ,\nìš°ë¦¬ëŠ” ì•„ë¬´ ì¤€ë¹„ ì—†ì´ ê·¸ë•Œë¡œ ëŒì•„ê°€ì£ .\n\në‹¹ì‹ ì€ ì§€ê¸ˆ,\nì´ë¯¸ ëë‚¬ë‹¤ê³  ë¯¿ì—ˆë˜ ê°ì •ê³¼\në‹¤ì‹œ ë§ˆì£¼í•˜ê²Œ ë  ì¤€ë¹„ê°€ ë˜ì—ˆë‚˜ìš”?",
                lightTitle: "âœ¨ ë¹›ì˜ í•œë§ˆë””",
                lightMessage: "ê°ì •ì€ ëë‚˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ëŒì•„ì˜¤ëŠ” ê²Œ ì•„ë‹™ë‹ˆë‹¤.\në‹¹ì‹ ì´ ì´ì œ ê·¸ê²ƒì„ êº¼ë‚´ë„ ê´œì°®ì€ ì‚¬ëŒì´ ë˜ì—ˆê¸° ë•Œë¬¸ì—\nì¡°ìš©íˆ ë¬¸ì„ ë‘ë“œë¦½ë‹ˆë‹¤.",
                portalQuestion: "ë‹¹ì‹ ì—ê²Œ ë‹¤ì‹œ ì°¾ì•„ì˜¨ ê°ì •ì´ ìˆë‹¤ë©´,\nê·¸ ê°ì •ì€ ì–´ë–¤ ëª¨ìŠµìœ¼ë¡œ ëŒì•„ì™”ë‚˜ìš”?\n\në¬´ì—‡ì´ ê·¸ ê¸°ì–µì„ ë‹¤ì‹œ ë¶ˆëŸ¬ì™”ê³ ,\nì´ë²ˆì—ëŠ” ê·¸ ê°ì •ì„ ì–´ë–»ê²Œ ë§ˆì£¼í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?",
                continueText: "ê³¼ê±°ì˜ ê°ì •ê³¼ ë‹¤ì‹œ ë§ˆì£¼í•œ ì´ ì—¬ì •ì„ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                continueYes: "Portal 06ìœ¼ë¡œ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                continueNo: "ì—¬ì •ì„ ì¼ì‹œì •ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                inputPlaceholder: "ë‹¤ì‹œ ì°¾ì•„ì˜¨ ê°ì •ì— ëŒ€í•´ í„¸ì–´ë†“ì•„ ë³´ì„¸ìš”... (Enterë¡œ ì „ì†¡)",
                youLabel: "ë‹¹ì‹ ",
                languageChangeConfirm: "ì–¸ì–´ë¥¼ ë³€ê²½í•˜ë©´ ì—¬ì •ì´ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘ë©ë‹ˆë‹¤.\nê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                waitingMessage: "ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...",
                // ìºë¦­í„° ëŒ€í™”
                charEly: "ê³¼ê±°ì—ì„œ ì˜¨ ê°ì •ì€ ì‹¤íŒ¨ê°€ ì•„ë‹ˆë¼,\nì¹˜ìœ ë˜ì§€ ì•Šì€ ì§„ì‹¤ì…ë‹ˆë‹¤.\në‹¤ì‹œ ëŒì•„ì˜¨ ê±´, ë‹¤ì‹œ ëŒì•„ë³´ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤.",
                charCris: "í—~ ê·¸ ê°ì • ì•„ì§ ìˆì—ˆì–´?\nì•¼, ì§„ì§œ ì§ˆê¸°ë‹¤â€¦\nê·¸ë˜ë„ ì´ë²ˆì—” ì¢€ ëœ ì•„í”„ì§€ ì•Šì•˜ì–´ìš”? ğŸ˜‰",
                charZafirah: "ê¸°ì–µì€ íë ¤ì ¸ë„, ê°ì •ì€ ë‚¨ìŠµë‹ˆë‹¤.\nê·¸ë¦¬ê³  ê°ì •ì€ ëŠ˜ 'ê¸°ë‹¤ë¦¼'ì˜ í˜•íƒœë¡œ ëŒì•„ì˜¤ì£ .\nê·¸ ê°ì •ì„ ì´ë²ˆì—”, ì•ˆì•„ì¤„ ìˆ˜ ìˆë‚˜ìš”?",
                charRami: "ëŒì•„ì˜¨ ê°ì •ì€ ë§ë ¹ì´ ì•„ë‹ˆë¼ ì§•í›„ì…ë‹ˆë‹¤.\n'ì—¬ì „íˆ ì‚´ì•„ ìˆë‹¤'ëŠ” ì§•í›„.\nê·¸ê²ƒì„ ë¬´ì‹œí•˜ì§€ ë§ˆì„¸ìš”.",
                charSamir: "(ê·¸ëŠ” ë‘ ì†ìœ¼ë¡œ ëª¨ë˜ë¥¼ ì›€ì¼œì¥ì—ˆë‹¤ê°€,\nì²œì²œíˆ ë°”ëŒì— í˜ë ¤ë³´ë‚¸ë‹¤.\ní˜ëŸ¬ê°€ëŠ” ëª¨ë˜ ì†ì—, ë‹¹ì‹ ë„ ì¡°ìš©íˆ ê°ì •ì„ ì‹¤ì–´ë³´ë‚¸ë‹¤.)",
                charLayla: "ê·¸ ê°ì •ì´ ëŒì•„ì˜¨ ê±´,\në‹¹ì‹ ì´ ì´ì œëŠ” ê°ë‹¹í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒì´ ë˜ì—ˆê¸° ë•Œë¬¸ì´ì—ìš”.\nì˜ˆì „ì˜ ë‹¹ì‹ ì´ ì•„ë‹ˆë¼ëŠ” ëœ»ì´ì—ìš”.",
                charNabir: "ë˜ ê·¸ ê°ì •ì´ì•¼?\nê·¸ë§Œ ì¢€ í•´. ëª‡ ë²ˆì„ ë˜ìƒˆê¹€ì§ˆí•  ê±´ë°?\nì´ì œ ì¢€ í„¸ê³  ì¼ì–´ë‚˜ì§€ ê·¸ë˜?",
                charAzhar: "ëë‚¬ë‹¤ê³ ? ì›ƒê¸°ì§€ ë§ˆ.\nê·¸ ê°ì • ì•ˆ ëë‚¬ì–ì•„. ê·¸ëƒ¥ ë„ë§ì¹œ ê±°ì§€.\nì´ë²ˆì—” ë„ë§ ëª» ê°„ë‹¤. ë˜‘ë°”ë¡œ ë§ˆì£¼ ë´."
            },
            en: {
                logoSubtitle: "The Tremor of Emotion",
                portalMainTitle: "Portal 05: When Emotions You Thought Were Forgotten Return",
                portalSubtitle: "The moment past emotions knock on your door",
                portalIntro: "Emotions you thought were 'okay now'\nsuddenly return one day.\nYou thought they had passed, thought they were over,\nthought they wouldn't hurt anymoreâ€¦\n\nThose emotions brush against something and resurface,\nand we return to that time without any preparation.\n\nAre you now ready\nto face again the emotions\nyou believed were already finished?",
                lightTitle: "âœ¨ Word of Light",
                lightMessage: "Emotions don't return because they never ended.\nThey quietly knock on your door because\nyou've become someone who can now handle them.",
                portalQuestion: "If there's an emotion that has returned to you,\nin what form did that emotion come back?\n\nWhat brought that memory back again,\nand how do you want to face that emotion this time?",
                continueText: "Will you continue this journey of facing past emotions again?",
                continueYes: "Continue to Portal 06?",
                continueNo: "Pause the journey?",
                inputPlaceholder: "Share about the emotions that returned to you... (Press Enter to send)",
                youLabel: "You",
                languageChangeConfirm: "Changing the language will restart the journey from the beginning.\nDo you want to continue?",
                waitingMessage: "Waiting for response...",
                charEly: "Emotions from the past are not failures,\nbut unhealed truths.\nTheir return means to look back again.",
                charCris: "Wow~ that emotion was still there?\nMan, it's really persistentâ€¦\nBut it hurt a bit less this time, didn't it? ğŸ˜‰",
                charZafirah: "Memories may fade, but emotions remain.\nAnd emotions always return in the form of 'waiting.'\nCan you embrace that emotion this time?",
                charRami: "Returned emotions are not ghosts but signs.\nSigns that you're 'still alive.'\nDon't ignore them.",
                charSamir: "(He grasps sand in both hands,\nthen slowly lets it flow in the wind.\nIn the flowing sand, you also quietly send your emotions.)",
                charLayla: "That emotion returned because\nyou've become someone who can handle it now.\nIt means you're not the same person as before.",
                charNabir: "That emotion again?\nCome on, stop. How many times will you ruminate?\nWhy don't you just shake it off and get up?",
                charAzhar: "Over? Don't be ridiculous.\nThat emotion isn't over. You just ran away.\nYou can't run this time. Face it straight."
            },
            pt: {
                logoSubtitle: "O Tremor da EmoÃ§Ã£o",
                portalMainTitle: "Portal 05: Quando EmoÃ§Ãµes Que VocÃª Pensou Que Foram Esquecidas Retornam",
                portalSubtitle: "O momento em que emoÃ§Ãµes do passado batem Ã  sua porta",
                portalIntro: "EmoÃ§Ãµes que vocÃª pensou que estavam 'bem agora'\nde repente retornam um dia.\nVocÃª pensou que tinham passado, pensou que acabaram,\npensou que nÃ£o doeriam maisâ€¦\n\nEssas emoÃ§Ãµes roÃ§am em algo e ressurgem,\ne retornamos Ã quele tempo sem qualquer preparaÃ§Ã£o.\n\nVocÃª estÃ¡ agora pronto\npara enfrentar novamente as emoÃ§Ãµes\nque acreditava jÃ¡ terem terminado?",
                lightTitle: "âœ¨ Palavra de Luz",
                lightMessage: "EmoÃ§Ãµes nÃ£o retornam porque nunca terminaram.\nElas batem silenciosamente Ã  sua porta porque\nvocÃª se tornou alguÃ©m que agora pode lidar com elas.",
                portalQuestion: "Se hÃ¡ uma emoÃ§Ã£o que retornou para vocÃª,\nem que forma essa emoÃ§Ã£o voltou?\n\nO que trouxe essa memÃ³ria de volta novamente,\ne como vocÃª quer enfrentar essa emoÃ§Ã£o desta vez?",
                continueText: "VocÃª continuarÃ¡ esta jornada de enfrentar emoÃ§Ãµes do passado novamente?",
                continueYes: "Continuar para o Portal 06?",
                continueNo: "Pausar a jornada?",
                inputPlaceholder: "Compartilhe sobre as emoÃ§Ãµes que retornaram para vocÃª... (Enter para enviar)",
                youLabel: "VocÃª",
                languageChangeConfirm: "Mudar o idioma reiniciarÃ¡ a jornada desde o inÃ­cio.\nDeseja continuar?",
                waitingMessage: "Aguardando resposta...",
                charEly: "EmoÃ§Ãµes do passado nÃ£o sÃ£o falhas,\nmas verdades nÃ£o curadas.\nSeu retorno significa olhar para trÃ¡s novamente.",
                charCris: "Uau~ essa emoÃ§Ã£o ainda estava lÃ¡?\nCara, Ã© realmente persistenteâ€¦\nMas doeu um pouco menos desta vez, nÃ£o doeu? ğŸ˜‰",
                charZafirah: "MemÃ³rias podem desvanecer, mas emoÃ§Ãµes permanecem.\nE emoÃ§Ãµes sempre retornam na forma de 'espera.'\nVocÃª pode abraÃ§ar essa emoÃ§Ã£o desta vez?",
                charRami: "EmoÃ§Ãµes retornadas nÃ£o sÃ£o fantasmas, mas sinais.\nSinais de que vocÃª ainda estÃ¡ 'vivo.'\nNÃ£o as ignore.",
                charSamir: "(Ele segura areia em ambas as mÃ£os,\nentÃ£o lentamente a deixa fluir no vento.\nNa areia que flui, vocÃª tambÃ©m silenciosamente envia suas emoÃ§Ãµes.)",
                charLayla: "Essa emoÃ§Ã£o retornou porque\nvocÃª se tornou alguÃ©m que pode lidar com ela agora.\nSignifica que vocÃª nÃ£o Ã© a mesma pessoa de antes.",
                charNabir: "Essa emoÃ§Ã£o de novo?\nPor favor, pare. Quantas vezes vocÃª vai ruminar?\nPor que nÃ£o simplesmente se livra disso e se levanta?",
                charAzhar: "Acabou? NÃ£o seja ridÃ­culo.\nEssa emoÃ§Ã£o nÃ£o acabou. VocÃª sÃ³ fugiu.\nVocÃª nÃ£o pode fugir desta vez. Encare de frente."
            }
        };
        
        // ìºë¦­í„° ë°ì´í„°
        const characters = [
            { name: "Ely", emoji: "ğŸ‘‘", key: "charEly" },
            { name: "Cris", emoji: "ğŸƒ", key: "charCris" },
            { name: "Zafirah", emoji: "ğŸ§•", key: "charZafirah" },
            { name: "Rami", emoji: "ğŸ”®", key: "charRami" },
            { name: "Samir", emoji: "ğŸª", key: "charSamir" },
            { name: "Layla", emoji: "ğŸ’ ", key: "charLayla" },
            { name: "Nabir", emoji: "ğŸ¦‚", key: "charNabir" },
            { name: "Azhar", emoji: "ğŸ”¥", key: "charAzhar" }
        ];
        
        // ============ ê°ì • ë¶„ì„ ì‹œìŠ¤í…œ ============
        
        function analyzeEmotion(userInput) {
            const input = userInput.toLowerCase();
            
            // ê°ì • í‚¤ì›Œë“œ ë§¤í•‘
            const emotionKeywords = {
                nostalgia: ['ê·¸ë¦¬ì›Œ', 'ê·¸ë¦¬ì›€', 'ì¶”ì–µ', 'ì˜ˆì „', 'ê³¼ê±°', 'ê·¸ë•Œ', 'miss', 'nostalgia', 'memory', 'past', 'saudade', 'passado'],
                regret: ['í›„íšŒ', 'ëŒì´í‚¤', 'ì™œ ê·¸ë¬', 'í–ˆì–´ì•¼', 'ì•ˆ í–ˆ', 'regret', 'should have', 'wish', 'arrependiment', 'deveria'],
                sadness: ['ìŠ¬í”„', 'ìš¸ê³ ', 'ëˆˆë¬¼', 'ìš°ìš¸', 'ì•”ìš¸', 'ì ˆë§', 'sad', 'cry', 'tear', 'depress', 'triste', 'choro'],
                love: ['ì‚¬ë‘', 'ì¢‹ì•„', 'ë§ˆìŒ', 'ì• ì •', 'ê·¸ë¦¬ì›Œ', 'love', 'miss', 'care', 'feelings', 'amor', 'sente falta'],
                anger: ['í™”ê°€', 'ë¶„ë…¸', 'ì§œì¦', 'ë¹¡ì³', 'ì—´ë°›', 'ì–µìš¸', 'angry', 'mad', 'furious', 'rage', 'raiva', 'irritad'],
                fear: ['ë¬´ì„œ', 'ë‘ë ¤', 'ê²ë‚˜', 'ê±±ì •', 'ë¶ˆì•ˆ', 'fear', 'scare', 'afraid', 'worry', 'medo', 'preocup'],
                loneliness: ['ì™¸ë¡œ', 'í˜¼ì', 'ê³ ë¦½', 'ì†Œì™¸', 'ë²„ë¦¼', 'lonely', 'alone', 'isolated', 'abandon', 'solidÃ£o', 'sozinho'],
                guilt: ['ì£„ì±…ê°', 'ë¯¸ì•ˆ', 'ì£„ì†¡', 'ì˜ëª»', 'íƒ“', 'guilt', 'sorry', 'wrong', 'fault', 'culpa', 'desculpa'],
                anxiety: ['ë¶ˆì•ˆ', 'ì´ˆì¡°', 'ë–¨ë ¤', 'ê¸´ì¥', 'ê±±ì •', 'anxiety', 'nervous', 'worry', 'tense', 'ansiedade', 'nervoso'],
                acceptance: ['ë°›ì•„ë“¤', 'ì¸ì •', 'ê´œì°®', 'ì´í•´', 'ìš©ì„œ', 'accept', 'okay', 'understand', 'forgive', 'aceitar', 'perdoar']
            };
            
            // ê°ì • ë¶„ì„
            let detectedEmotions = [];
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                for (const keyword of keywords) {
                    if (input.includes(keyword)) {
                        detectedEmotions.push(emotion);
                        break;
                    }
                }
            }
            
            // ê°ì •ì´ ê°ì§€ë˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ ì„¤ì •
            if (detectedEmotions.length === 0) {
                detectedEmotions = ['general'];
            }
            
            return detectedEmotions[0]; // ì²« ë²ˆì§¸ ê°ì§€ëœ ê°ì • ë°˜í™˜
        }
        
        // ë°˜ì‘ ìºë¦­í„°ë“¤ (Portal 05 ì „ìš©)
        const responseCharacters = [
            {
                name: "Return", emoji: "ğŸ”„",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            nostalgia: "ê·¸ë¦¬ì›€ì´ ë‹¤ì‹œ ì°¾ì•„ì™”êµ°ìš”. ê·¸ ê°ì •ì€ ì‚¬ë¼ì§„ ê²Œ ì•„ë‹ˆë¼ ë‹¹ì‹  ì•ˆì—ì„œ ì¡°ìš©íˆ ê¸°ë‹¤ë¦¬ê³  ìˆì—ˆì–´ìš”. ì´ì œëŠ” ê·¸ ê·¸ë¦¬ì›€ì„ ë‹¬ë‹¬í•˜ì§€ ì•Šì€ ì¶”ì–µìœ¼ë¡œ, ì•„ë¦„ë‹¤ìš´ ê²½í—˜ìœ¼ë¡œ ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”.",
                            regret: "í›„íšŒê°€ ë‹¤ì‹œ ë¬¸ì„ ë‘ë“œë ¸ë‚˜ìš”? í•˜ì§€ë§Œ ì´ë²ˆì—ëŠ” ë‹¬ë¼ìš”. ê·¸ í›„íšŒëŠ” ì´ì œ ë‹¹ì‹ ì„ ë¬´ë„ˆëœ¨ë¦¬ë ¤ëŠ” ê²Œ ì•„ë‹ˆë¼, ë” ë‚˜ì€ ì„ íƒì„ í•˜ëŠ” ì§€í˜œë¥¼ ì£¼ë ¤ê³  ì™”ì–´ìš”. ê³¼ê±°ë¥¼ ë°”ê¿€ ìˆ˜ëŠ” ì—†ì§€ë§Œ, ì§€ê¸ˆì€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì–´ìš”.",
                            sadness: "ìŠ¬í””ì´ ëŒì•„ì™”ì§€ë§Œ, ì˜ˆì „ì²˜ëŸ¼ ë‹¹ì‹ ì„ ì••ë„í•˜ì§€ëŠ” ì•Šì„ ê±°ì˜ˆìš”. ì´ì œ ë‹¹ì‹ ì€ ê·¸ ìŠ¬í””ê³¼ í•¨ê»˜ ìˆì„ ì¤„ ì•„ëŠ” ì‚¬ëŒì´ ë˜ì—ˆìœ¼ë‹ˆê¹Œìš”. ìŠ¬í””ë„ ë‹¹ì‹ ì˜ ì¼ë¶€ë¡œ ë°›ì•„ë“¤ì´ë©´ì„œë„, ê·¸ê²ƒì— ë§¤ëª°ë˜ì§€ ì•Šì„ ìˆ˜ ìˆì–´ìš”.",
                            love: "ê·¸ ì‚¬ë‘ì´ ë‹¤ì‹œ ë§ˆìŒì„ ë‘ë“œë¦¬ê³  ìˆë‚˜ìš”? ì´ë²ˆì—ëŠ” ì•„í”„ì§€ ì•Šì€ í˜•íƒœë¡œ ëŒì•„ì™”ì„ ê±°ì˜ˆìš”. ê·¸ ì‚¬ë‘ì´ ì£¼ì—ˆë˜ ì•„ë¦„ë‹¤ìš´ ìˆœê°„ë“¤, ì„±ì¥ì‹œì¼œì¤€ ê²½í—˜ë“¤ì„ ì´ì œëŠ” ê°ì‚¬íˆ ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”.",
                            anger: "ë¶„ë…¸ê°€ ë˜ëŒì•„ì™”ì§€ë§Œ, ì´ë²ˆì—ëŠ” ê·¸ ë¶„ë…¸ ì†ì— ìˆ¨ì–´ìˆëŠ” ë©”ì‹œì§€ë¥¼ ë“¤ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”. ë¬´ì—‡ì´ ë‹¹ì‹ ì„ í™”ë‚˜ê²Œ í–ˆëŠ”ì§€, ë¬´ì—‡ì„ ì§€í‚¤ê³  ì‹¶ì—ˆëŠ”ì§€. ê·¸ ë¶„ë…¸ë¥¼ ê±´ì„¤ì ì¸ ì—ë„ˆì§€ë¡œ ë°”ê¿€ ë•Œê°€ ì™”ì–´ìš”.",
                            fear: "ë‘ë ¤ì›€ì´ ë‹¤ì‹œ ì°¾ì•„ì™”ì§€ë§Œ, ì´ì œ ë‹¹ì‹ ì€ ê·¸ ë‘ë ¤ì›€ì˜ ì§„ì§œ ì •ì²´ë¥¼ ì•Œ ìˆ˜ ìˆì–´ìš”. ê·¸ê²ƒì´ ë‹¹ì‹ ì„ ë³´í˜¸í•˜ë ¤ë˜ ë§ˆìŒì´ì—ˆëŠ”ì§€, ì•„ë‹ˆë©´ ì„±ì¥ì„ ë§‰ëŠ” ì¥ë²½ì´ì—ˆëŠ”ì§€. ì´ë²ˆì—ëŠ” ë‘ë ¤ì›€ê³¼ ëŒ€í™”í•  ìˆ˜ ìˆì„ ê±°ì˜ˆìš”.",
                            loneliness: "ì™¸ë¡œì›€ì´ ëŒì•„ì™”ì§€ë§Œ, ì´ì œëŠ” ê·¸ ì™¸ë¡œì›€ ì†ì—ì„œë„ ìì‹ ê³¼ì˜ ê¹Šì€ ë§Œë‚¨ì„ ê°€ì§ˆ ìˆ˜ ìˆì–´ìš”. í˜¼ìë¼ëŠ” ê²ƒì´ ë²„ë¦¼ë°›ì€ ê²Œ ì•„ë‹ˆë¼, ìì‹ ì„ ë” ê¹Šì´ ì•Œì•„ê°€ëŠ” ì‹œê°„ì´ ë  ìˆ˜ ìˆì–´ìš”.",
                            guilt: "ì£„ì±…ê°ì´ ë‹¤ì‹œ ë§ˆìŒì„ ëˆ„ë¥´ë ¤ í•˜ì§€ë§Œ, ì´ë²ˆì—ëŠ” ê·¸ ê°ì •ì„ ì„±ì°°ì˜ ê¸°íšŒë¡œ ë°”ê¿€ ìˆ˜ ìˆì–´ìš”. ì£„ì±…ê°ì´ ê°€ë¥´ì³ì£¼ëŠ” êµí›ˆì„ ë°°ìš°ê³ , ë” ë‚˜ì€ ì„ íƒì„ í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒì´ ë˜ì—ˆìœ¼ë‹ˆê¹Œìš”.",
                            anxiety: "ë¶ˆì•ˆì´ ëŒì•„ì™”ì§€ë§Œ, ì´ì œëŠ” ê·¸ ë¶ˆì•ˆì´ ë‹¹ì‹ ì„ ë§ˆë¹„ì‹œí‚¤ì§€ ì•Šì„ ê±°ì˜ˆìš”. ë¶ˆì•ˆ ì†ì— ìˆ¨ì–´ìˆëŠ” ì§„ì§œ ê±±ì •ì´ ë¬´ì—‡ì¸ì§€ ì•Œì•„ë³´ê³ , í•˜ë‚˜ì”© í•´ê²°í•´ë‚˜ê°ˆ ìˆ˜ ìˆëŠ” í˜ì´ ìƒê²¼ì–´ìš”.",
                            acceptance: "ë°›ì•„ë“¤ì„ì˜ ë§ˆìŒìœ¼ë¡œ ê·¸ ê°ì •ì„ ë§ì´í•˜ê³  ìˆë‚˜ìš”? ê·¸ë ‡ë‹¤ë©´ ì´ì œ ì •ë§ë¡œ ê·¸ ê°ì •ê³¼ í‰í™”ë¡­ê²Œ ê³µì¡´í•  ìˆ˜ ìˆì„ ê±°ì˜ˆìš”. ì €í•­í•˜ì§€ ì•Šê³  ë°›ì•„ë“¤ì¼ ë•Œ, ê°ì •ì€ ìì—°ìŠ¤ëŸ½ê²Œ í˜ëŸ¬ê°‘ë‹ˆë‹¤.",
                            general: "ëŒì•„ì˜¨ ê°ì •ì´ ë¬´ì—‡ì´ë“ , ì´ë²ˆì—ëŠ” ë‹¹ì‹ ì´ ë” ì„±ìˆ™í•œ ë§ˆìŒìœ¼ë¡œ ë§ì´í•  ìˆ˜ ìˆì„ ê±°ì˜ˆìš”. ê·¸ ê°ì •ì´ ê°€ë¥´ì³ì£¼ë ¤ëŠ” ê²ƒì´ ë¬´ì—‡ì¸ì§€ ë“¤ì–´ë³´ì„¸ìš”. ëª¨ë“  ê°ì •ì—ëŠ” ì˜ë¯¸ê°€ ìˆì–´ìš”."
                        },
                        en: {
                            nostalgia: "Nostalgia has returned. That emotion wasn't gone, it was quietly waiting inside you. Now you can accept that longing as memories that aren't bitter, as beautiful experiences.",
                            regret: "Did regret knock on your door again? But this time is different. That regret isn't here to break you down, but to give you wisdom for better choices. You can't change the past, but now can be different.",
                            sadness: "Sadness has returned, but it won't overwhelm you like before. You've become someone who knows how to be with that sadness. You can accept sadness as part of you without being buried in it.",
                            love: "Is that love knocking on your heart again? This time it returned in a form that doesn't hurt. You'll be able to gratefully accept the beautiful moments that love gave, the experiences that made you grow.",
                            anger: "Anger has returned, but this time you'll be able to hear the message hidden in that anger. What made you angry, what you wanted to protect. It's time to transform that anger into constructive energy.",
                            fear: "Fear has returned, but now you can know the true identity of that fear. Whether it was a heart trying to protect you, or a barrier preventing growth. This time you'll be able to dialogue with fear.",
                            loneliness: "Loneliness has returned, but now you can have deep encounters with yourself even in that loneliness. Being alone isn't abandonment, but time to know yourself more deeply.",
                            guilt: "Guilt tries to press on your heart again, but this time you can turn that emotion into an opportunity for reflection. You've become someone who can learn from what guilt teaches and make better choices.",
                            anxiety: "Anxiety has returned, but now it won't paralyze you. You have the power to discover what real worry is hidden in anxiety and solve it step by step.",
                            acceptance: "Are you welcoming that emotion with acceptance? Then you'll truly be able to coexist peacefully with that emotion. When you accept without resistance, emotions flow naturally.",
                            general: "Whatever emotion has returned, this time you'll be able to welcome it with a more mature heart. Listen to what that emotion is trying to teach you. Every emotion has meaning."
                        },
                        pt: {
                            nostalgia: "A nostalgia retornou. Essa emoÃ§Ã£o nÃ£o tinha ido embora, estava silenciosamente esperando dentro de vocÃª. Agora vocÃª pode aceitar essa saudade como memÃ³rias que nÃ£o sÃ£o amargas, como experiÃªncias bonitas.",
                            regret: "O arrependimento bateu Ã  sua porta novamente? Mas desta vez Ã© diferente. Esse arrependimento nÃ£o estÃ¡ aqui para destruÃ­-lo, mas para dar sabedoria para melhores escolhas. VocÃª nÃ£o pode mudar o passado, mas agora pode ser diferente.",
                            sadness: "A tristeza retornou, mas nÃ£o o dominarÃ¡ como antes. VocÃª se tornou alguÃ©m que sabe como estar com essa tristeza. VocÃª pode aceitar tristeza como parte de vocÃª sem ser enterrado nela.",
                            love: "Esse amor estÃ¡ batendo no seu coraÃ§Ã£o novamente? Desta vez retornou em uma forma que nÃ£o dÃ³i. VocÃª serÃ¡ capaz de aceitar com gratidÃ£o os belos momentos que o amor deu, as experiÃªncias que fizeram vocÃª crescer.",
                            anger: "A raiva retornou, mas desta vez vocÃª serÃ¡ capaz de ouvir a mensagem escondida nessa raiva. O que te deixou com raiva, o que vocÃª queria proteger. Ã‰ hora de transformar essa raiva em energia construtiva.",
                            fear: "O medo retornou, mas agora vocÃª pode conhecer a verdadeira identidade desse medo. Se era um coraÃ§Ã£o tentando protegÃª-lo, ou uma barreira impedindo crescimento. Desta vez vocÃª serÃ¡ capaz de dialogar com o medo.",
                            loneliness: "A solidÃ£o retornou, mas agora vocÃª pode ter encontros profundos consigo mesmo mesmo nessa solidÃ£o. Estar sozinho nÃ£o Ã© abandono, mas tempo para se conhecer mais profundamente.",
                            guilt: "A culpa tenta pressionar seu coraÃ§Ã£o novamente, mas desta vez vocÃª pode transformar essa emoÃ§Ã£o em uma oportunidade de reflexÃ£o. VocÃª se tornou alguÃ©m que pode aprender com o que a culpa ensina e fazer melhores escolhas.",
                            anxiety: "A ansiedade retornou, mas agora nÃ£o o paralisarÃ¡. VocÃª tem o poder de descobrir que preocupaÃ§Ã£o real estÃ¡ escondida na ansiedade e resolvÃª-la passo a passo.",
                            acceptance: "VocÃª estÃ¡ recebendo essa emoÃ§Ã£o com aceitaÃ§Ã£o? EntÃ£o vocÃª verdadeiramente serÃ¡ capaz de coexistir pacificamente com essa emoÃ§Ã£o. Quando vocÃª aceita sem resistÃªncia, emoÃ§Ãµes fluem naturalmente.",
                            general: "Qualquer emoÃ§Ã£o que tenha retornado, desta vez vocÃª serÃ¡ capaz de recebÃª-la com um coraÃ§Ã£o mais maduro. Escute o que essa emoÃ§Ã£o estÃ¡ tentando ensinar. Toda emoÃ§Ã£o tem significado."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Wisdom", emoji: "ğŸ¦‰",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            nostalgia: "ê·¸ë¦¬ì›€ì´ ëŒì•„ì˜¨ ê±´ ë‹¹ì‹ ì´ ì´ì œ ê·¸ ê¸°ì–µì„ ê°ê´€ì ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆê²Œ ë˜ì—ˆê¸° ë•Œë¬¸ì´ì—ìš”. ì˜ˆì „ì—ëŠ” ê·¸ ê¸°ì–µì— ì‚¬ë¡œì¡í˜”ë‹¤ë©´, ì´ì œëŠ” ê·¸ ê¸°ì–µì—ì„œ ë°°ìš¸ ì ì„ ì°¾ì„ ìˆ˜ ìˆì–´ìš”. ê·¸ë¦¬ì›€ë„ ì§€í˜œì˜ í˜•íƒœë¡œ ë‹¤ê°€ì˜¬ ìˆ˜ ìˆë‹µë‹ˆë‹¤.",
                            regret: "í›„íšŒê°€ ë‹¤ì‹œ ì°¾ì•„ì˜¨ ê±´, ë‹¹ì‹ ì´ ì´ì œ ê³¼ê±°ì˜ ì‹¤ìˆ˜ë¥¼ êµí›ˆìœ¼ë¡œ ë°”ê¿€ ì¤€ë¹„ê°€ ë˜ì—ˆë‹¤ëŠ” ì‹ í˜¸ì˜ˆìš”. í›„íšŒëŠ” ë‹¨ìˆœí•œ ìì±…ì´ ì•„ë‹ˆë¼, ë” ë‚˜ì€ ë¯¸ë˜ë¥¼ ìœ„í•œ ë‚˜ì¹¨ë°˜ì´ ë  ìˆ˜ ìˆì–´ìš”. ê·¸ í›„íšŒê°€ ê°€ë¥´ì³ì£¼ëŠ” ê²ƒì„ ë“¤ì–´ë³´ì„¸ìš”.",
                            sadness: "ìŠ¬í””ì´ ëŒì•„ì™”ë‹¤ëŠ” ê²ƒì€ ë‹¹ì‹ ì´ ì´ì œ ê·¸ ìŠ¬í””ì˜ ê¹Šì´ë¥¼ ì´í•´í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤ëŠ” ëœ»ì´ì—ìš”. ìŠ¬í””ì€ ìš°ë¦¬ì—ê²Œ ë¬´ì—‡ì´ ì •ë§ ì†Œì¤‘í–ˆëŠ”ì§€ë¥¼ ê°€ë¥´ì³ì¤ë‹ˆë‹¤. ê·¸ ìŠ¬í”” ì†ì—ì„œ ì§„ì§œ ê°€ì¹˜ë¥¼ ë°œê²¬í•  ìˆ˜ ìˆì„ ê±°ì˜ˆìš”.",
                            love: "ì‚¬ë‘ì´ ë‹¤ì‹œ ë§ˆìŒì„ ë‘ë“œë¦¬ëŠ” ê±´, ë‹¹ì‹ ì´ ì´ì œ ì‚¬ë‘ì˜ ì§„ì •í•œ ì˜ë¯¸ë¥¼ ì´í•´í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆê¸° ë•Œë¬¸ì´ì—ìš”. ì†Œìœ í•˜ë ¤ëŠ” ì‚¬ë‘ì´ ì•„ë‹ˆë¼, ì£¼ê³ ë°›ëŠ” ì‚¬ë‘ì˜ ì•„ë¦„ë‹¤ì›€ì„ ì´ì œëŠ” ì•Œ ìˆ˜ ìˆì–´ìš”.",
                            anger: "ë¶„ë…¸ê°€ ëŒì•„ì˜¨ ê±´ ë‹¹ì‹ ì´ ì´ì œ ê·¸ ë¶„ë…¸ ë’¤ì— ìˆ¨ì€ ì§„ì§œ ë©”ì‹œì§€ë¥¼ ë“¤ì„ ì¤€ë¹„ê°€ ë˜ì—ˆê¸° ë•Œë¬¸ì´ì—ìš”. ë¶„ë…¸ëŠ” ë•Œë¡œ ìš°ë¦¬ì˜ ê°€ì¹˜ê´€ì´ ë¬´ì—‡ì¸ì§€ë¥¼ ëª…í™•íˆ ë³´ì—¬ì£¼ëŠ” ê±°ìš¸ì´ì—ìš”. ê·¸ ê±°ìš¸ì„ ë“¤ì—¬ë‹¤ë³´ì„¸ìš”.",
                            fear: "ë‘ë ¤ì›€ì´ ë‹¤ì‹œ ì°¾ì•„ì˜¨ ê±´ ë‹¹ì‹ ì´ ì´ì œ ì§„ì§œ ìš©ê¸°ê°€ ë¬´ì—‡ì¸ì§€ ë°°ìš¸ ì¤€ë¹„ê°€ ë˜ì—ˆë‹¤ëŠ” ì‹ í˜¸ì˜ˆìš”. ìš©ê¸°ëŠ” ë‘ë ¤ì›€ì´ ì—†ëŠ” ê²Œ ì•„ë‹ˆë¼, ë‘ë ¤ì›€ê³¼ í•¨ê»˜ ê±¸ì–´ê°€ëŠ” ê±°ì˜ˆìš”. ì´ì œ ê·¸ ë¹„ë°€ì„ ì•Œ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”.",
                            loneliness: "ì™¸ë¡œì›€ì´ ëŒì•„ì˜¨ ê±´ ë‹¹ì‹ ì´ ì´ì œ ì§„ì •í•œ ë…ë¦½ê³¼ ìë¦½ì´ ë¬´ì—‡ì¸ì§€ ë°°ìš¸ ë•Œê°€ ë˜ì—ˆê¸° ë•Œë¬¸ì´ì—ìš”. ì™¸ë¡œì›€ì€ ë•Œë¡œ ìì‹ ë§Œì˜ ë‚´ë©´ì˜ í’ìš”ë¡œì›€ì„ ë°œê²¬í•˜ê²Œ í•´ì£¼ëŠ” ì„ ìƒë‹˜ì´ì—ìš”.",
                            guilt: "ì£„ì±…ê°ì´ ë‹¤ì‹œ ì°¾ì•„ì˜¨ ê±´ ë‹¹ì‹ ì´ ì´ì œ ì§„ì •í•œ ì±…ì„ê°ê³¼ ì„±ìˆ™í•¨ì„ ë°°ìš¸ ì¤€ë¹„ê°€ ë˜ì—ˆë‹¤ëŠ” ëœ»ì´ì—ìš”. ì£„ì±…ê°ì„ í†µí•´ ë” ë‚˜ì€ íŒë‹¨ë ¥ì„ ê¸°ë¥¼ ìˆ˜ ìˆì–´ìš”. ê·¸ê²ƒì´ ì£„ì±…ê°ì´ ì£¼ëŠ” ì„ ë¬¼ì´ì—ìš”.",
                            anxiety: "ë¶ˆì•ˆì´ ëŒì•„ì˜¨ ê±´ ë‹¹ì‹ ì´ ì´ì œ ì§„ì •í•œ í‰ì•ˆì´ ë¬´ì—‡ì¸ì§€ ì•Œì•„ê°ˆ ë•Œê°€ ë˜ì—ˆê¸° ë•Œë¬¸ì´ì—ìš”. ë¶ˆì•ˆì€ ë•Œë¡œ ìš°ë¦¬ê°€ ì •ë§ ì¤‘ìš”í•˜ê²Œ ì—¬ê¸°ëŠ” ê²ƒì´ ë¬´ì—‡ì¸ì§€ë¥¼ ì•Œë ¤ì£¼ëŠ” ì‹ í˜¸ë“±ì´ì—ìš”.",
                            acceptance: "ë°›ì•„ë“¤ì„ì˜ ë§ˆìŒìœ¼ë¡œ ê·¸ ê°ì •ì„ ë§ì´í•œë‹¤ë©´, ë‹¹ì‹ ì€ ì´ë¯¸ í° ì§€í˜œë¥¼ ì–»ì€ ê±°ì˜ˆìš”. ì €í•­í•˜ì§€ ì•Šê³  ë°›ì•„ë“¤ì´ëŠ” ê²ƒ, ê·¸ê²ƒì´ ì§„ì •í•œ ì„±ìˆ™í•¨ì´ì—ìš”. ë‹¹ì‹ ì€ ì´ë¯¸ ê·¸ ê²½ì§€ì— ë„ë‹¬í–ˆì–´ìš”.",
                            general: "ì–´ë–¤ ê°ì •ì´ ëŒì•„ì™”ë“ , ê·¸ê²ƒì€ ë‹¹ì‹ ì´ ë” ê¹Šì€ ì´í•´ì™€ ì§€í˜œë¥¼ ì–»ì„ ì¤€ë¹„ê°€ ë˜ì—ˆë‹¤ëŠ” ì‹ í˜¸ì˜ˆìš”. ê°ì •ì€ ìš°ë¦¬ì˜ ì„ ìƒë‹˜ì´ì—ìš”. ê·¸ë“¤ì´ ê°€ë¥´ì³ì£¼ë ¤ëŠ” êµí›ˆì— ê·€ ê¸°ìš¸ì—¬ë³´ì„¸ìš”."
                        },
                        en: {
                            nostalgia: "Nostalgia returned because you can now view those memories objectively. If you were once captivated by those memories, now you can find lessons to learn from them. Nostalgia can also approach in the form of wisdom.",
                            regret: "Regret returning is a signal that you're now ready to transform past mistakes into lessons. Regret isn't just self-blame, but can become a compass for a better future. Listen to what that regret is teaching you.",
                            sadness: "Sadness returning means you can now understand the depth of that sadness. Sadness teaches us what was truly precious. You'll be able to discover real value within that sadness.",
                            love: "Love knocking on your heart again is because you can now understand love's true meaning. Not possessive love, but the beauty of giving and receiving love - you can know this now.",
                            anger: "Anger returned because you're now ready to hear the real message hidden behind that anger. Anger is sometimes a mirror that clearly shows what our values are. Look into that mirror.",
                            fear: "Fear returning is a signal that you're ready to learn what real courage is. Courage isn't the absence of fear, but walking together with fear. Now you'll be able to know that secret.",
                            loneliness: "Loneliness returned because it's time for you to learn what true independence and self-reliance are. Loneliness is sometimes a teacher that helps you discover your own inner richness.",
                            guilt: "Guilt returning means you're ready to learn true responsibility and maturity. Through guilt, you can develop better judgment. That's the gift guilt gives.",
                            anxiety: "Anxiety returned because it's time for you to discover what true peace is. Anxiety is sometimes a traffic light that tells us what we truly value.",
                            acceptance: "If you welcome that emotion with acceptance, you've already gained great wisdom. Accepting without resistance - that's true maturity. You've already reached that level.",
                            general: "Whatever emotion has returned, it's a signal that you're ready to gain deeper understanding and wisdom. Emotions are our teachers. Listen to the lessons they're trying to teach."
                        },
                        pt: {
                            nostalgia: "A nostalgia retornou porque vocÃª agora pode ver essas memÃ³rias objetivamente. Se uma vez vocÃª foi cativado por essas memÃ³rias, agora vocÃª pode encontrar liÃ§Ãµes para aprender com elas. A nostalgia tambÃ©m pode se aproximar na forma de sabedoria.",
                            regret: "O arrependimento retornar Ã© um sinal de que vocÃª estÃ¡ agora pronto para transformar erros passados em liÃ§Ãµes. Arrependimento nÃ£o Ã© apenas auto-culpa, mas pode se tornar uma bÃºssola para um futuro melhor. Escute o que esse arrependimento estÃ¡ ensinando.",
                            sadness: "A tristeza retornar significa que vocÃª agora pode entender a profundidade dessa tristeza. A tristeza nos ensina o que era verdadeiramente precioso. VocÃª serÃ¡ capaz de descobrir valor real dentro dessa tristeza.",
                            love: "O amor batendo no seu coraÃ§Ã£o novamente Ã© porque vocÃª agora pode entender o verdadeiro significado do amor. NÃ£o amor possessivo, mas a beleza de dar e receber amor - vocÃª pode saber isso agora.",
                            anger: "A raiva retornou porque vocÃª estÃ¡ agora pronto para ouvir a mensagem real escondida por trÃ¡s dessa raiva. A raiva Ã s vezes Ã© um espelho que mostra claramente quais sÃ£o nossos valores. Olhe nesse espelho.",
                            fear: "O medo retornar Ã© um sinal de que vocÃª estÃ¡ pronto para aprender o que Ã© coragem real. Coragem nÃ£o Ã© a ausÃªncia de medo, mas caminhar junto com o medo. Agora vocÃª serÃ¡ capaz de conhecer esse segredo.",
                            loneliness: "A solidÃ£o retornou porque Ã© hora de vocÃª aprender o que sÃ£o verdadeira independÃªncia e auto-suficiÃªncia. A solidÃ£o Ã s vezes Ã© um professor que ajuda vocÃª a descobrir sua prÃ³pria riqueza interior.",
                            guilt: "A culpa retornar significa que vocÃª estÃ¡ pronto para aprender verdadeira responsabilidade e maturidade. AtravÃ©s da culpa, vocÃª pode desenvolver melhor julgamento. Esse Ã© o presente que a culpa dÃ¡.",
                            anxiety: "A ansiedade retornou porque Ã© hora de vocÃª descobrir o que Ã© verdadeira paz. A ansiedade Ã s vezes Ã© um semÃ¡foro que nos diz o que realmente valorizamos.",
                            acceptance: "Se vocÃª recebe essa emoÃ§Ã£o com aceitaÃ§Ã£o, vocÃª jÃ¡ ganhou grande sabedoria. Aceitar sem resistÃªncia - essa Ã© verdadeira maturidade. VocÃª jÃ¡ alcanÃ§ou esse nÃ­vel.",
                            general: "Qualquer emoÃ§Ã£o que tenha retornado, Ã© um sinal de que vocÃª estÃ¡ pronto para ganhar compreensÃ£o e sabedoria mais profundas. EmoÃ§Ãµes sÃ£o nossos professores. Escute as liÃ§Ãµes que estÃ£o tentando ensinar."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Circle", emoji: "ğŸ”®",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            nostalgia: "ê·¸ë¦¬ì›€ì€ ì›í˜•ìœ¼ë¡œ ëŒì•„ì˜µë‹ˆë‹¤. ëì´ ìˆëŠ” ê²ƒ ê°™ì§€ë§Œ ì‚¬ì‹¤ì€ ìƒˆë¡œìš´ ì‹œì‘ì´ê¸°ë„ í•´ìš”. ë‹¹ì‹ ì´ ê·¸ë¦¬ì›Œí•˜ëŠ” ê²ƒë“¤ì´ ë‹¤ì‹œ ì°¾ì•„ì˜¨ ê±´, ì´ì œ ê·¸ê²ƒë“¤ì„ ìƒˆë¡œìš´ ê´€ì ì—ì„œ ë³¼ ì¤€ë¹„ê°€ ë˜ì—ˆê¸° ë•Œë¬¸ì´ì—ìš”. ê°™ì€ ê°ì •ì´ì§€ë§Œ ë‹¤ë¥¸ ì˜ë¯¸ë¥¼ ê°–ê²Œ ë  ê±°ì˜ˆìš”.",
                            regret: "í›„íšŒëŠ” ë‚˜ì„ í˜•ìœ¼ë¡œ ì›€ì§ì…ë‹ˆë‹¤. ê°™ì€ ìë¦¬ë¡œ ëŒì•„ì˜¨ ê²ƒ ê°™ì§€ë§Œ ì‚¬ì‹¤ì€ ë” ë†’ì€ ìœ„ì¹˜ì—ì„œ ê·¸ ê²½í—˜ì„ ë°”ë¼ë³´ê³  ìˆì–´ìš”. ì´ë²ˆì˜ í›„íšŒëŠ” ì˜ˆì „ê³¼ ë‹¤ë¥¸ ê¹Šì´ë¥¼ ê°€ì§ˆ ê±°ì˜ˆìš”. ë” ì„±ìˆ™í•œ ì‹œê°ìœ¼ë¡œ ê³¼ê±°ë¥¼ ë³¼ ìˆ˜ ìˆê²Œ ë˜ì—ˆìœ¼ë‹ˆê¹Œìš”.",
                            sadness: "ìŠ¬í””ì˜ ìˆœí™˜ì´ ë‹¤ì‹œ ì‹œì‘ë˜ì—ˆë‚˜ìš”? í•˜ì§€ë§Œ ì´ë²ˆì—ëŠ” ê·¸ ìŠ¬í””ì´ ë‹¹ì‹ ì„ ê°™ì€ ê³³ìœ¼ë¡œ ë°ë ¤ê°€ì§€ ì•Šì„ ê±°ì˜ˆìš”. ê²½í—˜ì´ë¼ëŠ” ê³„ë‹¨ì„ í•˜ë‚˜ ë” ì˜¬ë¼ì„  ìƒíƒœì—ì„œ ë§Œë‚˜ëŠ” ìŠ¬í””ì€ ë‹¤ë¥¸ ëª¨ìŠµì¼ ê±°ì˜ˆìš”. ë” ì§€í˜œë¡œìš´ ìŠ¬í””ì´ ë  ìˆ˜ ìˆì–´ìš”.",
                            love: "ì‚¬ë‘ì€ ì˜ì›í•œ ìˆœí™˜ì…ë‹ˆë‹¤. ë– ë‚¬ë‹¤ê°€ ëŒì•„ì˜¤ê³ , ì‚¬ë¼ì¡Œë‹¤ê°€ ë‹¤ì‹œ ë‚˜íƒ€ë‚˜ì£ . í•˜ì§€ë§Œ ëŒì•„ì˜¨ ì‚¬ë‘ì€ ì˜ˆì „ê³¼ ê°™ì§€ ì•Šì•„ìš”. ë” ê¹Šê³ , ë” ì´í•´ì‹¬ ìˆê³ , ë” ììœ ë¡œìš´ í˜•íƒœì˜ ì‚¬ë‘ì´ ë  ê±°ì˜ˆìš”.",
                            anger: "ë¶„ë…¸ì˜ ë°”í€´ê°€ ë‹¤ì‹œ ëŒê¸° ì‹œì‘í–ˆë‚˜ìš”? í•˜ì§€ë§Œ ì´ì œ ê·¸ ë°”í€´ë¥¼ ë©ˆì¶œ ìˆ˜ ìˆëŠ” í˜ì´ ìˆì–´ìš”. ê°™ì€ ë¶„ë…¸ë¼ë„ ì´ì œëŠ” ê·¸ê²ƒì„ ë‹¤ë¥¸ ë°©í–¥ìœ¼ë¡œ ì´ëŒ ìˆ˜ ìˆì–´ìš”. íŒŒê´´ì ì´ ì•„ë‹Œ ì°½ì¡°ì ì¸ ì—ë„ˆì§€ë¡œ ë°”ê¿€ ìˆ˜ ìˆì–´ìš”.",
                            fear: "ë‘ë ¤ì›€ì˜ ì›ì´ ë‹¤ì‹œ ê·¸ë ¤ì§€ê³  ìˆì§€ë§Œ, ì´ë²ˆì—ëŠ” ê·¸ ì›ì„ ë²—ì–´ë‚  ìˆ˜ ìˆëŠ” ë¬¸ì„ ì°¾ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”. ê°™ì€ ë‘ë ¤ì›€ì´ë¼ë„ ì´ì œëŠ” ê·¸ê²ƒì´ í—ˆìƒì¸ì§€ ì‹¤ì²´ì¸ì§€ êµ¬ë¶„í•  ìˆ˜ ìˆëŠ” ëˆˆì´ ìƒê²¼ì–´ìš”.",
                            loneliness: "ì™¸ë¡œì›€ì˜ ìˆœí™˜ ì†ì—ì„œë„ ì´ì œëŠ” ìì‹ ë§Œì˜ ì¤‘ì‹¬ì„ ì°¾ì„ ìˆ˜ ìˆì–´ìš”. ì™¸ë¡œì›€ì´ ëŒê³  ëŒì•„ë„ ë‹¹ì‹ ì€ ê·¸ ì¤‘ì‹¬ì—ì„œ í”ë“¤ë¦¬ì§€ ì•Šì„ ìˆ˜ ìˆì–´ìš”. ê³ ìš”í•œ ì¤‘ì‹¬ì—ì„œ ì™¸ë¡œì›€ì„ ê´€ì°°í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆì–´ìš”.",
                            guilt: "ì£„ì±…ê°ì˜ ê³ ë¦¬ê°€ ë‹¤ì‹œ ì—°ê²°ë˜ì—ˆì§€ë§Œ, ì´ë²ˆì—ëŠ” ê·¸ ê³ ë¦¬ë¥¼ ëŠì„ ìˆ˜ ìˆëŠ” ì—´ì‡ ë¥¼ ê°€ì§€ê³  ìˆì–´ìš”. ê°™ì€ ì£„ì±…ê°ì´ë¼ë„ ì´ì œëŠ” ê·¸ê²ƒì„ ìš©ì„œì™€ ì„±ì¥ì˜ ê¸°íšŒë¡œ ë°”ê¿€ ìˆ˜ ìˆì–´ìš”.",
                            anxiety: "ë¶ˆì•ˆì˜ ì†Œìš©ëŒì´ê°€ ë‹¤ì‹œ ì‹œì‘ë˜ì—ˆì§€ë§Œ, ì´ë²ˆì—ëŠ” ê·¸ ì¤‘ì‹¬ì—ì„œ ê³ ìš”í•¨ì„ ìœ ì§€í•  ìˆ˜ ìˆì–´ìš”. ë¶ˆì•ˆì´ ëŒê³  ëŒì•„ë„ ë‹¹ì‹ ì˜ ë‚´ë©´ì€ í‰ì˜¨í•  ìˆ˜ ìˆì–´ìš”. íƒœí’ì˜ ëˆˆì²˜ëŸ¼ ë§ì´ì—ìš”.",
                            acceptance: "ë°›ì•„ë“¤ì„ì˜ ì› ì•ˆì—ì„œ ëª¨ë“  ê°ì •ë“¤ì´ ìì—°ìŠ¤ëŸ½ê²Œ ìˆœí™˜í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë„¤ìš”. ì €í•­í•˜ì§€ ì•Šê³  í˜ë ¤ë³´ë‚´ëŠ” ê²ƒ, ê·¸ê²ƒì´ ì§„ì •í•œ ììœ ì˜ˆìš”. ë‹¹ì‹ ì€ ê·¸ ììœ ë¥¼ ì²´í—˜í•˜ê³  ìˆì–´ìš”.",
                            general: "ëª¨ë“  ê°ì •ì€ ì›í˜•ìœ¼ë¡œ ì›€ì§ì…ë‹ˆë‹¤. ë– ë‚¬ë‹¤ê°€ ëŒì•„ì˜¤ê³ , ì‚¬ë¼ì¡Œë‹¤ê°€ ë‹¤ì‹œ ë‚˜íƒ€ë‚˜ì£ . í•˜ì§€ë§Œ ê°™ì€ ìë¦¬ë¡œ ëŒì•„ì˜¨ ê²ƒ ê°™ì•„ë„ ë‹¹ì‹ ì€ ì´ë¯¸ ë‹¤ë¥¸ ì‚¬ëŒì´ ë˜ì–´ ìˆì–´ìš”. ê·¸ê²ƒì´ ì¸ìƒì˜ ë‚˜ì„ í˜• ì—¬ì •ì´ì—ìš”."
                        },
                        en: {
                            nostalgia: "Nostalgia returns in circles. It seems to have an end but is actually a new beginning too. The things you long for returned because you're ready to see them from a new perspective. Same emotion but will have different meaning.",
                            regret: "Regret moves in spirals. It seems to return to the same place but you're actually viewing that experience from a higher position. This regret will have different depth than before. You can now view the past with a more mature perspective.",
                            sadness: "Has the cycle of sadness begun again? But this time that sadness won't take you to the same place. Sadness met while having climbed one more step of experience will look different. It can become wiser sadness.",
                            love: "Love is an eternal cycle. It leaves and returns, disappears and reappears. But returned love isn't the same as before. It will be deeper, more understanding, more free form of love.",
                            anger: "Has anger's wheel started turning again? But now you have the power to stop that wheel. Even the same anger can now be led in different directions. You can transform it into creative rather than destructive energy.",
                            fear: "Fear's circle is being drawn again, but this time you'll be able to find the door to escape that circle. Even the same fear - now you have eyes to distinguish whether it's illusion or reality.",
                            loneliness: "Even in loneliness's cycle, you can now find your own center. Even as loneliness goes round and round, you can remain unshaken at that center. You've learned to observe loneliness from a quiet center.",
                            guilt: "Guilt's chain has connected again, but this time you have the key to break that chain. Even the same guilt can now be transformed into an opportunity for forgiveness and growth.",
                            anxiety: "Anxiety's whirlpool has started again, but this time you can maintain tranquility at its center. Even as anxiety spins round and round, your inner self can be peaceful. Like the eye of a storm.",
                            acceptance: "Within acceptance's circle, all emotions can naturally circulate. Not resisting and letting flow - that's true freedom. You're experiencing that freedom.",
                            general: "All emotions move in circles. They leave and return, disappear and reappear. But even if they seem to return to the same place, you've already become a different person. That's life's spiral journey."
                        },
                        pt: {
                            nostalgia: "A nostalgia retorna em cÃ­rculos. Parece ter um fim mas na verdade tambÃ©m Ã© um novo comeÃ§o. As coisas que vocÃª sente saudade retornaram porque vocÃª estÃ¡ pronto para vÃª-las de uma nova perspectiva. Mesma emoÃ§Ã£o mas terÃ¡ significado diferente.",
                            regret: "O arrependimento se move em espirais. Parece retornar ao mesmo lugar mas vocÃª estÃ¡ na verdade vendo essa experiÃªncia de uma posiÃ§Ã£o mais alta. Este arrependimento terÃ¡ profundidade diferente do anterior. VocÃª agora pode ver o passado com perspectiva mais madura.",
                            sadness: "O ciclo da tristeza comeÃ§ou novamente? Mas desta vez essa tristeza nÃ£o o levarÃ¡ ao mesmo lugar. Tristeza encontrada enquanto subiu mais um degrau de experiÃªncia parecerÃ¡ diferente. Pode se tornar tristeza mais sÃ¡bia.",
                            love: "O amor Ã© um ciclo eterno. Ele parte e retorna, desaparece e reaparece. Mas o amor retornado nÃ£o Ã© o mesmo de antes. SerÃ¡ forma de amor mais profunda, mais compreensiva, mais livre.",
                            anger: "A roda da raiva comeÃ§ou a girar novamente? Mas agora vocÃª tem o poder de parar essa roda. Mesmo a mesma raiva agora pode ser conduzida em direÃ§Ãµes diferentes. VocÃª pode transformÃ¡-la em energia criativa ao invÃ©s de destrutiva.",
                            fear: "O cÃ­rculo do medo estÃ¡ sendo desenhado novamente, mas desta vez vocÃª serÃ¡ capaz de encontrar a porta para escapar desse cÃ­rculo. Mesmo o mesmo medo - agora vocÃª tem olhos para distinguir se Ã© ilusÃ£o ou realidade.",
                            loneliness: "Mesmo no ciclo da solidÃ£o, vocÃª agora pode encontrar seu prÃ³prio centro. Mesmo enquanto a solidÃ£o gira e gira, vocÃª pode permanecer inabalÃ¡vel nesse centro. VocÃª aprendeu a observar a solidÃ£o de um centro silencioso.",
                            guilt: "A corrente da culpa se conectou novamente, mas desta vez vocÃª tem a chave para quebrar essa corrente. Mesmo a mesma culpa agora pode ser transformada em oportunidade de perdÃ£o e crescimento.",
                            anxiety: "O redemoinho da ansiedade comeÃ§ou novamente, mas desta vez vocÃª pode manter tranquilidade em seu centro. Mesmo enquanto a ansiedade gira e gira, seu eu interior pode estar em paz. Como o olho de uma tempestade.",
                            acceptance: "Dentro do cÃ­rculo da aceitaÃ§Ã£o, todas as emoÃ§Ãµes podem circular naturalmente. NÃ£o resistir e deixar fluir - essa Ã© a verdadeira liberdade. VocÃª estÃ¡ experimentando essa liberdade.",
                            general: "Todas as emoÃ§Ãµes se movem em cÃ­rculos. Elas partem e retornam, desaparecem e reaparecem. Mas mesmo se parecem retornar ao mesmo lugar, vocÃª jÃ¡ se tornou uma pessoa diferente. Essa Ã© a jornada espiral da vida."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            }
        ];
        
        let currentLanguage = 'en'; // ê¸°ë³¸ ì–¸ì–´ë¥¼ ì˜ì–´ë¡œ ì„¤ì •
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        // ============ ì—¬ì • ì´ˆê¸°í™” í•¨ìˆ˜ ============
        
        function resetJourney() {
            console.log('=== ì—¬ì • ì´ˆê¸°í™” ì‹œì‘ ===');
            
            // 1. ëª¨ë“  íƒ€ì´í•‘ íš¨ê³¼ ì™„ì „ ì •ë¦¬
            clearAllTypingEffects();
            
            // ì¶”ê°€ ì•ˆì „ì¥ì¹˜ - ëª¨ë“  timer ì •ë¦¬
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            
            // 2. ëª¨ë“  ì½˜í…ì¸  ì„¹ì…˜ ì™„ì „ ì´ˆê¸°í™”
            const sectionsToReset = [
                'portalIntroSection',
                'characterResponsesSection', 
                'lightMessageSection',
                'portalQuestionSection',
                'userInputSection',
                'userReactionsSection',
                'continueSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    } else {
                        const textElements = section.querySelectorAll('.portal-intro, .light-message, .portal-question, .continue-text');
                        textElements.forEach(el => {
                            el.innerHTML = '';
                            el.textContent = '';
                        });
                    }
                }
            });
            
            // 3. íŠ¹ì • ìš”ì†Œë“¤ ê°œë³„ ì´ˆê¸°í™”
            const portalIntro = document.getElementById('portalIntro');
            const lightMessage = document.getElementById('lightMessage');
            const portalQuestion = document.getElementById('portalQuestion');
            const continueText = document.getElementById('continueText');
            
            if (portalIntro) portalIntro.innerHTML = '';
            if (lightMessage) lightMessage.innerHTML = '';
            if (portalQuestion) portalQuestion.innerHTML = '';
            if (continueText) continueText.innerHTML = '';
            
            // 4. í…ìŠ¤íŠ¸ì˜ì—­ ì™„ì „ ì´ˆê¸°í™”
            const userTextarea = document.getElementById('userTextarea');
            if (userTextarea) {
                userTextarea.disabled = false;
                userTextarea.value = '';
                userTextarea.style.height = 'auto';
                userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            }
            
            // 5. ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì´ˆê¸°í™”
            const mainContent = document.getElementById('mainContent');
            if (mainContent) {
                mainContent.scrollTop = 0;
            }
            
            // 6. ìƒíƒœ ë³€ìˆ˜ ì™„ì „ ì´ˆê¸°í™”
            userResponse = '';
            currentTypingElement = null;
            
            console.log('=== ì—¬ì • ì´ˆê¸°í™” ì™„ë£Œ ===');
        }
        
        // ============ ê°œì„ ëœ ì–¸ì–´ ë³€ê²½ í•¨ìˆ˜ ============
        
        function changeLanguage(lang) {
            if (!translations[lang]) {
                console.error('ì§€ì›í•˜ì§€ ì•ŠëŠ” ì–¸ì–´:', lang);
                return;
            }
            
            if (currentLanguage === lang) {
                return;
            }
            
            if (journeyStarted) {
                const confirmMessage = translations[currentLanguage].languageChangeConfirm;
                const shouldRestart = confirm(confirmMessage);
                
                if (!shouldRestart) {
                    return;
                }
            }
            
            const previousLanguage = currentLanguage;
            currentLanguage = lang;
            
            console.log(`ì–¸ì–´ ë³€ê²½: ${previousLanguage} â†’ ${currentLanguage}`);
            
            if (journeyStarted) {
                resetJourney();
            }
            
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                setTimeout(() => {
                    console.log(`ìƒˆë¡œìš´ ì–¸ì–´(${currentLanguage})ë¡œ ì—¬ì • ì¬ì‹œì‘`);
                    startPortalSequence();
                }, 1000);
            }
        }
        
        // ============ UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤ ============
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            // ê°œë³„ ìš”ì†Œ ì—…ë°ì´íŠ¸
            const elements = [
                'logoSubtitle',
                'portalMainTitle', 
                'portalSubtitle',
                'lightTitle',
                'continueYesBtn',
                'continueNoBtn'
            ];
            
            elements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element && translations[lang]) {
                    const key = elementId.replace('Btn', 'Button').replace('Subtitle', 'Subtitle');
                    let translationKey = key;
                    
                    const keyMapping = {
                        'logoSubtitle': 'logoSubtitle',
                        'portalMainTitle': 'portalMainTitle',
                        'portalSubtitle': 'portalSubtitle',
                        'lightTitle': 'lightTitle',
                        'continueYesButton': 'continueYes',
                        'continueNoButton': 'continueNo'
                    };
                    
                    translationKey = keyMapping[key] || key;
                    
                    if (translations[lang][translationKey]) {
                        element.textContent = translations[lang][translationKey];
                    }
                }
            });
            
            // placeholder ì—…ë°ì´íŠ¸
            const textarea = document.getElementById('userTextarea');
            if (textarea) textarea.placeholder = translations[lang].inputPlaceholder;
        }
        
        // ============ ê°œì„ ëœ íƒ€ì´í•‘ íš¨ê³¼ + ìŠ¤í¬ë¡¤ ì¶”ì  ì‹œìŠ¤í…œ ============
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i % 10 === 0) {
                        scrollToFollowTyping(element);
                    }
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        
                        setTimeout(() => {
                            if (document.contains(element)) {
                                scrollToFollowTyping(element);
                            }
                        }, 200);
                        
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        // ============ ìŠ¤ë§ˆíŠ¸ ìŠ¤í¬ë¡¤ ì‹œìŠ¤í…œ ============
        
        function scrollToFollowTyping(element) {
            const mainContent = document.getElementById('mainContent');
            const elementRect = element.getBoundingClientRect();
            const containerRect = mainContent.getBoundingClientRect();
            
            if (elementRect.bottom > containerRect.bottom - 150) {
                const scrollTop = mainContent.scrollTop;
                const elementOffsetTop = element.offsetTop;
                const targetScroll = elementOffsetTop - (containerRect.height / 2);
                
                mainContent.scrollTo({
                    top: Math.max(0, targetScroll),
                    behavior: 'smooth'
                });
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        // ============ ì–¸ì–´ ë²„íŠ¼ ì´ë²¤íŠ¸ ì„¤ì • ============
        
        function setupLanguageButtons() {
            const langButtons = document.querySelectorAll('.lang-btn');
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const newLang = this.dataset.lang;
                    changeLanguage(newLang);
                });
            });
        }
        
        // ============ ë©”ì¸ ì—¬ì • ì‹œìŠ¤í…œ ============
        
        function initializeTemarix() {
            console.log('=== Temarix Portal 05 ì´ˆê¸°í™” ì‹œì‘ ===');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        // ============ ì—¬ì • ë‹¨ê³„ë“¤ ============
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            const introText = translations[currentLanguage].portalIntro;
            await typewriterEffect(introElement, introText, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const dialogueText = translations[currentLanguage][char.key];
                await typewriterEffect(dialogueDiv, dialogueText, 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            const lightText = translations[currentLanguage].lightMessage;
            await typewriterEffect(lightMessageEl, lightText, 60);
            
            setTimeout(() => {
                showQuestion();
            }, 2000);
        }
        
        async function showQuestion() {
            const questionSection = document.getElementById('portalQuestionSection');
            const questionEl = document.getElementById('portalQuestion');
            
            questionSection.classList.add('show');
            
            const questionText = translations[currentLanguage].portalQuestion;
            await typewriterEffect(questionEl, questionText, 50);
            
            setTimeout(() => {
                enableUserInput();
            }, 1500);
        }
        
        // ============ ì‚¬ìš©ì ì…ë ¥ ì‹œìŠ¤í…œ ============
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', handleTextareaKeydown);
            
            document.getElementById('continueYesBtn').addEventListener('click', function() {
                processContinue('Y');
            });
            
            document.getElementById('continueNoBtn').addEventListener('click', function() {
                processContinue('N');
            });
        }
        
        function handleTextareaKeydown(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                const inputValue = this.value.trim();
                
                if (inputValue) {
                    processUserInput(inputValue);
                }
            }
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                showUserReactions(inputText);
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = `<strong>${youLabel}:</strong> "${text}"`;
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showContinueOption();
            }, 2000);
        }
        
        async function showContinueOption() {
            const continueSection = document.getElementById('continueSection');
            const continueText = document.getElementById('continueText');
            
            continueSection.classList.add('show');
            
            const questionText = translations[currentLanguage].continueText;
            await typewriterEffect(continueText, questionText, 50);
            
            setTimeout(() => {
                scrollToElement(continueSection);
            }, 500);
        }
        
        function processContinue(input) {
            if (input === 'Y') {
                const message = currentLanguage === 'ko' ? 
                    'Portal 06ì´ ê³§ ì¤€ë¹„ë©ë‹ˆë‹¤. ê³„ì†í•´ì„œ ë” ê¹Šì€ ê°ì •ì˜ ì—¬ì •ì´ ì´ì–´ì§‘ë‹ˆë‹¤.' :
                    currentLanguage === 'en' ? 
                    'Portal 06 will be ready soon. The journey into deeper emotions continues.' :
                    'Portal 06 estarÃ¡ pronto em breve. A jornada para emoÃ§Ãµes mais profundas continua.';
                alert(message);
            } else if (input === 'N') {
                const message = currentLanguage === 'ko' ? 
                    'ì—¬ì •ì´ ì¼ì‹œ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì–¸ì œë“  ë‹¤ì‹œ ëŒì•„ì™€ ê³„ì†í•˜ì„¸ìš”.' :
                    currentLanguage === 'en' ? 
                    'The journey has been paused. Come back and continue anytime.' :
                    'A jornada foi pausada. Volte e continue a qualquer momento.';
                alert(message);
            }
        }
        
        // ============ ì´ˆê¸°í™” ============
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V2 Portal 05 DOM ë¡œë“œ ì™„ë£Œ');
            
            // ìë™ ë¡œê·¸ì¸ ì²˜ë¦¬ (ë¡œê·¸ì¸ ëª¨ë‹¬ ì œê±°)
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            memoryStorage.mockUser = currentUser;
            
            updateStaticTranslations(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>