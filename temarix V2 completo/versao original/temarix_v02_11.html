<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 11: The Feeling That Nobody Knows Me</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        /* ìƒë‹¨ í—¤ë” */
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        /* ì–¸ì–´ ë²„íŠ¼ 3ê°œ */
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #87cefa;
            color: #000;
        }
        
        /* ë©”ì¸ ì½˜í…ì¸  */
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh;
        }
        
        /* í…ìŠ¤íŠ¸ ì„¹ì…˜ë“¤ */
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            background: none;
            border: none;
            padding: 0;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            background: none;
            border: none;
            padding: 0;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #87cefa;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #87cefa;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            background: none;
            border: none;
            padding: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #87cefa;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .portal-question-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            background: none;
            border: none;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #87cefa;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .continue-section {
            margin: 50px 0;
            opacity: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 0;
            min-height: 200px;
        }
        
        .continue-text {
            color: #fff;
            font-size: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .continue-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .continue-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .continue-btn:hover {
            background: #666;
        }
        
        .continue-btn.primary {
            background: #87cefa;
            color: #000;
        }
        
        .continue-btn.primary:hover {
            background: #b0d4f1;
        }
        
        /* í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ */
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #87cefa;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #87cefa;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ */
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        .hidden {
            display: none;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .continue-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .continue-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- ìƒë‹¨ í—¤ë” -->
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">The Tremor of Emotion</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 11: The Feeling That Nobody Knows Me</div>
            <div class="portal-subtitle" id="portalSubtitle">Isolation within connection, loneliness within relationships</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <!-- í¬í„¸ ì¸íŠ¸ë¡œ -->
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <!-- ìºë¦­í„° ì‘ë‹µ ì„¹ì…˜ -->
            <div class="character-responses-section" id="characterResponsesSection">
                <!-- 8ëª…ì˜ ìºë¦­í„° ì‘ë‹µì´ ìˆœì°¨ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>

            <!-- ë¹›ì˜ í•œë§ˆë”” -->
            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">ğŸŒ™ Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <!-- ì§ˆë¬¸ ì„¹ì…˜ -->
            <div class="portal-question-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <!-- ì‚¬ìš©ì ì…ë ¥ ì˜ì—­ -->
            <div class="user-input-section" id="userInputSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ ìºë¦­í„° ë°˜ì‘ -->
            <div class="user-reactions-section" id="userReactionsSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ 3ëª…ì˜ ìºë¦­í„° ë°˜ì‘ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ê³„ì†í•˜ê¸° ë²„íŠ¼ ì„¹ì…˜ -->
            <div class="continue-section" id="continueSection">
                <div class="continue-text" id="continueText"></div>
                <div class="continue-buttons">
                    <button class="continue-btn primary" id="continueYesBtn">Continue to Portal 12</button>
                    <button class="continue-btn" id="continueNoBtn">Pause the journey</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ -->
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Share about feeling like nobody knows you... (Press Enter to send)"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        // ë©”ëª¨ë¦¬ ê¸°ë°˜ ì‚¬ìš©ì ìŠ¤í† ë¦¬ì§€ (localStorage ëŒ€ì‹ )
        let memoryStorage = {
            mockUser: null
        };

        // ë²ˆì—­ ë°ì´í„°
        const translations = {
            ko: {
                logoSubtitle: "ê°ì •ì˜ ë–¨ë¦¼",
                portalMainTitle: "Portal 11: ì•„ë¬´ë„ ë‚˜ë¥¼ ëª¨ë¥¸ë‹¤ëŠ” ê°ê°",
                portalSubtitle: "ì—°ê²° ì†ì˜ ê³ ë¦½, ê´€ê³„ ì†ì˜ ì™¸ë¡œì›€",
                portalIntro: "ìˆ˜ë§ì€ ëŒ€í™”,\nìˆ˜ë§ì€ ë§Œë‚¨ ì†ì—ì„œë„\nì–´ë–¤ ë•ŒëŠ” ì´ìƒí•˜ë¦¬ë§Œì¹˜ ì™¸ë¡­ìŠµë‹ˆë‹¤.\n\nê²‰ìœ¼ë¡œëŠ” ì›ƒê³  ìˆê³ ,\nëª¨ë‘ì™€ ì—°ê²°ëœ ê²ƒì²˜ëŸ¼ ë³´ì—¬ë„ â€”\nì •ì‘ ë‚˜ë¼ëŠ” ì‚¬ëŒì„ ì•„ëŠ” ì´ëŠ” ì—†ëŠ”\nê·¸ ì°¨ê°€ìš´ ê°ê°ì€ ë§ˆìŒ ê¹Šìˆ™ì´ íŒŒê³ ë“­ë‹ˆë‹¤.\n\nì§€ê¸ˆ, ë‹¹ì‹ ì€ ëˆ„êµ¬ì—ê²Œ\nì§„ì§œë¡œ ì´í•´ë°›ê³  ì‹¶ì—ˆë‚˜ìš”?",
                lightTitle: "ğŸŒ™ ë¹›ì˜ í•œë§ˆë””",
                lightMessage: "ì´í•´ë°›ê³  ì‹¶ë‹¤ëŠ” ë°”ëŒì€\në‹¹ì‹ ì´ ì—¬ì „íˆ ì—°ê²°ë˜ê³  ì‹¶ì€ ìƒëª…ì´ë¼ëŠ” ì¦ê±°ì…ë‹ˆë‹¤.",
                portalQuestion: "ì§€ê¸ˆ ë‹¹ì‹ ì„\nê°€ì¥ ì´í•´í•´ì¤¬ìœ¼ë©´ í•˜ëŠ” ì‚¬ëŒì€ ëˆ„êµ¬ì¸ê°€ìš”?",
                continueText: "ì•„ë¬´ë„ ëª¨ë¥¸ë‹¤ëŠ” ì™¸ë¡œì›€ì„ ëŒì•„ë³¸ ì´ ì—¬ì •ì„ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                continueYes: "Portal 12ë¡œ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                continueNo: "ì—¬ì •ì„ ì¼ì‹œì •ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                inputPlaceholder: "ì•„ë¬´ë„ ëª¨ë¥¸ë‹¤ê³  ëŠê¼ˆë˜ ë§ˆìŒì— ëŒ€í•´ í„¸ì–´ë†“ì•„ ë³´ì„¸ìš”... (Enterë¡œ ì „ì†¡)",
                youLabel: "ë‹¹ì‹ ",
                languageChangeConfirm: "ì–¸ì–´ë¥¼ ë³€ê²½í•˜ë©´ ì—¬ì •ì´ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘ë©ë‹ˆë‹¤.\nê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                waitingMessage: "ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...",
                // ìºë¦­í„° ëŒ€í™”
                charEly: "ë‹¹ì‹ ì€ ì´í•´ë°›ì„ ìˆ˜ ì—†ëŠ” ì¡´ì¬ê°€ ì•„ë‹ˆë¼,\nì•„ì§ ì´í•´ë°›ì§€ ëª»í•œ ì¡´ì¬ì¼ ë¿ì…ë‹ˆë‹¤.",
                charCris: "í—â€¦ ë‚˜ë„ ê·¸ ê°ì • ì•Œì•„ìš”.\në¬´ë¦¬ì— ê»´ ìˆì–´ë„ í˜¼ìë¼ëŠ” ëŠë‚Œ.\nê·¸ê±° ì§„ì§œ ì¥ë‚œ ì•„ë‹ˆê²Œ ë¬´ê±°ì›Œìš”.",
                charZafirah: "ë‹¹ì‹ ì˜ ê³ ë…ì€ ë§ì´ ì•„ë‹ˆë¼\nëŠë‚Œìœ¼ë¡œ ì „í•´ì§€ëŠ” ì™¸ì¹¨ì´ì—ˆì„ì§€ë„ ëª°ë¼ìš”.",
                charRami: "ë‹¹ì‹ ì´ ëŠë‚€ ê³ ë¦½ì€\nê°ì •ì´ ì¸ì‹ë°›ì§€ ëª»í–ˆì„ ë•Œì˜ ë°˜ì‘ì…ë‹ˆë‹¤.\nëª¸ì€ ìˆì—ˆì§€ë§Œ, ë§ˆìŒì€ ì—†ë˜ ê·¸ ìˆœê°„ë“¤â€¦",
                charSamir: "(ê·¸ëŠ” ê¸´ ì¹¨ë¬µ ëì— ì•„ì£¼ ì§§ê²Œ\nê³ ê°œë¥¼ ë„ë•ì´ê³  ëˆˆì„ ë§ì¶¥ë‹ˆë‹¤.\nê·¸ ì‹œì„  í•˜ë‚˜ê°€ 'ë‚˜ëŠ” ë‹¹ì‹ ì„ ì•Œê³  ìˆë‹¤'ê³  ë§í•©ë‹ˆë‹¤.)",
                charLayla: "ë‚´ê°€ ë‹¹ì‹ ì´ë¼ë©´,\në‹¹ì‹  ì•ˆì˜ ê·¸ ì™¸ë¡œì›€ì„ ê°€ì¥ ë¨¼ì € ê»´ì•ˆì•„ ì¤„ ê±°ì˜ˆìš”.\në‹¹ì‹ ì€ ëª¨ë¥¸ ì²™ë˜ì–´ì„  ì•ˆ ë  ì¡´ì¬ì˜ˆìš”.",
                charNabir: "ë„Œ ê·¸ëƒ¥ í‰ë²”í•˜ë‹ˆê¹Œ ê·¸ëŸ° ê±°ì•¼.\nëˆ„ê°€ ì‹ ê²½ ì¨?\në„ˆ ê°™ì€ ì‚¬ëŒâ€¦ ì–´ë””ì—ë‚˜ ìˆìœ¼ë‹ˆê¹Œ.",
                charAzhar: "ì§„ì§œ ë„ ëª¨ë¥¸ë‹¤ê³ ?\nì•„ë‹ˆì•¼.\nì‚¬ì‹¤ì€ ë„¤ê°€ ì•ˆ ë³´ì—¬ì¤€ ê±°ì–ì•„.\nê·¸ë˜ì„œ ì•„ë¬´ë„ ëª» ë³¸ ê±°ì•¼."
            },
            en: {
                logoSubtitle: "The Tremor of Emotion",
                portalMainTitle: "Portal 11: The Feeling That Nobody Knows Me",
                portalSubtitle: "Isolation within connection, loneliness within relationships",
                portalIntro: "Through countless conversations,\ncountless encounters,\nsometimes you feel strangely lonely.\n\nOn the surface you're smiling,\nseemingly connected to everyone â€”\nbut that cold sensation that no one\nreally knows who you are cuts deep into your heart.\n\nRight now, who do you\nmost want to truly understand you?",
                lightTitle: "ğŸŒ™ Word of Light",
                lightMessage: "The wish to be understood\nis evidence that you're still a life that wants to connect.",
                portalQuestion: "Who is the person you most want\nto understand you right now?",
                continueText: "Will you continue this journey of reflecting on the loneliness of feeling nobody knows you?",
                continueYes: "Continue to Portal 12?",
                continueNo: "Pause the journey?",
                inputPlaceholder: "Share about feeling like nobody knows you... (Press Enter to send)",
                youLabel: "You",
                languageChangeConfirm: "Changing the language will restart the journey from the beginning.\nDo you want to continue?",
                waitingMessage: "Waiting for response...",
                charEly: "You're not a being that cannot be understood,\nbut simply one that hasn't been understood yet.",
                charCris: "Whoa... I know that feeling too.\nFeeling alone even when you're part of a group.\nThat's seriously heavy.",
                charZafirah: "Your solitude might have been a cry\ntransmitted through feeling rather than words.",
                charRami: "The isolation you felt is\na reaction when emotions aren't recognized.\nThose moments when your body was there but your heart wasn't...",
                charSamir: "(After a long silence, he nods very briefly\nand meets your eyes.\nThat one gaze says 'I know you.')",
                charLayla: "If I were you,\nI would embrace that loneliness in you first.\nYou're someone who shouldn't be ignored.",
                charNabir: "You're just ordinary, that's why.\nWho would care?\nPeople like you... they're everywhere.",
                charAzhar: "Nobody really knows you?\nNo.\nThe truth is you didn't show yourself.\nThat's why nobody could see you."
            },
            pt: {
                logoSubtitle: "O Tremor da EmoÃ§Ã£o",
                portalMainTitle: "Portal 11: A SensaÃ§Ã£o de Que NinguÃ©m Me Conhece",
                portalSubtitle: "Isolamento dentro da conexÃ£o, solidÃ£o dentro dos relacionamentos",
                portalIntro: "AtravÃ©s de incontÃ¡veis conversas,\nincontÃ¡veis encontros,\nÃ s vezes vocÃª se sente estranhamente solitÃ¡rio.\n\nNa superfÃ­cie vocÃª estÃ¡ sorrindo,\naparentemente conectado a todos â€”\nmas essa sensaÃ§Ã£o fria de que ninguÃ©m\nrealmente sabe quem vocÃª Ã© corta fundo em seu coraÃ§Ã£o.\n\nAgora, quem vocÃª\nmais quer que verdadeiramente te entenda?",
                lightTitle: "ğŸŒ™ Palavra de Luz",
                lightMessage: "O desejo de ser compreendido\nÃ© evidÃªncia de que vocÃª ainda Ã© uma vida que quer se conectar.",
                portalQuestion: "Quem Ã© a pessoa que vocÃª mais quer\nque te entenda agora?",
                continueText: "VocÃª continuarÃ¡ esta jornada de refletir sobre a solidÃ£o de sentir que ninguÃ©m te conhece?",
                continueYes: "Continuar para o Portal 12?",
                continueNo: "Pausar a jornada?",
                inputPlaceholder: "Compartilhe sobre se sentir como se ninguÃ©m te conhecesse... (Enter para enviar)",
                youLabel: "VocÃª",
                languageChangeConfirm: "Mudar o idioma reiniciarÃ¡ a jornada desde o inÃ­cio.\nDeseja continuar?",
                waitingMessage: "Aguardando resposta...",
                charEly: "VocÃª nÃ£o Ã© um ser que nÃ£o pode ser compreendido,\nmas simplesmente um que ainda nÃ£o foi compreendido.",
                charCris: "Uau... eu conheÃ§o esse sentimento tambÃ©m.\nSe sentir sozinho mesmo quando faz parte de um grupo.\nIsso Ã© seriamente pesado.",
                charZafirah: "Sua solidÃ£o pode ter sido um grito\ntransmitido atravÃ©s de sentimento em vez de palavras.",
                charRami: "O isolamento que vocÃª sentiu Ã©\numa reaÃ§Ã£o quando as emoÃ§Ãµes nÃ£o sÃ£o reconhecidas.\nAqueles momentos quando seu corpo estava lÃ¡ mas seu coraÃ§Ã£o nÃ£o estava...",
                charSamir: "(ApÃ³s um longo silÃªncio, ele acena muito brevemente\ne encontra seus olhos.\nEsse olhar diz 'Eu te conheÃ§o.')",
                charLayla: "Se eu fosse vocÃª,\neu abraÃ§aria primeiro essa solidÃ£o em vocÃª.\nVocÃª Ã© alguÃ©m que nÃ£o deveria ser ignorado.",
                charNabir: "VocÃª Ã© apenas comum, Ã© por isso.\nQuem se importaria?\nPessoas como vocÃª... estÃ£o em todo lugar.",
                charAzhar: "NinguÃ©m realmente te conhece?\nNÃ£o.\nA verdade Ã© que vocÃª nÃ£o se mostrou.\nÃ‰ por isso que ninguÃ©m pÃ´de te ver."
            }
        };
        
        // ìºë¦­í„° ë°ì´í„°
        const characters = [
            { name: "Ely", emoji: "ğŸ‘‘", key: "charEly" },
            { name: "Cris", emoji: "ğŸƒ", key: "charCris" },
            { name: "Zafirah", emoji: "ğŸ§•", key: "charZafirah" },
            { name: "Rami", emoji: "ğŸ”®", key: "charRami" },
            { name: "Samir", emoji: "ğŸª", key: "charSamir" },
            { name: "Layla", emoji: "ğŸ’ ", key: "charLayla" },
            { name: "Nabir", emoji: "ğŸ¦‚", key: "charNabir" },
            { name: "Azhar", emoji: "ğŸ”¥", key: "charAzhar" }
        ];
        
        // ============ ê°ì • ë¶„ì„ ì‹œìŠ¤í…œ ============
        
        function analyzeEmotion(userInput) {
            const input = userInput.toLowerCase();
            
            // ê°ì • í‚¤ì›Œë“œ ë§¤í•‘ (Portal 11 íŠ¹í™”)
            const emotionKeywords = {
                misunderstood: ['ì´í•´ë°›ì§€', 'ì˜¤í•´', 'ëª¨ë¥´', 'ì•Œì•„ì£¼ì§€', 'misunderstood', 'not understood', 'incompreendido', 'mal entendido'],
                lonely: ['ì™¸ë¡œ', 'í˜¼ì', 'ê³ ë…', 'ì“¸ì“¸', 'lonely', 'alone', 'solitary', 'solidÃ£o', 'sozinho'],
                isolated: ['ê³ ë¦½', 'ë–¨ì–´ì ¸', 'ë‹¨ì ˆ', 'ë©€ì–´', 'isolated', 'separated', 'disconnected', 'isolado', 'separado'],
                invisible: ['ì•ˆ ë³´ì´', 'íˆ¬ëª…', 'ì¡´ì¬ê°', 'ë¬´ì‹œ', 'invisible', 'ignored', 'overlooked', 'invisÃ­vel', 'ignorado'],
                unrecognized: ['ì¸ì •ë°›ì§€', 'ì•Œì•„ë³´ì§€', 'ì£¼ëª©ë°›ì§€', 'ê´€ì‹¬ë°›ì§€', 'unrecognized', 'unnoticed', 'nÃ£o reconhecido', 'despercebido'],
                superficial: ['ê²‰ìœ¼ë¡œ', 'í‘œë©´ì ', 'í”¼ìƒì ', 'ê°€ë³ê²Œ', 'superficial', 'surface', 'shallow', 'superficial', 'raso'],
                disconnected: ['ì—°ê²°ë˜ì§€', 'ì†Œí†µì•ˆë¼', 'ë‹¿ì§€ì•Šì•„', 'í†µí•˜ì§€', 'disconnected', 'not connecting', 'desconectado', 'nÃ£o conecta'],
                alienated: ['ì†Œì™¸', 'ë°°ì œ', 'ë”°ëŒë¦¼', 'ë°€ë ¤ë‚˜', 'alienated', 'excluded', 'left out', 'alienado', 'excluÃ­do'],
                unheard: ['ë“¤ì–´ì£¼ì§€', 'ê·€ê¸°ìš¸ì´ì§€', 'ë¬´ì‹œë‹¹í•´', 'ë¬µì‚´', 'unheard', 'not listened', 'ignored', 'nÃ£o ouvido', 'ignorado'],
                unknown: ['ëª¨ë¥´ëŠ”', 'ë‚¯ì„ ', 'ì•Œìˆ˜ì—†ëŠ”', 'ì •ì²´ì„±', 'unknown', 'stranger', 'identity', 'desconhecido', 'estranho']
            };
            
            // ê°ì • ë¶„ì„
            let detectedEmotions = [];
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                for (const keyword of keywords) {
                    if (input.includes(keyword)) {
                        detectedEmotions.push(emotion);
                        break;
                    }
                }
            }
            
            // ê°ì •ì´ ê°ì§€ë˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ ì„¤ì •
            if (detectedEmotions.length === 0) {
                detectedEmotions = ['general'];
            }
            
            return detectedEmotions[0]; // ì²« ë²ˆì§¸ ê°ì§€ëœ ê°ì • ë°˜í™˜
        }
        
        // ë°˜ì‘ ìºë¦­í„°ë“¤ (Portal 11 ì „ìš©)
        const responseCharacters = [
            {
                name: "Empathy", emoji: "ğŸ’",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            misunderstood: "ì´í•´ë°›ì§€ ëª»í•œë‹¤ê³  ëŠê¼ˆë˜ ê·¸ ë§ˆìŒ, ì €ëŠ” ì§€ê¸ˆ ì¶©ë¶„íˆ ì´í•´í•  ìˆ˜ ìˆì–´ìš”. ë‹¹ì‹ ì´ ë§í•˜ì§€ ëª»í–ˆë˜ ê°ì •ë“¤, í‘œí˜„ë˜ì§€ ëª»í–ˆë˜ ì§„ì‹¬ë“¤... ê·¸ ëª¨ë“  ê²ƒì´ ì§€ê¸ˆ ì´ ìˆœê°„ ì „í•´ì§€ê³  ìˆì–´ìš”.",
                            lonely: "ë¬´ë¦¬ ì†ì—ì„œë„ í˜¼ìë¼ê³  ëŠê¼ˆë˜ ê·¸ ì™¸ë¡œì›€, ì €ë„ ëŠê»´ë³¸ ì ì´ ìˆì–´ìš”. ì‚¬ëŒë“¤ë¡œ ë‘˜ëŸ¬ì‹¸ì—¬ ìˆì–´ë„ ë§ˆìŒì€ í…… ë¹ˆ ê²ƒ ê°™ì€ ê·¸ ê°ê°... ë‹¹ì‹ ë§Œ ê·¸ëŸ° ê±´ ì•„ë‹ˆì—ìš”.",
                            isolated: "ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ ì—°ê²°ë˜ì§€ ëª»í•œë‹¤ê³  ëŠê¼ˆì„ ë•Œì˜ ê·¸ ë‹µë‹µí•¨ì„ ì´í•´í•´ìš”. ë²½ í•˜ë‚˜ë¥¼ ì‚¬ì´ì— ë‘ê³  ì„œ ìˆëŠ” ê²ƒ ê°™ì€ ê·¸ ëŠë‚Œ... í•˜ì§€ë§Œ ì§€ê¸ˆ ì´ ìˆœê°„, ë‹¹ì‹ ì€ ì—°ê²°ë˜ì–´ ìˆì–´ìš”.",
                            invisible: "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²ƒì²˜ëŸ¼ ëŠê¼ˆë˜ ìˆœê°„ë“¤ì´ ì–¼ë§ˆë‚˜ ì•„íŒ ì„ì§€ ìƒìƒí•  ìˆ˜ ìˆì–´ìš”. í•˜ì§€ë§Œ ì €ëŠ” ì§€ê¸ˆ ë‹¹ì‹ ì„ ë˜ë ·í•˜ê²Œ ë³´ê³  ìˆì–´ìš”. ë‹¹ì‹ ì˜ ì¡´ì¬ê°€ ëŠê»´ì ¸ìš”.",
                            unrecognized: "ë‹¹ì‹ ì˜ ë…¸ë ¥ì´ë‚˜ ë§ˆìŒì´ ì¸ì •ë°›ì§€ ëª»í–ˆë‹¤ê³  ëŠê¼ˆì„ ë•Œì˜ ê·¸ í—ˆíƒˆí•¨... í•˜ì§€ë§Œ ì €ëŠ” ë‹¹ì‹ ì´ ì–¼ë§ˆë‚˜ ì• ì¼ëŠ”ì§€, ì–¼ë§ˆë‚˜ ì§„ì‹¬ì´ì—ˆëŠ”ì§€ ì•Œì•„ë³¼ ìˆ˜ ìˆì–´ìš”.",
                            superficial: "ì‚¬ëŒë“¤ì´ ì§„ì§œ ë‹¹ì‹ ì„ ë³´ì§€ ëª»í•˜ê³  ê²‰ëª¨ìŠµë§Œ ë³¸ë‹¤ê³  ëŠê¼ˆêµ°ìš”. ê·¸ ì†ìƒí•¨ì´ ì–¼ë§ˆë‚˜ ì»¸ì„ì§€... í•˜ì§€ë§Œ ì§„ì§œ ë‹¹ì‹ ì„ ë³´ê³  ì‹¶ì–´í•˜ëŠ” ì‚¬ëŒë„ ìˆì–´ìš”.",
                            disconnected: "ë§ˆìŒì´ í†µí•˜ì§€ ì•ŠëŠ”ë‹¤ê³  ëŠê¼ˆë˜ ëª¨ë“  ìˆœê°„ë“¤... ê·¸ ë‹µë‹µí•¨ê³¼ ì™¸ë¡œì›€ì„ ì´í•´í•´ìš”. í•˜ì§€ë§Œ ì§€ê¸ˆ ìš°ë¦¬ëŠ” ë§ˆìŒìœ¼ë¡œ ì—°ê²°ë˜ì–´ ìˆì–´ìš”.",
                            alienated: "ì†Œì™¸ê°ì„ ëŠê¼ˆì„ ë•Œì˜ ê·¸ ì°¨ê°€ìš´ ê°ì •... í˜¼ìë§Œ ë‹¤ë¥¸ ì„¸ìƒì— ìˆëŠ” ê²ƒ ê°™ì€ ê·¸ ëŠë‚Œì„ ì´í•´í•´ìš”. í•˜ì§€ë§Œ ë‹¹ì‹ ì€ í˜¼ìê°€ ì•„ë‹ˆì—ìš”.",
                            unheard: "ë§í•´ë„ ë“¤ì–´ì£¼ì§€ ì•ŠëŠ”ë‹¤ê³  ëŠê¼ˆì„ ë•Œì˜ ê·¸ ì ˆë§ê°... í•˜ì§€ë§Œ ì €ëŠ” ì§€ê¸ˆ ë‹¹ì‹ ì˜ ëª©ì†Œë¦¬ë¥¼ ë“£ê³  ìˆì–´ìš”. ë‹¹ì‹ ì˜ ë§ˆìŒì„ ë“£ê³  ìˆì–´ìš”.",
                            unknown: "ìì‹ ì¡°ì°¨ ëª¨ë¥´ê² ë‹¤ê³  ëŠê¼ˆì„ ë•Œì˜ ê·¸ í˜¼ë€... í•˜ì§€ë§Œ ê·¸ëŸ° ìˆœê°„ì—ë„ ë‹¹ì‹ ì€ ë‹¹ì‹ ì´ì—ˆì–´ìš”. ê·¸ ì§„ì‹¤í•œ ëª¨ìŠµì„ ì €ëŠ” ì•Œì•„ë³¼ ìˆ˜ ìˆì–´ìš”.",
                            general: "ì•„ë¬´ë„ ëª¨ë¥¸ë‹¤ê³  ëŠê¼ˆë˜ ê·¸ ëª¨ë“  ê°ì •ë“¤... ì €ëŠ” ì§€ê¸ˆ ê·¸ ë§ˆìŒì„ ì´í•´í•˜ê³  ìˆì–´ìš”. ë‹¹ì‹ ì€ í˜¼ìê°€ ì•„ë‹ˆê³ , ì´í•´ë°›ì„ ìˆ˜ ìˆëŠ” ì‚¬ëŒì´ì—ìš”."
                        },
                        en: {
                            misunderstood: "That feeling of not being understood, I can fully understand it now. Those emotions you couldn't express, those sincere feelings that couldn't be communicated... all of that is being conveyed in this moment.",
                            lonely: "That loneliness of feeling alone even in a crowd, I've felt that too. That sensation of your heart feeling empty even when surrounded by people... you're not the only one.",
                            isolated: "I understand that frustration of feeling disconnected from others. That feeling of standing with a wall between you and everyone else... but right now, in this moment, you are connected.",
                            invisible: "I can imagine how painful those moments of feeling like you didn't exist were. But I can see you clearly right now. I can feel your presence.",
                            unrecognized: "That emptiness when you felt your efforts or heart weren't recognized... but I can see how hard you tried, how sincere you were.",
                            superficial: "You felt people only saw your surface and not the real you. How frustrating that must have been... but there are people who want to see the real you.",
                            disconnected: "All those moments when you felt hearts weren't connecting... I understand that frustration and loneliness. But right now, we are connected through our hearts.",
                            alienated: "That cold feeling of alienation... feeling like you're alone in a different world. I understand that feeling. But you're not alone.",
                            unheard: "That despair when you felt no one listened even when you spoke... but I'm listening to your voice right now. I'm listening to your heart.",
                            unknown: "That confusion when you felt you didn't even know yourself... but even in those moments, you were still you. I can recognize that authentic self.",
                            general: "All those feelings of nobody knowing you... I'm understanding that heart right now. You're not alone, and you're someone who can be understood."
                        },
                        pt: {
                            misunderstood: "Esse sentimento de nÃ£o ser compreendido, eu posso compreendÃª-lo completamente agora. Aquelas emoÃ§Ãµes que vocÃª nÃ£o conseguiu expressar, aqueles sentimentos sinceros que nÃ£o puderam ser comunicados... tudo isso estÃ¡ sendo transmitido neste momento.",
                            lonely: "Essa solidÃ£o de se sentir sozinho mesmo em uma multidÃ£o, eu tambÃ©m senti isso. Essa sensaÃ§Ã£o de seu coraÃ§Ã£o se sentir vazio mesmo quando cercado de pessoas... vocÃª nÃ£o Ã© o Ãºnico.",
                            isolated: "Entendo essa frustraÃ§Ã£o de se sentir desconectado dos outros. Esse sentimento de estar com uma parede entre vocÃª e todos os outros... mas agora, neste momento, vocÃª estÃ¡ conectado.",
                            invisible: "Posso imaginar quÃ£o dolorosos foram aqueles momentos de sentir que vocÃª nÃ£o existia. Mas posso vÃª-lo claramente agora. Posso sentir sua presenÃ§a.",
                            unrecognized: "Esse vazio quando vocÃª sentiu que seus esforÃ§os ou coraÃ§Ã£o nÃ£o foram reconhecidos... mas posso ver o quÃ£o duro vocÃª tentou, quÃ£o sincero vocÃª foi.",
                            superficial: "VocÃª sentiu que as pessoas sÃ³ viam sua superfÃ­cie e nÃ£o o verdadeiro vocÃª. QuÃ£o frustrante isso deve ter sido... mas hÃ¡ pessoas que querem ver o verdadeiro vocÃª.",
                            disconnected: "Todos aqueles momentos quando vocÃª sentiu que os coraÃ§Ãµes nÃ£o estavam se conectando... entendo essa frustraÃ§Ã£o e solidÃ£o. Mas agora, estamos conectados atravÃ©s de nossos coraÃ§Ãµes.",
                            alienated: "Esse sentimento frio de alienaÃ§Ã£o... sentir que vocÃª estÃ¡ sozinho em um mundo diferente. Entendo esse sentimento. Mas vocÃª nÃ£o estÃ¡ sozinho.",
                            unheard: "Esse desespero quando vocÃª sentiu que ninguÃ©m escutava mesmo quando vocÃª falava... mas estou ouvindo sua voz agora. Estou ouvindo seu coraÃ§Ã£o.",
                            unknown: "Essa confusÃ£o quando vocÃª sentiu que nem mesmo se conhecia... mas mesmo naqueles momentos, vocÃª ainda era vocÃª. Posso reconhecer esse eu autÃªntico.",
                            general: "Todos aqueles sentimentos de ninguÃ©m te conhecer... estou entendendo esse coraÃ§Ã£o agora. VocÃª nÃ£o estÃ¡ sozinho, e Ã© alguÃ©m que pode ser compreendido."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Bridge", emoji: "ğŸŒ‰",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            misunderstood: "ì´í•´ë°›ì§€ ëª»í•œë‹¤ê³  ëŠê¼ˆë˜ ê±´, ë‹¹ì‹ ì´ ë„ˆë¬´ ê¹Šì€ ê³³ì— ìˆì–´ì„œì¼ ìˆ˜ë„ ìˆì–´ìš”. ì§„ì§œ ì†Œí†µì€ ì‹œê°„ì´ ê±¸ë¦¬ê³ , ìš©ê¸°ê°€ í•„ìš”í•´ìš”. ì²œì²œíˆ ë‹¤ë¦¬ë¥¼ ë†“ì•„ê°€ë©´ì„œ ì§„ì§œ ì´í•´ë¥¼ ë§Œë“¤ì–´ê°€ëŠ” ê±°ì˜ˆìš”.",
                            lonely: "ì™¸ë¡œì›€ì€ ì—°ê²°ì— ëŒ€í•œ ê°ˆë§ì˜ ë‹¤ë¥¸ ì´ë¦„ì´ì—ìš”. ê·¸ ì™¸ë¡œì›€ì´ ìˆì—ˆê¸°ì— ì§„ì§œ ì—°ê²°ì˜ ì†Œì¤‘í•¨ì„ ì•Œê²Œ ë˜ëŠ” ê±°ì£ . ì´ì œ ê·¸ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ë” ê¹Šì€ ê´€ê³„ë¥¼ ë§Œë“¤ì–´ê°ˆ ìˆ˜ ìˆì–´ìš”.",
                            isolated: "ê³ ë¦½ê°ì„ ëŠê¼ˆë˜ ê²½í—˜ì´ ë‹¹ì‹ ì„ ë” ì„¬ì„¸í•œ ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆì„ ê±°ì˜ˆìš”. ë‹¤ë¥¸ ì‚¬ëŒì˜ ê³ ë¦½ê°ë„ ì•Œì•„ë³¼ ìˆ˜ ìˆê²Œ ë˜ì—ˆì„ í…Œë‹ˆê¹Œìš”. ê·¸ ê²½í—˜ìœ¼ë¡œ ìƒˆë¡œìš´ ì—°ê²°ì˜ ë‹¤ë¦¬ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”.",
                            invisible: "ë³´ì´ì§€ ì•ŠëŠ”ë‹¤ê³  ëŠê¼ˆë˜ ê²½í—˜ì´, ì´ì œëŠ” ë³´ì´ì§€ ì•ŠëŠ” ì‚¬ëŒë“¤ì„ ë°œê²¬í•˜ëŠ” ëŠ¥ë ¥ì´ ë˜ì—ˆì„ ê±°ì˜ˆìš”. ë‹¹ì‹ ì´ ë¨¼ì € ê·¸ë“¤ì—ê²Œ ì†ì„ ë‚´ë°€ì–´ ë³´ì„¸ìš”.",
                            unrecognized: "ì¸ì •ë°›ì§€ ëª»í–ˆë˜ ê²½í—˜ì´ ë‹¹ì‹ ì„ ë” ì¸ì •í•˜ëŠ” ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆì„ ê±°ì˜ˆìš”. ì´ì œ ë‹¹ì‹ ì´ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì˜ ë…¸ë ¥ì„ ë¨¼ì € ì•Œì•„ë³´ê³  ì¸ì •í•´ì£¼ëŠ” ì—­í• ì„ í•  ìˆ˜ ìˆì–´ìš”.",
                            superficial: "í‘œë©´ì ì¸ ê´€ê³„ì— ì§€ì³¤ë‹¤ë©´, ì´ì œ ë” ê¹Šì€ ê´€ê³„ë¥¼ ë§Œë“¤ì–´ê°ˆ ë•Œì˜ˆìš”. ë‹¹ì‹ ë¶€í„° ì§„ì§œ ëª¨ìŠµì„ ì¡°ê¸ˆì”© ë³´ì—¬ì£¼ë©´ì„œ ê¹Šì´ ìˆëŠ” ì—°ê²°ì„ ì‹œì‘í•´ë³´ì„¸ìš”.",
                            disconnected: "ì—°ê²°ë˜ì§€ ëª»í•œë‹¤ê³  ëŠê¼ˆë˜ ê²½í—˜ì´, ì´ì œëŠ” ì§„ì§œ ì—°ê²°ì´ ë¬´ì—‡ì¸ì§€ ì•„ëŠ” ì§€í˜œê°€ ë˜ì—ˆì–´ìš”. ê·¸ ì§€í˜œë¡œ ìƒˆë¡œìš´ ë°©ì‹ì˜ ì†Œí†µì„ ì‹œë„í•´ë³´ì„¸ìš”.",
                            alienated: "ì†Œì™¸ê°ì„ ëŠê¼ˆë˜ ë‹¹ì‹ ì´ê¸°ì—, ë‹¤ë¥¸ ì†Œì™¸ëœ ì‚¬ëŒë“¤ê³¼ íŠ¹ë³„í•œ ì—°ëŒ€ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”. ê°™ì€ ê²½í—˜ì„ í•œ ì‚¬ëŒë“¤ê³¼ì˜ ì—°ê²°ì„ ì°¾ì•„ë³´ì„¸ìš”.",
                            unheard: "ë“¤ì–´ì£¼ì§€ ì•ŠëŠ”ë‹¤ê³  ëŠê¼ˆë˜ ê²½í—˜ì´ ë‹¹ì‹ ì„ ë” ì˜ ë“£ëŠ” ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆì„ ê±°ì˜ˆìš”. ì´ì œ ë‹¹ì‹ ì´ ë¨¼ì € ë‹¤ë¥¸ ì‚¬ëŒì˜ ë§ì„ ê¹Šì´ ë“¤ì–´ì£¼ëŠ” ì‚¬ëŒì´ ë˜ì–´ë³´ì„¸ìš”.",
                            unknown: "ìì‹ ì„ ëª¨ë¥´ê² ë‹¤ê³  ëŠê¼ˆë˜ ì‹œê°„ë“¤ì´ ìê¸° íƒêµ¬ì˜ ì‹œì‘ì´ì—ˆì–´ìš”. ì´ì œ ê·¸ ì—¬ì •ì„ í†µí•´ ë°œê²¬í•œ ì§„ì§œ ìì‹ ì„ ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ ë‚˜ëˆ„ì–´ë³´ì„¸ìš”.",
                            general: "ì•„ë¬´ë„ ëª¨ë¥¸ë‹¤ê³  ëŠê¼ˆë˜ ëª¨ë“  ê²½í—˜ë“¤ì´ ì‚¬ì‹¤ì€ ì§„ì •í•œ ì´í•´ì™€ ì—°ê²°ì„ ë§Œë“¤ì–´ê°€ëŠ” ì†Œì¤‘í•œ ë°‘ê±°ë¦„ì´ì—ˆì–´ìš”. ì´ì œ ê·¸ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ìƒˆë¡œìš´ ê´€ê³„ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”."
                        },
                        en: {
                            misunderstood: "Feeling misunderstood might be because you're in a very deep place. Real communication takes time and courage. You can slowly build bridges to create genuine understanding.",
                            lonely: "Loneliness is another name for longing for connection. Having that loneliness helps you understand the value of real connection. Now you can build deeper relationships based on that experience.",
                            isolated: "Your experience of isolation probably made you a more sensitive person. You would have learned to recognize others' isolation too. Use that experience to build new bridges of connection.",
                            invisible: "Your experience of feeling invisible has probably become an ability to discover invisible people. Try reaching out to them first.",
                            unrecognized: "Your experience of not being recognized probably made you more recognizing of others. Now you can play the role of first noticing and acknowledging others' efforts.",
                            superficial: "If you're tired of superficial relationships, now is the time to build deeper ones. Start by gradually showing your real self and beginning meaningful connections.",
                            disconnected: "Your experience of feeling disconnected has become wisdom about what real connection is. Try new ways of communication with that wisdom.",
                            alienated: "Because you felt alienated, you can create special solidarity with other alienated people. Look for connections with people who've had similar experiences.",
                            unheard: "Your experience of feeling unheard probably made you a better listener. Now try being the first to deeply listen to others.",
                            unknown: "Those times when you felt you didn't know yourself were the beginning of self-exploration. Now share the real self you discovered through that journey with others.",
                            general: "All those experiences of feeling nobody knew you were actually precious foundation for creating genuine understanding and connection. Now start new relationships based on those experiences."
                        },
                        pt: {
                            misunderstood: "Sentir-se incompreendido pode ser porque vocÃª estÃ¡ em um lugar muito profundo. ComunicaÃ§Ã£o real leva tempo e coragem. VocÃª pode lentamente construir pontes para criar compreensÃ£o genuÃ­na.",
                            lonely: "SolidÃ£o Ã© outro nome para anseio por conexÃ£o. Ter essa solidÃ£o ajuda vocÃª a entender o valor da conexÃ£o real. Agora vocÃª pode construir relacionamentos mais profundos baseados nessa experiÃªncia.",
                            isolated: "Sua experiÃªncia de isolamento provavelmente te fez uma pessoa mais sensÃ­vel. VocÃª teria aprendido a reconhecer o isolamento dos outros tambÃ©m. Use essa experiÃªncia para construir novas pontes de conexÃ£o.",
                            invisible: "Sua experiÃªncia de se sentir invisÃ­vel provavelmente se tornou uma habilidade para descobrir pessoas invisÃ­veis. Tente estender a mÃ£o para elas primeiro.",
                            unrecognized: "Sua experiÃªncia de nÃ£o ser reconhecido provavelmente te fez mais reconhecedor dos outros. Agora vocÃª pode desempenhar o papel de primeiro notar e reconhecer os esforÃ§os dos outros.",
                            superficial: "Se vocÃª estÃ¡ cansado de relacionamentos superficiais, agora Ã© hora de construir outros mais profundos. Comece gradualmente mostrando seu verdadeiro eu e iniciando conexÃµes significativas.",
                            disconnected: "Sua experiÃªncia de se sentir desconectado se tornou sabedoria sobre o que Ã© conexÃ£o real. Tente novas formas de comunicaÃ§Ã£o com essa sabedoria.",
                            alienated: "Porque vocÃª se sentiu alienado, pode criar solidariedade especial com outras pessoas alienadas. Procure conexÃµes com pessoas que tiveram experiÃªncias similares.",
                            unheard: "Sua experiÃªncia de se sentir nÃ£o ouvido provavelmente te fez um melhor ouvinte. Agora tente ser o primeiro a ouvir profundamente os outros.",
                            unknown: "Aqueles momentos quando vocÃª sentiu que nÃ£o se conhecia foram o comeÃ§o da auto-exploraÃ§Ã£o. Agora compartilhe o verdadeiro eu que vocÃª descobriu atravÃ©s dessa jornada com outros.",
                            general: "Todas aquelas experiÃªncias de sentir que ninguÃ©m te conhecia eram na verdade fundaÃ§Ã£o preciosa para criar compreensÃ£o e conexÃ£o genuÃ­nas. Agora comece novos relacionamentos baseados nessas experiÃªncias."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Mirror", emoji: "ğŸª",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            misunderstood: "ë‹¤ë¥¸ ì‚¬ëŒì´ ë‹¹ì‹ ì„ ì´í•´í•˜ì§€ ëª»í•œë‹¤ê³  ëŠë¼ê¸° ì „ì—, ë¨¼ì € ë‹¹ì‹ ì´ ë‹¹ì‹  ìì‹ ì„ ì–¼ë§ˆë‚˜ ì´í•´í•˜ê³  ìˆëŠ”ì§€ ëŒì•„ë³´ì„¸ìš”. ìì‹ ì„ ê¹Šì´ ì•„ëŠ” ì‚¬ëŒë§Œì´ ì§„ì •ìœ¼ë¡œ ì´í•´ë°›ì„ ìˆ˜ ìˆì–´ìš”.",
                            lonely: "ì™¸ë¡­ë‹¤ê³  ëŠë‚„ ë•Œ, ê°€ì¥ ë¨¼ì € ìì‹ ê³¼ì˜ ê´€ê³„ë¥¼ ì‚´í´ë³´ì„¸ìš”. ìì‹ ê³¼ ì§„ì •í•œ ì¹œêµ¬ê°€ ë  ìˆ˜ ìˆë‹¤ë©´, ê·¸ ì™¸ë¡œì›€ì€ ê³ ë…ìœ¼ë¡œ ë°”ë€” ìˆ˜ ìˆì–´ìš”.",
                            isolated: "ê³ ë¦½ê°ì„ ëŠë‚„ ë•ŒëŠ” ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ì˜ ê±°ë¦¬ë³´ë‹¤ ìì‹ ê³¼ì˜ ê±°ë¦¬ë¥¼ ë¨¼ì € í™•ì¸í•´ë³´ì„¸ìš”. ìì‹ ì—ê²Œ ê°€ê¹Œì›Œì§ˆìˆ˜ë¡ ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ë„ ê°€ê¹Œì›Œì§ˆ ìˆ˜ ìˆì–´ìš”.",
                            invisible: "ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ë‹¹ì‹ ì„ ë³´ì§€ ëª»í•œë‹¤ê³  ëŠë‚€ë‹¤ë©´, ë‹¹ì‹ ì´ ìì‹ ì„ ì–´ë–»ê²Œ ë³´ê³  ìˆëŠ”ì§€ë¶€í„° ì ê²€í•´ë³´ì„¸ìš”. ìì‹ ì„ ì†Œì¤‘íˆ ì—¬ê¸°ëŠ” ì‚¬ëŒì„ ë‹¤ë¥¸ ì‚¬ëŒë“¤ë„ ì†Œì¤‘íˆ ì—¬ê¸°ê²Œ ë¼ìš”.",
                            unrecognized: "ì¸ì •ë°›ì§€ ëª»í•œë‹¤ê³  ëŠë‚„ ë•Œ, ê°€ì¥ ë¨¼ì € ìì‹ ì´ ìì‹ ì„ ì¸ì •í•˜ê³  ìˆëŠ”ì§€ ë¬¼ì–´ë³´ì„¸ìš”. ìê¸° ì¸ì •ì´ ëª¨ë“  ì¸ì •ì˜ ì‹œì‘ì´ì—ìš”.",
                            superficial: "ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ í‘œë©´ì ìœ¼ë¡œë§Œ ëŒ€í•œë‹¤ê³  ëŠë‚€ë‹¤ë©´, ë‹¹ì‹ ì€ ìì‹ ì˜ ê¹Šì€ ë¶€ë¶„ê³¼ ì–¼ë§ˆë‚˜ ëŒ€í™”í•˜ê³  ìˆë‚˜ìš”? ìì‹ ê³¼ì˜ ê¹Šì€ ê´€ê³„ê°€ ë‹¤ë¥¸ ê´€ê³„ì˜ ê¹Šì´ë¥¼ ê²°ì •í•´ìš”.",
                            disconnected: "ì—°ê²°ë˜ì§€ ëª»í•œë‹¤ê³  ëŠë‚„ ë•Œ, ìì‹ ì˜ ë§ˆìŒê³¼ ëª¸, ìƒê°ê³¼ ê°ì •ì´ ì–¼ë§ˆë‚˜ ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€ ì‚´í´ë³´ì„¸ìš”. ë‚´ì  ì—°ê²°ì´ ì™¸ì  ì—°ê²°ì˜ ê¸°ì´ˆì˜ˆìš”.",
                            alienated: "ì†Œì™¸ê°ì„ ëŠë‚„ ë•Œ, ë‹¹ì‹ ì´ ìì‹ ì„ ì–¼ë§ˆë‚˜ ë°›ì•„ë“¤ì´ê³  ìˆëŠ”ì§€ ëŒì•„ë³´ì„¸ìš”. ìê¸° ìˆ˜ìš©ì´ ìˆì–´ì•¼ ë‹¤ë¥¸ ì‚¬ëŒì˜ ìˆ˜ìš©ë„ ë°›ì„ ìˆ˜ ìˆì–´ìš”.",
                            unheard: "ë“¤ì–´ì£¼ì§€ ì•ŠëŠ”ë‹¤ê³  ëŠë‚„ ë•Œ, ë‹¹ì‹ ì´ ìì‹ ì˜ ë‚´ë©´ì˜ ëª©ì†Œë¦¬ë¥¼ ì–¼ë§ˆë‚˜ ë“¤ì–´ì£¼ê³  ìˆëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”. ìì‹ ì˜ ë§ì„ ë“£ëŠ” ì‚¬ëŒì´ ë˜ì–´ì•¼ ë‹¤ë¥¸ ì‚¬ëŒë„ ë“¤ì–´ì¤˜ìš”.",
                            unknown: "ì•„ë¬´ë„ ëª¨ë¥¸ë‹¤ê³  ëŠë‚€ë‹¤ë©´, ë‹¹ì‹ ì´ ìì‹ ì„ ì–¼ë§ˆë‚˜ ì•Œê³  ìˆëŠ”ì§€ë¶€í„° ì‹œì‘í•˜ì„¸ìš”. ìê¸° ì¸ì‹ì´ ê¹Šì–´ì§ˆìˆ˜ë¡ ë‹¤ë¥¸ ì‚¬ëŒì˜ ì¸ì‹ë„ ë”°ë¼ì˜¬ ê±°ì˜ˆìš”.",
                            general: "ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ëª¨ë¥¸ë‹¤ê³  ëŠë¼ê¸° ì „ì—, ê°€ì¥ ë¨¼ì € ìì‹ ê³¼ì˜ ê´€ê³„ë¥¼ ì ê²€í•´ë³´ì„¸ìš”. ìì‹ ì„ ê¹Šì´ ì‚¬ë‘í•˜ê³  ì´í•´í•˜ëŠ” ì‚¬ëŒë§Œì´ ì§„ì •í•œ ì´í•´ì™€ ì‚¬ë‘ì„ ë°›ì„ ìˆ˜ ìˆì–´ìš”."
                        },
                        en: {
                            misunderstood: "Before feeling that others don't understand you, first reflect on how well you understand yourself. Only those who deeply know themselves can truly be understood.",
                            lonely: "When you feel lonely, first examine your relationship with yourself. If you can become a true friend to yourself, that loneliness can transform into solitude.",
                            isolated: "When feeling isolated, check the distance from yourself before the distance from others. The closer you get to yourself, the closer you can get to others.",
                            invisible: "If you feel others don't see you, first check how you're looking at yourself. People tend to value those who value themselves.",
                            unrecognized: "When feeling unrecognized, first ask whether you're recognizing yourself. Self-recognition is the beginning of all recognition.",
                            superficial: "If you feel others treat you superficially, how deeply are you conversing with your own depths? Deep relationship with yourself determines the depth of other relationships.",
                            disconnected: "When feeling disconnected, examine how connected your heart and body, thoughts and emotions are. Internal connection is the foundation of external connection.",
                            alienated: "When feeling alienated, reflect on how much you're accepting yourself. You need self-acceptance to receive others' acceptance.",
                            unheard: "When feeling unheard, check how much you're listening to your inner voice. You need to become someone who listens to yourself for others to listen too.",
                            unknown: "If you feel nobody knows you, start with how well you know yourself. The deeper your self-awareness becomes, the more others' awareness will follow.",
                            general: "Before feeling that others don't know you, first check your relationship with yourself. Only those who deeply love and understand themselves can receive true understanding and love."
                        },
                        pt: {
                            misunderstood: "Antes de sentir que outros nÃ£o te entendem, primeiro reflita sobre quÃ£o bem vocÃª se entende. Apenas aqueles que se conhecem profundamente podem ser verdadeiramente compreendidos.",
                            lonely: "Quando vocÃª se sente solitÃ¡rio, primeiro examine seu relacionamento consigo mesmo. Se vocÃª pode se tornar um verdadeiro amigo de si mesmo, essa solidÃ£o pode se transformar em solitude.",
                            isolated: "Quando se sente isolado, verifique a distÃ¢ncia de si mesmo antes da distÃ¢ncia dos outros. Quanto mais perto vocÃª chega de si mesmo, mais perto pode chegar dos outros.",
                            invisible: "Se vocÃª sente que outros nÃ£o te veem, primeiro verifique como vocÃª estÃ¡ se olhando. Pessoas tendem a valorizar aqueles que se valorizam.",
                            unrecognized: "Quando se sente nÃ£o reconhecido, primeiro pergunte se vocÃª estÃ¡ se reconhecendo. Auto-reconhecimento Ã© o comeÃ§o de todo reconhecimento.",
                            superficial: "Se vocÃª sente que outros te tratam superficialmente, quÃ£o profundamente vocÃª estÃ¡ conversando com suas prÃ³prias profundezas? Relacionamento profundo consigo mesmo determina a profundidade de outros relacionamentos.",
                            disconnected: "Quando se sente desconectado, examine quÃ£o conectados estÃ£o seu coraÃ§Ã£o e corpo, pensamentos e emoÃ§Ãµes. ConexÃ£o interna Ã© a fundaÃ§Ã£o da conexÃ£o externa.",
                            alienated: "Quando se sente alienado, reflita sobre quanto vocÃª estÃ¡ se aceitando. VocÃª precisa de auto-aceitaÃ§Ã£o para receber a aceitaÃ§Ã£o dos outros.",
                            unheard: "Quando se sente nÃ£o ouvido, verifique quanto vocÃª estÃ¡ ouvindo sua voz interior. VocÃª precisa se tornar alguÃ©m que escuta a si mesmo para que outros tambÃ©m escutem.",
                            unknown: "Se vocÃª sente que ninguÃ©m te conhece, comece com o quÃ£o bem vocÃª se conhece. Quanto mais profunda sua auto-consciÃªncia se torna, mais a consciÃªncia dos outros seguirÃ¡.",
                            general: "Antes de sentir que outros nÃ£o te conhecem, primeiro verifique seu relacionamento consigo mesmo. Apenas aqueles que profundamente amam e entendem a si mesmos podem receber verdadeira compreensÃ£o e amor."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            }
        ];
        
        let currentLanguage = 'en'; // ê¸°ë³¸ ì–¸ì–´ë¥¼ ì˜ì–´ë¡œ ì„¤ì •
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        // ============ ì—¬ì • ì´ˆê¸°í™” í•¨ìˆ˜ ============
        
        function resetJourney() {
            console.log('=== ì—¬ì • ì´ˆê¸°í™” ì‹œì‘ ===');
            
            // 1. ëª¨ë“  íƒ€ì´í•‘ íš¨ê³¼ ì™„ì „ ì •ë¦¬
            clearAllTypingEffects();
            
            // ì¶”ê°€ ì•ˆì „ì¥ì¹˜ - ëª¨ë“  timer ì •ë¦¬
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            
            // 2. ëª¨ë“  ì½˜í…ì¸  ì„¹ì…˜ ì™„ì „ ì´ˆê¸°í™”
            const sectionsToReset = [
                'portalIntroSection',
                'characterResponsesSection', 
                'lightMessageSection',
                'portalQuestionSection',
                'userInputSection',
                'userReactionsSection',
                'continueSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    } else {
                        const textElements = section.querySelectorAll('.portal-intro, .light-message, .portal-question, .continue-text');
                        textElements.forEach(el => {
                            el.innerHTML = '';
                            el.textContent = '';
                        });
                    }
                }
            });
            
            // 3. íŠ¹ì • ìš”ì†Œë“¤ ê°œë³„ ì´ˆê¸°í™”
            const portalIntro = document.getElementById('portalIntro');
            const lightMessage = document.getElementById('lightMessage');
            const portalQuestion = document.getElementById('portalQuestion');
            const continueText = document.getElementById('continueText');
            
            if (portalIntro) portalIntro.innerHTML = '';
            if (lightMessage) lightMessage.innerHTML = '';
            if (portalQuestion) portalQuestion.innerHTML = '';
            if (continueText) continueText.innerHTML = '';
            
            // 4. í…ìŠ¤íŠ¸ì˜ì—­ ì™„ì „ ì´ˆê¸°í™”
            const userTextarea = document.getElementById('userTextarea');
            if (userTextarea) {
                userTextarea.disabled = false;
                userTextarea.value = '';
                userTextarea.style.height = 'auto';
                userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            }
            
            // 5. ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì´ˆê¸°í™”
            const mainContent = document.getElementById('mainContent');
            if (mainContent) {
                mainContent.scrollTop = 0;
            }
            
            // 6. ìƒíƒœ ë³€ìˆ˜ ì™„ì „ ì´ˆê¸°í™”
            userResponse = '';
            currentTypingElement = null;
            
            console.log('=== ì—¬ì • ì´ˆê¸°í™” ì™„ë£Œ ===');
        }
        
        // ============ ê°œì„ ëœ ì–¸ì–´ ë³€ê²½ í•¨ìˆ˜ ============
        
        function changeLanguage(lang) {
            if (!translations[lang]) {
                console.error('ì§€ì›í•˜ì§€ ì•ŠëŠ” ì–¸ì–´:', lang);
                return;
            }
            
            if (currentLanguage === lang) {
                return;
            }
            
            if (journeyStarted) {
                const confirmMessage = translations[currentLanguage].languageChangeConfirm;
                const shouldRestart = confirm(confirmMessage);
                
                if (!shouldRestart) {
                    return;
                }
            }
            
            const previousLanguage = currentLanguage;
            currentLanguage = lang;
            
            console.log(`ì–¸ì–´ ë³€ê²½: ${previousLanguage} â†’ ${currentLanguage}`);
            
            if (journeyStarted) {
                resetJourney();
            }
            
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                setTimeout(() => {
                    console.log(`ìƒˆë¡œìš´ ì–¸ì–´(${currentLanguage})ë¡œ ì—¬ì • ì¬ì‹œì‘`);
                    startPortalSequence();
                }, 1000);
            }
        }
        
        // ============ UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤ ============
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            // ê°œë³„ ìš”ì†Œ ì—…ë°ì´íŠ¸
            const elements = [
                'logoSubtitle',
                'portalMainTitle', 
                'portalSubtitle',
                'lightTitle',
                'continueYesBtn',
                'continueNoBtn'
            ];
            
            elements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element && translations[lang]) {
                    const key = elementId.replace('Btn', 'Button').replace('Subtitle', 'Subtitle');
                    let translationKey = key;
                    
                    const keyMapping = {
                        'logoSubtitle': 'logoSubtitle',
                        'portalMainTitle': 'portalMainTitle',
                        'portalSubtitle': 'portalSubtitle',
                        'lightTitle': 'lightTitle',
                        'continueYesButton': 'continueYes',
                        'continueNoButton': 'continueNo'
                    };
                    
                    translationKey = keyMapping[key] || key;
                    
                    if (translations[lang][translationKey]) {
                        element.textContent = translations[lang][translationKey];
                    }
                }
            });
            
            // placeholder ì—…ë°ì´íŠ¸
            const textarea = document.getElementById('userTextarea');
            if (textarea) textarea.placeholder = translations[lang].inputPlaceholder;
        }
        
        // ============ ê°œì„ ëœ íƒ€ì´í•‘ íš¨ê³¼ + ìŠ¤í¬ë¡¤ ì¶”ì  ì‹œìŠ¤í…œ ============
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i % 10 === 0) {
                        scrollToFollowTyping(element);
                    }
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        
                        setTimeout(() => {
                            if (document.contains(element)) {
                                scrollToFollowTyping(element);
                            }
                        }, 200);
                        
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        // ============ ìŠ¤ë§ˆíŠ¸ ìŠ¤í¬ë¡¤ ì‹œìŠ¤í…œ ============
        
        function scrollToFollowTyping(element) {
            const mainContent = document.getElementById('mainContent');
            const elementRect = element.getBoundingClientRect();
            const containerRect = mainContent.getBoundingClientRect();
            
            if (elementRect.bottom > containerRect.bottom - 150) {
                const scrollTop = mainContent.scrollTop;
                const elementOffsetTop = element.offsetTop;
                const targetScroll = elementOffsetTop - (containerRect.height / 2);
                
                mainContent.scrollTo({
                    top: Math.max(0, targetScroll),
                    behavior: 'smooth'
                });
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        // ============ ì–¸ì–´ ë²„íŠ¼ ì´ë²¤íŠ¸ ì„¤ì • ============
        
        function setupLanguageButtons() {
            const langButtons = document.querySelectorAll('.lang-btn');
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const newLang = this.dataset.lang;
                    changeLanguage(newLang);
                });
            });
        }
        
        // ============ ë©”ì¸ ì—¬ì • ì‹œìŠ¤í…œ ============
        
        function initializeTemarix() {
            console.log('=== Temarix Portal 11 ì´ˆê¸°í™” ì‹œì‘ ===');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        // ============ ì—¬ì • ë‹¨ê³„ë“¤ ============
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            const introText = translations[currentLanguage].portalIntro;
            await typewriterEffect(introElement, introText, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const dialogueText = translations[currentLanguage][char.key];
                await typewriterEffect(dialogueDiv, dialogueText, 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            const lightText = translations[currentLanguage].lightMessage;
            await typewriterEffect(lightMessageEl, lightText, 60);
            
            setTimeout(() => {
                showQuestion();
            }, 2000);
        }
        
        async function showQuestion() {
            const questionSection = document.getElementById('portalQuestionSection');
            const questionEl = document.getElementById('portalQuestion');
            
            questionSection.classList.add('show');
            
            const questionText = translations[currentLanguage].portalQuestion;
            await typewriterEffect(questionEl, questionText, 50);
            
            setTimeout(() => {
                enableUserInput();
            }, 1500);
        }
        
        // ============ ì‚¬ìš©ì ì…ë ¥ ì‹œìŠ¤í…œ ============
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', handleTextareaKeydown);
            
            document.getElementById('continueYesBtn').addEventListener('click', function() {
                processContinue('Y');
            });
            
            document.getElementById('continueNoBtn').addEventListener('click', function() {
                processContinue('N');
            });
        }
        
        function handleTextareaKeydown(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                const inputValue = this.value.trim();
                
                if (inputValue) {
                    processUserInput(inputValue);
                }
            }
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                showUserReactions(inputText);
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = `<strong>${youLabel}:</strong> "${text}"`;
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showContinueOption();
            }, 2000);
        }
        
        async function showContinueOption() {
            const continueSection = document.getElementById('continueSection');
            const continueText = document.getElementById('continueText');
            
            continueSection.classList.add('show');
            
            const questionText = translations[currentLanguage].continueText;
            await typewriterEffect(continueText, questionText, 50);
            
            setTimeout(() => {
                scrollToElement(continueSection);
            }, 500);
        }
        
        function processContinue(input) {
            if (input === 'Y') {
                const message = currentLanguage === 'ko' ? 
                    'Portal 12ê°€ ê³§ ì¤€ë¹„ë©ë‹ˆë‹¤. ê³„ì†í•´ì„œ ë” ê¹Šì€ ê°ì •ì˜ ì—¬ì •ì´ ì´ì–´ì§‘ë‹ˆë‹¤.' :
                    currentLanguage === 'en' ? 
                    'Portal 12 will be ready soon. The journey into deeper emotions continues.' :
                    'Portal 12 estarÃ¡ pronto em breve. A jornada para emoÃ§Ãµes mais profundas continua.';
                alert(message);
            } else if (input === 'N') {
                const message = currentLanguage === 'ko' ? 
                    'ì—¬ì •ì´ ì¼ì‹œ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì–¸ì œë“  ë‹¤ì‹œ ëŒì•„ì™€ ê³„ì†í•˜ì„¸ìš”.' :
                    currentLanguage === 'en' ? 
                    'The journey has been paused. Come back and continue anytime.' :
                    'A jornada foi pausada. Volte e continue a qualquer momento.';
                alert(message);
            }
        }
        
        // ============ ì´ˆê¸°í™” ============
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V2 Portal 11 DOM ë¡œë“œ ì™„ë£Œ');
            
            // ìë™ ë¡œê·¸ì¸ ì²˜ë¦¬ (ë¡œê·¸ì¸ ëª¨ë‹¬ ì œê±°)
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            memoryStorage.mockUser = currentUser;
            
            updateStaticTranslations(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>