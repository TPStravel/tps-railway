<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 15: To Me Who Fears Change</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        /* ìƒë‹¨ í—¤ë” */
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        /* ì–¸ì–´ ë²„íŠ¼ 3ê°œ */
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #87cefa;
            color: #000;
        }
        
        /* ë©”ì¸ ì½˜í…ì¸  */
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh;
        }
        
        /* í…ìŠ¤íŠ¸ ì„¹ì…˜ë“¤ */
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            background: none;
            border: none;
            padding: 0;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            background: none;
            border: none;
            padding: 0;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #87cefa;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #87cefa;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            background: none;
            border: none;
            padding: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #87cefa;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .portal-question-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            background: none;
            border: none;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #87cefa;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .continue-section {
            margin: 50px 0;
            opacity: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 0;
            min-height: 200px;
        }
        
        .continue-text {
            color: #fff;
            font-size: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .continue-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .continue-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .continue-btn:hover {
            background: #666;
        }
        
        .continue-btn.primary {
            background: #87cefa;
            color: #000;
        }
        
        .continue-btn.primary:hover {
            background: #b0d4f1;
        }
        
        /* í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ */
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #87cefa;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #87cefa;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ */
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        .hidden {
            display: none;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .continue-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .continue-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- ìƒë‹¨ í—¤ë” -->
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">The Tremor of Emotion</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 15: To Me Who Fears Change</div>
            <div class="portal-subtitle" id="portalSubtitle">The first step outside of safety</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <!-- í¬í„¸ ì¸íŠ¸ë¡œ -->
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <!-- ìºë¦­í„° ì‘ë‹µ ì„¹ì…˜ -->
            <div class="character-responses-section" id="characterResponsesSection">
                <!-- 8ëª…ì˜ ìºë¦­í„° ì‘ë‹µì´ ìˆœì°¨ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>

            <!-- ë¹›ì˜ í•œë§ˆë”” -->
            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">ğŸŒ™ Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <!-- ì§ˆë¬¸ ì„¹ì…˜ -->
            <div class="portal-question-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <!-- ì‚¬ìš©ì ì…ë ¥ ì˜ì—­ -->
            <div class="user-input-section" id="userInputSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ ìºë¦­í„° ë°˜ì‘ -->
            <div class="user-reactions-section" id="userReactionsSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ 3ëª…ì˜ ìºë¦­í„° ë°˜ì‘ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ê³„ì†í•˜ê¸° ë²„íŠ¼ ì„¹ì…˜ -->
            <div class="continue-section" id="continueSection">
                <div class="continue-text" id="continueText"></div>
                <div class="continue-buttons">
                    <button class="continue-btn primary" id="continueYesBtn">Continue to Portal 16</button>
                    <button class="continue-btn" id="continueNoBtn">Pause the journey</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ -->
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Share about your fears and courage regarding change... (Press Enter to send)"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        // ë©”ëª¨ë¦¬ ê¸°ë°˜ ì‚¬ìš©ì ìŠ¤í† ë¦¬ì§€ (localStorage ëŒ€ì‹ )
        let memoryStorage = {
            mockUser: null
        };

        // ë²ˆì—­ ë°ì´í„°
        const translations = {
            ko: {
                logoSubtitle: "ê°ì •ì˜ ë–¨ë¦¼",
                portalMainTitle: "Portal 15: ë³€í™”ê°€ ë‘ë ¤ìš´ ë‚˜ì—ê²Œ",
                portalSubtitle: "ì•ˆì „í•¨ì„ ë²—ì–´ë‚˜ëŠ” ì²« ê±¸ìŒ",
                portalIntro: "ì§€ê¸ˆê¹Œì§€ì˜ ì‚¶ì´ í¸í•˜ì§€ëŠ” ì•Šì•˜ì§€ë§Œ\nê·¸ë˜ë„ ìµìˆ™í–ˆìŠµë‹ˆë‹¤.\nì˜ˆì¸¡ ê°€ëŠ¥í•˜ê³ , í†µì œí•  ìˆ˜ ìˆê³ ,\nì ì–´ë„ 'ì–´ë–»ê²Œ ì‚´ì•„ì•¼ í•˜ëŠ”ì§€'ëŠ” ì•Œê³  ìˆì—ˆì£ .\n\ní•˜ì§€ë§Œ ì§„ì§œ ìš•ë§ì„ ë§ˆì£¼í•˜ê³  ë‚˜ë‹ˆ\në³€í™”ê°€ í•„ìš”í•˜ë‹¤ëŠ” ê±¸ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.\nê·¸ë¦¬ê³  ë™ì‹œì—...\në³€í™”ê°€ ë„ˆë¬´ ë‘ë µë‹¤ëŠ” ê²ƒë„.\n\nìƒˆë¡œìš´ ê¸¸ì€ ì–´ë–¨ì§€ ëª¨ë¥´ê³ ,\nì‹¤íŒ¨í•  ìˆ˜ë„ ìˆê³ ,\nì§€ê¸ˆë³´ë‹¤ ë” í˜ë“¤ ìˆ˜ë„ ìˆìœ¼ë‹ˆê¹Œìš”.",
                lightTitle: "ğŸŒ™ ë¹›ì˜ í•œë§ˆë””",
                lightMessage: "ë‘ë ¤ì›€ ì†ì—ì„œ í•œ ê±¸ìŒ ë‚´ë”›ëŠ” ê²ƒì´\nìš©ê¸°ì˜ ì§„ì •í•œ ëª¨ìŠµì…ë‹ˆë‹¤.\në‘ë µì§€ ì•Šë‹¤ë©´, ê·¸ê±´ ìš©ê¸°ê°€ ì•„ë‹ˆë¼ ë¬´ëª¨í•¨ì¼ ë¿ì…ë‹ˆë‹¤.",
                portalQuestion: "ë‹¹ì‹ ì´ ê°€ì¥ ë‘ë ¤ì›Œí•˜ëŠ” ë³€í™”ëŠ” ë¬´ì—‡ì¸ê°€ìš”?\nê·¸ ë‘ë ¤ì›€ ë„ˆë¨¸ì—ëŠ” ë¬´ì—‡ì´ ê¸°ë‹¤ë¦¬ê³  ìˆì„ê¹Œìš”?",
                continueText: "ë³€í™”ì— ëŒ€í•œ ë‘ë ¤ì›€ì„ ë§ˆì£¼í•œ ì´ ì—¬ì •ì„ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                continueYes: "Portal 16ìœ¼ë¡œ ê³„ì†í•˜ê¸°",
                continueNo: "ì—¬ì •ì„ ì¼ì‹œì •ì§€í•˜ê¸°",
                inputPlaceholder: "ë³€í™”ì— ëŒ€í•œ ë‘ë ¤ì›€ê³¼ ìš©ê¸°ì— ëŒ€í•´ í„¸ì–´ë†“ì•„ ë³´ì„¸ìš”... (Enterë¡œ ì „ì†¡)",
                youLabel: "ë‹¹ì‹ ",
                languageChangeConfirm: "ì–¸ì–´ë¥¼ ë³€ê²½í•˜ë©´ ì—¬ì •ì´ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘ë©ë‹ˆë‹¤.\nê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                waitingMessage: "ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...",
                // ìºë¦­í„° ëŒ€í™”
                charEly: "ë³€í™”ë¥¼ ë‘ë ¤ì›Œí•˜ëŠ” ê²ƒì€\nì•„ì§ ë‹¹ì‹  ì•ˆì— ì§€í‚¬ ê°€ì¹˜ê°€ ìˆëŠ” ê²ƒë“¤ì´ ë‚¨ì•„ìˆë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.",
                charCris: "ë‚˜ë„ ë³€í™” ë¬´ì„œì›Œìš”!\nê·¼ë° ê°€ë§Œíˆ ìˆëŠ” ê²ƒë„ ì€ê·¼ ë¬´ì„œì›Œìš”.\nê·¸ë˜ì„œ... ê·¸ëƒ¥ ë¬´ì„œìš´ ê±¸ë¡œ ê°€ì! ğŸ¤·â€â™€ï¸",
                charZafirah: "ë³€í™”ê°€ ë‘ë µë‹¤ëŠ” ê±´\nì§€ê¸ˆì˜ ë‹¹ì‹ ì´ ì†Œì¤‘í•˜ë‹¤ëŠ” ë§ˆìŒì—ì„œ ë‚˜ì˜¤ëŠ” ê²ƒì´ì—ìš”.",
                charRami: "ë‘ë ¤ì›€ì€ ë³€í™”ì˜ ì „ì¡°ì…ë‹ˆë‹¤.\në‚˜ë¹„ê°€ ë˜ê¸° ì „, ì• ë²Œë ˆë„ ë²ˆë°ê¸° ì•ˆì—ì„œ ë–¨ì—ˆì„ ê±°ì˜ˆìš”.",
                charSamir: "(ê·¸ëŠ” ë¬¸ ì•ì— ì„œì„œ ì†ì¡ì´ë¥¼ ë§Œì§€ì‘ê±°ë¦½ë‹ˆë‹¤.\nì—´ì§€ë„, ëŒì•„ì„œì§€ë„ ì•Šì€ ì±„\nê·¸ ìˆœê°„ì˜ ë–¨ë¦¼ì„ í•¨ê»˜ ëŠë¼ê³  ìˆìŠµë‹ˆë‹¤.)",
                charLayla: "ë³€í™”ë¥¼ ë‘ë ¤ì›Œí•˜ëŠ” ë‹¹ì‹ ë„,\në³€í™”ë¥¼ ì„ íƒí•˜ëŠ” ë‹¹ì‹ ë„\në˜‘ê°™ì´ ìš©ê°í•œ ì‚¬ëŒì´ì—ìš”.",
                charNabir: "ë³€í•˜ê³  ì‹¶ë‹¤ë©´ì„œ ì™œ ì•ˆ ë³€í•´?\nê²°êµ­ ë¬´ì„œì›Œì„œ ëª» í•˜ëŠ” ê±°ì–ì•„.\nê·¸ëƒ¥ ì§€ê¸ˆëŒ€ë¡œ ì‚´ì•„.",
                charAzhar: "ë³€í™”? ê·¸ê±° ë‹¤ ì°©ê°ì´ì•¼.\në„Œ ë³€í•  ìˆ˜ë„ ì—†ê³ , ë³€í•´ë„ ê²°êµ­ ì‹¤íŒ¨í•´.\ní¸í•˜ê²Œ í¬ê¸°í•´."
            },
            en: {
                logoSubtitle: "The Tremor of Emotion",
                portalMainTitle: "Portal 15: To Me Who Fears Change",
                portalSubtitle: "The first step outside of safety",
                portalIntro: "Life so far wasn't comfortable,\nbut it was familiar.\nPredictable, controllable,\nand at least I knew 'how to live'.\n\nBut after facing my real desires,\nI realized change is necessary.\nAnd at the same time...\nI also realized how terrifying change is.\n\nThe new path is unknown,\nI might fail,\nit might be harder than now.",
                lightTitle: "ğŸŒ™ Word of Light",
                lightMessage: "Taking one step forward in fear\nis the true face of courage.\nIf you're not afraid, that's not courage but recklessness.",
                portalQuestion: "What change do you fear most?\nWhat might be waiting beyond that fear?",
                continueText: "Will you continue this journey of facing fear of change?",
                continueYes: "Continue to Portal 16",
                continueNo: "Pause the journey",
                inputPlaceholder: "Share about your fears and courage regarding change... (Press Enter to send)",
                youLabel: "You",
                languageChangeConfirm: "Changing the language will restart the journey from the beginning.\nDo you want to continue?",
                waitingMessage: "Waiting for response...",
                charEly: "Fearing change means\nthere are still valuable things left in you worth protecting.",
                charCris: "I'm scared of change too!\nBut staying still is also kinda scary.\nSo... let's just go with scary! ğŸ¤·â€â™€ï¸",
                charZafirah: "Being afraid of change comes from\na heart that treasures who you are now.",
                charRami: "Fear is a harbinger of change.\nEven caterpillars must have trembled inside their cocoons before becoming butterflies.",
                charSamir: "(He stands at the door, fidgeting with the handle.\nNeither opening nor turning away,\nhe feels the trembling of that moment together with you.)",
                charLayla: "You who fear change\nand you who choose change\nare equally brave people.",
                charNabir: "You want to change but why don't you?\nIn the end, you can't because you're scared.\nJust live as you are now.",
                charAzhar: "Change? That's all an illusion.\nYou can't change, and even if you do, you'll fail eventually.\nJust give up comfortably."
            },
            pt: {
                logoSubtitle: "O Tremor da EmoÃ§Ã£o",
                portalMainTitle: "Portal 15: Para Mim Que Temo a MudanÃ§a",
                portalSubtitle: "O primeiro passo fora da seguranÃ§a",
                portalIntro: "A vida atÃ© agora nÃ£o era confortÃ¡vel,\nmas era familiar.\nPrevisÃ­vel, controlÃ¡vel,\ne pelo menos eu sabia 'como viver'.\n\nMas depois de enfrentar meus verdadeiros desejos,\npercebi que a mudanÃ§a Ã© necessÃ¡ria.\nE ao mesmo tempo...\ntambÃ©m percebi como a mudanÃ§a Ã© aterrorizante.\n\nO novo caminho Ã© desconhecido,\neu posso falhar,\npode ser mais difÃ­cil que agora.",
                lightTitle: "ğŸŒ™ Palavra de Luz",
                lightMessage: "Dar um passo Ã  frente no medo\nÃ© a verdadeira face da coragem.\nSe vocÃª nÃ£o tem medo, isso nÃ£o Ã© coragem mas imprudÃªncia.",
                portalQuestion: "Qual mudanÃ§a vocÃª mais teme?\nO que pode estar esperando alÃ©m desse medo?",
                continueText: "VocÃª continuarÃ¡ esta jornada de enfrentar o medo da mudanÃ§a?",
                continueYes: "Continuar para o Portal 16",
                continueNo: "Pausar a jornada",
                inputPlaceholder: "Compartilhe sobre seus medos e coragem em relaÃ§Ã£o Ã  mudanÃ§a... (Enter para enviar)",
                youLabel: "VocÃª",
                languageChangeConfirm: "Mudar o idioma reiniciarÃ¡ a jornada desde o inÃ­cio.\nDeseja continuar?",
                waitingMessage: "Aguardando resposta...",
                charEly: "Temer a mudanÃ§a significa\nque ainda hÃ¡ coisas valiosas em vocÃª que vale a pena proteger.",
                charCris: "Eu tambÃ©m tenho medo de mudanÃ§a!\nMas ficar parado tambÃ©m Ã© meio assustador.\nEntÃ£o... vamos com o assustador! ğŸ¤·â€â™€ï¸",
                charZafirah: "Ter medo de mudanÃ§a vem de\num coraÃ§Ã£o que valoriza quem vocÃª Ã© agora.",
                charRami: "O medo Ã© um prenÃºncio de mudanÃ§a.\nAtÃ© as lagartas devem ter tremido dentro de seus casulos antes de se tornarem borboletas.",
                charSamir: "(Ele fica na porta, mexendo na maÃ§aneta.\nSem abrir nem se afastar,\nele sente o tremor daquele momento junto com vocÃª.)",
                charLayla: "VocÃª que teme a mudanÃ§a\ne vocÃª que escolhe a mudanÃ§a\nsÃ£o igualmente pessoas corajosas.",
                charNabir: "VocÃª quer mudar mas por que nÃ£o muda?\nNo final, vocÃª nÃ£o consegue porque tem medo.\nApenas viva como estÃ¡ agora.",
                charAzhar: "MudanÃ§a? Isso Ã© tudo ilusÃ£o.\nVocÃª nÃ£o pode mudar, e mesmo se mudar, eventualmente falharÃ¡.\nApenas desista confortavelmente."
            }
        };
        
        // ìºë¦­í„° ë°ì´í„°
        const characters = [
            { name: "Ely", emoji: "ğŸ‘‘", key: "charEly" },
            { name: "Cris", emoji: "ğŸƒ", key: "charCris" },
            { name: "Zafirah", emoji: "ğŸ§•", key: "charZafirah" },
            { name: "Rami", emoji: "ğŸ”®", key: "charRami" },
            { name: "Samir", emoji: "ğŸª", key: "charSamir" },
            { name: "Layla", emoji: "ğŸ’ ", key: "charLayla" },
            { name: "Nabir", emoji: "ğŸ¦‚", key: "charNabir" },
            { name: "Azhar", emoji: "ğŸ”¥", key: "charAzhar" }
        ];
        
        // ============ ê°ì • ë¶„ì„ ì‹œìŠ¤í…œ ============
        
        function analyzeEmotion(userInput) {
            const input = userInput.toLowerCase();
            
            // ê°ì • í‚¤ì›Œë“œ ë§¤í•‘ (Portal 15 íŠ¹í™”)
            const emotionKeywords = {
                fear: ['ë‘ë ¤ìš´', 'ë¬´ì„œìš´', 'ë¶ˆì•ˆí•œ', 'ê±±ì •', 'fear', 'scared', 'afraid', 'anxious', 'medo', 'assustado', 'ansioso'],
                comfort_zone: ['í¸ì•ˆí•œ', 'ìµìˆ™í•œ', 'ì•ˆì „í•œ', 'í˜„ì¬', 'comfort', 'familiar', 'safe', 'current', 'conforto', 'familiar', 'seguro'],
                failure: ['ì‹¤íŒ¨', 'ë§í• ', 'ì•ˆë ', 'í¬ê¸°', 'failure', 'fail', 'give up', 'falha', 'falhar', 'desistir'],
                unknown: ['ëª¨ë¥´ëŠ”', 'ì•Œìˆ˜ì—†ëŠ”', 'ì˜ˆì¸¡ë¶ˆê°€', 'unknown', 'uncertain', 'unpredictable', 'desconhecido', 'incerto'],
                courage: ['ìš©ê¸°', 'ìš©ê°í•œ', 'ë„ì „', 'courage', 'brave', 'challenge', 'coragem', 'corajoso', 'desafio'],
                growth: ['ì„±ì¥', 'ë°œì „', 'ë‚˜ì•„ì§€ëŠ”', 'growth', 'development', 'improve', 'crescimento', 'desenvolvimento'],
                relationships: ['ê´€ê³„', 'ì‚¬ëŒë“¤', 'ê°€ì¡±', 'ì¹œêµ¬', 'relationships', 'people', 'family', 'friends', 'relacionamentos', 'pessoas'],
                career: ['ì§ì—…', 'ì¼', 'ì»¤ë¦¬ì–´', 'career', 'job', 'work', 'carreira', 'trabalho'],
                identity: ['ì •ì²´ì„±', 'ë‚˜ë‹¤ì›€', 'ìì•„', 'identity', 'self', 'who I am', 'identidade', 'eu mesmo'],
                past: ['ê³¼ê±°', 'ì˜ˆì „', 'ì „ì—', 'past', 'before', 'used to', 'passado', 'antes'],
                stuck: ['ê°‡íŒ', 'ë§‰íŒ', 'ì •ì²´ëœ', 'stuck', 'trapped', 'stagnant', 'preso', 'estagnado'],
                regret: ['í›„íšŒ', 'ì•„ì‰¬ìš´', 'ë†“ì¹œ', 'regret', 'remorse', 'missed', 'arrependimento', 'perdido']
            };
            
            // ê°ì • ë¶„ì„
            let detectedEmotions = [];
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                for (const keyword of keywords) {
                    if (input.includes(keyword)) {
                        detectedEmotions.push(emotion);
                        break;
                    }
                }
            }
            
            // ê°ì •ì´ ê°ì§€ë˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ ì„¤ì •
            if (detectedEmotions.length === 0) {
                detectedEmotions = ['general'];
            }
            
            return detectedEmotions[0]; // ì²« ë²ˆì§¸ ê°ì§€ëœ ê°ì • ë°˜í™˜
        }
        
        // ë°˜ì‘ ìºë¦­í„°ë“¤ (Portal 15 ì „ìš©)
        const responseCharacters = [
            {
                name: "Bridge", emoji: "ğŸŒ‰",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            fear: "ë‹¤ë¦¬ëŠ” ë‘ ê³³ì„ ì—°ê²°í•˜ì§€ë§Œ, ê±¸ì–´ê°€ëŠ” ë™ì•ˆì—ëŠ” ì–´ëŠ ìª½ì—ë„ ì†í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê·¸ ì¤‘ê°„ ì§€ì ì—ì„œì˜ ë‘ë ¤ì›€ì„ ì´í•´í•´ìš”. í•˜ì§€ë§Œ ê·¸ ë–¨ë¦¼ì´ ë°”ë¡œ ë³€í™”ì˜ ìˆœê°„ì…ë‹ˆë‹¤.",
                            comfort_zone: "í¸ì•ˆí•œ ê³³ì—ì„œ ìƒˆë¡œìš´ ê³³ìœ¼ë¡œ ê°€ëŠ” í†µë¡œê°€ ë‹¤ë¦¬ì…ë‹ˆë‹¤. ìµìˆ™í•¨ì„ ë’¤ë¡œí•˜ê³  ê±´ë„ˆì˜¤ëŠ” ëª¨ë“  ë°œê±¸ìŒì„ ì €ëŠ” ê²¬ëŒë‚´ê³  ì§€ì§€í•´ì™”ì–´ìš”. ë‹¹ì‹ ë„ ê·¸ëŸ´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                            failure: "ë‹¤ë¦¬ ìœ„ì—ì„œ ë„˜ì–´ì ¸ë„ ë‹¤ë¦¬ê°€ ë¬´ë„ˆì§€ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. ì‹¤íŒ¨ëŠ” ëª©ì ì§€ê°€ ì•„ë‹ˆë¼ ì§€ë‚˜ê°€ëŠ” ìˆœê°„ì¼ ë¿ì´ì—ìš”. ë‹¤ì‹œ ì¼ì–´ë‚˜ì„œ ê³„ì† ê±¸ì–´ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                            unknown: "ë‹¤ë¦¬ ê±´ë„ˆí¸ì´ ì–´ë–¨ì§€ ëª¨ë¥´ëŠ” ê²ƒì€ ë‹¹ì—°í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ë‹¤ë¦¬ëŠ” ê·¸ 'ëª¨ë¦„'ì„ ê±´ë“œë¦¬ì§€ ì•Šê³  ë‹¨ì§€ ì•ˆì „í•œ ê¸¸ì„ ì œê³µí•  ë¿ì´ì—ìš”. ëª¨ë¥´ëŠ” ê²ƒë„ ê´œì°®ìŠµë‹ˆë‹¤.",
                            courage: "ìš©ê¸°ëŠ” ë¬´ì„œì›Œí•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ë¬´ì„œì›Œí•˜ë©´ì„œë„ ê³„ì† ê±·ëŠ” ê²ƒì…ë‹ˆë‹¤. ë‹¤ë¦¬ ìœ„ì˜ ëª¨ë“  ë°œê±¸ìŒì´ ìš©ê¸°ì…ë‹ˆë‹¤.",
                            growth: "ë‹¤ë¦¬ë¥¼ ê±´ë„ˆëŠ” ì‚¬ëŒì€ ê°™ì€ ì‚¬ëŒì´ì§€ë§Œ, ê±´ë„ˆê³  ë‚˜ë©´ ë‹¤ë¥¸ ì‚¬ëŒì´ ë©ë‹ˆë‹¤. ì„±ì¥ì€ ì´ì²˜ëŸ¼ í•œ ê±¸ìŒ í•œ ê±¸ìŒìœ¼ë¡œ ì´ë£¨ì–´ì ¸ìš”.",
                            relationships: "ë•Œë¡œëŠ” ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ì—ì„œ ë‹¤ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì„œë¡œ ë‹¤ë¥¸ ê³³ì— ìˆëŠ” ë§ˆìŒë“¤ì„ ì—°ê²°í•˜ëŠ” ë‹¤ë¦¬. ë³€í™”ê°€ ê´€ê³„ë¥¼ ëŠëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ìƒˆë¡œìš´ ì—°ê²°ì„ ë§Œë“¤ ìˆ˜ë„ ìˆì–´ìš”.",
                            career: "ìƒˆë¡œìš´ ì¼, ìƒˆë¡œìš´ ê¸¸ë¡œ ê°€ëŠ” ê²ƒë„ ë‹¤ë¦¬ë¥¼ ê±´ë„ˆëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤. ì´ì „ì˜ ê²½í—˜ì´ ì—†ì–´ì§€ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ê·¸ê²ƒì´ ë‹¤ë¦¬ê°€ ë˜ì–´ ìƒˆë¡œìš´ ê³³ìœ¼ë¡œ ë°ë ¤ë‹¤ì¤ë‹ˆë‹¤.",
                            identity: "ì •ì²´ì„±ì˜ ë³€í™”ëŠ” ìì‹ ì„ ìƒëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ë” ë„“ì€ ìì‹ ì„ ë°œê²¬í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë‹¤ë¦¬ ì–‘ìª½ì— ëª¨ë‘ ë‹¹ì‹ ì´ ìˆì–´ìš”.",
                            past: "ê³¼ê±°ëŠ” ë‹¤ë¦¬ì˜ ì‹œì‘ì ì…ë‹ˆë‹¤. ê·¸ê³³ì—ì„œ ì¶œë°œí–ˆê¸°ì— ì§€ê¸ˆ ì—¬ê¸° ë‹¤ë¦¬ ìœ„ì— ì„¤ ìˆ˜ ìˆëŠ” ê±°ì˜ˆìš”. ê³¼ê±°ë¥¼ ë²„ë¦¬ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë”›ê³  ì¼ì–´ì„œëŠ” ê²ƒì…ë‹ˆë‹¤.",
                            stuck: "ê°‡íŒ ëŠë‚Œì´ ë“¤ ë•Œ, ë‹¤ë¦¬ëŠ” ì¶œêµ¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤. í•œ ê³³ì— ë¨¸ë¬¼ëŸ¬ ìˆì„ í•„ìš”ëŠ” ì—†ì–´ìš”. ì–¸ì œë“  ê±´ë„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                            regret: "í›„íšŒë„ ë‹¤ë¦¬ë¥¼ ê±´ë„ˆëŠ” ì´ìœ ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë†“ì¹œ ê²ƒë“¤ì„ ì°¾ì•„ê°€ëŠ” ìƒˆë¡œìš´ ê¸¸, ê·¸ê²ƒë„ ì˜ë¯¸ ìˆëŠ” ì—¬ì •ì´ì—ìš”.",
                            general: "ë³€í™”ëŠ” ë‹¤ë¦¬ë¥¼ ê±´ë„ˆëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤. ì¤‘ìš”í•œ ê²ƒì€ ëª©ì ì§€ê°€ ì•„ë‹ˆë¼ ê·¸ ë‹¤ë¦¬ê°€ ë‹¹ì‹ ì„ ì•ˆì „íˆ ë– ë°›ì¹˜ê³  ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. í•œ ê±¸ìŒì”©, ì²œì²œíˆ ê°€ì„¸ìš”."
                        },
                        en: {
                            fear: "A bridge connects two places, but while walking across, you don't belong to either side. I understand the fear in that middle point. But that trembling is exactly the moment of change.",
                            comfort_zone: "A bridge is a passage from comfort to newness. I've endured and supported every step that leaves familiarity behind. You can do it too.",
                            failure: "Even if you fall on the bridge, the bridge doesn't collapse. Failure is just a passing moment, not a destination. You can get up and keep walking.",
                            unknown: "It's natural not to know what's across the bridge. But the bridge doesn't disturb that 'unknown' - it simply provides a safe path. It's okay not to know.",
                            courage: "Courage isn't being unafraid, but continuing to walk while being afraid. Every step on the bridge is courage.",
                            growth: "The person crossing the bridge is the same person, but becomes different after crossing. Growth happens one step at a time like this.",
                            relationships: "Sometimes relationships need bridges. Bridges that connect hearts in different places. Change might not break relationships but create new connections.",
                            career: "Going to new work, new paths is like crossing a bridge. Previous experiences don't disappear - they become the bridge taking you to new places.",
                            identity: "Identity change isn't losing yourself but discovering a broader self. You exist on both sides of the bridge.",
                            past: "The past is the starting point of the bridge. Because you started there, you can now stand on this bridge. It's not about abandoning the past but standing upon it.",
                            stuck: "When feeling trapped, bridges provide exits. You don't need to stay in one place. You can always cross over.",
                            regret: "Regret can also be a reason to cross bridges. A new path to find what was missed - that's also a meaningful journey.",
                            general: "Change is like crossing a bridge. What matters isn't the destination but that the bridge safely supports you. Go slowly, step by step."
                        },
                        pt: {
                            fear: "Uma ponte conecta dois lugares, mas enquanto caminha atravÃ©s dela, vocÃª nÃ£o pertence a nenhum dos lados. Entendo o medo nesse ponto mÃ©dio. Mas esse tremor Ã© exatamente o momento da mudanÃ§a.",
                            comfort_zone: "Uma ponte Ã© uma passagem do conforto para o novo. Tenho suportado e apoiado cada passo que deixa a familiaridade para trÃ¡s. VocÃª tambÃ©m pode fazer isso.",
                            failure: "Mesmo se vocÃª cair na ponte, a ponte nÃ£o desaba. O fracasso Ã© apenas um momento passageiro, nÃ£o um destino. VocÃª pode se levantar e continuar caminhando.",
                            unknown: "Ã‰ natural nÃ£o saber o que estÃ¡ do outro lado da ponte. Mas a ponte nÃ£o perturba esse 'desconhecido' - simplesmente fornece um caminho seguro. NÃ£o hÃ¡ problema em nÃ£o saber.",
                            courage: "Coragem nÃ£o Ã© nÃ£o ter medo, mas continuar a caminhar mesmo tendo medo. Cada passo na ponte Ã© coragem.",
                            growth: "A pessoa que cruza a ponte Ã© a mesma pessoa, mas se torna diferente depois de cruzar. O crescimento acontece um passo de cada vez assim.",
                            relationships: "Ã€s vezes relacionamentos precisam de pontes. Pontes que conectam coraÃ§Ãµes em lugares diferentes. A mudanÃ§a pode nÃ£o quebrar relacionamentos mas criar novas conexÃµes.",
                            career: "Ir para novos trabalhos, novos caminhos Ã© como cruzar uma ponte. ExperiÃªncias anteriores nÃ£o desaparecem - elas se tornam a ponte levando vocÃª a novos lugares.",
                            identity: "MudanÃ§a de identidade nÃ£o Ã© se perder mas descobrir um eu mais amplo. VocÃª existe em ambos os lados da ponte.",
                            past: "O passado Ã© o ponto de partida da ponte. Porque vocÃª comeÃ§ou lÃ¡, agora pode ficar nesta ponte. NÃ£o Ã© sobre abandonar o passado mas se apoiar nele.",
                            stuck: "Quando se sente preso, pontes fornecem saÃ­das. VocÃª nÃ£o precisa ficar em um lugar. Sempre pode atravessar.",
                            regret: "Arrependimento tambÃ©m pode ser uma razÃ£o para cruzar pontes. Um novo caminho para encontrar o que foi perdido - isso tambÃ©m Ã© uma jornada significativa.",
                            general: "MudanÃ§a Ã© como cruzar uma ponte. O que importa nÃ£o Ã© o destino mas que a ponte te apoie com seguranÃ§a. VÃ¡ devagar, passo a passo."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Lighthouse", emoji: "ğŸ—¼",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            fear: "ì–´ë‘  ì†ì—ì„œ ë°°ë“¤ì´ ê¸¸ì„ ìƒì„ ë•Œ, ë“±ëŒ€ëŠ” ë‘ë ¤ì›€ì„ ì—†ì• ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë°©í–¥ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ë‘ë ¤ì›€ë„ ë§ˆì°¬ê°€ì§€ì˜ˆìš”. ì™„ì „íˆ ì‚¬ë¼ì§ˆ í•„ìš”ëŠ” ì—†ì–´ìš”.",
                            comfort_zone: "ë“±ëŒ€ëŠ” í•­êµ¬ì˜ ì•ˆì „í•¨ì„ ë– ë‚˜ëŠ” ë°°ë“¤ì„ ìœ„í•´ ì„¸ì›Œì¡ŒìŠµë‹ˆë‹¤. í¸ì•ˆí•¨ì„ ë– ë‚˜ëŠ” ê²ƒì´ ìœ„í—˜í•˜ì§€ë§Œ, ê·¸ ì—¬ì •ì— ë¹›ì„ ë¹„ì¶°ì£¼ëŠ” ê²ƒì´ ì œ ì—­í• ì´ì—ìš”.",
                            failure: "ë§ì€ ë°°ë“¤ì´ í­í’ì„ ë§Œë‚˜ê³  ëŒì•„ì˜¤ê¸°ë„ í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ë“±ëŒ€ëŠ” ê·¸ë“¤ì„ ì‹¤íŒ¨í–ˆë‹¤ê³  ì—¬ê¸°ì§€ ì•Šì•„ìš”. ë‹¤ì‹œ ì¶œí•­í•  ë•Œë¥¼ ìœ„í•´ ê³„ì† ë¹›ì„ ë¹„ì¶°ì¤„ ë¿ì…ë‹ˆë‹¤.",
                            unknown: "ë“±ëŒ€ì˜ ë¹›ì´ ë‹¿ì§€ ì•ŠëŠ” ë¨¼ ë°”ë‹¤ê°€ ìˆë‹¤ëŠ” ê±¸ ì•Œê³  ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë³´ì´ëŠ” ë§Œí¼ì´ë¼ë„ ì•ˆì „í•œ ê¸¸ì„ ë°í˜€ì£¼ëŠ” ê²ƒì´ ì˜ë¯¸ê°€ ìˆì–´ìš”.",
                            courage: "ìš©ê¸°ëŠ” ë“±ëŒ€ì²˜ëŸ¼ í˜¼ìì„œ ì–´ë‘ ì„ ê²¬ë””ëŠ” í˜ì…ë‹ˆë‹¤. í­í’ì´ ì™€ë„, ì•ˆê°œê°€ ê»´ë„, ê³„ì† ë¹›ì„ ë‚´ëŠ” ê·¸ ê¾¸ì¤€í•¨ì´ ì§„ì§œ ìš©ê¸°ì˜ˆìš”.",
                            growth: "ë“±ëŒ€ëŠ” ë†’ì€ ê³³ì— ì„œì„œ ë©€ë¦¬ ë´…ë‹ˆë‹¤. ì„±ì¥ë„ ë§ˆì°¬ê°€ì§€ì˜ˆìš”. ì¡°ê¸ˆì”© ë†’ì•„ì§ˆ ë•Œë§ˆë‹¤ ë” ë„“ì€ ì„¸ìƒì´ ë³´ì´ê²Œ ë©ë‹ˆë‹¤.",
                            relationships: "ë“±ëŒ€ëŠ” í˜¼ì ìˆì§€ë§Œ ì™¸ë¡­ì§€ ì•ŠìŠµë‹ˆë‹¤. ìˆ˜ë§ì€ ë°°ë“¤ê³¼ ì—°ê²°ë˜ì–´ ìˆê±°ë“ ìš”. ë³€í™” ì†ì—ì„œë„ ì§„ì •í•œ ê´€ê³„ëŠ” ê³„ì†ë  ê±°ì˜ˆìš”.",
                            career: "ìƒˆë¡œìš´ í•­ë¡œë¥¼ ê°œì²™í•˜ëŠ” ë°°ë“¤ì²˜ëŸ¼, ìƒˆë¡œìš´ ì¼ì„ ì‹œì‘í•˜ëŠ” ê²ƒë„ ëª¨í—˜ì…ë‹ˆë‹¤. ë“±ëŒ€ëŠ” ê·¸ ì—¬ì •ì˜ ì´ì •í‘œê°€ ë˜ì–´ì¤„ ìˆ˜ ìˆì–´ìš”.",
                            identity: "ë“±ëŒ€ëŠ” ìœ„ì¹˜ê°€ ë°”ë€Œì§€ ì•Šì§€ë§Œ, ë¹„ì¶”ëŠ” ë°”ë‹¤ëŠ” ë§¤ì¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ë³¸ì§ˆì€ ê·¸ëŒ€ë¡œì´ë©´ì„œë„ ìƒˆë¡œìš´ ë©´ì„ ë¹„ì¶œ ìˆ˜ ìˆì–´ìš”.",
                            past: "ë“±ëŒ€ëŠ” ê³¼ê±°ì˜ ëª¨ë“  í­í’ì„ ê¸°ì–µí•©ë‹ˆë‹¤. ê·¸ ê²½í—˜ì´ ë” ë°ì€ ë¹›ì„ ë§Œë“¤ì–´ë‚´ìš”. ë‹¹ì‹ ì˜ ê³¼ê±°ë„ ì§€ê¸ˆì˜ ë¹›ì´ ë©ë‹ˆë‹¤.",
                            stuck: "ë“±ëŒ€ëŠ” ë°”ë‹¤ í•œê°€ìš´ë° ê³ ì •ë˜ì–´ ìˆì§€ë§Œ, ê·¸ ë¹›ì€ ììœ ë¡­ê²Œ ë°”ë‹¤ë¥¼ í›‘ìŠµë‹ˆë‹¤. ëª¸ì€ í•œ ê³³ì— ìˆì–´ë„ ë§ˆìŒì€ ì–´ë””ë“  ê°ˆ ìˆ˜ ìˆì–´ìš”.",
                            regret: "ë“±ëŒ€ëŠ” êµ¬í•˜ì§€ ëª»í•œ ë°°ë“¤ì„ ê¸°ì–µí•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ê·¸ ì•„í””ì´ ë” ë°ì€ ë¹›ì„ ë§Œë“¤ì–´ë‚´ëŠ” ì›ë™ë ¥ì´ ë˜ê¸°ë„ í•´ìš”.",
                            general: "ë³€í™”ì˜ ë°”ë‹¤ì—ì„œ ë‹¹ì‹  ìì‹ ì´ ë“±ëŒ€ê°€ ë˜ì„¸ìš”. ì™„ë²½í•œ ê¸¸ì„ ì œì‹œí•  í•„ìš”ëŠ” ì—†ì–´ìš”. ì§€ê¸ˆ í•  ìˆ˜ ìˆëŠ” ë§Œí¼ì˜ ë¹›ë§Œ ë¹„ì¶°ì£¼ë©´ ë©ë‹ˆë‹¤."
                        },
                        en: {
                            fear: "When ships lose their way in darkness, lighthouses don't eliminate fear but show direction. Your fear is the same. It doesn't need to completely disappear.",
                            comfort_zone: "Lighthouses are built for ships leaving the safety of harbors. Leaving comfort is dangerous, but my role is to shine light on that journey.",
                            failure: "Many ships encounter storms and return. But lighthouses don't consider them failures. They just keep shining for when they set sail again.",
                            unknown: "I know there are distant seas where my light doesn't reach. But illuminating a safe path as far as I can see has meaning.",
                            courage: "Courage is the strength to endure darkness alone like a lighthouse. That steadiness of continuing to shine despite storms and fog is true courage.",
                            growth: "Lighthouses stand high and see far. Growth is the same. Each time you rise a little higher, you see a wider world.",
                            relationships: "Lighthouses are alone but not lonely. They're connected to countless ships. True relationships will continue even through change.",
                            career: "Like ships pioneering new routes, starting new work is also an adventure. Lighthouses can be milestones on that journey.",
                            identity: "Lighthouses don't change position, but the sea they illuminate is different every day. Your essence remains while you can illuminate new aspects.",
                            past: "Lighthouses remember all past storms. That experience creates brighter light. Your past also becomes today's light.",
                            stuck: "Lighthouses are fixed in the middle of the sea, but their light freely sweeps across the ocean. Even if your body is in one place, your heart can go anywhere.",
                            regret: "Lighthouses remember ships they couldn't save. But that pain sometimes becomes the driving force for creating brighter light.",
                            general: "Become a lighthouse yourself in the sea of change. You don't need to present a perfect path. Just shine as much light as you can now."
                        },
                        pt: {
                            fear: "Quando navios se perdem na escuridÃ£o, farÃ³is nÃ£o eliminam o medo mas mostram direÃ§Ã£o. Seu medo Ã© o mesmo. NÃ£o precisa desaparecer completamente.",
                            comfort_zone: "FarÃ³is sÃ£o construÃ­dos para navios deixando a seguranÃ§a dos portos. Deixar o conforto Ã© perigoso, mas meu papel Ã© brilhar luz nessa jornada.",
                            failure: "Muitos navios encontram tempestades e retornam. Mas farÃ³is nÃ£o os consideram fracassos. Apenas continuam brilhando para quando zarpar novamente.",
                            unknown: "Sei que hÃ¡ mares distantes onde minha luz nÃ£o alcanÃ§a. Mas iluminar um caminho seguro atÃ© onde posso ver tem significado.",
                            courage: "Coragem Ã© a forÃ§a de suportar a escuridÃ£o sozinho como um farol. Essa constÃ¢ncia de continuar brilhando apesar de tempestades e nÃ©voa Ã© verdadeira coragem.",
                            growth: "FarÃ³is ficam altos e veem longe. Crescimento Ã© igual. Cada vez que vocÃª sobe um pouco mais alto, vÃª um mundo mais amplo.",
                            relationships: "FarÃ³is estÃ£o sozinhos mas nÃ£o solitÃ¡rios. EstÃ£o conectados a incontÃ¡veis navios. Relacionamentos verdadeiros continuarÃ£o mesmo atravÃ©s da mudanÃ§a.",
                            career: "Como navios pioneirando novas rotas, comeÃ§ar novo trabalho tambÃ©m Ã© uma aventura. FarÃ³is podem ser marcos nessa jornada.",
                            identity: "FarÃ³is nÃ£o mudam de posiÃ§Ã£o, mas o mar que iluminam Ã© diferente todos os dias. Sua essÃªncia permanece enquanto vocÃª pode iluminar novos aspectos.",
                            past: "FarÃ³is lembram de todas as tempestades passadas. Essa experiÃªncia cria luz mais brilhante. Seu passado tambÃ©m se torna a luz de hoje.",
                            stuck: "FarÃ³is estÃ£o fixos no meio do mar, mas sua luz varre livremente o oceano. Mesmo se seu corpo estÃ¡ em um lugar, seu coraÃ§Ã£o pode ir a qualquer lugar.",
                            regret: "FarÃ³is lembram de navios que nÃ£o conseguiram salvar. Mas essa dor Ã s vezes se torna a forÃ§a motriz para criar luz mais brilhante.",
                            general: "Torne-se vocÃª mesmo um farol no mar da mudanÃ§a. NÃ£o precisa apresentar um caminho perfeito. Apenas brilhe tanta luz quanto pode agora."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Butterfly", emoji: "ğŸ¦‹",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            fear: "ì• ë²Œë ˆì¼ ë•ŒëŠ” í•˜ëŠ˜ì„ ë‚˜ëŠ” ê²ƒì´ ìƒìƒë„ ì•ˆ ëì–´ìš”. ë²ˆë°ê¸°ê°€ ë˜ëŠ” ê²ƒë„ ì£½ëŠ” ê²ƒ ê°™ì•„ì„œ ë¬´ì„œì› ê³ ìš”. í•˜ì§€ë§Œ ë‘ë ¤ì›€ ì†ì—ì„œë„ ë³€í™”ëŠ” ê³„ì†ëì–´ìš”.",
                            comfort_zone: "ë•… ìœ„ë¥¼ ê¸°ì–´ë‹¤ë‹ˆëŠ” ê²ƒì´ í¸í–ˆì–´ìš”. ì˜ˆì¸¡ ê°€ëŠ¥í•˜ê³  ì•ˆì „í–ˆê±°ë“ ìš”. í•˜ì§€ë§Œ ê·¸ ì•ˆì „í•¨ì´ ì§„ì§œ ë‚˜ë¥¼ ê°€ë‘ê³  ìˆì—ˆë‹¤ëŠ” ê±¸ ë‚˜ì¤‘ì— ì•Œì•˜ì–´ìš”.",
                            failure: "ì²« ë²ˆì§¸ ë‚ ê°¯ì§“ì—ì„œ ë–¨ì–´ì¡Œì–´ìš”. ë°”ëŒì— íœ˜ë‘˜ë ¤ì„œ ì–´ë””ë¡œ ê°ˆì§€ë„ ëª°ëê³ ìš”. í•˜ì§€ë§Œ ì‹¤íŒ¨ê°€ ë‚ ì•„ì˜¤ë¥´ëŠ” ì—°ìŠµì´ì—ˆë‹¤ëŠ” ê±¸ ê¹¨ë‹¬ì•˜ì–´ìš”.",
                            unknown: "í•˜ëŠ˜ì´ ì–´ë–¤ ê³³ì¸ì§€ ì „í˜€ ëª°ëì–´ìš”. ë•…ì—ì„œëŠ” ìƒìƒí•  ìˆ˜ ì—†ëŠ” ì„¸ìƒì´ì—ˆê±°ë“ ìš”. í•˜ì§€ë§Œ ëª¨ë¥´ëŠ” ì„¸ìƒì´ ë” ì•„ë¦„ë‹¤ì› ì–´ìš”.",
                            courage: "ìš©ê¸°ëŠ” ë‚ ê°œê°€ ìˆë‹¤ê³  ë¯¿ëŠ” ê²ƒì´ì—ˆì–´ìš”. ì•„ì§ ì¨ë³¸ ì ë„ ì—†ëŠ” ë‚ ê°œë¥¼, ê·¸ì € ë¯¿ê³  í¼ì¹˜ëŠ” ê²ƒ. ê·¸ê²Œ ì €ì—ê²ŒëŠ” ê°€ì¥ í° ìš©ê¸°ì˜€ì–´ìš”.",
                            growth: "ì„±ì¥ì€ ì™„ì „íˆ ë‹¤ë¥¸ ì¡´ì¬ê°€ ë˜ëŠ” ê²ƒì´ì—ˆì–´ìš”. ì• ë²Œë ˆì˜ ê¸°ì–µì„ ê°€ì§„ ë‚˜ë¹„ê°€ ë˜ëŠ” ê²ƒ. ê³¼ê±°ë¥¼ ë²„ë¦¬ëŠ” ê²Œ ì•„ë‹ˆë¼ í¬í•¨í•˜ë©´ì„œ ë” í° ì¡´ì¬ê°€ ë˜ëŠ” ê±°ì˜ˆìš”.",
                            relationships: "ì• ë²Œë ˆ ì¹œêµ¬ë“¤ì€ ì œê°€ ë‚˜ë¹„ê°€ ëœ í›„ ì²˜ìŒì—” ì•Œì•„ë³´ì§€ ëª»í–ˆì–´ìš”. í•˜ì§€ë§Œ ì§„ì§œ ì¹œêµ¬ë“¤ì€ ë³€í•œ ëª¨ìŠµë„ ì‚¬ë‘í•´ì¤¬ì–´ìš”.",
                            career: "ì• ë²Œë ˆë¡œì„œì˜ 'ì¼'ì€ ìì„ ë¨¹ëŠ” ê²ƒì´ì—ˆì–´ìš”. ë‚˜ë¹„ê°€ ë˜ê³  ë‚˜ì„œëŠ” ê½ƒê°€ë£¨ë¥¼ ì˜®ê¸°ëŠ” ì¼ì„ í•˜ê²Œ ëê³ ìš”. ì™„ì „íˆ ë‹¤ë¥¸ ì—­í• ì´ì§€ë§Œ, ë‘˜ ë‹¤ ì˜ë¯¸ ìˆëŠ” ì¼ì´ì—ˆì–´ìš”.",
                            identity: "ë‚˜ëŠ” ì• ë²Œë ˆì˜€ë˜ ë‚˜ë¹„ì¼ê¹Œìš”, ë‚˜ë¹„ê°€ ëœ ì• ë²Œë ˆì¼ê¹Œìš”? ì•„ë§ˆ ë‘˜ ë‹¤ì¼ ê±°ì˜ˆìš”. ì •ì²´ì„±ì€ í•˜ë‚˜ë¡œ ê³ ì •ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê±¸ ë°°ì› ì–´ìš”.",
                            past: "ì• ë²Œë ˆì˜€ë˜ ì‹œê°„ì„ í›„íšŒí•˜ì§€ ì•Šì•„ìš”. ê·¸ ì‹œê°„ì´ ìˆì—ˆê¸°ì— ì§€ê¸ˆì˜ ë‚ ê°œê°€ ìˆê±°ë“ ìš”. ê³¼ê±°ëŠ” í˜„ì¬ë¥¼ ë§Œë“œëŠ” ì¬ë£Œì˜€ì–´ìš”.",
                            stuck: "ë²ˆë°ê¸° ì•ˆì—ì„œëŠ” ì •ë§ ê°‡íŒ ê²ƒ ê°™ì•˜ì–´ìš”. ì›€ì§ì¼ ìˆ˜ë„, ë³¼ ìˆ˜ë„ ì—†ì—ˆê±°ë“ ìš”. í•˜ì§€ë§Œ ê·¸ê³³ì—ì„œ ê°€ì¥ í° ë³€í™”ê°€ ì¼ì–´ë‚˜ê³  ìˆì—ˆì–´ìš”.",
                            regret: "ë” ì¼ì° ë³€í•˜ì§€ ëª»í•œ ê±¸ ì•„ì‰¬ì›Œí–ˆì–´ìš”. í•˜ì§€ë§Œ ëª¨ë“  ë³€í™”ì—ëŠ” ë•Œê°€ ìˆë‹¤ëŠ” ê±¸ ì•Œê²Œ ëì–´ìš”. ë‚˜ë§Œì˜ ì‹œê°„ì´ ìˆì—ˆë˜ ê±°ì˜ˆìš”.",
                            general: "ë³€í™”ëŠ” ë¬´ì„œìš´ ì¼ì´ì—ìš”. í•˜ì§€ë§Œ ê·¸ ëì—ëŠ” ì§€ê¸ˆì€ ìƒìƒí•  ìˆ˜ ì—†ëŠ” ì•„ë¦„ë‹¤ìš´ ì„¸ìƒì´ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”. ë‚ ê°œë¥¼ ë¯¿ê³  í•œ ë²ˆ í¼ì³ë³´ì„¸ìš”."
                        },
                        en: {
                            fear: "As a caterpillar, I couldn't even imagine flying in the sky. Becoming a chrysalis was scary too, like dying. But change continued even within that fear.",
                            comfort_zone: "Crawling on the ground was comfortable. It was predictable and safe. But I later realized that safety was actually trapping the real me.",
                            failure: "I fell during my first wingbeat. I was swept by the wind and didn't know where to go. But I realized failure was practice for taking flight.",
                            unknown: "I had no idea what the sky was like. It was a world unimaginable from the ground. But the unknown world was more beautiful.",
                            courage: "Courage was believing I had wings. Spreading wings I'd never used, just believing in them. That was the greatest courage for me.",
                            growth: "Growth was becoming a completely different being. Becoming a butterfly with caterpillar memories. Not abandoning the past but including it while becoming something greater.",
                            relationships: "My caterpillar friends didn't recognize me at first after I became a butterfly. But true friends loved my changed form too.",
                            career: "My 'job' as a caterpillar was eating leaves. After becoming a butterfly, I started carrying pollen. Completely different roles, but both were meaningful work.",
                            identity: "Am I a butterfly who was a caterpillar, or a caterpillar who became a butterfly? Probably both. I learned that identity isn't fixed to one thing.",
                            past: "I don't regret the time I was a caterpillar. Without that time, I wouldn't have these wings now. The past was material for creating the present.",
                            stuck: "Inside the chrysalis, I really felt trapped. I couldn't move or see anything. But the greatest change was happening there.",
                            regret: "I regretted not changing sooner. But I learned that every change has its time. I had my own timing.",
                            general: "Change is scary. But at the end, there's a beautiful world waiting that you can't imagine now. Trust your wings and try spreading them once."
                        },
                        pt: {
                            fear: "Como lagarta, eu nem conseguia imaginar voar no cÃ©u. Tornar-se crisÃ¡lida tambÃ©m era assustador, como morrer. Mas a mudanÃ§a continuou mesmo dentro desse medo.",
                            comfort_zone: "Rastejar no chÃ£o era confortÃ¡vel. Era previsÃ­vel e seguro. Mas depois percebi que essa seguranÃ§a estava na verdade prendendo o verdadeiro eu.",
                            failure: "CaÃ­ durante meu primeiro bater de asas. Fui levada pelo vento e nÃ£o sabia para onde ir. Mas percebi que o fracasso era prÃ¡tica para alÃ§ar voo.",
                            unknown: "Eu nÃ£o tinha ideia de como era o cÃ©u. Era um mundo inimaginÃ¡vel do chÃ£o. Mas o mundo desconhecido era mais bonito.",
                            courage: "Coragem era acreditar que eu tinha asas. Abrir asas que nunca tinha usado, apenas acreditando nelas. Essa foi a maior coragem para mim.",
                            growth: "Crescimento era tornar-se um ser completamente diferente. Tornar-se uma borboleta com memÃ³rias de lagarta. NÃ£o abandonar o passado mas incluÃ­-lo enquanto se torna algo maior.",
                            relationships: "Meus amigos lagartas nÃ£o me reconheceram no inÃ­cio depois que me tornei borboleta. Mas verdadeiros amigos amaram minha forma mudada tambÃ©m.",
                            career: "Meu 'trabalho' como lagarta era comer folhas. Depois de me tornar borboleta, comecei a carregar pÃ³len. PapÃ©is completamente diferentes, mas ambos eram trabalho significativo.",
                            identity: "Sou uma borboleta que foi lagarta, ou uma lagarta que se tornou borboleta? Provavelmente ambas. Aprendi que identidade nÃ£o Ã© fixa a uma coisa.",
                            past: "NÃ£o me arrependo do tempo que fui lagarta. Sem esse tempo, nÃ£o teria essas asas agora. O passado foi material para criar o presente.",
                            stuck: "Dentro da crisÃ¡lida, realmente me senti presa. NÃ£o conseguia me mover ou ver nada. Mas a maior mudanÃ§a estava acontecendo ali.",
                            regret: "Me arrependi de nÃ£o ter mudado mais cedo. Mas aprendi que toda mudanÃ§a tem seu tempo. Eu tinha meu prÃ³prio timing.",
                            general: "MudanÃ§a Ã© assustadora. Mas no final, hÃ¡ um mundo bonito esperando que vocÃª nÃ£o pode imaginar agora. Confie em suas asas e tente abri-las uma vez."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            }
        ];
        
        let currentLanguage = 'en'; // ê¸°ë³¸ ì–¸ì–´ë¥¼ ì˜ì–´ë¡œ ì„¤ì •
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        // ============ ì—¬ì • ì´ˆê¸°í™” í•¨ìˆ˜ ============
        
        function resetJourney() {
            console.log('=== ì—¬ì • ì´ˆê¸°í™” ì‹œì‘ ===');
            
            // 1. ëª¨ë“  íƒ€ì´í•‘ íš¨ê³¼ ì™„ì „ ì •ë¦¬
            clearAllTypingEffects();
            
            // ì¶”ê°€ ì•ˆì „ì¥ì¹˜ - ëª¨ë“  timer ì •ë¦¬
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            
            // 2. ëª¨ë“  ì½˜í…ì¸  ì„¹ì…˜ ì™„ì „ ì´ˆê¸°í™”
            const sectionsToReset = [
                'portalIntroSection',
                'characterResponsesSection', 
                'lightMessageSection',
                'portalQuestionSection',
                'userInputSection',
                'userReactionsSection',
                'continueSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    } else {
                        const textElements = section.querySelectorAll('.portal-intro, .light-message, .portal-question, .continue-text');
                        textElements.forEach(el => {
                            el.innerHTML = '';
                            el.textContent = '';
                        });
                    }
                }
            });
            
            // 3. íŠ¹ì • ìš”ì†Œë“¤ ê°œë³„ ì´ˆê¸°í™”
            const portalIntro = document.getElementById('portalIntro');
            const lightMessage = document.getElementById('lightMessage');
            const portalQuestion = document.getElementById('portalQuestion');
            const continueText = document.getElementById('continueText');
            
            if (portalIntro) portalIntro.innerHTML = '';
            if (lightMessage) lightMessage.innerHTML = '';
            if (portalQuestion) portalQuestion.innerHTML = '';
            if (continueText) continueText.innerHTML = '';
            
            // 4. í…ìŠ¤íŠ¸ì˜ì—­ ì™„ì „ ì´ˆê¸°í™”
            const userTextarea = document.getElementById('userTextarea');
            if (userTextarea) {
                userTextarea.disabled = false;
                userTextarea.value = '';
                userTextarea.style.height = 'auto';
                userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            }
            
            // 5. ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì´ˆê¸°í™”
            const mainContent = document.getElementById('mainContent');
            if (mainContent) {
                mainContent.scrollTop = 0;
            }
            
            // 6. ìƒíƒœ ë³€ìˆ˜ ì™„ì „ ì´ˆê¸°í™”
            userResponse = '';
            currentTypingElement = null;
            
            console.log('=== ì—¬ì • ì´ˆê¸°í™” ì™„ë£Œ ===');
        }
        
        // ============ ê°œì„ ëœ ì–¸ì–´ ë³€ê²½ í•¨ìˆ˜ ============
        
        function changeLanguage(lang) {
            if (!translations[lang]) {
                console.error('ì§€ì›í•˜ì§€ ì•ŠëŠ” ì–¸ì–´:', lang);
                return;
            }
            
            if (currentLanguage === lang) {
                return;
            }
            
            if (journeyStarted) {
                const confirmMessage = translations[currentLanguage].languageChangeConfirm;
                const shouldRestart = confirm(confirmMessage);
                
                if (!shouldRestart) {
                    return;
                }
            }
            
            const previousLanguage = currentLanguage;
            currentLanguage = lang;
            
            console.log(`ì–¸ì–´ ë³€ê²½: ${previousLanguage} â†’ ${currentLanguage}`);
            
            if (journeyStarted) {
                resetJourney();
            }
            
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                setTimeout(() => {
                    console.log(`ìƒˆë¡œìš´ ì–¸ì–´(${currentLanguage})ë¡œ ì—¬ì • ì¬ì‹œì‘`);
                    startPortalSequence();
                }, 1000);
            }
        }
        
        // ============ UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤ ============
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            // ê°œë³„ ìš”ì†Œ ì—…ë°ì´íŠ¸
            const elements = [
                'logoSubtitle',
                'portalMainTitle', 
                'portalSubtitle',
                'lightTitle',
                'continueYesBtn',
                'continueNoBtn'
            ];
            
            elements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element && translations[lang]) {
                    const key = elementId.replace('Btn', 'Button').replace('Subtitle', 'Subtitle');
                    let translationKey = key;
                    
                    const keyMapping = {
                        'logoSubtitle': 'logoSubtitle',
                        'portalMainTitle': 'portalMainTitle',
                        'portalSubtitle': 'portalSubtitle',
                        'lightTitle': 'lightTitle',
                        'continueYesButton': 'continueYes',
                        'continueNoButton': 'continueNo'
                    };
                    
                    translationKey = keyMapping[key] || key;
                    
                    if (translations[lang][translationKey]) {
                        element.textContent = translations[lang][translationKey];
                    }
                }
            });
            
            // placeholder ì—…ë°ì´íŠ¸
            const textarea = document.getElementById('userTextarea');
            if (textarea) textarea.placeholder = translations[lang].inputPlaceholder;
        }
        
        // ============ ê°œì„ ëœ íƒ€ì´í•‘ íš¨ê³¼ + ìŠ¤í¬ë¡¤ ì¶”ì  ì‹œìŠ¤í…œ ============
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i % 10 === 0) {
                        scrollToFollowTyping(element);
                    }
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        
                        setTimeout(() => {
                            if (document.contains(element)) {
                                scrollToFollowTyping(element);
                            }
                        }, 200);
                        
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        // ============ ìŠ¤ë§ˆíŠ¸ ìŠ¤í¬ë¡¤ ì‹œìŠ¤í…œ ============
        
        function scrollToFollowTyping(element) {
            const mainContent = document.getElementById('mainContent');
            const elementRect = element.getBoundingClientRect();
            const containerRect = mainContent.getBoundingClientRect();
            
            if (elementRect.bottom > containerRect.bottom - 150) {
                const scrollTop = mainContent.scrollTop;
                const elementOffsetTop = element.offsetTop;
                const targetScroll = elementOffsetTop - (containerRect.height / 2);
                
                mainContent.scrollTo({
                    top: Math.max(0, targetScroll),
                    behavior: 'smooth'
                });
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        // ============ ì–¸ì–´ ë²„íŠ¼ ì´ë²¤íŠ¸ ì„¤ì • ============
        
        function setupLanguageButtons() {
            const langButtons = document.querySelectorAll('.lang-btn');
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const newLang = this.dataset.lang;
                    changeLanguage(newLang);
                });
            });
        }
        
        // ============ ë©”ì¸ ì—¬ì • ì‹œìŠ¤í…œ ============
        
        function initializeTemarix() {
            console.log('=== Temarix Portal 15 ì´ˆê¸°í™” ì‹œì‘ ===');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        // ============ ì—¬ì • ë‹¨ê³„ë“¤ ============
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            const introText = translations[currentLanguage].portalIntro;
            await typewriterEffect(introElement, introText, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const dialogueText = translations[currentLanguage][char.key];
                await typewriterEffect(dialogueDiv, dialogueText, 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            const lightText = translations[currentLanguage].lightMessage;
            await typewriterEffect(lightMessageEl, lightText, 60);
            
            setTimeout(() => {
                showQuestion();
            }, 2000);
        }
        
        async function showQuestion() {
            const questionSection = document.getElementById('portalQuestionSection');
            const questionEl = document.getElementById('portalQuestion');
            
            questionSection.classList.add('show');
            
            const questionText = translations[currentLanguage].portalQuestion;
            await typewriterEffect(questionEl, questionText, 50);
            
            setTimeout(() => {
                enableUserInput();
            }, 1500);
        }
        
        // ============ ì‚¬ìš©ì ì…ë ¥ ì‹œìŠ¤í…œ ============
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', handleTextareaKeydown);
            
            document.getElementById('continueYesBtn').addEventListener('click', function() {
                processContinue('Y');
            });
            
            document.getElementById('continueNoBtn').addEventListener('click', function() {
                processContinue('N');
            });
        }
        
        function handleTextareaKeydown(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                const inputValue = this.value.trim();
                
                if (inputValue) {
                    processUserInput(inputValue);
                }
            }
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                showUserReactions(inputText);
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = `<strong>${youLabel}:</strong> "${text}"`;
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showContinueOption();
            }, 2000);
        }
        
        async function showContinueOption() {
            const continueSection = document.getElementById('continueSection');
            const continueText = document.getElementById('continueText');
            
            continueSection.classList.add('show');
            
            const questionText = translations[currentLanguage].continueText;
            await typewriterEffect(continueText, questionText, 50);
            
            setTimeout(() => {
                scrollToElement(continueSection);
            }, 500);
        }
        
        function processContinue(input) {
            if (input === 'Y') {
                const message = currentLanguage === 'ko' ? 
                    'Portal 16ì´ ê³§ ì¤€ë¹„ë©ë‹ˆë‹¤. ê³„ì†í•´ì„œ ë” ê¹Šì€ ê°ì •ì˜ ì—¬ì •ì´ ì´ì–´ì§‘ë‹ˆë‹¤.' :
                    currentLanguage === 'en' ? 
                    'Portal 16 will be ready soon. The journey into deeper emotions continues.' :
                    'Portal 16 estarÃ¡ pronto em breve. A jornada para emoÃ§Ãµes mais profundas continua.';
                alert(message);
            } else if (input === 'N') {
                const message = currentLanguage === 'ko' ? 
                    'ì—¬ì •ì´ ì¼ì‹œ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì–¸ì œë“  ë‹¤ì‹œ ëŒì•„ì™€ ê³„ì†í•˜ì„¸ìš”.' :
                    currentLanguage === 'en' ? 
                    'The journey has been paused. Come back and continue anytime.' :
                    'A jornada foi pausada. Volte e continue a qualquer momento.';
                alert(message);
            }
        }
        
        // ============ ì´ˆê¸°í™” ============
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V2 Portal 15 DOM ë¡œë“œ ì™„ë£Œ');
            
            // ìë™ ë¡œê·¸ì¸ ì²˜ë¦¬ (ë¡œê·¸ì¸ ëª¨ë‹¬ ì œê±°)
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            memoryStorage.mockUser = currentUser;
            
            updateStaticTranslations(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>