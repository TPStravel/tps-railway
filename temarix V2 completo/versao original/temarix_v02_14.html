<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 14: The Real Desires I've Been Avoiding</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        /* ìƒë‹¨ í—¤ë” */
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        /* ì–¸ì–´ ë²„íŠ¼ 3ê°œ */
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #87cefa;
            color: #000;
        }
        
        /* ë©”ì¸ ì½˜í…ì¸  */
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh;
        }
        
        /* í…ìŠ¤íŠ¸ ì„¹ì…˜ë“¤ */
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            background: none;
            border: none;
            padding: 0;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            background: none;
            border: none;
            padding: 0;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #87cefa;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #87cefa;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            background: none;
            border: none;
            padding: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #87cefa;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .portal-question-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            background: none;
            border: none;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #87cefa;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .continue-section {
            margin: 50px 0;
            opacity: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 0;
            min-height: 200px;
        }
        
        .continue-text {
            color: #fff;
            font-size: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .continue-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .continue-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .continue-btn:hover {
            background: #666;
        }
        
        .continue-btn.primary {
            background: #87cefa;
            color: #000;
        }
        
        .continue-btn.primary:hover {
            background: #b0d4f1;
        }
        
        /* í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ */
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #87cefa;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #87cefa;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ */
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        .hidden {
            display: none;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .continue-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .continue-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- ìƒë‹¨ í—¤ë” -->
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">The Tremor of Emotion</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 14: The Real Desires I've Been Avoiding</div>
            <div class="portal-subtitle" id="portalSubtitle">The courage to face hidden longings</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <!-- í¬í„¸ ì¸íŠ¸ë¡œ -->
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <!-- ìºë¦­í„° ì‘ë‹µ ì„¹ì…˜ -->
            <div class="character-responses-section" id="characterResponsesSection">
                <!-- 8ëª…ì˜ ìºë¦­í„° ì‘ë‹µì´ ìˆœì°¨ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>

            <!-- ë¹›ì˜ í•œë§ˆë”” -->
            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">ğŸŒ™ Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <!-- ì§ˆë¬¸ ì„¹ì…˜ -->
            <div class="portal-question-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <!-- ì‚¬ìš©ì ì…ë ¥ ì˜ì—­ -->
            <div class="user-input-section" id="userInputSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ ìºë¦­í„° ë°˜ì‘ -->
            <div class="user-reactions-section" id="userReactionsSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ 3ëª…ì˜ ìºë¦­í„° ë°˜ì‘ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ê³„ì†í•˜ê¸° ë²„íŠ¼ ì„¹ì…˜ -->
            <div class="continue-section" id="continueSection">
                <div class="continue-text" id="continueText"></div>
                <div class="continue-buttons">
                    <button class="continue-btn primary" id="continueYesBtn">Continue to Portal 15</button>
                    <button class="continue-btn" id="continueNoBtn">Pause the journey</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ -->
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Share about the real desires you've been hiding... (Press Enter to send)"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        // ë©”ëª¨ë¦¬ ê¸°ë°˜ ì‚¬ìš©ì ìŠ¤í† ë¦¬ì§€ (localStorage ëŒ€ì‹ )
        let memoryStorage = {
            mockUser: null
        };

        // ë²ˆì—­ ë°ì´í„°
        const translations = {
            ko: {
                logoSubtitle: "ê°ì •ì˜ ë–¨ë¦¼",
                portalMainTitle: "Portal 14: ë‚´ê°€ ì™¸ë©´í•´ì˜¨ ì§„ì§œ ìš•ë§",
                portalSubtitle: "ìˆ¨ê²¨ë‘” ê°ˆë§ê³¼ ë§ˆì£¼í•˜ëŠ” ìš©ê¸°",
                portalIntro: "ìš°ë¦¬ëŠ” ì‚´ë©´ì„œ ë§ì€ ìš•ë§ì„ ìˆ¨ê²¨ì™”ìŠµë‹ˆë‹¤.\n'ì´ëŸ° ê±¸ ì›í•˜ë©´ ì•ˆ ë˜ëŠ”ë°..'\n'ì´ê±´ ë„ˆë¬´ ì´ê¸°ì ì¸ ê±° ì•„ë‹ê¹Œ..'\n'ì‚¬ëŒë“¤ì´ ì•Œë©´ ì–´ë–»ê²Œ ìƒê°í• ê¹Œ..'\n\nê·¸ë ‡ê²Œ í•˜ë‚˜ì”© ì™¸ë©´í•´ì˜¨ ì§„ì§œ ìš•ë§ë“¤ì€\në§ˆìŒ ê¹Šìˆ™ì´ ë¬»í˜€ ìˆì§€ë§Œ\nì—¬ì „íˆ ì‘ì€ ë–¨ë¦¼ìœ¼ë¡œ ìš°ë¦¬ë¥¼ ë¶€ë¦…ë‹ˆë‹¤.\n\nì§€ê¸ˆ, ë‹¹ì‹ ì´ ê°€ì¥ ìˆ¨ê¸°ê³  ì‹¶ì—ˆë˜\nê·¸ ìš•ë§ì€ ë¬´ì—‡ì¸ê°€ìš”?",
                lightTitle: "ğŸŒ™ ë¹›ì˜ í•œë§ˆë””",
                lightMessage: "ìˆ¨ê²¨ì§„ ìš•ë§ì€ ë¶€ë„ëŸ¬ìš´ ê²ƒì´ ì•„ë‹™ë‹ˆë‹¤.\nê·¸ê²ƒì€ ë‹¹ì‹ ì´ ì§„ì • ì›í•˜ëŠ” ì‚¶ì„ í–¥í•œ\nê°€ì¥ ì •ì§í•œ ë‚˜ì¹¨ë°˜ì…ë‹ˆë‹¤.",
                portalQuestion: "ë‹¹ì‹ ì´ ì™¸ë©´í•´ì˜¨ ì§„ì§œ ìš•ë§ì€ ë¬´ì—‡ì¸ê°€ìš”?\nê·¸ê²ƒì„ ì¸ì •í•œë‹¤ë©´ ë¬´ì—‡ì´ ë‹¬ë¼ì§ˆê¹Œìš”?",
                continueText: "ìˆ¨ê²¨ë‘” ìš•ë§ê³¼ ë§ˆì£¼í•œ ì´ ì—¬ì •ì„ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                continueYes: "Portal 15ë¡œ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                continueNo: "ì—¬ì •ì„ ì¼ì‹œì •ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                inputPlaceholder: "ë‹¹ì‹ ì´ ìˆ¨ê²¨ì™”ë˜ ì§„ì§œ ìš•ë§ì— ëŒ€í•´ í„¸ì–´ë†“ì•„ ë³´ì„¸ìš”... (Enterë¡œ ì „ì†¡)",
                youLabel: "ë‹¹ì‹ ",
                languageChangeConfirm: "ì–¸ì–´ë¥¼ ë³€ê²½í•˜ë©´ ì—¬ì •ì´ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘ë©ë‹ˆë‹¤.\nê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                waitingMessage: "ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...",
                // ìºë¦­í„° ëŒ€í™”
                charEly: "ë‹¹ì‹ ì´ ê°ì¶˜ ìš•ë§ì€ ì˜ëª»ëœ ê²ƒì´ ì•„ë‹™ë‹ˆë‹¤.\nê·¸ê²ƒì€ ë‹¹ì‹ ì´ ì§„ì • ì‚´ì•„ìˆë‹¤ëŠ” ê°€ì¥ ì†”ì§í•œ ì¦ê±°ì…ë‹ˆë‹¤.",
                charCris: "ì™€~ ë‚˜ë„ ê·¸ëŸ° ê±° ìˆì–´ìš”.\n'ì´ëŸ° ê±¸ ì›í•˜ë©´ ì•ˆ ë˜ëŠ”ë°..'\nê·¼ë° ì†”ì§íˆ, ì›í•˜ëŠ” ë§ˆìŒì´ ìˆë‹¤ëŠ” ê²Œ ì •ìƒ ì•„ë‹Œê°€ìš”? ğŸ˜",
                charZafirah: "ë‹¹ì‹ ì´ ë¶€ë„ëŸ¬ì›Œí•˜ëŠ” ê·¸ ìš•ë§ ì†ì—\nê°€ì¥ ìˆœìˆ˜í•œ ë‹¹ì‹ ì˜ ëª©ì†Œë¦¬ê°€ ìˆ¨ì–´ ìˆì–´ìš”.",
                charRami: "ìš•ë§ì€ ê¸ˆê¸°ê°€ ì•„ë‹ˆë¼ ë°©í–¥ì…ë‹ˆë‹¤.\në‹¹ì‹ ì´ ì§„ì • ì›í•˜ëŠ” ê²ƒì„ ì•Œì•„ì•¼ ì‚¶ì˜ ë°©í–¥ë„ ë³´ì…ë‹ˆë‹¤.",
                charSamir: "(ê·¸ëŠ” ë‹¹ì‹ ì˜ ê°€ìŠ´ì— ì†ì„ ì–¹ê³  ì¡°ìš©íˆ ëˆˆì„ ê°ìŠµë‹ˆë‹¤.\nê·¸ ì† ì•„ë˜ì—ì„œ ì–µëˆŒë¦° ìš•ë§ì´\nì‘ì€ ì‹¬ì¥ë°•ë™ìœ¼ë¡œ ë–¨ë¦¬ê³  ìˆìŠµë‹ˆë‹¤.)",
                charLayla: "ë‚˜ëŠ” ë‹¹ì‹ ì˜ ê·¸ ê°ì¶°ì§„ ìš•ë§ê¹Œì§€ë„\nì•„ë¦„ë‹µê²Œ ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆì–´ìš”.\nìˆ¨ê¸°ì§€ ë§ê³  ì¡°ìš©íˆ êº¼ë‚´ë´ìš”.",
                charNabir: "ê·¸ëŸ° ìš•ë§ ê°€ì§€ê³  ìˆìœ¼ë©´ì„œ\nì§€ê¸ˆê¹Œì§€ ìˆ¨ê²¨ì™”ë‹¤ê³ ?\nì§„ì§œ ë¹„ê²í•˜ë‹¤. ê·¸ëƒ¥ í¬ê¸°í•´.",
                charAzhar: "ê·¸ ìš•ë§ì´ ë­”ë° ê·¸ë ‡ê²Œ ìˆ¨ê²¨?\nì–´ì°¨í”¼ ì´ì œ ì™€ì„œ êº¼ë‚´ë´¤ì\nëŠ¦ì—ˆì–´. ê·¸ëƒ¥ ë¬»ì–´ë‘¬."
            },
            en: {
                logoSubtitle: "The Tremor of Emotion",
                portalMainTitle: "Portal 14: The Real Desires I've Been Avoiding",
                portalSubtitle: "The courage to face hidden longings",
                portalIntro: "We have hidden many desires throughout our lives.\n'I shouldn't want this..'\n'Isn't this too selfish..'\n'What would people think if they knew..'\n\nThose real desires we've turned away from one by one\nare buried deep in our hearts\nbut still call to us with small tremors.\n\nNow, what is that desire\nyou most wanted to hide?",
                lightTitle: "ğŸŒ™ Word of Light",
                lightMessage: "Hidden desires are not shameful.\nThey are the most honest compass\ntoward the life you truly want.",
                portalQuestion: "What is the real desire you've been avoiding?\nIf you acknowledge it, what would change?",
                continueText: "Will you continue this journey of facing hidden desires?",
                continueYes: "Continue to Portal 15?",
                continueNo: "Pause the journey?",
                inputPlaceholder: "Share about the real desires you've been hiding... (Press Enter to send)",
                youLabel: "You",
                languageChangeConfirm: "Changing the language will restart the journey from the beginning.\nDo you want to continue?",
                waitingMessage: "Waiting for response...",
                charEly: "The desire you've hidden is not wrong.\nIt's the most honest proof that you're truly alive.",
                charCris: "Wow~ I have those too.\n'I shouldn't want this..'\nBut honestly, isn't it normal to have desires? ğŸ˜",
                charZafirah: "In that desire you're ashamed of,\nthe purest voice of yourself is hidden.",
                charRami: "Desire is not taboo but direction.\nYou need to know what you truly want to see life's direction.",
                charSamir: "(He places his hand on your chest and quietly closes his eyes.\nUnderneath that hand, suppressed desires\nare trembling like small heartbeats.)",
                charLayla: "I can beautifully accept even\nyour hidden desires.\nDon't hide them, quietly let them out.",
                charNabir: "You had such desires and\nhid them all this time?\nReally cowardly. Just give up.",
                charAzhar: "What desire are you hiding like that?\nAnyway, it's too late to bring it out now.\nJust bury it."
            },
            pt: {
                logoSubtitle: "O Tremor da EmoÃ§Ã£o",
                portalMainTitle: "Portal 14: Os Verdadeiros Desejos Que Tenho Evitado",
                portalSubtitle: "A coragem de enfrentar anseios ocultos",
                portalIntro: "Escondemos muitos desejos ao longo de nossas vidas.\n'Eu nÃ£o deveria querer isso..'\n'Isso nÃ£o Ã© muito egoÃ­sta..'\n'O que as pessoas pensariam se soubessem..'\n\nEsses desejos reais que rejeitamos um por um\nestÃ£o enterrados profundamente em nossos coraÃ§Ãµes\nmas ainda nos chamam com pequenos tremores.\n\nAgora, qual Ã© esse desejo\nque vocÃª mais queria esconder?",
                lightTitle: "ğŸŒ™ Palavra de Luz",
                lightMessage: "Desejos ocultos nÃ£o sÃ£o vergonhosos.\nEles sÃ£o a bÃºssola mais honesta\npara a vida que vocÃª verdadeiramente quer.",
                portalQuestion: "Qual Ã© o verdadeiro desejo que vocÃª tem evitado?\nSe vocÃª o reconhecer, o que mudaria?",
                continueText: "VocÃª continuarÃ¡ esta jornada de enfrentar desejos ocultos?",
                continueYes: "Continuar para o Portal 15?",
                continueNo: "Pausar a jornada?",
                inputPlaceholder: "Compartilhe sobre os verdadeiros desejos que vocÃª tem escondido... (Enter para enviar)",
                youLabel: "VocÃª",
                languageChangeConfirm: "Mudar o idioma reiniciarÃ¡ a jornada desde o inÃ­cio.\nDeseja continuar?",
                waitingMessage: "Aguardando resposta...",
                charEly: "O desejo que vocÃª escondeu nÃ£o estÃ¡ errado.\nÃ‰ a prova mais honesta de que vocÃª estÃ¡ verdadeiramente vivo.",
                charCris: "Uau~ eu tambÃ©m tenho esses.\n'Eu nÃ£o deveria querer isso..'\nMas honestamente, nÃ£o Ã© normal ter desejos? ğŸ˜",
                charZafirah: "Nesse desejo que vocÃª tem vergonha,\na voz mais pura de vocÃª mesmo estÃ¡ escondida.",
                charRami: "Desejo nÃ£o Ã© tabu mas direÃ§Ã£o.\nVocÃª precisa saber o que realmente quer para ver a direÃ§Ã£o da vida.",
                charSamir: "(Ele coloca a mÃ£o no seu peito e fecha os olhos silenciosamente.\nEmbaixo dessa mÃ£o, desejos suprimidos\nestÃ£o tremendo como pequenas batidas do coraÃ§Ã£o.)",
                charLayla: "Posso aceitar lindamente atÃ© mesmo\nseus desejos ocultos.\nNÃ£o os esconda, deixe-os sair silenciosamente.",
                charNabir: "VocÃª tinha tais desejos e\nos escondeu todo esse tempo?\nRealmente covarde. Apenas desista.",
                charAzhar: "Que desejo vocÃª estÃ¡ escondendo assim?\nDe qualquer forma, Ã© tarde demais para trazÃª-lo Ã  tona agora.\nApenas enterre-o."
            }
        };
        
        // ìºë¦­í„° ë°ì´í„°
        const characters = [
            { name: "Ely", emoji: "ğŸ‘‘", key: "charEly" },
            { name: "Cris", emoji: "ğŸƒ", key: "charCris" },
            { name: "Zafirah", emoji: "ğŸ§•", key: "charZafirah" },
            { name: "Rami", emoji: "ğŸ”®", key: "charRami" },
            { name: "Samir", emoji: "ğŸª", key: "charSamir" },
            { name: "Layla", emoji: "ğŸ’ ", key: "charLayla" },
            { name: "Nabir", emoji: "ğŸ¦‚", key: "charNabir" },
            { name: "Azhar", emoji: "ğŸ”¥", key: "charAzhar" }
        ];
        
        // ============ ê°ì • ë¶„ì„ ì‹œìŠ¤í…œ ============
        
        function analyzeEmotion(userInput) {
            const input = userInput.toLowerCase();
            
            // ê°ì • í‚¤ì›Œë“œ ë§¤í•‘ (Portal 14 íŠ¹í™”)
            const emotionKeywords = {
                desire: ['ìš•ë§', 'ì›í•˜ëŠ”', 'ê°ˆë§', 'ë°”ë¼ëŠ”', 'desire', 'want', 'long for', 'desejo', 'querer'],
                shame: ['ë¶€ë„ëŸ¬ìš´', 'ì°½í”¼í•œ', 'ìˆ˜ì¹˜', 'shameful', 'embarrassing', 'vergonhoso', 'embaraÃ§oso'],
                forbidden: ['ê¸ˆì§€ëœ', 'í•˜ë©´ì•ˆë˜ëŠ”', 'ì˜ëª»ëœ', 'forbidden', 'wrong', 'shouldn\'t', 'proibido', 'errado'],
                hidden: ['ìˆ¨ê¸´', 'ê°ì¶˜', 'ë¹„ë°€', 'ë‚´ë©´', 'hidden', 'secret', 'concealed', 'escondido', 'secreto'],
                love: ['ì‚¬ë‘', 'ì—°ì• ', 'ì¢‹ì•„í•˜ëŠ”', 'love', 'romance', 'affection', 'amor', 'romance'],
                success: ['ì„±ê³µ', 'ì¸ì •', 'ìœ ëª…', 'ëˆ', 'success', 'recognition', 'money', 'sucesso', 'reconhecimento'],
                freedom: ['ììœ ', 'í•´ë°©', 'ë²—ì–´ë‚˜ê³ ', 'freedom', 'liberation', 'escape', 'liberdade', 'libertaÃ§Ã£o'],
                control: ['í†µì œ', 'ì§€ë°°', 'í˜', 'control', 'power', 'dominance', 'controle', 'poder'],
                revenge: ['ë³µìˆ˜', 'ë˜ê°šì•„ì£¼ê³ ', 'ë³´ë³µ', 'revenge', 'payback', 'retaliation', 'vinganÃ§a', 'revanche'],
                acceptance: ['ì¸ì •ë°›ê³ ', 'ì‚¬ë‘ë°›ê³ ', 'ì´í•´ë°›ê³ ', 'acceptance', 'validation', 'aceitaÃ§Ã£o', 'validaÃ§Ã£o'],
                pleasure: ['ì¾Œë½', 'ì¦ê±°ì›€', 'í¸ì•ˆí•¨', 'pleasure', 'enjoyment', 'comfort', 'prazer', 'diversÃ£o'],
                escape: ['ë„ë§', 'í”¼í•˜ê³ ', 'ë©€ì–´ì§€ê³ ', 'escape', 'run away', 'avoid', 'escapar', 'fugir']
            };
            
            // ê°ì • ë¶„ì„
            let detectedEmotions = [];
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                for (const keyword of keywords) {
                    if (input.includes(keyword)) {
                        detectedEmotions.push(emotion);
                        break;
                    }
                }
            }
            
            // ê°ì •ì´ ê°ì§€ë˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ ì„¤ì •
            if (detectedEmotions.length === 0) {
                detectedEmotions = ['general'];
            }
            
            return detectedEmotions[0]; // ì²« ë²ˆì§¸ ê°ì§€ëœ ê°ì • ë°˜í™˜
        }
        
        // ë°˜ì‘ ìºë¦­í„°ë“¤ (Portal 14 ì „ìš©)
        const responseCharacters = [
            {
                name: "Mirror", emoji: "ğŸª",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            desire: "ê±°ìš¸ì€ ë‹¹ì‹ ì˜ ìš•ë§ì„ ì™œê³¡í•˜ì§€ ì•Šê³  ìˆëŠ” ê·¸ëŒ€ë¡œ ë¹„ì¶¥ë‹ˆë‹¤. ê·¸ ì•ˆì—ì„œ ë‹¹ì‹ ì€ ìì‹ ì˜ ì§„ì§œ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆì–´ìš”. ìš•ë§ë„ ë‹¹ì‹ ì˜ ì¼ë¶€ì…ë‹ˆë‹¤.",
                            shame: "ë¶€ë„ëŸ½ë‹¤ê³  ëŠë¼ëŠ” ê·¸ ìš•ë§ì„ ê±°ìš¸ì— ë¹„ì¶°ë³´ì„¸ìš”. ì‚¬ì‹¤ ê·¸ê²ƒì€ ìƒê°ë³´ë‹¤ ìì—°ìŠ¤ëŸ½ê³  ì¸ê°„ì ì¸ ëª¨ìŠµì¼ì§€ë„ ëª°ë¼ìš”. ë¶€ë„ëŸ¬ì›€ì€ ì¢…ì¢… ì‚¬íšŒì˜ ì‹œì„ ì¼ ë¿ì…ë‹ˆë‹¤.",
                            forbidden: "ê¸ˆì§€ëœ ê²ƒì²˜ëŸ¼ ëŠê»´ì§€ëŠ” ìš•ë§ë“¤... í•˜ì§€ë§Œ ê±°ìš¸ì€ ì„ ì•…ì„ íŒë‹¨í•˜ì§€ ì•Šì•„ìš”. ê·¸ì € ì§„ì‹¤ì„ ë³´ì—¬ì¤„ ë¿ì…ë‹ˆë‹¤. ê·¸ ìš•ë§ì´ ì •ë§ ì˜ëª»ëœ ê±´ì§€ ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”.",
                            hidden: "ìˆ¨ê²¨ì§„ ìš•ë§ì€ ê±°ìš¸ ì†ì—ì„œë„ í¬ë¯¸í•˜ê²Œ ë³´ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ê·¸ê²ƒì´ ìˆë‹¤ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ë‹¹ì‹ ì€ ì™„ì „í•œ ì‚¬ëŒì…ë‹ˆë‹¤. ë” ì´ìƒ ìˆ¨ê¸°ì§€ ì•Šì•„ë„ ê´œì°®ì•„ìš”.",
                            love: "ì‚¬ë‘ì— ëŒ€í•œ ìš•ë§ì€ ê±°ìš¸ ì†ì—ì„œ ê°€ì¥ ë°ê²Œ ë¹›ë‚©ë‹ˆë‹¤. ê·¸ê²ƒì€ ì¸ê°„ì˜ ê°€ì¥ ê¸°ë³¸ì ì¸ ìš•êµ¬ì…ë‹ˆë‹¤. ê·¸ ë§ˆìŒì„ ì¸ì •í•˜ëŠ” ê²ƒë¶€í„° ì‹œì‘í•´ë³´ì„¸ìš”.",
                            success: "ì„±ê³µí•˜ê³  ì‹¶ì€ ë§ˆìŒ, ì¸ì •ë°›ê³  ì‹¶ì€ ë§ˆìŒ... ê±°ìš¸ì€ ê·¸ ìš•ë§ ì†ì— ìˆ¨ì€ ë…¸ë ¥í•˜ëŠ” ë‹¹ì‹ ì˜ ëª¨ìŠµì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ê·¸ê²ƒì€ ì¶©ë¶„íˆ ì•„ë¦„ë‹¤ìš´ ìš•ë§ì…ë‹ˆë‹¤.",
                            freedom: "ììœ ë¡­ê³  ì‹¶ë‹¤ëŠ” ìš•ë§ì´ ê±°ìš¸ì— ë¹„ì¹©ë‹ˆë‹¤. ê·¸ ì•ˆì—ëŠ” í˜„ì¬ì˜ ì–µì••ì—ì„œ ë²—ì–´ë‚˜ê³  ì‹¶ì€ ê°„ì ˆí•¨ì´ ìˆì–´ìš”. ê·¸ ë§ˆìŒì„ ë“¤ì–´ì£¼ì„¸ìš”.",
                            control: "í†µì œí•˜ê³  ì‹¶ì€ ìš•ë§... ê±°ìš¸ì€ ê·¸ ì´ë©´ì— ìˆëŠ” ë¶ˆì•ˆí•¨ë„ í•¨ê»˜ ë³´ì—¬ì¤ë‹ˆë‹¤. ë•Œë¡œëŠ” ìš•ë§ ë’¤ì— ìˆ¨ì€ ì§„ì§œ í•„ìš”ë¥¼ ë“¤ì—¬ë‹¤ë³´ëŠ” ê²ƒì´ ì¤‘ìš”í•´ìš”.",
                            revenge: "ë³µìˆ˜í•˜ê³  ì‹¶ì€ ë§ˆìŒì´ ê±°ìš¸ì— ì–´ë‘¡ê²Œ ë¹„ì¹©ë‹ˆë‹¤. ê·¸ ë¶„ë…¸ì™€ ìƒì²˜ë¥¼ ì¸ì •í•˜ë˜, ê·¸ê²ƒì´ ë‹¹ì‹ ì„ ë” ì•„í”„ê²Œ í•˜ì§€ ì•Šê¸°ë¥¼ ë°”ë¼ìš”.",
                            acceptance: "ì¸ì •ë°›ê³  ì‹¶ë‹¤ëŠ” ìš•ë§ì€ ê±°ìš¸ ì†ì—ì„œ ê°€ì¥ ì ˆì ˆí•˜ê²Œ ë³´ì…ë‹ˆë‹¤. ë¨¼ì € ê±°ìš¸ ì† ë‹¹ì‹  ìì‹ ë¶€í„° ì¸ì •í•´ì£¼ëŠ” ê²ƒì€ ì–´ë–¨ê¹Œìš”?",
                            pleasure: "ì¦ê±°ì›€ì„ ì›í•˜ëŠ” ë§ˆìŒ, í¸ì•ˆí•¨ì„ ê°ˆë§í•˜ëŠ” ë§ˆìŒ... ê±°ìš¸ì€ ê·¸ê²ƒì´ ì–¼ë§ˆë‚˜ ì¸ê°„ì ì¸ ìš•êµ¬ì¸ì§€ ë³´ì—¬ì¤ë‹ˆë‹¤. ì£„ì±…ê° ì—†ì´ ë°›ì•„ë“¤ì—¬ë„ ê´œì°®ì•„ìš”.",
                            escape: "ë„ë§ì¹˜ê³  ì‹¶ë‹¤ëŠ” ìš•ë§ì´ ê±°ìš¸ì— í¬ë¯¸í•˜ê²Œ ë– ì˜¤ë¦…ë‹ˆë‹¤. ë•Œë¡œëŠ” ë²—ì–´ë‚˜ê³  ì‹¶ì€ ë§ˆìŒë„ ìš©ê¸°ì˜ ë‹¤ë¥¸ ëª¨ìŠµì¼ ìˆ˜ ìˆì–´ìš”.",
                            general: "ê±°ìš¸ì€ ë‹¹ì‹ ì´ ëŠë¼ëŠ” ëª¨ë“  ìš•ë§ì„ íŒë‹¨ ì—†ì´ ë¹„ì¶°ì¤ë‹ˆë‹¤. ê·¸ ì•ˆì—ì„œ ë‹¹ì‹ ì€ ì™„ì „í•œ ì¸ê°„ìœ¼ë¡œì„œì˜ ìì‹ ì„ ë³¼ ìˆ˜ ìˆì–´ìš”. ìˆ¨ê¸°ì§€ ë§ˆì„¸ìš”."
                        },
                        en: {
                            desire: "The mirror reflects your desires without distortion, just as they are. In it, you can see your true self. Desires are also part of you.",
                            shame: "Look at that desire you feel ashamed of in the mirror. It might actually be more natural and human than you think. Shame is often just society's gaze.",
                            forbidden: "Desires that feel forbidden... But the mirror doesn't judge good and evil. It simply shows the truth. Think again about whether that desire is really wrong.",
                            hidden: "Hidden desires appear faintly even in the mirror. But just having them makes you a complete person. You don't need to hide anymore.",
                            love: "Desires for love shine brightest in the mirror. It's the most basic human need. Start by acknowledging that feeling.",
                            success: "The desire to succeed, to be recognized... The mirror shows you working hard hidden within that desire. That's a beautiful enough desire.",
                            freedom: "The desire to be free is reflected in the mirror. Within it is the desperation to escape current oppression. Listen to that heart.",
                            control: "The desire to control... The mirror also shows the anxiety behind it. Sometimes it's important to look at the real need hidden behind desire.",
                            revenge: "The desire for revenge is darkly reflected in the mirror. Acknowledge that anger and hurt, but I hope it doesn't hurt you more.",
                            acceptance: "The desire to be accepted appears most desperately in the mirror. How about first accepting yourself in the mirror?",
                            pleasure: "The heart wanting pleasure, longing for comfort... The mirror shows how human these desires are. You can accept them without guilt.",
                            escape: "The desire to run away faintly appears in the mirror. Sometimes the desire to escape can be another form of courage.",
                            general: "The mirror reflects all the desires you feel without judgment. In it, you can see yourself as a complete human being. Don't hide."
                        },
                        pt: {
                            desire: "O espelho reflete seus desejos sem distorÃ§Ã£o, exatamente como sÃ£o. Nele, vocÃª pode ver seu verdadeiro eu. Desejos tambÃ©m sÃ£o parte de vocÃª.",
                            shame: "Olhe para esse desejo que vocÃª sente vergonha no espelho. Pode ser na verdade mais natural e humano do que vocÃª pensa. A vergonha Ã© frequentemente apenas o olhar da sociedade.",
                            forbidden: "Desejos que parecem proibidos... Mas o espelho nÃ£o julga o bem e o mal. Simplesmente mostra a verdade. Pense novamente se esse desejo Ã© realmente errado.",
                            hidden: "Desejos ocultos aparecem fracamente atÃ© no espelho. Mas apenas tÃª-los faz de vocÃª uma pessoa completa. VocÃª nÃ£o precisa mais se esconder.",
                            love: "Desejos por amor brilham mais intensamente no espelho. Ã‰ a necessidade humana mais bÃ¡sica. Comece reconhecendo esse sentimento.",
                            success: "O desejo de ter sucesso, ser reconhecido... O espelho mostra vocÃª trabalhando duro escondido dentro desse desejo. Esse Ã© um desejo suficientemente belo.",
                            freedom: "O desejo de ser livre se reflete no espelho. Dentro dele estÃ¡ o desespero de escapar da opressÃ£o atual. Escute esse coraÃ§Ã£o.",
                            control: "O desejo de controlar... O espelho tambÃ©m mostra a ansiedade por trÃ¡s dele. Ã€s vezes Ã© importante olhar para a necessidade real escondida atrÃ¡s do desejo.",
                            revenge: "O desejo de vinganÃ§a se reflete sombriamente no espelho. ReconheÃ§a essa raiva e dor, mas espero que nÃ£o te machuque mais.",
                            acceptance: "O desejo de ser aceito aparece mais desesperadamente no espelho. Que tal primeiro aceitar a si mesmo no espelho?",
                            pleasure: "O coraÃ§Ã£o querendo prazer, ansiando por conforto... O espelho mostra o quÃ£o humanos sÃ£o esses desejos. VocÃª pode aceitÃ¡-los sem culpa.",
                            escape: "O desejo de fugir aparece fracamente no espelho. Ã€s vezes o desejo de escapar pode ser outra forma de coragem.",
                            general: "O espelho reflete todos os desejos que vocÃª sente sem julgamento. Nele, vocÃª pode se ver como um ser humano completo. NÃ£o se esconda."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Compass", emoji: "ğŸ§­",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            desire: "ë‚˜ì¹¨ë°˜ì€ ë‹¹ì‹ ì˜ ìš•ë§ì´ ê°€ë¦¬í‚¤ëŠ” ë°©í–¥ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ê·¸ ë°©í–¥ì´ ì–´ë””ë“ , ê·¸ê²ƒì€ ë‹¹ì‹ ì´ ì§„ì • ê°€ê³  ì‹¶ì–´í•˜ëŠ” ê³³ì…ë‹ˆë‹¤. ìš•ë§ì€ ê¸¸ì„ ìƒì—ˆì„ ë•Œì˜ ì•ˆë‚´ìì…ë‹ˆë‹¤.",
                            shame: "ë¶€ë„ëŸ¬ìš´ ìš•ë§ì´ë¼ê³  í•´ì„œ ë‚˜ì¹¨ë°˜ì´ ê°€ë¦¬í‚¤ëŠ” ë°©í–¥ì´ í‹€ë¦° ê±´ ì•„ë‹™ë‹ˆë‹¤. ë•Œë¡œëŠ” ì‚¬íšŒê°€ ì •í•œ ë°©í–¥ì´ ì•„ë‹Œ, ë‹¹ì‹ ë§Œì˜ ë°©í–¥ì´ í•„ìš”í•  ë•Œê°€ ìˆì–´ìš”.",
                            forbidden: "ê¸ˆì§€ëœ ê²ƒì²˜ëŸ¼ ë³´ì´ëŠ” ìš•ë§... í•˜ì§€ë§Œ ë‚˜ì¹¨ë°˜ì€ ë„ë•ì´ ì•„ë‹Œ ì§„ì‹¤ì„ ê°€ë¦¬í‚µë‹ˆë‹¤. ê·¸ ë°©í–¥ì„ ë”°ë¼ê°€ëŠ” ê²ƒì´ ì •ë§ ì˜ëª»ëœ ì¼ì¸ì§€ ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”.",
                            hidden: "ìˆ¨ê²¨ì§„ ìš•ë§ì€ ë‚˜ì¹¨ë°˜ì˜ ìˆ¨ê²¨ì§„ ë°”ëŠ˜ê³¼ ê°™ìŠµë‹ˆë‹¤. ê²‰ìœ¼ë¡œëŠ” ë³´ì´ì§€ ì•Šì§€ë§Œ ì—¬ì „íˆ ë°©í–¥ì„ ê°€ë¦¬í‚¤ê³  ìˆì–´ìš”. ê·¸ ë°©í–¥ì„ ë¯¿ì–´ë³´ì„¸ìš”.",
                            love: "ì‚¬ë‘ì— ëŒ€í•œ ê°ˆë§ì€ ë‚˜ì¹¨ë°˜ì´ ê°€ë¦¬í‚¤ëŠ” ê°€ì¥ í™•ì‹¤í•œ ë°©í–¥ì…ë‹ˆë‹¤. ê·¸ ë°©í–¥ìœ¼ë¡œ ê°€ëŠ” ê²ƒì„ ë‘ë ¤ì›Œí•˜ì§€ ë§ˆì„¸ìš”. ì‚¬ë‘ì€ ì–¸ì œë‚˜ ì˜³ì€ ë°©í–¥ì…ë‹ˆë‹¤.",
                            success: "ì„±ê³µí•˜ê³  ì‹¶ì€ ìš•ë§ì´ ë‚˜ì¹¨ë°˜ì„ ì›€ì§ì…ë‹ˆë‹¤. ê·¸ê²ƒì€ ë‹¹ì‹ ì´ ì„±ì¥í•˜ê³  ì‹¶ì–´í•˜ëŠ” ë°©í–¥ì„ ê°€ë¦¬ì¼œìš”. ê·¸ ì—´ë§ì„ ë”°ë¼ê°€ëŠ” ê²ƒì€ ìì—°ìŠ¤ëŸ¬ìš´ ì¼ì…ë‹ˆë‹¤.",
                            freedom: "ììœ ë¥¼ í–¥í•œ ìš•ë§ì€ ë‚˜ì¹¨ë°˜ì˜ ê°€ì¥ ê°•ë ¥í•œ ìê¸°ì¥ì…ë‹ˆë‹¤. ê·¸ ë°©í–¥ìœ¼ë¡œ ê°€ëŠ” ê²ƒì€ ë‹¹ì‹ ì˜ ê¶Œë¦¬ì…ë‹ˆë‹¤. ì–µì••ì—ì„œ ë²—ì–´ë‚˜ê³  ì‹¶ì€ ë§ˆìŒì„ ì¸ì •í•˜ì„¸ìš”.",
                            control: "í†µì œí•˜ê³  ì‹¶ì€ ìš•ë§... ë‚˜ì¹¨ë°˜ì€ ê·¸ ë’¤ì— ìˆ¨ì€ ì•ˆì •ì„±ì— ëŒ€í•œ ê°ˆë§ì„ ê°€ë¦¬í‚µë‹ˆë‹¤. ì§„ì • ì›í•˜ëŠ” ê²ƒì´ í†µì œì¸ì§€, ì•ˆì „ì¸ì§€ êµ¬ë¶„í•´ë³´ì„¸ìš”.",
                            revenge: "ë³µìˆ˜í•˜ê³  ì‹¶ì€ ë§ˆìŒì´ ë‚˜ì¹¨ë°˜ì„ ì–´ë‘¡ê²Œ í”ë“­ë‹ˆë‹¤. ê·¸ ë°©í–¥ì´ ì •ë§ ë‹¹ì‹ ì„ ì›í•˜ëŠ” ê³³ìœ¼ë¡œ ë°ë ¤ë‹¤ì¤„ì§€ ì‹ ì¤‘íˆ ìƒê°í•´ë³´ì„¸ìš”.",
                            acceptance: "ì¸ì •ë°›ê³  ì‹¶ë‹¤ëŠ” ìš•ë§ì€ ë‚˜ì¹¨ë°˜ì„ ì‚¬ëŒë“¤ ìª½ìœ¼ë¡œ í–¥í•˜ê²Œ í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ê°€ì¥ ë¨¼ì € ê°€ì•¼ í•  ë°©í–¥ì€ ë‹¹ì‹  ìì‹ ì…ë‹ˆë‹¤.",
                            pleasure: "ì¦ê±°ì›€ì„ ì¶”êµ¬í•˜ëŠ” ìš•ë§ì€ ë‚˜ì¹¨ë°˜ì„ ë°ì€ ë°©í–¥ìœ¼ë¡œ ì´ë•ë‹ˆë‹¤. ê·¸ ë°©í–¥ì„ ë”°ë¼ê°€ëŠ” ê²ƒì€ ì‚¶ì„ ë” í’ìš”ë¡­ê²Œ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”.",
                            escape: "ë„ë§ì¹˜ê³  ì‹¶ì€ ìš•ë§ì€ ë‚˜ì¹¨ë°˜ì„ í˜„ì¬ì™€ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ í–¥í•˜ê²Œ í•©ë‹ˆë‹¤. ë•Œë¡œëŠ” ê·¸ ë°©í–¥ì´ ìƒˆë¡œìš´ ì‹œì‘ì„ ì˜ë¯¸í•  ìˆ˜ë„ ìˆì–´ìš”.",
                            general: "ë‹¹ì‹ ì˜ ìš•ë§ì´ ê°€ë¦¬í‚¤ëŠ” ëª¨ë“  ë°©í–¥ì„ ë‚˜ì¹¨ë°˜ì€ ì •í™•íˆ ë³´ì—¬ì¤ë‹ˆë‹¤. ê·¸ ë°©í–¥ì„ ë”°ë¼ê°€ëŠ” ê²ƒì„ ë‘ë ¤ì›Œí•˜ì§€ ë§ˆì„¸ìš”. ê·¸ê²ƒì´ ë‹¹ì‹ ì˜ ê¸¸ì…ë‹ˆë‹¤."
                        },
                        en: {
                            desire: "The compass shows the direction your desires point to. Wherever that direction is, it's where you truly want to go. Desire is a guide when you're lost.",
                            shame: "Just because it's a shameful desire doesn't mean the direction the compass points is wrong. Sometimes you need your own direction, not one set by society.",
                            forbidden: "Desires that seem forbidden... But the compass points to truth, not morality. Think again about whether following that direction is really wrong.",
                            hidden: "Hidden desires are like hidden needles in a compass. Though not visible on the surface, they still point in a direction. Trust that direction.",
                            love: "Longing for love is the most certain direction the compass points. Don't be afraid to go in that direction. Love is always the right direction.",
                            success: "The desire to succeed moves the compass. It points to the direction you want to grow. Following that aspiration is natural.",
                            freedom: "The desire for freedom is the compass's strongest magnetic field. Going in that direction is your right. Acknowledge your desire to escape oppression.",
                            control: "The desire to control... The compass points to the hidden longing for stability behind it. Distinguish whether what you truly want is control or safety.",
                            revenge: "The desire for revenge darkly shakes the compass. Think carefully whether that direction will really take you where you want to go.",
                            acceptance: "The desire to be accepted points the compass toward people. But the first direction you should go is toward yourself.",
                            pleasure: "The desire to pursue pleasure leads the compass toward bright directions. Following that direction can make life more abundant.",
                            escape: "The desire to run away points the compass in the opposite direction from the present. Sometimes that direction can mean a new beginning.",
                            general: "The compass accurately shows all directions your desires point to. Don't be afraid to follow those directions. That's your path."
                        },
                        pt: {
                            desire: "A bÃºssola mostra a direÃ§Ã£o para onde seus desejos apontam. Onde quer que seja essa direÃ§Ã£o, Ã© para onde vocÃª verdadeiramente quer ir. O desejo Ã© um guia quando vocÃª estÃ¡ perdido.",
                            shame: "SÃ³ porque Ã© um desejo vergonhoso nÃ£o significa que a direÃ§Ã£o que a bÃºssola aponta estÃ¡ errada. Ã€s vezes vocÃª precisa de sua prÃ³pria direÃ§Ã£o, nÃ£o uma definida pela sociedade.",
                            forbidden: "Desejos que parecem proibidos... Mas a bÃºssola aponta para a verdade, nÃ£o para a moralidade. Pense novamente se seguir essa direÃ§Ã£o Ã© realmente errado.",
                            hidden: "Desejos ocultos sÃ£o como agulhas escondidas em uma bÃºssola. Embora nÃ£o visÃ­veis na superfÃ­cie, ainda apontam em uma direÃ§Ã£o. Confie nessa direÃ§Ã£o.",
                            love: "Anseio por amor Ã© a direÃ§Ã£o mais certa que a bÃºssola aponta. NÃ£o tenha medo de ir nessa direÃ§Ã£o. Amor Ã© sempre a direÃ§Ã£o certa.",
                            success: "O desejo de ter sucesso move a bÃºssola. Aponta para a direÃ§Ã£o que vocÃª quer crescer. Seguir essa aspiraÃ§Ã£o Ã© natural.",
                            freedom: "O desejo de liberdade Ã© o campo magnÃ©tico mais forte da bÃºssola. Ir nessa direÃ§Ã£o Ã© seu direito. ReconheÃ§a seu desejo de escapar da opressÃ£o.",
                            control: "O desejo de controlar... A bÃºssola aponta para o anseio oculto por estabilidade por trÃ¡s dele. Distinga se o que vocÃª realmente quer Ã© controle ou seguranÃ§a.",
                            revenge: "O desejo de vinganÃ§a balanÃ§a a bÃºssola sombriamente. Pense cuidadosamente se essa direÃ§Ã£o realmente te levarÃ¡ onde vocÃª quer ir.",
                            acceptance: "O desejo de ser aceito aponta a bÃºssola em direÃ§Ã£o Ã s pessoas. Mas a primeira direÃ§Ã£o que vocÃª deveria ir Ã© em direÃ§Ã£o a si mesmo.",
                            pleasure: "O desejo de buscar prazer leva a bÃºssola em direÃ§Ãµes brilhantes. Seguir essa direÃ§Ã£o pode tornar a vida mais abundante.",
                            escape: "O desejo de fugir aponta a bÃºssola na direÃ§Ã£o oposta ao presente. Ã€s vezes essa direÃ§Ã£o pode significar um novo comeÃ§o.",
                            general: "A bÃºssola mostra com precisÃ£o todas as direÃ§Ãµes para onde seus desejos apontam. NÃ£o tenha medo de seguir essas direÃ§Ãµes. Esse Ã© seu caminho."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Gardener", emoji: "ğŸŒ±",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            desire: "ì •ì›ì‚¬ëŠ” ë‹¹ì‹ ì˜ ìš•ë§ì„ ì”¨ì•—ìœ¼ë¡œ ë´…ë‹ˆë‹¤. ë¬»ì–´ë‘ë©´ ì©ì§€ë§Œ, ì ì ˆí•œ í™˜ê²½ì—ì„œ í‚¤ìš°ë©´ ì•„ë¦„ë‹¤ìš´ ê½ƒì´ ë  ìˆ˜ ìˆì–´ìš”. ê·¸ ìš•ë§ì„ ì–´ë–»ê²Œ í‚¤ì›Œê°ˆì§€ ìƒê°í•´ë³´ì„¸ìš”.",
                            shame: "ë¶€ë„ëŸ¬ìš´ ìš•ë§ë„ ì •ì›ì‚¬ì—ê²ŒëŠ” íŠ¹ë³„í•œ ì”¨ì•—ì…ë‹ˆë‹¤. ê·¸ëŠ˜ì§„ ê³³ì—ì„œë„ ìë„ ìˆ˜ ìˆëŠ” ì‹ë¬¼ë“¤ì´ ìˆë“¯ì´, ê·¸ ìš•ë§ë„ ì¡°ìš©íˆ í‚¤ì›Œê°ˆ ìˆ˜ ìˆì–´ìš”.",
                            forbidden: "ê¸ˆì§€ëœ ê²ƒì²˜ëŸ¼ ë³´ì´ëŠ” ìš•ë§... í•˜ì§€ë§Œ ìì—°ì—ëŠ” ê¸ˆì§€ëœ ì‹ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤. ë‹¤ë§Œ ì–´ë–¤ í™˜ê²½ì—ì„œ í‚¤ìš¸ì§€, ì–´ë–»ê²Œ ëŒë³¼ì§€ê°€ ì¤‘ìš”í•´ìš”.",
                            hidden: "ë•…ì† ê¹Šì´ ë¬»íŒ ì”¨ì•—ì²˜ëŸ¼, ìˆ¨ê²¨ì§„ ìš•ë§ë„ ë•Œê°€ ë˜ë©´ ì‹¹ì„ í‹”ì›ë‹ˆë‹¤. ì–µì§€ë¡œ íŒŒë‚´ë ¤ í•˜ì§€ ë§ê³ , ì¡°ê±´ì´ ë§ì„ ë•Œë¥¼ ê¸°ë‹¤ë ¤ë³´ì„¸ìš”.",
                            love: "ì‚¬ë‘ì— ëŒ€í•œ ìš•ë§ì€ ê°€ì¥ ì•„ë¦„ë‹¤ìš´ ê½ƒì„ í”¼ì›ë‹ˆë‹¤. ë¬¼ê³¼ í–‡ë¹›ë§Œ ì¶©ë¶„íˆ ì£¼ë©´, ì •ì› ì „ì²´ë¥¼ í–¥ê¸°ë¡­ê²Œ ë§Œë“¤ ìˆ˜ ìˆëŠ” ê°•í•œ ìƒëª…ë ¥ì„ ê°€ì§€ê³  ìˆì–´ìš”.",
                            success: "ì„±ê³µí•˜ê³  ì‹¶ì€ ìš•ë§ì€ ë†’ì´ ìë¼ëŠ” ë‚˜ë¬´ì™€ ê°™ìŠµë‹ˆë‹¤. ì¸ë‚´ì‹¬ì„ ê°€ì§€ê³  ê¾¸ì¤€íˆ ëŒë³´ë©´, ì–¸ì  ê°€ëŠ” í° ê·¸ëŠ˜ì„ ë§Œë“¤ì–´ì¤„ ê±°ì˜ˆìš”.",
                            freedom: "ììœ ì— ëŒ€í•œ ê°ˆë§ì€ ë‹´ìŸì´ì²˜ëŸ¼ ë²½ì„ íƒ€ê³  ì˜¬ë¼ê°‘ë‹ˆë‹¤. ì–´ë–¤ ì œì•½ë„ ê²°êµ­ì€ ë„˜ì–´ì„¤ ìˆ˜ ìˆëŠ” ê°•ì¸í•œ ìƒëª…ë ¥ì„ ê°€ì§€ê³  ìˆì–´ìš”.",
                            control: "í†µì œí•˜ê³  ì‹¶ì€ ìš•ë§ì€ ì •ì›ì„ ì§ˆì„œì •ì—°í•˜ê²Œ ë§Œë“¤ê³  ì‹¶ì–´í•˜ëŠ” ë§ˆìŒê³¼ ê°™ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë•Œë¡œëŠ” ìì—°ìŠ¤ëŸ½ê²Œ ìë¼ëŠ” ê²ƒë„ ì•„ë¦„ë‹¤ì›€ì„ ë§Œë“¤ì–´ìš”.",
                            revenge: "ë³µìˆ˜í•˜ê³  ì‹¶ì€ ë§ˆìŒì€ ê°€ì‹œë¤ë¶ˆê³¼ ê°™ìŠµë‹ˆë‹¤. í‚¤ìš°ë©´ ìì‹ ë„ ë‹¤ì¹˜ê²Œ ë©ë‹ˆë‹¤. ê·¸ë³´ë‹¤ëŠ” ì¹˜ìœ í•˜ëŠ” ì‹ë¬¼ë“¤ì„ í‚¤ì›Œë³´ëŠ” ê±´ ì–´ë–¨ê¹Œìš”?",
                            acceptance: "ì¸ì •ë°›ê³  ì‹¶ë‹¤ëŠ” ìš•ë§ì€ í•´ë°”ë¼ê¸°ì™€ ê°™ìŠµë‹ˆë‹¤. í–‡ë¹›ì„ í–¥í•´ ê³ ê°œë¥¼ ëŒë¦¬ì§€ë§Œ, ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€ ìì‹ ì˜ ë¿Œë¦¬ë¥¼ íŠ¼íŠ¼íˆ í•˜ëŠ” ê²ƒì´ì—ìš”.",
                            pleasure: "ì¦ê±°ì›€ì„ ì¶”êµ¬í•˜ëŠ” ìš•ë§ì€ ìƒ‰ìƒ‰ì˜ ê½ƒë“¤ì„ í”¼ìš°ê³  ì‹¶ì–´í•˜ëŠ” ë§ˆìŒì…ë‹ˆë‹¤. ì •ì›ì— ë‹¤ì–‘í•œ ê¸°ì¨ì„ ì‹¬ì–´ë³´ì„¸ìš”. ê·¸ê²ƒì´ ì‚¶ì„ í’ìš”ë¡­ê²Œ ë§Œë“¤ì–´ìš”.",
                            escape: "ë„ë§ì¹˜ê³  ì‹¶ì€ ìš•ë§ì€ ìƒˆë¡œìš´ ë•…ì— ì”¨ì•—ì„ ë¿Œë¦¬ê³  ì‹¶ì–´í•˜ëŠ” ë§ˆìŒì…ë‹ˆë‹¤. ë•Œë¡œëŠ” í™˜ê²½ì„ ë°”ê¾¸ëŠ” ê²ƒì´ ë” ë‚˜ì€ ì„±ì¥ì„ ê°€ì ¸ë‹¤ì¤„ ìˆ˜ ìˆì–´ìš”.",
                            general: "ëª¨ë“  ìš•ë§ì€ ì •ì›ì‚¬ì—ê²Œ ì†Œì¤‘í•œ ì”¨ì•—ì…ë‹ˆë‹¤. ì–´ë–¤ ì”¨ì•—ì´ë“  ì ì ˆí•œ ê´€ì‹¬ê³¼ ëŒë´„ì„ ë°›ìœ¼ë©´ ìƒëª…ì„ í”¼ì›Œë‚¼ ìˆ˜ ìˆì–´ìš”. ë‹¹ì‹ ì˜ ìš•ë§ë„ ë§ˆì°¬ê°€ì§€ì…ë‹ˆë‹¤."
                        },
                        en: {
                            desire: "The gardener sees your desires as seeds. If buried, they rot, but if nurtured in the right environment, they can become beautiful flowers. Think about how to cultivate that desire.",
                            shame: "Shameful desires are also special seeds to the gardener. Just as there are plants that can grow in shade, that desire can also be quietly cultivated.",
                            forbidden: "Desires that seem forbidden... But in nature, there are no forbidden plants. What matters is what environment to grow them in and how to care for them.",
                            hidden: "Like seeds buried deep in the ground, hidden desires will sprout when the time comes. Don't try to forcibly dig them up, wait for when conditions are right.",
                            love: "Desires for love bloom the most beautiful flowers. With enough water and sunlight, they have strong vitality that can make the entire garden fragrant.",
                            success: "The desire to succeed is like a tall-growing tree. With patience and consistent care, it will someday create great shade.",
                            freedom: "Longing for freedom climbs walls like ivy. It has strong vitality that can eventually overcome any constraint.",
                            control: "The desire to control is like wanting to make a garden orderly. But sometimes what grows naturally also creates beauty.",
                            revenge: "The desire for revenge is like thorny bushes. If you cultivate it, you'll hurt yourself too. How about growing healing plants instead?",
                            acceptance: "The desire to be accepted is like a sunflower. It turns toward the sun, but the most important thing is strengthening your own roots.",
                            pleasure: "The desire to pursue pleasure is the heart wanting to bloom colorful flowers. Plant various joys in your garden. That enriches life.",
                            escape: "The desire to run away is the heart wanting to plant seeds in new soil. Sometimes changing environment can bring better growth.",
                            general: "All desires are precious seeds to the gardener. Any seed can bloom life with proper attention and care. Your desires are the same."
                        },
                        pt: {
                            desire: "O jardineiro vÃª seus desejos como sementes. Se enterradas, apodrecem, mas se nutridas no ambiente certo, podem se tornar flores bonitas. Pense em como cultivar esse desejo.",
                            shame: "Desejos vergonhosos tambÃ©m sÃ£o sementes especiais para o jardineiro. Assim como hÃ¡ plantas que podem crescer na sombra, esse desejo tambÃ©m pode ser silenciosamente cultivado.",
                            forbidden: "Desejos que parecem proibidos... Mas na natureza, nÃ£o hÃ¡ plantas proibidas. O que importa Ã© em que ambiente cultivÃ¡-las e como cuidar delas.",
                            hidden: "Como sementes enterradas profundamente no solo, desejos ocultos brotarÃ£o quando chegar a hora. NÃ£o tente forÃ§osamente desenterrÃ¡-los, espere quando as condiÃ§Ãµes estiverem certas.",
                            love: "Desejos por amor florescem as flores mais bonitas. Com Ã¡gua e luz solar suficientes, tÃªm vitalidade forte que pode tornar todo o jardim perfumado.",
                            success: "O desejo de ter sucesso Ã© como uma Ã¡rvore que cresce alta. Com paciÃªncia e cuidado consistente, um dia criarÃ¡ grande sombra.",
                            freedom: "Anseio por liberdade escala paredes como hera. Tem vitalidade forte que pode eventualmente superar qualquer restriÃ§Ã£o.",
                            control: "O desejo de controlar Ã© como querer tornar um jardim ordeiro. Mas Ã s vezes o que cresce naturalmente tambÃ©m cria beleza.",
                            revenge: "O desejo de vinganÃ§a Ã© como arbustos espinhosos. Se vocÃª cultivÃ¡-lo, tambÃ©m se machucarÃ¡. Que tal cultivar plantas curativas em vez disso?",
                            acceptance: "O desejo de ser aceito Ã© como um girassol. Vira-se para o sol, mas o mais importante Ã© fortalecer suas prÃ³prias raÃ­zes.",
                            pleasure: "O desejo de buscar prazer Ã© o coraÃ§Ã£o querendo florescer flores coloridas. Plante vÃ¡rias alegrias em seu jardim. Isso enriquece a vida.",
                            escape: "O desejo de fugir Ã© o coraÃ§Ã£o querendo plantar sementes em novo solo. Ã€s vezes mudar de ambiente pode trazer melhor crescimento.",
                            general: "Todos os desejos sÃ£o sementes preciosas para o jardineiro. Qualquer semente pode florescer vida com atenÃ§Ã£o e cuidado adequados. Seus desejos sÃ£o iguais."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            }
        ];
        
        let currentLanguage = 'en'; // ê¸°ë³¸ ì–¸ì–´ë¥¼ ì˜ì–´ë¡œ ì„¤ì •
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        // ============ ì—¬ì • ì´ˆê¸°í™” í•¨ìˆ˜ ============
        
        function resetJourney() {
            console.log('=== ì—¬ì • ì´ˆê¸°í™” ì‹œì‘ ===');
            
            // 1. ëª¨ë“  íƒ€ì´í•‘ íš¨ê³¼ ì™„ì „ ì •ë¦¬
            clearAllTypingEffects();
            
            // ì¶”ê°€ ì•ˆì „ì¥ì¹˜ - ëª¨ë“  timer ì •ë¦¬
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            
            // 2. ëª¨ë“  ì½˜í…ì¸  ì„¹ì…˜ ì™„ì „ ì´ˆê¸°í™”
            const sectionsToReset = [
                'portalIntroSection',
                'characterResponsesSection', 
                'lightMessageSection',
                'portalQuestionSection',
                'userInputSection',
                'userReactionsSection',
                'continueSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    } else {
                        const textElements = section.querySelectorAll('.portal-intro, .light-message, .portal-question, .continue-text');
                        textElements.forEach(el => {
                            el.innerHTML = '';
                            el.textContent = '';
                        });
                    }
                }
            });
            
            // 3. íŠ¹ì • ìš”ì†Œë“¤ ê°œë³„ ì´ˆê¸°í™”
            const portalIntro = document.getElementById('portalIntro');
            const lightMessage = document.getElementById('lightMessage');
            const portalQuestion = document.getElementById('portalQuestion');
            const continueText = document.getElementById('continueText');
            
            if (portalIntro) portalIntro.innerHTML = '';
            if (lightMessage) lightMessage.innerHTML = '';
            if (portalQuestion) portalQuestion.innerHTML = '';
            if (continueText) continueText.innerHTML = '';
            
            // 4. í…ìŠ¤íŠ¸ì˜ì—­ ì™„ì „ ì´ˆê¸°í™”
            const userTextarea = document.getElementById('userTextarea');
            if (userTextarea) {
                userTextarea.disabled = false;
                userTextarea.value = '';
                userTextarea.style.height = 'auto';
                userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            }
            
            // 5. ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì´ˆê¸°í™”
            const mainContent = document.getElementById('mainContent');
            if (mainContent) {
                mainContent.scrollTop = 0;
            }
            
            // 6. ìƒíƒœ ë³€ìˆ˜ ì™„ì „ ì´ˆê¸°í™”
            userResponse = '';
            currentTypingElement = null;
            
            console.log('=== ì—¬ì • ì´ˆê¸°í™” ì™„ë£Œ ===');
        }
        
        // ============ ê°œì„ ëœ ì–¸ì–´ ë³€ê²½ í•¨ìˆ˜ ============
        
        function changeLanguage(lang) {
            if (!translations[lang]) {
                console.error('ì§€ì›í•˜ì§€ ì•ŠëŠ” ì–¸ì–´:', lang);
                return;
            }
            
            if (currentLanguage === lang) {
                return;
            }
            
            if (journeyStarted) {
                const confirmMessage = translations[currentLanguage].languageChangeConfirm;
                const shouldRestart = confirm(confirmMessage);
                
                if (!shouldRestart) {
                    return;
                }
            }
            
            const previousLanguage = currentLanguage;
            currentLanguage = lang;
            
            console.log(`ì–¸ì–´ ë³€ê²½: ${previousLanguage} â†’ ${currentLanguage}`);
            
            if (journeyStarted) {
                resetJourney();
            }
            
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                setTimeout(() => {
                    console.log(`ìƒˆë¡œìš´ ì–¸ì–´(${currentLanguage})ë¡œ ì—¬ì • ì¬ì‹œì‘`);
                    startPortalSequence();
                }, 1000);
            }
        }
        
        // ============ UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤ ============
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            // ê°œë³„ ìš”ì†Œ ì—…ë°ì´íŠ¸
            const elements = [
                'logoSubtitle',
                'portalMainTitle', 
                'portalSubtitle',
                'lightTitle',
                'continueYesBtn',
                'continueNoBtn'
            ];
            
            elements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element && translations[lang]) {
                    const key = elementId.replace('Btn', 'Button').replace('Subtitle', 'Subtitle');
                    let translationKey = key;
                    
                    const keyMapping = {
                        'logoSubtitle': 'logoSubtitle',
                        'portalMainTitle': 'portalMainTitle',
                        'portalSubtitle': 'portalSubtitle',
                        'lightTitle': 'lightTitle',
                        'continueYesButton': 'continueYes',
                        'continueNoButton': 'continueNo'
                    };
                    
                    translationKey = keyMapping[key] || key;
                    
                    if (translations[lang][translationKey]) {
                        element.textContent = translations[lang][translationKey];
                    }
                }
            });
            
            // placeholder ì—…ë°ì´íŠ¸
            const textarea = document.getElementById('userTextarea');
            if (textarea) textarea.placeholder = translations[lang].inputPlaceholder;
        }
        
        // ============ ê°œì„ ëœ íƒ€ì´í•‘ íš¨ê³¼ + ìŠ¤í¬ë¡¤ ì¶”ì  ì‹œìŠ¤í…œ ============
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i % 10 === 0) {
                        scrollToFollowTyping(element);
                    }
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        
                        setTimeout(() => {
                            if (document.contains(element)) {
                                scrollToFollowTyping(element);
                            }
                        }, 200);
                        
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        // ============ ìŠ¤ë§ˆíŠ¸ ìŠ¤í¬ë¡¤ ì‹œìŠ¤í…œ ============
        
        function scrollToFollowTyping(element) {
            const mainContent = document.getElementById('mainContent');
            const elementRect = element.getBoundingClientRect();
            const containerRect = mainContent.getBoundingClientRect();
            
            if (elementRect.bottom > containerRect.bottom - 150) {
                const scrollTop = mainContent.scrollTop;
                const elementOffsetTop = element.offsetTop;
                const targetScroll = elementOffsetTop - (containerRect.height / 2);
                
                mainContent.scrollTo({
                    top: Math.max(0, targetScroll),
                    behavior: 'smooth'
                });
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        // ============ ì–¸ì–´ ë²„íŠ¼ ì´ë²¤íŠ¸ ì„¤ì • ============
        
        function setupLanguageButtons() {
            const langButtons = document.querySelectorAll('.lang-btn');
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const newLang = this.dataset.lang;
                    changeLanguage(newLang);
                });
            });
        }
        
        // ============ ë©”ì¸ ì—¬ì • ì‹œìŠ¤í…œ ============
        
        function initializeTemarix() {
            console.log('=== Temarix Portal 14 ì´ˆê¸°í™” ì‹œì‘ ===');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        // ============ ì—¬ì • ë‹¨ê³„ë“¤ ============
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            const introText = translations[currentLanguage].portalIntro;
            await typewriterEffect(introElement, introText, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const dialogueText = translations[currentLanguage][char.key];
                await typewriterEffect(dialogueDiv, dialogueText, 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            const lightText = translations[currentLanguage].lightMessage;
            await typewriterEffect(lightMessageEl, lightText, 60);
            
            setTimeout(() => {
                showQuestion();
            }, 2000);
        }
        
        async function showQuestion() {
            const questionSection = document.getElementById('portalQuestionSection');
            const questionEl = document.getElementById('portalQuestion');
            
            questionSection.classList.add('show');
            
            const questionText = translations[currentLanguage].portalQuestion;
            await typewriterEffect(questionEl, questionText, 50);
            
            setTimeout(() => {
                enableUserInput();
            }, 1500);
        }
        
        // ============ ì‚¬ìš©ì ì…ë ¥ ì‹œìŠ¤í…œ ============
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', handleTextareaKeydown);
            
            document.getElementById('continueYesBtn').addEventListener('click', function() {
                processContinue('Y');
            });
            
            document.getElementById('continueNoBtn').addEventListener('click', function() {
                processContinue('N');
            });
        }
        
        function handleTextareaKeydown(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                const inputValue = this.value.trim();
                
                if (inputValue) {
                    processUserInput(inputValue);
                }
            }
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                showUserReactions(inputText);
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = `<strong>${youLabel}:</strong> "${text}"`;
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showContinueOption();
            }, 2000);
        }
        
        async function showContinueOption() {
            const continueSection = document.getElementById('continueSection');
            const continueText = document.getElementById('continueText');
            
            continueSection.classList.add('show');
            
            const questionText = translations[currentLanguage].continueText;
            await typewriterEffect(continueText, questionText, 50);
            
            setTimeout(() => {
                scrollToElement(continueSection);
            }, 500);
        }
        
        function processContinue(input) {
            if (input === 'Y') {
                const message = currentLanguage === 'ko' ? 
                    'Portal 15ê°€ ê³§ ì¤€ë¹„ë©ë‹ˆë‹¤. ê³„ì†í•´ì„œ ë” ê¹Šì€ ê°ì •ì˜ ì—¬ì •ì´ ì´ì–´ì§‘ë‹ˆë‹¤.' :
                    currentLanguage === 'en' ? 
                    'Portal 15 will be ready soon. The journey into deeper emotions continues.' :
                    'Portal 15 estarÃ¡ pronto em breve. A jornada para emoÃ§Ãµes mais profundas continua.';
                alert(message);
            } else if (input === 'N') {
                const message = currentLanguage === 'ko' ? 
                    'ì—¬ì •ì´ ì¼ì‹œ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì–¸ì œë“  ë‹¤ì‹œ ëŒì•„ì™€ ê³„ì†í•˜ì„¸ìš”.' :
                    currentLanguage === 'en' ? 
                    'The journey has been paused. Come back and continue anytime.' :
                    'A jornada foi pausada. Volte e continue a qualquer momento.';
                alert(message);
            }
        }
        
        // ============ ì´ˆê¸°í™” ============
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V2 Portal 14 DOM ë¡œë“œ ì™„ë£Œ');
            
            // ìë™ ë¡œê·¸ì¸ ì²˜ë¦¬ (ë¡œê·¸ì¸ ëª¨ë‹¬ ì œê±°)
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            memoryStorage.mockUser = currentUser;
            
            updateStaticTranslations(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>