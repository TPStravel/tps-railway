<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 18: When Your Heart Feels Completely Stopped</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #87cefa;
            color: #000;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            background: none;
            border: none;
            padding: 0;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            background: none;
            border: none;
            padding: 0;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #87cefa;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #87cefa;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            background: none;
            border: none;
            padding: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #87cefa;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .portal-question-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            background: none;
            border: none;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #87cefa;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .continue-section {
            margin: 50px 0;
            opacity: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 0;
            min-height: 200px;
        }
        
        .continue-text {
            color: #fff;
            font-size: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .continue-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .continue-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .continue-btn:hover {
            background: #666;
        }
        
        .continue-btn.primary {
            background: #87cefa;
            color: #000;
        }
        
        .continue-btn.primary:hover {
            background: #b0d4f1;
        }
        
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #87cefa;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #87cefa;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        .hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .continue-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .continue-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">The Tremor of Emotion</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 18: When Your Heart Feels Completely Stopped</div>
            <div class="portal-subtitle" id="portalSubtitle">Finding new breath within numbness</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <div class="portal-question-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>
            
            <div class="continue-section" id="continueSection">
                <div class="continue-text" id="continueText"></div>
                <div class="continue-buttons">
                    <button class="continue-btn primary" id="continueYesBtn">Continue to Portal 19</button>
                    <button class="continue-btn" id="continueNoBtn">Pause the journey</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Tell me what you're feeling right now..."
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        let memoryStorage = { mockUser: null };

        const translations = {
            ko: {
                logoSubtitle: "Í∞êÏ†ïÏùò Îñ®Î¶º",
                portalMainTitle: "Portal 18: ÎßàÏùåÏù¥ Î©àÏ∂∞Î≤ÑÎ¶∞ Í≤É Í∞ôÏùÄ ÎÇ†",
                portalSubtitle: "Î¨¥Í∏∞Î†• ÏÜçÏóêÏÑú Ï∞æÎäî ÏÉàÎ°úÏö¥ Ïà®Í≤∞",
                portalIntro: "Ïñ¥Îñ§ ÎÇ†ÏùÄ ÏõÉÍ≥† Ïö∏Í≥† ÌôîÎÇ¥Îäî Í≤ÉÏ°∞Ï∞® Í∑ÄÏ∞ÆÏïÑÏßëÎãàÎã§. ÏïÑÎ¨¥ Í∞êÏ†ïÎèÑ ÎäêÍª¥ÏßÄÏßÄ ÏïäÍ≥† Í∑∏Ï†Ä Î¨¥Í∏∞Î†•Ìïú Ïπ®Î¨µ ÏÜçÏóêÏÑú ÌïòÎ£®Í∞Ä ÌùêÎ¶ÖÎãàÎã§. Î¨¥Ïñ∏Í∞Ä ÏûòÎ™ªÎêú Í≤ÉÎèÑ ÏïÑÌîà Í≤ÉÎèÑ ÏïÑÎãåÎç∞ Í∑∏Ï†Ä ÏÇ¥ÏïÑ ÏûàÎã§Îäî ÎäêÎÇåÏ°∞Ï∞® ÏóÜÎäî ÎÇ†. Í∑∏ÎÇ† ÎãπÏã†Ïùò ÎßàÏùåÏùÄ Ïñ¥ÎîîÏóê Î®∏Î¨ºÎü¨ ÏûàÏóàÎÇòÏöî?",
                lightTitle: "ÎπõÏùò ÌïúÎßàÎîî",
                lightMessage: "Í∞êÏ†ïÏù¥ Î©àÏ∑ÑÎã§Îäî Í±¥ ÎãπÏã†Ïù¥ ÎÑàÎ¨¥ Ïò§Îûò ÌùîÎì§Î†§ÏôîÎã§Îäî ÎúªÏùºÏßÄÎèÑ Î™®Î¶ÖÎãàÎã§. Ïû†Ïãú Î©àÏ∂ò ÎßàÏùåÎèÑ ÏÇ¥ÏïÑ ÏûàÍ∏∞Ïóê Í∞ÄÎä•Ìïú Í≤ÉÏûÖÎãàÎã§.",
                portalQuestion: "ÎãπÏã†ÏùÄ Ïñ∏Ï†ú 'ÎßàÏùåÏù¥ ÌÖÖ ÎπÑÏñ¥Î≤ÑÎ¶∞ Í≤É Í∞ôÎã§'Í≥† ÎäêÍºàÎÇòÏöî?",
                continueText: "Ïù¥ Í≥†ÏöîÌï®Í≥º Ìï®Íªò Í∞êÏ†ïÏùò ÌöåÎ≥µÏùÑ ÏúÑÌïú Îã§Ïùå Ïó¨Ï†ïÏùÑ Í≥ÑÏÜçÌïòÏãúÍ≤†ÏäµÎãàÍπå?",
                continueYes: "Portal 19Î°ú Í≥ÑÏÜçÌïòÍ∏∞",
                continueNo: "Ïó¨Ï†ïÏùÑ ÏùºÏãúÏ†ïÏßÄÌïòÍ∏∞",
                inputPlaceholder: "ÏßÄÍ∏à Ïù¥ ÏàúÍ∞Ñ ÎäêÎÅºÎäî Í≤ÉÏùÑ ÎßêÌï¥Ï£ºÏÑ∏Ïöî...",
                youLabel: "ÎãπÏã†",
                waitingMessage: "ÏùëÎãµÏùÑ Í∏∞Îã§Î¶¨Îäî Ï§ë...",
                charEly: "ÎßàÏùåÏù¥ Î©àÏ∂ò Í≤ÉÏùÄ ÎãπÏã†Ïù¥ Î©àÏ∂îÍ≥† Ïã∂ÏóàÎçò Ï†àÎ∞ïÌïú Ïã†Ìò∏ÏòÄÏùÑÏßÄÎèÑ Î™®Î¶ÖÎãàÎã§.",
                charCris: "ÏßÑÏßú Î¨¥ÏÑúÏö¥ Í±¥ ÏïÑÎ¨¥ Í∞êÏ†ïÎèÑ Ïïà ÎäêÍª¥Ïßà ÎïåÏòàÏöî. Í∑ºÎç∞ Í∑∏ ÏïàÏóê Ïà®Ïñ¥ ÏûàÎäî Í∞êÏ†ïÎèÑ Íº≠ ÏûàÏñ¥Ïöî.",
                charZafirah: "ÎãπÏã†Ïù¥ Î©àÏ∂ò Í≤å ÏïÑÎãàÎùº Í∞êÏ†ïÏù¥ ÎßêÌï† ÌûòÏùÑ Ïû†Ïãú ÏûÉÏóàÏùÑ ÎøêÏù¥ÏóêÏöî.",
                charRami: "Í∞êÏ†ïÏùÄ ÌùêÎ¶ÑÏù¥ Î©àÏ∂ú Îïå ÍπäÏùÄ Í∞êÏ†ïÏ∏µ ÏïÑÎûòÎ°ú ÎÇ¥Î†§Í∞ëÎãàÎã§.",
                charSamir: "Í∑∏Îäî Î©àÏ∂∞ ÏÑ† ÏãúÍ≥Ñ ÏúÑÏóê ÏÜêÏùÑ ÏñπÍ≥† Í∞ÄÎßåÌûà Í∏∞Îã§Î¶ΩÎãàÎã§.",
                charLayla: "ÎÇòÎäî ÎãπÏã†Ïù¥ ÏïÑÎ¨¥ Í∞êÏ†ïÎèÑ ÎäêÍª¥ÏßÄÏßÄ ÏïäÎäî Í∑∏ ÏÉÅÌÉúÎèÑ ÏÜåÏ§ëÌïú Í∞êÏ†ïÏùò ÏùºÎ∂ÄÎ°ú Î∞õÏïÑÎì§Ïùº Ïàò ÏûàÏñ¥Ïöî.",
                charNabir: "Ìïò ÎìúÎîîÏñ¥ Í∞êÏ†ïÎèÑ Í≥†Ïû•ÎÇ¨ÎÇò Î≥¥ÏßÄ? Ïù¥Ï†† ÏïÑÎ¨¥ ÎäêÎÇåÎèÑ Ïïà ÎÇòÎãàÍπå Ï∞∏ Ìé∏ÌïòÍ≤†ÎÑ§.",
                charAzhar: "Î©àÏ∂ò Í±∞ÏßÄ? Ï¢ãÏïÑ. Í∑∏ ÏÉÅÌÉúÍ∞Ä Í≥ÑÏÜçÎêòÎ©¥ ÎÑà Ïä§Ïä§Î°ú ÏÇ¨ÎùºÏßÄÎäî Í±¥ ÏãúÍ∞ÑÎ¨∏Ï†úÏïº."
            },
            en: {
                logoSubtitle: "The Tremor of Emotion",
                portalMainTitle: "Portal 18: When Your Heart Feels Completely Stopped",
                portalSubtitle: "Finding new breath within numbness",
                portalIntro: "Some days even laughing crying or getting angry feels tiresome. You feel no emotions at all and the day just passes in powerless silence. Nothing is wrong nothing hurts but you don't even feel alive. On that day where did your heart stay?",
                lightTitle: "Word of Light",
                lightMessage: "When emotions stop it might mean you've been shaken for too long. Even a paused heart is possible because it's alive.",
                portalQuestion: "When did you feel like your heart was completely empty?",
                continueText: "Would you like to continue the next journey for emotional recovery with this quietude?",
                continueYes: "Continue to Portal 19",
                continueNo: "Pause the journey",
                inputPlaceholder: "Tell me what you're feeling right now...",
                youLabel: "You",
                waitingMessage: "Waiting for response...",
                charEly: "Your heart stopping might have been a desperate signal that you wanted to stop.",
                charCris: "What's really scary is when you feel no emotions at all. But there are definitely emotions hiding inside.",
                charZafirah: "You didn't stop emotions just temporarily lost their voice.",
                charRami: "When emotions stop flowing they go down to deep emotional layers.",
                charSamir: "He places his hand on a stopped clock and waits quietly.",
                charLayla: "I can accept that state where you feel no emotions as a precious part of emotions too.",
                charNabir: "Ha finally your emotions broke down too? Now that you feel nothing it must be quite comfortable.",
                charAzhar: "You stopped? Good. If that state continues it's only a matter of time before you disappear yourself."
            },
            pt: {
                logoSubtitle: "O Tremor da Emocao",
                portalMainTitle: "Portal 18: Quando Seu Coracao Parece Completamente Parado",
                portalSubtitle: "Encontrando nova respiracao dentro do entorpecimento",
                portalIntro: "Alguns dias ate rir chorar ou se irritar parece cansativo. Voce nao sente nenhuma emocao e o dia apenas passa em silencio impotente. Nada esta errado nada doi mas voce nem se sente vivo. Naquele dia onde seu coracao ficou?",
                lightTitle: "Palavra de Luz",
                lightMessage: "Quando as emocoes param pode significar que voce foi abalado por muito tempo. Ate um coracao pausado e possivel porque esta vivo.",
                portalQuestion: "Quando voce sentiu que seu coracao estava completamente vazio?",
                continueText: "Gostaria de continuar a proxima jornada para recuperacao emocional com essa quietude?",
                continueYes: "Continuar para o Portal 19",
                continueNo: "Pausar a jornada",
                inputPlaceholder: "Me diga o que esta sentindo agora...",
                youLabel: "Voce",
                waitingMessage: "Aguardando resposta...",
                charEly: "Seu coracao parar pode ter sido um sinal desesperado de que voce queria parar.",
                charCris: "O que e realmente assustador e quando voce nao sente nenhuma emocao. Mas definitivamente ha emocoes se escondendo dentro.",
                charZafirah: "Voce nao parou as emocoes apenas perderam temporariamente sua voz.",
                charRami: "Quando as emocoes param de fluir elas descem para camadas emocionais profundas.",
                charSamir: "Ele coloca a mao em um relogio parado e espera silenciosamente.",
                charLayla: "Posso aceitar esse estado onde voce nao sente emocoes como parte preciosa das emocoes tambem.",
                charNabir: "Ha finalmente suas emocoes quebraram tambem? Agora que voce nao sente nada deve ser bem confortavel.",
                charAzhar: "Voce parou? Bom. Se esse estado continuar e apenas questao de tempo antes de voce desaparecer."
            }
        };
        
        const characters = [
            { name: "Ely", emoji: "üëë", key: "charEly" },
            { name: "Cris", emoji: "üÉè", key: "charCris" },
            { name: "Zafirah", emoji: "üßï", key: "charZafirah" },
            { name: "Rami", emoji: "üîÆ", key: "charRami" },
            { name: "Samir", emoji: "üê™", key: "charSamir" },
            { name: "Layla", emoji: "üí†", key: "charLayla" },
            { name: "Nabir", emoji: "ü¶Ç", key: "charNabir" },
            { name: "Azhar", emoji: "üî•", key: "charAzhar" }
        ];
        
        function analyzeEmotion(userInput) {
            const input = userInput.toLowerCase();
            const emotionKeywords = {
                numbness: ['Î¨¥Í∞êÍ∞Å', 'ÏïÑÎ¨¥Í≤ÉÎèÑ', 'ÎäêÍª¥ÏßÄÏßÄ', 'Î¨¥Í∏∞Î†•', 'Î©àÏ∂ò', 'numb', 'nothing', 'feel nothing', 'entorpecido', 'nada'],
                emptiness: ['Í≥µÌóà', 'ÌÖÖ Îπà', 'ÎπÑÏñ¥', 'ÌóàÎ¨¥', 'empty', 'void', 'hollow', 'vazio', 'oco'],
                exhaustion: ['ÏßÄÏ≥§', 'ÌîºÍ≥§', 'Í∏∞Î†•', 'ÌûòÏóÜ', 'tired', 'exhausted', 'drained', 'cansado', 'exausto']
            };
            
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                for (const keyword of keywords) {
                    if (input.includes(keyword)) {
                        return emotion;
                    }
                }
            }
            return 'general';
        }
        
        const responseCharacters = [
            {
                name: "Silence", emoji: "ü§´",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "Î¨¥Í∞êÍ∞ÅÌïú Ïπ®Î¨µÎèÑ ÌïòÎÇòÏùò Ïñ∏Ïñ¥ÏòàÏöî. ÎïåÎ°úÎäî Ïπ®Î¨µÏù¥ Í∞ÄÏû• ÏôÑÎ≤ΩÌïú ÌëúÌòÑÏù¥ÏóêÏöî.",
                        en: "Numb silence is also a language. Sometimes silence is the most perfect expression.",
                        pt: "Silencio entorpecido tambem e uma linguagem. As vezes silencio e a expressao mais perfeita."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Pause", emoji: "‚è∏Ô∏è",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÏùºÏãúÏ†ïÏßÄÎèÑ ÌïÑÏöîÌï¥Ïöî. Ïù∏ÏÉùÏóêÎèÑ ÏùºÏãúÏ†ïÏßÄ Î≤ÑÌäºÏù¥ ÏûàÏñ¥Ïöî. ÎãπÏã†Ïùò ÏÜçÎèÑÎ°ú ÏÇ¥ÏïÑÍ∞ÄÏÑ∏Ïöî.",
                        en: "Pause is necessary too. Life has a pause button too. Live at your own pace.",
                        pt: "Pausa tambem e necessaria. A vida tambem tem botao de pausa. Viva no seu proprio ritmo."
                    };
                    return responses[lang];
                }
            },
            {
                name: "Space", emoji: "üåå",
                getResponse: (userInput, lang) => {
                    const responses = {
                        ko: "ÎãπÏã†ÏùÄ Ïö∞Ï£ºÏùò ÏùºÎ∂ÄÏòàÏöî. Í¥ëÎåÄÌïú Ïö∞Ï£º ÏÜç ÏûëÏùÄ Ï°¥Ïû¨Ïù¥ÏßÄÎßå Í∑∏ ÏûêÏ≤¥Î°ú Í∏∞Ï†ÅÏù¥ÏóêÏöî.",
                        en: "You are part of the universe. A small existence in the vast cosmos but a miracle in itself.",
                        pt: "Voce e parte do universo. Uma pequena existencia no vasto cosmos mas um milagre em si."
                    };
                    return responses[lang];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        function resetJourney() {
            clearAllTypingEffects();
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'lightMessageSection', 'portalQuestionSection',
                'userInputSection', 'userReactionsSection', 'continueSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            const portalIntro = document.getElementById('portalIntro');
            const lightMessage = document.getElementById('lightMessage');
            const portalQuestion = document.getElementById('portalQuestion');
            const continueText = document.getElementById('continueText');
            
            if (portalIntro) portalIntro.innerHTML = '';
            if (lightMessage) lightMessage.innerHTML = '';
            if (portalQuestion) portalQuestion.innerHTML = '';
            if (continueText) continueText.innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            if (userTextarea) {
                userTextarea.disabled = false;
                userTextarea.value = '';
                userTextarea.style.height = 'auto';
                userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            }
            
            const mainContent = document.getElementById('mainContent');
            if (mainContent) {
                mainContent.scrollTop = 0;
            }
            
            userResponse = '';
            currentTypingElement = null;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            const previousLanguage = currentLanguage;
            currentLanguage = lang;
            
            if (journeyStarted) {
                resetJourney();
            }
            
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            const elements = ['logoSubtitle', 'portalMainTitle', 'portalSubtitle', 'lightTitle', 'continueYesBtn', 'continueNoBtn'];
            
            elements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element && translations[lang]) {
                    const keyMapping = {
                        'logoSubtitle': 'logoSubtitle',
                        'portalMainTitle': 'portalMainTitle',
                        'portalSubtitle': 'portalSubtitle',
                        'lightTitle': 'lightTitle',
                        'continueYesBtn': 'continueYes',
                        'continueNoBtn': 'continueNo'
                    };
                    
                    const translationKey = keyMapping[elementId] || elementId;
                    
                    if (translations[lang][translationKey]) {
                        element.textContent = translations[lang][translationKey];
                    }
                }
            });
            
            const textarea = document.getElementById('userTextarea');
            if (textarea) textarea.placeholder = translations[lang].inputPlaceholder;
        }
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i % 10 === 0) {
                        scrollToFollowTyping(element);
                    }
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        
                        setTimeout(() => {
                            if (document.contains(element)) {
                                scrollToFollowTyping(element);
                            }
                        }, 200);
                        
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToFollowTyping(element) {
            const mainContent = document.getElementById('mainContent');
            const elementRect = element.getBoundingClientRect();
            const containerRect = mainContent.getBoundingClientRect();
            
            if (elementRect.bottom > containerRect.bottom - 150) {
                const scrollTop = mainContent.scrollTop;
                const elementOffsetTop = element.offsetTop;
                const targetScroll = elementOffsetTop - (containerRect.height / 2);
                
                mainContent.scrollTo({
                    top: Math.max(0, targetScroll),
                    behavior: 'smooth'
                });
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function setupLanguageButtons() {
            const langButtons = document.querySelectorAll('.lang-btn');
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const newLang = this.dataset.lang;
                    changeLanguage(newLang);
                });
            });
        }
        
        function initializeTemarix() {
            console.log('=== Temarix Portal 18 Ï¥àÍ∏∞Ìôî ÏãúÏûë ===');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            const introText = translations[currentLanguage].portalIntro;
            await typewriterEffect(introElement, introText, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const dialogueText = translations[currentLanguage][char.key];
                await typewriterEffect(dialogueDiv, dialogueText, 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            const lightText = translations[currentLanguage].lightMessage;
            await typewriterEffect(lightMessageEl, lightText, 60);
            
            setTimeout(() => {
                showQuestion();
            }, 2000);
        }
        
        async function showQuestion() {
            const questionSection = document.getElementById('portalQuestionSection');
            const questionEl = document.getElementById('portalQuestion');
            
            questionSection.classList.add('show');
            
            const questionText = translations[currentLanguage].portalQuestion;
            await typewriterEffect(questionEl, questionText, 50);
            
            setTimeout(() => {
                enableUserInput();
            }, 1500);
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', handleTextareaKeydown);
            
            document.getElementById('continueYesBtn').addEventListener('click', function() {
                processContinue('Y');
            });
            
            document.getElementById('continueNoBtn').addEventListener('click', function() {
                processContinue('N');
            });
        }
        
        function handleTextareaKeydown(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                const inputValue = this.value.trim();
                
                if (inputValue) {
                    processUserInput(inputValue);
                }
            }
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                showUserReactions(inputText);
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showContinueOption();
            }, 2000);
        }
        
        async function showContinueOption() {
            const continueSection = document.getElementById('continueSection');
            const continueText = document.getElementById('continueText');
            
            continueSection.classList.add('show');
            
            const questionText = translations[currentLanguage].continueText;
            await typewriterEffect(continueText, questionText, 50);
            
            setTimeout(() => {
                scrollToElement(continueSection);
            }, 500);
        }
        
        function processContinue(input) {
            if (input === 'Y') {
                const message = currentLanguage === 'ko' ? 
                    'Portal 19Í∞Ä Í≥ß Ï§ÄÎπÑÎê©ÎãàÎã§. Í≥ÑÏÜçÌï¥ÏÑú Îçî ÍπäÏùÄ Í∞êÏ†ïÏùò Ïó¨Ï†ïÏù¥ Ïù¥Ïñ¥ÏßëÎãàÎã§.' :
                    currentLanguage === 'en' ? 
                    'Portal 19 will be ready soon. The journey into deeper emotions continues.' :
                    'Portal 19 estara pronto em breve. A jornada para emocoes mais profundas continua.';
                alert(message);
            } else if (input === 'N') {
                const message = currentLanguage === 'ko' ? 
                    'Ïó¨Ï†ïÏù¥ ÏùºÏãú Ï§ëÏßÄÎêòÏóàÏäµÎãàÎã§. Ïñ∏Ï†úÎì† Îã§Ïãú ÎèåÏïÑÏôÄ Í≥ÑÏÜçÌïòÏÑ∏Ïöî.' :
                    currentLanguage === 'en' ? 
                    'The journey has been paused. Come back and continue anytime.' :
                    'A jornada foi pausada. Volte e continue a qualquer momento.';
                alert(message);
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V2 Portal 18 DOM Î°úÎìú ÏôÑÎ£å');
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            memoryStorage.mockUser = currentUser;
            
            updateStaticTranslations(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>