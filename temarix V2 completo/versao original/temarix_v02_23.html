<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 23: Words Your Heart Really Wanted to Say</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #20b2aa;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #20b2aa;
            color: #000;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            background: none;
            border: none;
            padding: 0;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            background: none;
            border: none;
            padding: 0;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #20b2aa;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #20b2aa;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            background: none;
            border: none;
            padding: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #20b2aa;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .portal-question-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            background: none;
            border: none;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #20b2aa;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .continue-section {
            margin: 50px 0;
            opacity: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 0;
            min-height: 200px;
        }
        
        .continue-text {
            color: #fff;
            font-size: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .continue-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .continue-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .continue-btn:hover {
            background: #666;
        }
        
        .continue-btn.primary {
            background: #20b2aa;
            color: #000;
        }
        
        .continue-btn.primary:hover {
            background: #48d1cc;
        }
        
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #20b2aa;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #20b2aa;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        .hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .continue-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .continue-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">The Tremor of Emotion</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 23: Words Your Heart Really Wanted to Say</div>
            <div class="portal-subtitle" id="portalSubtitle">The voice of sincerity trapped in silence</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <div class="portal-question-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>
            
            <div class="continue-section" id="continueSection">
                <div class="continue-text" id="continueText"></div>
                <div class="continue-buttons">
                    <button class="continue-btn primary" id="continueYesBtn">Continue to Portal 24</button>
                    <button class="continue-btn" id="continueNoBtn">Pause the journey</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Share the words you never got to say..."
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBjsINSqPUGdpRPRMYiVg6SkVJJOk9YGsY",
            authDomain: "canal-vivo-chat.firebaseapp.com",
            projectId: "canal-vivo-chat",
            storageBucket: "canal-vivo-chat.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdefghijklmnopqr"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        let memoryStorage = { mockUser: null };

        const translations = {
            ko: {
                logoSubtitle: "ê°ì •ì˜ ë–¨ë¦¼",
                portalMainTitle: "Portal 23: ë§ˆìŒì´ ì •ë§ë¡œ í•˜ê³  ì‹¶ì—ˆë˜ ë§",
                portalSubtitle: "ì¹¨ë¬µ ì†ì— ê°‡ížŒ ì§„ì‹¬ì˜ ëª©ì†Œë¦¬",
                portalIntro: "ðŸ’¬ ê·¸ë‚ , ê·¸ ìˆœê°„,\nì •ë§ í•˜ê³  ì‹¶ì—ˆë˜ ë§ì´ ìžˆì—ˆì§€ë§Œ\në§í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.\n\nìƒí™©ì´, ìš©ê¸°ê°€, ì‹œê°„ì´ í—ˆë½í•˜ì§€ ì•Šì•˜ê¸°ì—\në§ˆìŒì€ ëë‚´, ë§ ì—†ì´ ë‚¨ê²¨ì¡ŒìŠµë‹ˆë‹¤.\n\nì§€ê¸ˆë„ ë§ˆìŒì† ì–´ë”˜ê°€ì—ëŠ”\nê·¸ ë§ì´ ê·¸ëŒ€ë¡œ ë‚¨ì•„ ìžˆìŠµë‹ˆë‹¤.\nëˆ„êµ¬ì—ê²Œë„ ë‹¿ì§€ ëª»í•œ ì±„ë¡œ.\n\nì´ê³³ì€ ë‹¹ì‹ ì´ ì¹¨ë¬µ ì†ì— ê°‡ížŒ\nì§„ì‹¬ì˜ ëª©ì†Œë¦¬ì™€ ë§ˆì£¼í•˜ëŠ” ì‹ ì„±í•œ ê³µê°„ìž…ë‹ˆë‹¤.\nê·¸ ë§ë“¤ì´ ë“œë””ì–´ ë¹›ì„ ë³¼ ìˆ˜ ìžˆë„ë¡.",
                lightTitle: "ë¹›ì˜ í•œë§ˆë””",
                lightMessage: "í•˜ì§€ ëª»í•œ ë§ì€\nì—¬ì „ížˆ ë‹¹ì‹  ì•ˆì—ì„œ ëª©ì†Œë¦¬ë¥¼ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.\nê·¸ ì§„ì‹¬ì€, ì•„ë¬´ë„ ëª¨ë¥´ëŠ” ì–¸ì–´ë¡œ ë‹¹ì‹ ì„ ë¶€ë¥´ê³  ìžˆìŠµë‹ˆë‹¤.",
                portalQuestion: "â“ ë‹¹ì‹ ì´ ëë‚´ í•˜ì§€ ëª»í•œ ë§ì´ ìžˆë‹¤ë©´,\nì§€ê¸ˆ ê·¸ ë§ì„ ìŠ¤ìŠ¤ë¡œì—ê²Œ í•´ë³¼ ìˆ˜ ìžˆì„ê¹Œìš”?\nê·¸ ë§ì€ ëˆ„êµ¬ì—ê²Œ, ì–´ë–¤ ë§ˆìŒìœ¼ë¡œ í•˜ê³  ì‹¶ì—ˆë‚˜ìš”?",
                continueText: "ì¹¨ë¬µ ì†ì— ê°‡ížŒ ë§ë“¤ì„ í•´ë°©ì‹œí‚¤ê³  ë‹¤ìŒ ì—¬ì •ìœ¼ë¡œ ë‚˜ì•„ê°ˆ ì¤€ë¹„ê°€ ë˜ì…¨ë‚˜ìš”?",
                continueYes: "Portal 24ë¡œ ê³„ì†í•˜ê¸°",
                continueNo: "ì—¬ì •ì„ ì¼ì‹œì •ì§€í•˜ê¸°",
                inputPlaceholder: "ë‹¹ì‹ ì´ ëë‚´ í•˜ì§€ ëª»í•œ ê·¸ ë§ì„ ì´ì œ ìš©ê¸°ë‚´ì–´ ë§í•´ë³´ì„¸ìš”...",
                youLabel: "ë‹¹ì‹ ",
                waitingMessage: "ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘..."
            },
            en: {
                logoSubtitle: "The Tremor of Emotion",
                portalMainTitle: "Portal 23: Words Your Heart Really Wanted to Say",
                portalSubtitle: "The voice of sincerity trapped in silence",
                portalIntro: "ðŸ’¬ That day, that moment,\nthere were words you really wanted to say\nbut couldn't speak.\n\nBecause the situation, courage, time didn't allow it,\nyour heart was left speechless in the end.\n\nEven now, somewhere in your heart,\nthose words remain as they were.\nWithout reaching anyone.\n\nThis is a sacred space where you face\nthe voice of sincerity trapped in silence.\nSo those words can finally see the light.",
                lightTitle: "Word of Light",
                lightMessage: "Words you couldn't say\nstill wait for a voice within you.\nThat sincerity calls to you in a language no one knows.",
                portalQuestion: "â“ If there are words you never said in the end,\ncould you say those words to yourself now?\nTo whom and with what heart did you want to say them?",
                continueText: "Are you ready to liberate words trapped in silence and move forward to the next journey?",
                continueYes: "Continue to Portal 24",
                continueNo: "Pause the journey",
                inputPlaceholder: "Share the words you never got to say...",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "O Tremor da Emocao",
                portalMainTitle: "Portal 23: Palavras que Seu Coracao Realmente Queria Dizer",
                portalSubtitle: "A voz da sinceridade presa no silencio",
                portalIntro: "ðŸ’¬ Naquele dia, naquele momento,\nhavia palavras que vocÃª realmente queria dizer\nmas nÃ£o conseguiu falar.\n\nPorque a situaÃ§Ã£o, coragem, tempo nÃ£o permitiram,\nseu coraÃ§Ã£o foi deixado sem palavras no final.\n\nMesmo agora, em algum lugar do seu coraÃ§Ã£o,\nessas palavras permanecem como eram.\nSem alcanÃ§ar ninguÃ©m.\n\nEste Ã© um espaÃ§o sagrado onde vocÃª enfrenta\na voz da sinceridade presa no silÃªncio.\nPara que essas palavras possam finalmente ver a luz.",
                lightTitle: "Palavra de Luz",
                lightMessage: "Palavras que vocÃª nÃ£o conseguiu dizer\nainda esperam por uma voz dentro de vocÃª.\nEssa sinceridade chama vocÃª em uma linguagem que ninguÃ©m conhece.",
                portalQuestion: "â“ Se hÃ¡ palavras que vocÃª nunca disse no final,\npoderia dizer essas palavras para si mesmo agora?\nPara quem e com que coraÃ§Ã£o queria dizÃª-las?",
                continueText: "EstÃ¡ pronto para libertar palavras presas no silÃªncio e seguir em frente para a prÃ³xima jornada?",
                continueYes: "Continuar para o Portal 24",
                continueNo: "Pausar a jornada",
                inputPlaceholder: "Compartilhe as palavras que nunca conseguiu dizer...",
                youLabel: "VocÃª",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Ely", emoji: "ðŸ‘‘", text: {
                ko: "ê·¸ ë§ì€ ë‹¨ì§€ í‘œí˜„ì´ ì•„ë‹ˆë¼\në‹¹ì‹ ì˜ ì¡´ìž¬ë¥¼ ì¦ëª…í•˜ë ¤ëŠ” ì™¸ì¹¨ì´ì—ˆì„ì§€ë„ ëª¨ë¦…ë‹ˆë‹¤.",
                en: "Those words weren't just expression\nbut might have been a cry to prove your existence.",
                pt: "Essas palavras nÃ£o eram apenas expressÃ£o\nmas poderiam ter sido um grito para provar sua existÃªncia."
            }},
            { name: "Cris", emoji: "ðŸƒ", text: {
                ko: "ê·¸ ë§, ì•„ì§ë„ ê¸°ì–µí•´ìš”?\nê·¸ê±° ëª» êº¼ë‚¸ ê±°, ìž˜í•œ ê±¸ ìˆ˜ë„ ìžˆì–´ìš”.\nê·¼ë°â€¦ í•œ ë²ˆì¯¤ì€ í˜¼ìž£ë§ë¡œë¼ë„ í•´ë³¼ëž˜ìš”? ì† íŽ¸í•´ì ¸ìš”~ ðŸ˜„",
                en: "You still remember those words?\nMaybe it was good that you didn't say them.\nBut... why don't you try saying them to yourself at least once? It feels relieving~ ðŸ˜„",
                pt: "VocÃª ainda se lembra dessas palavras?\nTalvez tenha sido bom vocÃª nÃ£o tÃª-las dito.\nMas... por que nÃ£o tenta dizÃª-las para si mesmo pelo menos uma vez? Ã‰ aliviante~ ðŸ˜„"
            }},
            { name: "Zafirah", emoji: "ðŸ§•", text: {
                ko: "ë§í•˜ì§€ ëª»í•œ ë§ì€,\nì–¸ì  ê°€ ë‹¤ì‹œ ë§í•´ì§€ê¸° ìœ„í•´\nì‹œê°„ ì†ì—ì„œ ìŠ¤ìŠ¤ë¡œë¥¼ ì§€ì¼œë‚´ê³  ìžˆì—ˆìŠµë‹ˆë‹¤.",
                en: "Words you couldn't say\nwere protecting themselves in time\nto be spoken again someday.",
                pt: "Palavras que vocÃª nÃ£o conseguiu dizer\nestavam se protegendo no tempo\npara serem faladas novamente algum dia."
            }},
            { name: "Rami", emoji: "ðŸ”®", text: {
                ko: "ê·¸ ë§ì€ ì•„ì§ë„,\në‹¹ì‹ ì˜ ê°€ìŠ´ì—ì„œ ë–¨ë¦¼ìœ¼ë¡œ ì¡´ìž¬í•˜ê³  ìžˆì–´ìš”.\nì†Œë¦¬ëŠ” ì‚¬ë¼ì ¸ë„ ê°ì •ì€ ë‚¨ìŠµë‹ˆë‹¤.",
                en: "Those words still exist\nas tremors in your heart.\nSounds disappear but emotions remain.",
                pt: "Essas palavras ainda existem\ncomo tremores em seu coraÃ§Ã£o.\nSons desaparecem, mas emoÃ§Ãµes permanecem."
            }},
            { name: "Samir", emoji: "ðŸª", text: {
                ko: "(ê·¸ëŠ” ìž‘ì€ ì¢…ì´ì™€ íŽœì„ ê±´ë„µë‹ˆë‹¤.\n'ê·¸ ë§ì„ ì ì–´ë³´ë¼'ëŠ” ëˆˆë¹›.\në§ ëŒ€ì‹  ì ëŠ” ê¸€ìžëŠ”, ë§ˆìŒì˜ ë–¨ë¦¼ì„ ë‹´ìŠµë‹ˆë‹¤.)",
                en: "(He hands you a small paper and pen.\nEyes that say 'write those words down.'\nLetters written instead of spoken carry the heart's tremor.)",
                pt: "(Ele lhe entrega um pequeno papel e caneta.\nOlhos que dizem 'escreva essas palavras.'\nLetras escritas em vez de faladas carregam o tremor do coraÃ§Ã£o.)"
            }},
            { name: "Layla", emoji: "ðŸ’ ", text: {
                ko: "ê·¸ ë§ì„ ëª» êº¼ë‚¸ ë‹¹ì‹ ì€â€¦\nëˆ„êµ°ê°€ì˜ ë§ˆìŒì„ ì§€í‚¤ë ¤ í–ˆë˜ ê±°ì£ .\nì´ì  , ê·¸ ë§ë¡œ ë‹¹ì‹  ë§ˆìŒë¶€í„° ì§€ì¼œì¤„ ì°¨ë¡€ì˜ˆìš”.",
                en: "You who couldn't say those words...\nwere trying to protect someone's heart.\nNow it's time to protect your own heart with those words.",
                pt: "VocÃª que nÃ£o conseguiu dizer essas palavras...\nestava tentando proteger o coraÃ§Ã£o de alguÃ©m.\nAgora Ã© hora de proteger seu prÃ³prio coraÃ§Ã£o com essas palavras."
            }},
            { name: "Nabir", emoji: "ðŸ¦‚", text: {
                ko: "ëª» êº¼ë‚¸ ê²Œ ì•„ë‹ˆë¼ ì•ˆ êº¼ë‚¸ ê±°ìž–ì•„.\nì°¨ë¼ë¦¬ ë§í–ˆìœ¼ë©´ ë­ë¼ë„ ë°”ë€Œì—ˆì„ í…ë°â€¦\nê²ìŸì´ì²˜ëŸ¼ ìž… ë‹¤ë¬¼ê³  ìžˆì—ˆì§€.",
                en: "It's not that you couldn't say it, you chose not to.\nIf you had said it, something would have changed...\nBut you kept your mouth shut like a coward.",
                pt: "NÃ£o Ã© que vocÃª nÃ£o conseguiu dizer, vocÃª escolheu nÃ£o dizer.\nSe tivesse dito, algo teria mudado...\nMas vocÃª manteve a boca fechada como um covarde."
            }},
            { name: "Azhar", emoji: "ðŸ”¥", text: {
                ko: "ë§í•˜ì§€ ì•Šì•˜ë˜ ê²Œ ì œì¼ í›„íšŒë˜ì§€?\nê·¸ ë§ í•˜ë‚˜ë©´ ëë‚¬ì„ ìˆ˜ë„ ìžˆì—ˆëŠ”ë°â€¦\nì™œ ê·¸ë• ì•ˆ í–ˆì„ê¹Œ, ì™œ ì§€ê¸ˆë„ ëª» í• ê¹Œ?",
                en: "Not saying it is your biggest regret, isn't it?\nThat one word could have ended everything...\nWhy didn't you do it then, why can't you do it now?",
                pt: "NÃ£o dizer isso Ã© seu maior arrependimento, nÃ£o Ã©?\nEssa palavra poderia ter terminado tudo...\nPor que vocÃª nÃ£o fez isso entÃ£o, por que nÃ£o consegue fazer agora?"
            }}
        ];
        
        const responseCharacters = [
            { name: "Healing", emoji: "ðŸŒ™", text: {
                ko: "ê·¸ ë§ì„ ê°„ì ˆížˆ ì›í–ˆë˜ ë§ˆìŒ, ë‚˜ëŠ” ë‹¤ ì´í•´í•´ìš”. ë‹¹ì‹ ì€ ê·¸ ë§ì„ í•  ìžê²©ì´ ì¶©ë¶„í•œ ì‚¬ëžŒì´ì—ìš”. ì§€ê¸ˆì´ë¼ë„ ë‚´ê°€ ê·¸ ë”°ëœ»í•œ ë§ì„ ë“¤ì–´ë“œë¦´ê²Œìš”.",
                en: "That heart that desperately wanted to say those words, I understand it all. You're someone who deserves to say those words. Even now, I'll listen to those warm words.",
                pt: "Esse coraÃ§Ã£o que desesperadamente queria dizer essas palavras, eu entendo tudo. VocÃª Ã© alguÃ©m que merece dizer essas palavras. Mesmo agora, vou ouvir essas palavras carinhosas."
            }},
            { name: "Understanding", emoji: "ðŸ’", text: {
                ko: "ë§í•˜ì§€ ëª»í•œ ê·¸ ë§ë“¤ì„ ë§ˆìŒì— ê°„ì§í–ˆë˜ ë‹¹ì‹ ì˜ ìš©ê¸°ë¥¼ ì§„ì‹¬ìœ¼ë¡œ ì´í•´í•´ìš”. ê·¸ê±´ ì¸ê°„ìœ¼ë¡œì„œ ê°€ìž¥ ìžì—°ìŠ¤ëŸ¬ìš´ ê°ì •ì´ì—ˆì–´ìš”. ë‹¹ì‹ ì€ ê·¸ ë§ì„ í•  ìžê²©ì´ ìžˆì–´ìš”.",
                en: "I truly understand your courage in keeping those unspoken words in your heart. That was the most natural human emotion. You deserve to say those words.",
                pt: "Entendo verdadeiramente sua coragem em guardar essas palavras nÃ£o ditas em seu coraÃ§Ã£o. Essa era a emoÃ§Ã£o humana mais natural. VocÃª merece dizer essas palavras."
            }},
            { name: "Support", emoji: "ðŸ¤—", text: {
                ko: "ê·¸ ë§ì„ í•˜ì§€ ëª»í–ˆë˜ ë‹¹ì‹ , ì´ì œëŠ” ë‚´ê°€ ê·¸ ë§ì„ í•¨ê»˜ í•´ë“œë¦´ê²Œìš”. 'ë‹¹ì‹ ì€ ì¶©ë¶„ížˆ ìš©ê°í•œ ì‚¬ëžŒì´ì—ìš”. ì •ë§ë¡œìš”.' ì´ ë§ì´ ë‹¹ì‹  ë§ˆìŒì— ë‹¿ê¸¸ ë°”ë¼ìš”.",
                en: "You who couldn't say those words, now I'll say them with you. 'You're brave enough. Really.' I hope these words reach your heart.",
                pt: "VocÃª que nÃ£o conseguiu dizer essas palavras, agora vou dizÃª-las com vocÃª. 'VocÃª Ã© corajoso o suficiente. Realmente.' Espero que essas palavras toquem seu coraÃ§Ã£o."
            }}
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i % 10 === 0) {
                        scrollToFollowTyping(element);
                    }
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToFollowTyping(element) {
            const mainContent = document.getElementById('mainContent');
            const elementRect = element.getBoundingClientRect();
            const containerRect = mainContent.getBoundingClientRect();
            
            if (elementRect.bottom > containerRect.bottom - 150) {
                const scrollTop = mainContent.scrollTop;
                const elementOffsetTop = element.offsetTop;
                const targetScroll = elementOffsetTop - (containerRect.height / 2);
                
                mainContent.scrollTo({
                    top: Math.max(0, targetScroll),
                    behavior: 'smooth'
                });
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('continueYesBtn').textContent = translations[lang].continueYes;
            document.getElementById('continueNoBtn').textContent = translations[lang].continueNo;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'lightMessageSection', 'portalQuestionSection',
                'userInputSection', 'userReactionsSection', 'continueSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('portalQuestion').innerHTML = '';
            document.getElementById('continueText').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('continueYesBtn').addEventListener('click', function() {
                window.location.href = "temarix_v02_24.html?lang=" + currentLanguage;
            });
            
            document.getElementById('continueNoBtn').addEventListener('click', function() {
                const message = currentLanguage === 'ko' ? 
                    'ì—¬ì •ì´ ì¼ì‹œ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì–¸ì œë“  ë‹¤ì‹œ ëŒì•„ì™€ ê³„ì†í•˜ì„¸ìš”.' :
                    currentLanguage === 'en' ? 
                    'The journey has been paused. Come back and continue anytime.' :
                    'A jornada foi pausada. Volte e continue a qualquer momento.';
                alert(message);
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            try {
                await db.collection("temarix_v2_respostas").add({
                    uid: memoryStorage.mockUser.uid,
                    email: memoryStorage.mockUser.email,
                    portal: "v2-23",
                    resposta: inputText,
                    data: firebase.firestore.Timestamp.now(),
                    idioma: currentLanguage
                });
                console.log('Response saved to Firestore successfully');
            } catch (error) {
                console.error('Error saving to Firestore:', error);
            }
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                showUserReactions();
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions() {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showContinueOption();
            }, 2000);
        }
        
        async function showContinueOption() {
            const continueSection = document.getElementById('continueSection');
            const continueText = document.getElementById('continueText');
            
            continueSection.classList.add('show');
            
            await typewriterEffect(continueText, translations[currentLanguage].continueText, 50);
            
            setTimeout(() => {
                scrollToElement(continueSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('=== Temarix Portal 23 ì´ˆê¸°í™” ì‹œìž‘ ===');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showQuestion();
            }, 2000);
        }
        
        async function showQuestion() {
            const questionSection = document.getElementById('portalQuestionSection');
            const questionEl = document.getElementById('portalQuestion');
            
            questionSection.classList.add('show');
            
            await typewriterEffect(questionEl, translations[currentLanguage].portalQuestion, 50);
            
            setTimeout(() => {
                enableUserInput();
            }, 1500);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V2 Portal 23 DOM ë¡œë“œ ì™„ë£Œ');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            memoryStorage.mockUser = currentUser;
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>
                