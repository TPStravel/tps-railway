<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 20: The Weight of Endurance</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ff6b6b;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #ff6b6b;
            color: #000;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            background: none;
            border: none;
            padding: 0;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            background: none;
            border: none;
            padding: 0;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #ff6b6b;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            background: none;
            border: none;
            padding: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #ff6b6b;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .portal-question-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            background: none;
            border: none;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #ff6b6b;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .continue-section {
            margin: 50px 0;
            opacity: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 0;
            min-height: 200px;
        }
        
        .continue-text {
            color: #fff;
            font-size: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .continue-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .continue-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .continue-btn:hover {
            background: #666;
        }
        
        .continue-btn.primary {
            background: #ff6b6b;
            color: #000;
        }
        
        .continue-btn.primary:hover {
            background: #ff8a8a;
        }
        
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #ff6b6b;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #ff6b6b;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        .hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .continue-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .continue-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">The Tremor of Emotion</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 20: The Weight of Endurance</div>
            <div class="portal-subtitle" id="portalSubtitle">Where suppressed anger awakens</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <div class="portal-question-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>
            
            <div class="continue-section" id="continueSection">
                <div class="continue-text" id="continueText"></div>
                <div class="continue-buttons">
                    <button class="continue-btn primary" id="continueYesBtn">Continue to Portal 21</button>
                    <button class="continue-btn" id="continueNoBtn">Pause the journey</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Courageously release the emotions you've endured..."
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        let memoryStorage = { mockUser: null };

        const translations = {
            ko: {
                logoSubtitle: "ê°ì •ì˜ ë–¨ë¦¼",
                portalMainTitle: "Portal 20: ì°¸ìŒì˜ ë¬´ê²Œ",
                portalSubtitle: "ì–µëˆŒë¦° ë¶„ë…¸ê°€ ê¹¨ì–´ë‚˜ëŠ” ê³³",
                portalIntro: "í•­ìƒ ë‚´ê°€ ë¨¼ì € ì–‘ë³´í–ˆê³ , í•­ìƒ ë‚´ê°€ ì¡°ìš©íˆ ë„˜ê²¼ê³ , í•­ìƒ ë‚´ê°€ í˜¼ìì„œ ì°¸ì•˜ìŠµë‹ˆë‹¤.\n\nê·¸ëŸ¬ë©´ì„œë„ ë§ˆìŒ í•œì¼ ì—” 'ì™œ ë‚˜ë§Œ ê·¸ë˜ì•¼ í•˜ì§€?' 'ì™œ ëŠ˜ ë‚˜ë§Œ ë” ì°¸ì•„ì•¼ í•˜ì§€?'ë¼ëŠ” ì‘ì€ ë¶„ë…¸ê°€ ìë¼ë‚˜ê³  ìˆì—ˆì£ .\n\nì§€ê¸ˆ, ê·¸ ê°ì •ì€ ì–´ë–¤ ì´ë¦„ìœ¼ë¡œ ë‚¨ì•„ ìˆë‚˜ìš”?\n\nì´ê³³ì€ ë‹¹ì‹ ì´ ì˜¤ë«ë™ì•ˆ ì–µëˆŒëŸ¬ì˜¨ ë¶ˆê³µì •í•¨ì— ëŒ€í•œ ë¶„ë…¸ì™€ ë§ˆì£¼í•˜ëŠ” ì‹ ì„±í•œ ê³µê°„ì…ë‹ˆë‹¤. ì°¸ëŠ” ê²ƒì´ ë¯¸ë•ì´ë¼ê³  ë°°ì› ì§€ë§Œ, ë•Œë¡œëŠ” ë¶„ë…¸í•  ê¶Œë¦¬ë„ í•„ìš”í•©ë‹ˆë‹¤.",
                lightTitle: "ë¹›ì˜ í•œë§ˆë””",
                lightMessage: "ë‹¹ì‹ ì´ ì°¸ì•„ì˜¨ ê²ƒë“¤ì—” ì¹¨ë¬µ ëŒ€ì‹  ë§í•  ìˆ˜ ìˆëŠ” ì´ë¦„ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ì œëŠ” ê°ì •ì„ êº¼ë‚´ì–´ ë§í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.",
                portalQuestion: "ë‹¹ì‹ ì€ ëˆ„êµ¬ ì•ì—ì„œ ê°€ì¥ ì˜¤ë˜, ê°€ì¥ ë§ì´ ì°¸ì•„ì•¼ í–ˆë‚˜ìš”? ê·¸ë•Œì˜ ê°ì •ì„ ì§€ê¸ˆ ì´ë¦„ì„ ë¶™ì—¬ì¤€ë‹¤ë©´?",
                continueText: "ì°¸ìŒì˜ ë¬´ê²Œë¥¼ ëœì–´ë‚´ê³  ë‹¤ìŒ ì—¬ì •ìœ¼ë¡œ ë‚˜ì•„ê°ˆ ì¤€ë¹„ê°€ ë˜ì…¨ë‚˜ìš”?",
                continueYes: "Portal 21ë¡œ ê³„ì†í•˜ê¸°",
                continueNo: "ì—¬ì •ì„ ì¼ì‹œì •ì§€í•˜ê¸°",
                inputPlaceholder: "ì°¸ì•„ì˜¨ ê°ì •ì„ ìš©ê¸° ìˆê²Œ êº¼ë‚´ë³´ì„¸ìš”...",
                youLabel: "ë‹¹ì‹ ",
                waitingMessage: "ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...",
                charEly: "ë‹¹ì‹ ì´ ì°¸ì•„ì˜¨ ê±´ ì•½í•´ì„œê°€ ì•„ë‹ˆë¼, ê´€ê³„ë¥¼ ì§€í‚¤ê³  ì‹¶ì—ˆë˜ ì‚¬ë‘ì˜ ì„ íƒì´ì—ˆì–´ìš”.",
                charCris: "ê·¸ê±°â€¦ 'ê´œì°®ì€ ì‚¬ëŒì´ ë˜ê³  ì‹¶ì€ ë§ˆìŒ'ì—ì„œ ë‚˜ì˜¨ ê±°ì£ . ê·¼ë° ì†”ì§íˆ ë§í•´ì„œ, ë„ˆë¬´ ì˜¤ë˜ ì°¸ìœ¼ë©´ íƒˆë‚˜ìš”! ğŸ˜£",
                charZafirah: "ë‹¹ì‹ ì´ ì°¸ì•„ì•¼ í–ˆë˜ ê±´ ê·¸ ìƒí™©ì˜ ë¬¸ì œë³´ë‹¤ë„ ìŠ¤ìŠ¤ë¡œë¥¼ ì‘ê²Œ ë§Œë“  ì˜¤ë˜ëœ ê¸°ì–µ ë•Œë¬¸ì¼ì§€ë„ ëª°ë¼ìš”.",
                charRami: "ê°ì •ì€ 'ê³µì •í•˜ì§€ ì•Šì€ êµ¬ì¡°'ì—ì„œ í•­ìƒ ë” ì•½í•œ ìª½ì— ë” í° ì¹¨ë¬µì„ ìš”êµ¬í•©ë‹ˆë‹¤. ë‹¹ì‹ ì€ ê·¸ ì¹¨ë¬µì„ ë„ˆë¬´ ì˜¤ë˜ ê°ë‹¹í•´ì™”ì–´ìš”.",
                charSamir: "ê·¸ëŠ” ë°”ë‹¥ì„ ê°€ë¦¬í‚µë‹ˆë‹¤. ë‹¹ì‹ ì´ ëˆŒëŸ¬ì˜¨ ìë¦¬ë¥¼. ê·¸ê³³ì—ì„œ ì²œì²œíˆ í•œ ì†¡ì´ì˜ ê½ƒì´ ìë¼ê³  ìˆìŠµë‹ˆë‹¤.",
                charLayla: "ë‚˜ëŠ” ì´ì œ ë‹¹ì‹ ì´ ë” ì´ìƒ ì°¸ì§€ ì•Šì•„ë„ ë˜ëŠ” ì„¸ìƒì„ í•¨ê»˜ ë§Œë“¤ê³  ì‹¶ì–´ìš”.",
                charNabir: "ê·¸ë˜. ë„ˆë§Œ ì°¸ì•˜ì§€. ê·¼ë° ì´ì œ ì™€ì„œ ë¶ˆë§Œ ìˆì–´? ê·¸ë• ë§ë„ ëª» í•˜ë”ë‹ˆ, ì§€ê¸ˆ ì™€ì„œ ë­ ì–´ì©Œê² ë‹¤ê³ ?",
                charAzhar: "ì°¸ì•˜ë‹¤ê³ ? ê·¸ëŸ¼ í„°ëœ¨ë ¤! ì§€ê¸ˆ ê·¸ê±° ì•ˆ êº¼ë‚´ë©´ í‰ìƒ ë„¤ ì†ì—ì„œ ì©ëŠ”ë‹¤."
            },
            en: {
                logoSubtitle: "The Tremor of Emotion",
                portalMainTitle: "Portal 20: The Weight of Endurance",
                portalSubtitle: "Where suppressed anger awakens",
                portalIntro: "You were always the first to compromise, always the one to quietly let things go, always the one to endure alone.\n\nYet somewhere in your heart, 'Why must it always be me?' 'Why do I always have to endure more?' a small anger has been growing.\n\nNow, what name does that emotion carry?\n\nThis is a sacred space where you face the anger about injustice you've long suppressed. You learned that endurance is a virtue, but sometimes you also need the right to be angry.",
                lightTitle: "Word of Light",
                lightMessage: "The things you've endured need names that can be spoken instead of silence. Now it's time to bring out emotions and speak them.",
                portalQuestion: "Before whom did you have to endure the longest and the most? If you could name that emotion now?",
                continueText: "Are you ready to release the weight of endurance and move forward to the next journey?",
                continueYes: "Continue to Portal 21",
                continueNo: "Pause the journey",
                inputPlaceholder: "Courageously release the emotions you've endured...",
                youLabel: "You",
                waitingMessage: "Waiting for response...",
                charEly: "What you've endured wasn't because of weakness, but a loving choice to protect relationships.",
                charCris: "That came from 'wanting to be a good person.' But honestly, enduring too long can break you! ğŸ˜£",
                charZafirah: "Your need to endure might have been due to old memories that made you small, more than the situation itself.",
                charRami: "In 'unfair structures,' emotions always demand greater silence from the weaker side. You've borne that silence for too long.",
                charSamir: "He points to the ground. The place where you've been pressed down. A flower is slowly growing there.",
                charLayla: "I want to create a world with you where you no longer have to endure.",
                charNabir: "Yes, only you endured. But are you complaining now? You couldn't speak then, what will you do now?",
                charAzhar: "You endured? Then explode! If you don't release it now, it'll rot inside you forever."
            },
            pt: {
                logoSubtitle: "O Tremor da Emocao",
                portalMainTitle: "Portal 20: O Peso da Resistencia",
                portalSubtitle: "Onde a raiva suprimida desperta",
                portalIntro: "VocÃª sempre foi o primeiro a ceder, sempre aquele que deixou as coisas passarem quietamente, sempre aquele que suportou sozinho.\n\nMas em algum lugar do seu coraÃ§Ã£o, 'Por que sempre tenho que ser eu?' 'Por que sempre tenho que suportar mais?' uma pequena raiva tem crescido.\n\nAgora, que nome essa emoÃ§Ã£o carrega?\n\nEste Ã© um espaÃ§o sagrado onde vocÃª enfrenta a raiva sobre injustiÃ§as que suprimiu por muito tempo. VocÃª aprendeu que resistir Ã© uma virtude, mas Ã s vezes tambÃ©m precisa do direito de ficar bravo.",
                lightTitle: "Palavra de Luz",
                lightMessage: "As coisas que vocÃª suportou precisam de nomes que possam ser falados em vez de silÃªncio. Agora Ã© hora de trazer emoÃ§Ãµes e expressÃ¡-las.",
                portalQuestion: "Diante de quem vocÃª teve que suportar por mais tempo e mais? Se pudesse nomear essa emoÃ§Ã£o agora?",
                continueText: "EstÃ¡ pronto para liberar o peso da resistÃªncia e seguir em frente para a prÃ³xima jornada?",
                continueYes: "Continuar para o Portal 21",
                continueNo: "Pausar a jornada",
                inputPlaceholder: "Libere corajosamente as emoÃ§Ãµes que suportou...",
                youLabel: "VocÃª",
                waitingMessage: "Aguardando resposta...",
                charEly: "O que vocÃª suportou nÃ£o foi por fraqueza, mas uma escolha amorosa para proteger relacionamentos.",
                charCris: "Isso veio de 'querer ser uma boa pessoa.' Mas honestamente, suportar demais pode quebrar vocÃª! ğŸ˜£",
                charZafirah: "Sua necessidade de suportar pode ter sido devido a memÃ³rias antigas que te fizeram pequeno, mais que a situaÃ§Ã£o em si.",
                charRami: "Em 'estruturas injustas,' emoÃ§Ãµes sempre exigem maior silÃªncio do lado mais fraco. VocÃª carregou esse silÃªncio por muito tempo.",
                charSamir: "Ele aponta para o chÃ£o. O lugar onde vocÃª foi pressionado. Uma flor estÃ¡ crescendo lentamente ali.",
                charLayla: "Quero criar um mundo com vocÃª onde nÃ£o precise mais suportar.",
                charNabir: "Sim, sÃ³ vocÃª suportou. Mas estÃ¡ reclamando agora? NÃ£o podia falar entÃ£o, o que vai fazer agora?",
                charAzhar: "VocÃª suportou? EntÃ£o exploda! Se nÃ£o liberar agora, vai apodrecer dentro de vocÃª para sempre."
            }
        };
        
        const characters = [
            { name: "Ely", emoji: "ğŸ‘‘", key: "charEly" },
            { name: "Cris", emoji: "ğŸƒ", key: "charCris" },
            { name: "Zafirah", emoji: "ğŸ§•", key: "charZafirah" },
            { name: "Rami", emoji: "ğŸ”®", key: "charRami" },
            { name: "Samir", emoji: "ğŸª", key: "charSamir" },
            { name: "Layla", emoji: "ğŸ’ ", key: "charLayla" },
            { name: "Nabir", emoji: "ğŸ¦‚", key: "charNabir" },
            { name: "Azhar", emoji: "ğŸ”¥", key: "charAzhar" }
        ];
        
        function analyzeEmotion(userInput) {
            const input = userInput.toLowerCase();
            const emotionKeywords = {
                suppressed_anger: ['ì–µìš¸', 'í™”ê°€', 'ë¶„ë…¸', 'ì§œì¦', 'ë¹¡ì³', 'ì—´ë°›', 'ì°¸ì•˜', 'ì–µëˆŒ', 'ë¶ˆê³µí‰', 'ë¶ˆê³µì •', 'unfair', 'angry', 'mad', 'suppressed', 'injusto', 'raiva'],
                frustration: ['ë‹µë‹µ', 'ê°‘ê°‘', 'ë§‰ë§‰', 'ìˆ¨ë§‰', 'frustrat', 'stifled', 'frustraÃ§'],
                resentment: ['ì›ë§', 'ë¯¸ì›€', 'ì¦ì˜¤', 'ì‹œê¸°', 'resentment', 'hatred', 'ressentiment'],
                betrayal: ['ë°°ì‹ ', 'ì‹¤ë§', 'ë¯¿ì—ˆëŠ”ë°', 'betrayal', 'disappointed', 'traiÃ§Ã£o'],
                exhaustion: ['ì§€ì³¤', 'í”¼ê³¤', 'í˜ë“¤', 'ì§€ê²¨', 'tired', 'exhaust', 'cansado'],
                powerlessness: ['ë¬´ë ¥', 'ì•½í•´', 'ëª»í•´', 'ì•ˆë¼', 'powerless', 'weak', 'impotente']
            };
            
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                for (const keyword of keywords) {
                    if (input.includes(keyword)) {
                        return emotion;
                    }
                }
            }
            return 'general';
        }
        
        const responseCharacters = [
            {
                name: "Strength", emoji: "ğŸ’ª",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    const responses = {
                        ko: {
                            suppressed_anger: "ë‹¹ì‹ ì˜ ë¶„ë…¸ëŠ” ì •ë‹¹í•©ë‹ˆë‹¤. ê·¸ê²ƒì€ ë¶ˆì˜ì— ë§ì„œëŠ” ì˜í˜¼ì˜ ì™¸ì¹¨ì´ì—ˆì–´ìš”. ì°¸ì•„ì˜¨ ì‹œê°„ë§Œí¼, ì´ì œëŠ” ê·¸ ê°ì •ì— í˜ì„ ì‹¤ì–´ì£¼ì„¸ìš”.",
                            frustration: "ë‹µë‹µí•¨ ì†ì—ì„œë„ ë‹¹ì‹ ì€ í¬ê¸°í•˜ì§€ ì•Šì•˜ì–´ìš”. ê·¸ ëˆê¸°ì•¼ë§ë¡œ ì§„ì •í•œ í˜ì…ë‹ˆë‹¤. ì´ì œ ìˆ¨ ì‰´ ê³µê°„ì„ ë§Œë“¤ì–´ë„ ë¼ìš”.",
                            resentment: "ì›ë§ë„ ë•Œë¡œëŠ” ìì‹ ì„ ì§€í‚¤ëŠ” ë°©ë²•ì´ì—ˆì„ ê±°ì˜ˆìš”. í•˜ì§€ë§Œ ì´ì œëŠ” ê·¸ ì—ë„ˆì§€ë¥¼ ë‹¹ì‹ ì„ ìœ„í•œ í˜ìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆì–´ìš”.",
                            betrayal: "ë°°ì‹ ë‹¹í•œ ë§ˆìŒì´ ì–¼ë§ˆë‚˜ ì•„íŒ ì„ê¹Œìš”. í•˜ì§€ë§Œ ê·¸ ê²½í—˜ì´ ë‹¹ì‹ ì„ ë” ì§€í˜œë¡œìš´ ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.",
                            exhaustion: "ì§€ì¹¨ë§ˆì €ë„ ë‹¹ì‹ ì´ ëê¹Œì§€ ë…¸ë ¥í–ˆë‹¤ëŠ” ì¦ê±°ì˜ˆìš”. ì´ì œëŠ” ì‰¬ì–´ë„ ê´œì°®ìŠµë‹ˆë‹¤. ê·¸ê²ƒë„ í˜ì˜ ì¼ë¶€ì˜ˆìš”.",
                            powerlessness: "ë¬´ë ¥ê°ì„ ëŠê¼ˆë˜ ê·¸ë•Œì—ë„ ë‹¹ì‹ ì€ í¬ê¸°í•˜ì§€ ì•Šì•˜ì–´ìš”. ê·¸ ìì²´ê°€ ë†€ë¼ìš´ í˜ì…ë‹ˆë‹¤.",
                            general: "ë‹¹ì‹ ì´ ê²¬ëŒì˜¨ ëª¨ë“  ìˆœê°„ì´ ì§€ê¸ˆì˜ ê°•í•œ ë‹¹ì‹ ì„ ë§Œë“¤ì—ˆì–´ìš”. ê·¸ í˜ì„ ì¸ì •í•´ì£¼ì„¸ìš”."
                        },
                        en: {
                            suppressed_anger: "Your anger is justified. It was your soul's cry against injustice. As long as you've endured, now empower that emotion.",
                            frustration: "Even in frustration, you didn't give up. That persistence is true strength. Now you can create space to breathe.",
                            resentment: "Resentment was sometimes a way to protect yourself. But now you can transform that energy into power for yourself.",
                            betrayal: "How painful that betrayed heart must have been. But that experience made you a wiser person.",
                            exhaustion: "Even fatigue is proof you tried until the end. It's okay to rest now. That's also part of strength.",
                            powerlessness: "Even when you felt powerless, you didn't give up. That itself is amazing strength.",
                            general: "Every moment you've endured made you the strong person you are now. Please acknowledge that strength."
                        },
                        pt: {
                            suppressed_anger: "Sua raiva Ã© justificada. Foi o grito da sua alma contra a injustiÃ§a. Pelo tempo que suportou, agora empodere essa emoÃ§Ã£o.",
                            frustration: "Mesmo na frustraÃ§Ã£o, vocÃª nÃ£o desistiu. Essa persistÃªncia Ã© verdadeira forÃ§a. Agora pode criar espaÃ§o para respirar.",
                            resentment: "O ressentimento Ã s vezes era uma forma de se proteger. Mas agora pode transformar essa energia em poder para si mesmo.",
                            betrayal: "Como deve ter doÃ­do esse coraÃ§Ã£o traÃ­do. Mas essa experiÃªncia o tornou uma pessoa mais sÃ¡bia.",
                            exhaustion: "Mesmo a fadiga Ã© prova de que tentou atÃ© o fim. EstÃ¡ bem descansar agora. Isso tambÃ©m Ã© parte da forÃ§a.",
                            powerlessness: "Mesmo quando se sentiu impotente, nÃ£o desistiu. Isso em si Ã© uma forÃ§a incrÃ­vel.",
                            general: "Cada momento que suportou o tornou a pessoa forte que Ã© agora. Por favor, reconheÃ§a essa forÃ§a."
                        }
                    };
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Liberation", emoji: "ğŸ•Šï¸",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    const responses = {
                        ko: {
                            suppressed_anger: "ë¶„ë…¸ë¥¼ ì–µëˆ„ë¥´ëŠë¼ ìˆ˜ê³ í–ˆì–´ìš”. ì´ì œëŠ” ê·¸ ê°ì •ì„ ììœ ë¡­ê²Œ í‘œí˜„í•´ë„ ê´œì°®ì•„ìš”. í•´ë°©ì˜ ìˆœê°„ì´ì—ìš”.",
                            frustration: "ë‹µë‹µí•¨ì—ì„œ ë²—ì–´ë‚  ì‹œê°„ì´ì—ìš”. ë‹¹ì‹ ì€ ë” ì´ìƒ ê·¸ í‹€ ì•ˆì— ê°‡í˜€ ìˆì„ í•„ìš”ê°€ ì—†ì–´ìš”.",
                            resentment: "ì›ë§ì˜ ì‚¬ìŠ¬ì—ì„œ ììœ ë¡œì›Œì§ˆ ë•Œì˜ˆìš”. ê·¸ ë¬´ê±°ìš´ ì§ì„ ë‚´ë ¤ë†“ê³  ê°€ë²¼ì›Œì§€ì„¸ìš”.",
                            betrayal: "ë°°ì‹ ì˜ ìƒì²˜ì—ì„œ ë²—ì–´ë‚˜ ìƒˆë¡œìš´ ì‹œì‘ì„ í•  ìˆ˜ ìˆì–´ìš”. ììœ ë¡­ê²Œ ë‚ ì•„ì˜¤ë¥´ì„¸ìš”.",
                            exhaustion: "ì§€ì¹¨ì—ì„œ í•´ë°©ë˜ì–´ ì§„ì •í•œ íœ´ì‹ì„ ì°¾ì„ ì‹œê°„ì´ì—ìš”. í‰í™”ë¡œì›Œì ¸ë„ ê´œì°®ì•„ìš”.",
                            powerlessness: "ë¬´ë ¥ê°ì˜ êµ´ë ˆì—ì„œ ë²—ì–´ë‚˜ ì§„ì •í•œ ììœ ë¥¼ ëŠë‚„ ìˆ˜ ìˆì–´ìš”. ë‚ ê°œë¥¼ í´ì„¸ìš”.",
                            general: "ëª¨ë“  ì–µì••ì—ì„œ ë²—ì–´ë‚˜ ììœ ë¡œìš´ ë‹¹ì‹ ì´ ë˜ì„¸ìš”. í•´ë°©ì˜ ìˆœê°„ì„ ë§ì´í•˜ì„¸ìš”."
                        },
                        en: {
                            suppressed_anger: "You've worked hard suppressing anger. Now it's okay to express that emotion freely. This is a moment of liberation.",
                            frustration: "It's time to break free from frustration. You no longer need to be trapped in that frame.",
                            resentment: "It's time to be free from the chains of resentment. Put down that heavy burden and become light.",
                            betrayal: "You can break free from the wounds of betrayal and make a new beginning. Fly freely.",
                            exhaustion: "It's time to be liberated from fatigue and find true rest. It's okay to become peaceful.",
                            powerlessness: "You can break free from the shackles of powerlessness and feel true freedom. Spread your wings.",
                            general: "Break free from all oppression and become the free you. Welcome the moment of liberation."
                        },
                        pt: {
                            suppressed_anger: "VocÃª trabalhou duro suprimindo a raiva. Agora estÃ¡ bem expressar essa emoÃ§Ã£o livremente. Este Ã© um momento de libertaÃ§Ã£o.",
                            frustration: "Ã‰ hora de se libertar da frustraÃ§Ã£o. VocÃª nÃ£o precisa mais estar preso nesse quadro.",
                            resentment: "Ã‰ hora de se libertar das correntes do ressentimento. Largue esse fardo pesado e torne-se leve.",
                            betrayal: "VocÃª pode se libertar das feridas da traiÃ§Ã£o e fazer um novo comeÃ§o. Voe livremente.",
                            exhaustion: "Ã‰ hora de se libertar da fadiga e encontrar verdadeiro descanso. EstÃ¡ bem se tornar pacÃ­fico.",
                            powerlessness: "VocÃª pode se libertar dos grilhÃµes da impotÃªncia e sentir verdadeira liberdade. Abra suas asas.",
                            general: "Liberte-se de toda opressÃ£o e torne-se o vocÃª livre. Bem-vindo ao momento de libertaÃ§Ã£o."
                        }
                    };
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Validation", emoji: "âœ¨",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    const responses = {
                        ko: {
                            suppressed_anger: "ë‹¹ì‹ ì˜ ë¶„ë…¸ëŠ” ì™„ì „íˆ íƒ€ë‹¹í•´ìš”. ê·¸ ê°ì •ì„ ëŠë¼ëŠ” ê²ƒì´ ì •ìƒì´ê³  ê±´ê°•í•œ ë°˜ì‘ì´ì—ìš”.",
                            frustration: "ë‹µë‹µí–ˆë˜ ë§ˆìŒ, ê·¸ ëª¨ë“  ê°ì •ì´ ì´í•´ë¼ìš”. ë‹¹ì‹ ì˜ ê°ì •ì€ ì†Œì¤‘í•˜ê³  ì˜ë¯¸ê°€ ìˆì–´ìš”.",
                            resentment: "ì›ë§í•˜ëŠ” ë§ˆìŒë„ ë‹¹ì—°í•´ìš”. ëˆ„êµ¬ë„ ê·¸ë ‡ê²Œ ë§ì´ ì°¸ì„ í•„ìš”ëŠ” ì—†ì—ˆì–´ìš”.",
                            betrayal: "ë¯¿ì—ˆë˜ ì‚¬ëŒì—ê²Œ ìƒì²˜ë°›ì€ ë§ˆìŒ... ê·¸ ì•„í””ì´ ì–¼ë§ˆë‚˜ ê¹Šì—ˆì„ì§€ ì•Œì•„ìš”.",
                            exhaustion: "ë„ˆë¬´ ë§ì´ ê²¬ë””ëŠë¼ ì§€ì³¤ì£ . ê·¸ í”¼ë¡œê°ë„ ì¶©ë¶„íˆ ì´í•´í•  ìˆ˜ ìˆì–´ìš”.",
                            powerlessness: "ë¬´ë ¥í–ˆë˜ ìˆœê°„ë“¤, ê·¸ê²ƒë„ ì¸ê°„ë‹¤ìš´ ìì—°ìŠ¤ëŸ¬ìš´ ê°ì •ì´ì—ìš”.",
                            general: "ë‹¹ì‹ ì˜ ëª¨ë“  ê°ì •ì´ ì†Œì¤‘í•˜ê³  ì˜ë¯¸ê°€ ìˆì–´ìš”. ê·¸ ê°ì •ë“¤ì„ ì¸ì •í•´ì£¼ì„¸ìš”."
                        },
                        en: {
                            suppressed_anger: "Your anger is completely valid. Feeling that emotion is a normal and healthy response.",
                            frustration: "That frustrated heart, I understand all those emotions. Your feelings are precious and meaningful.",
                            resentment: "It's natural to feel resentment. No one needed to endure that much.",
                            betrayal: "The heart hurt by someone you trusted... I know how deep that pain must have been.",
                            exhaustion: "You're tired from enduring too much. I can fully understand that fatigue.",
                            powerlessness: "Those powerless moments, that's also a naturally human emotion.",
                            general: "All your emotions are precious and meaningful. Please acknowledge those feelings."
                        },
                        pt: {
                            suppressed_anger: "Sua raiva Ã© completamente vÃ¡lida. Sentir essa emoÃ§Ã£o Ã© uma resposta normal e saudÃ¡vel.",
                            frustration: "Esse coraÃ§Ã£o frustrado, entendo todas essas emoÃ§Ãµes. Seus sentimentos sÃ£o preciosos e significativos.",
                            resentment: "Ã‰ natural sentir ressentimento. NinguÃ©m precisava suportar tanto.",
                            betrayal: "O coraÃ§Ã£o ferido por alguÃ©m em quem confiava... Sei como essa dor deve ter sido profunda.",
                            exhaustion: "EstÃ¡ cansado de suportar demais. Posso entender completamente essa fadiga.",
                            powerlessness: "Esses momentos de impotÃªncia, isso tambÃ©m Ã© uma emoÃ§Ã£o naturalmente humana.",
                            general: "Todas as suas emoÃ§Ãµes sÃ£o preciosas e significativas. Por favor, reconheÃ§a esses sentimentos."
                        }
                    };
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        function resetJourney() {
            clearAllTypingEffects();
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'lightMessageSection', 'portalQuestionSection',
                'userInputSection', 'userReactionsSection', 'continueSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            const portalIntro = document.getElementById('portalIntro');
            const lightMessage = document.getElementById('lightMessage');
            const portalQuestion = document.getElementById('portalQuestion');
            const continueText = document.getElementById('continueText');
            
            if (portalIntro) portalIntro.innerHTML = '';
            if (lightMessage) lightMessage.innerHTML = '';
            if (portalQuestion) portalQuestion.innerHTML = '';
            if (continueText) continueText.innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            if (userTextarea) {
                userTextarea.disabled = false;
                userTextarea.value = '';
                userTextarea.style.height = 'auto';
                userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            }
            
            const mainContent = document.getElementById('mainContent');
            if (mainContent) {
                mainContent.scrollTop = 0;
            }
            
            userResponse = '';
            currentTypingElement = null;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            const previousLanguage = currentLanguage;
            currentLanguage = lang;
            
            if (journeyStarted) {
                resetJourney();
            }
            
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            const elements = ['logoSubtitle', 'portalMainTitle', 'portalSubtitle', 'lightTitle', 'continueYesBtn', 'continueNoBtn'];
            
            elements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element && translations[lang]) {
                    const keyMapping = {
                        'logoSubtitle': 'logoSubtitle',
                        'portalMainTitle': 'portalMainTitle',
                        'portalSubtitle': 'portalSubtitle',
                        'lightTitle': 'lightTitle',
                        'continueYesBtn': 'continueYes',
                        'continueNoBtn': 'continueNo'
                    };
                    
                    const translationKey = keyMapping[elementId] || elementId;
                    
                    if (translations[lang][translationKey]) {
                        element.textContent = translations[lang][translationKey];
                    }
                }
            });
            
            const textarea = document.getElementById('userTextarea');
            if (textarea) textarea.placeholder = translations[lang].inputPlaceholder;
        }
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i % 10 === 0) {
                        scrollToFollowTyping(element);
                    }
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        
                        setTimeout(() => {
                            if (document.contains(element)) {
                                scrollToFollowTyping(element);
                            }
                        }, 200);
                        
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToFollowTyping(element) {
            const mainContent = document.getElementById('mainContent');
            const elementRect = element.getBoundingClientRect();
            const containerRect = mainContent.getBoundingClientRect();
            
            if (elementRect.bottom > containerRect.bottom - 150) {
                const scrollTop = mainContent.scrollTop;
                const elementOffsetTop = element.offsetTop;
                const targetScroll = elementOffsetTop - (containerRect.height / 2);
                
                mainContent.scrollTo({
                    top: Math.max(0, targetScroll),
                    behavior: 'smooth'
                });
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function setupLanguageButtons() {
            const langButtons = document.querySelectorAll('.lang-btn');
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const newLang = this.dataset.lang;
                    changeLanguage(newLang);
                });
            });
        }
        
        function initializeTemarix() {
            console.log('=== Temarix Portal 20 ì´ˆê¸°í™” ì‹œì‘ ===');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            const introText = translations[currentLanguage].portalIntro;
            await typewriterEffect(introElement, introText, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const dialogueText = translations[currentLanguage][char.key];
                await typewriterEffect(dialogueDiv, dialogueText, 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            const lightText = translations[currentLanguage].lightMessage;
            await typewriterEffect(lightMessageEl, lightText, 60);
            
            setTimeout(() => {
                showQuestion();
            }, 2000);
        }
        
        async function showQuestion() {
            const questionSection = document.getElementById('portalQuestionSection');
            const questionEl = document.getElementById('portalQuestion');
            
            questionSection.classList.add('show');
            
            const questionText = translations[currentLanguage].portalQuestion;
            await typewriterEffect(questionEl, questionText, 50);
            
            setTimeout(() => {
                enableUserInput();
            }, 1500);
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', handleTextareaKeydown);
            
            document.getElementById('continueYesBtn').addEventListener('click', function() {
                processContinue('Y');
            });
            
            document.getElementById('continueNoBtn').addEventListener('click', function() {
                processContinue('N');
            });
        }
        
        function handleTextareaKeydown(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                const inputValue = this.value.trim();
                
                if (inputValue) {
                    processUserInput(inputValue);
                }
            }
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                showUserReactions(inputText);
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showContinueOption();
            }, 2000);
        }
        
        async function showContinueOption() {
            const continueSection = document.getElementById('continueSection');
            const continueText = document.getElementById('continueText');
            
            continueSection.classList.add('show');
            
            const questionText = translations[currentLanguage].continueText;
            await typewriterEffect(continueText, questionText, 50);
            
            setTimeout(() => {
                scrollToElement(continueSection);
            }, 500);
        }
        
        function processContinue(input) {
            if (input === 'Y') {
                const message = currentLanguage === 'ko' ? 
                    'Portal 21ì´ ê³§ ì¤€ë¹„ë©ë‹ˆë‹¤. ì°¸ìŒì˜ ë¬´ê²Œë¥¼ ëœì–´ë‚´ê³  ë” ììœ ë¡œìš´ ê°ì •ì˜ ì—¬ì •ì´ ì´ì–´ì§‘ë‹ˆë‹¤.' :
                    currentLanguage === 'en' ? 
                    'Portal 21 will be ready soon. The journey continues with liberation from the weight of endurance.' :
                    'Portal 21 estarÃ¡ pronto em breve. A jornada continua com libertaÃ§Ã£o do peso da resistÃªncia.';
                alert(message);
            } else if (input === 'N') {
                const message = currentLanguage === 'ko' ? 
                    'ì—¬ì •ì´ ì¼ì‹œ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì–¸ì œë“  ë‹¤ì‹œ ëŒì•„ì™€ ê³„ì†í•˜ì„¸ìš”.' :
                    currentLanguage === 'en' ? 
                    'The journey has been paused. Come back and continue anytime.' :
                    'A jornada foi pausada. Volte e continue a qualquer momento.';
                alert(message);
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V2 Portal 20 DOM ë¡œë“œ ì™„ë£Œ');
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            memoryStorage.mockUser = currentUser;
            
            updateStaticTranslations(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>