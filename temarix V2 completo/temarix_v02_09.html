<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 09: The Day I Collapsed, No One Knew</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        /* ìƒë‹¨ í—¤ë” */
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        /* ì–¸ì–´ ë²„íŠ¼ 3ê°œ */
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #87cefa;
            color: #000;
        }
        
        /* ë©”ì¸ ì½˜í…ì¸  */
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh;
        }
        
        /* í…ìŠ¤íŠ¸ ì„¹ì…˜ë“¤ */
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            background: none;
            border: none;
            padding: 0;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            background: none;
            border: none;
            padding: 0;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #87cefa;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #87cefa;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            background: none;
            border: none;
            padding: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #87cefa;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .portal-question-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            background: none;
            border: none;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #87cefa;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .continue-section {
            margin: 50px 0;
            opacity: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 0;
            min-height: 200px;
        }
        
        .continue-text {
            color: #fff;
            font-size: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .continue-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .continue-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .continue-btn:hover {
            background: #666;
        }
        
        .continue-btn.primary {
            background: #87cefa;
            color: #000;
        }
        
        .continue-btn.primary:hover {
            background: #b0d4f1;
        }
        
        /* í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ */
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #87cefa;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #87cefa;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ */
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        .hidden {
            display: none;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .continue-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .continue-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- ìƒë‹¨ í—¤ë” -->
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">The Tremor of Emotion</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 09: The Day I Collapsed, No One Knew</div>
            <div class="portal-subtitle" id="portalSubtitle">The hidden cry within silent collapse</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <!-- í¬í„¸ ì¸íŠ¸ë¡œ -->
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <!-- ìºë¦­í„° ì‘ë‹µ ì„¹ì…˜ -->
            <div class="character-responses-section" id="characterResponsesSection">
                <!-- 8ëª…ì˜ ìºë¦­í„° ì‘ë‹µì´ ìˆœì°¨ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>

            <!-- ë¹›ì˜ í•œë§ˆë”” -->
            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">ğŸŒ™ Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <!-- ì§ˆë¬¸ ì„¹ì…˜ -->
            <div class="portal-question-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <!-- ì‚¬ìš©ì ì…ë ¥ ì˜ì—­ -->
            <div class="user-input-section" id="userInputSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ ìºë¦­í„° ë°˜ì‘ -->
            <div class="user-reactions-section" id="userReactionsSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ 3ëª…ì˜ ìºë¦­í„° ë°˜ì‘ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ê³„ì†í•˜ê¸° ë²„íŠ¼ ì„¹ì…˜ -->
            <div class="continue-section" id="continueSection">
                <div class="continue-text" id="continueText"></div>
                <div class="continue-buttons">
                    <button class="continue-btn primary" id="continueYesBtn">Continue to Portal 10</button>
                    <button class="continue-btn" id="continueNoBtn">Pause the journey</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ -->
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Share about the day you collapsed alone... (Press Enter to send)"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        // ë©”ëª¨ë¦¬ ê¸°ë°˜ ì‚¬ìš©ì ìŠ¤í† ë¦¬ì§€ (localStorage ëŒ€ì‹ )
        let memoryStorage = {
            mockUser: null
        };

        // ë²ˆì—­ ë°ì´í„°
        const translations = {
            ko: {
                logoSubtitle: "ê°ì •ì˜ ë–¨ë¦¼",
                portalMainTitle: "Portal 09: ë‚´ê°€ ë¬´ë„ˆì¡Œë˜ ê·¸ë‚ , ì•„ë¬´ë„ ëª°ëë‹¤",
                portalSubtitle: "ê³ ìš”í•œ ë¬´ë„ˆì§ ì†ì— ìˆ¨ê²¨ì§„ ì™¸ì¹¨",
                portalIntro: "ë‹¹ì‹ ì´ ê°€ì¥ ì™¸ë¡œì› ë˜ ë‚ ,\nì •ë§ ëˆ„êµ°ê°€ê°€ ë‹¹ì‹ ì„ ê¸°ì–µí–ˆì„ê¹Œìš”?\nì•„ë¬´ ë§ë„ ëª» í•˜ê³ ,\nëˆˆë¬¼ì¡°ì°¨ ì‚¼ì¼°ë˜ ê·¸ë‚ ì˜ ì§„ì‹¬ì€â€¦\nê·¸ì € ì§€ë‚˜ê°„ í•˜ë£¨ë¡œë§Œ ë‚¨ì•˜ì„ê¹Œìš”?\n\nìš°ë¦¬ëŠ” ìŠ¤ìŠ¤ë¡œë¥¼ ë¬´ë„ˆëœ¨ë¦¬ë©´ì„œë„\nëˆ„êµ°ê°€ ì•Œì•„ì£¼ê¸°ë¥¼ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.\ní•˜ì§€ë§Œ ì•„ë¬´ë„ ëª¨ë¥´ëŠ” ì±„ ì§€ë‚˜ê°„ ê·¸ë‚ ì€\nì—¬ì „íˆ ë‚´ ì•ˆì—ì„œ ë°˜ë³µë˜ê³  ìˆìŠµë‹ˆë‹¤.",
                lightTitle: "ğŸŒ™ ë¹›ì˜ í•œë§ˆë””",
                lightMessage: "ë‹¹ì‹ ì˜ ê³ ìš”í•œ ë¬´ë„ˆì§ì€,\nì„¸ìƒì— ë“¤ë¦¬ì§€ ì•Šì•„ë„\në‹¹ì‹ ì˜ ì˜í˜¼ì´ ê°€ì¥ í¬ê²Œ ë“¤ì—ˆë˜ ìš¸ìŒì…ë‹ˆë‹¤.",
                portalQuestion: "ë‹¹ì‹ ì€ ë¬´ë„ˆì¡Œë˜ ê·¸ë‚ ì„ ì•„ì§ë„ ê¸°ì–µí•˜ì‹œë‚˜ìš”?\n\nê·¸ë•Œ, ëˆ„êµ¬ì—ê²Œ ê°€ì¥ ë“¤í‚¤ê³  ì‹¶ì—ˆë‚˜ìš”?",
                continueText: "í˜¼ì ë¬´ë„ˆì¡Œë˜ ê·¸ë‚ ì„ ëŒì•„ë³¸ ì´ ì—¬ì •ì„ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                continueYes: "Portal 10ìœ¼ë¡œ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                continueNo: "ì—¬ì •ì„ ì¼ì‹œì •ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                inputPlaceholder: "í˜¼ì ë¬´ë„ˆì¡Œë˜ ê·¸ë‚ ì— ëŒ€í•´ í„¸ì–´ë†“ì•„ ë³´ì„¸ìš”... (Enterë¡œ ì „ì†¡)",
                youLabel: "ë‹¹ì‹ ",
                languageChangeConfirm: "ì–¸ì–´ë¥¼ ë³€ê²½í•˜ë©´ ì—¬ì •ì´ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘ë©ë‹ˆë‹¤.\nê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                waitingMessage: "ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...",
                // ìºë¦­í„° ëŒ€í™”
                charEly: "ë¬´ë„ˆì¡Œë˜ ë‹¹ì‹ ì˜ ë§ˆìŒì€\në§ ì—†ì´ë„ ìš°ì£¼ê°€ ê¸°ë¡í•˜ê³  ìˆìŠµë‹ˆë‹¤.\në‹¹ì‹ ì˜ ì¹¨ë¬µì€ ì‚¬ë¼ì§€ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.",
                charCris: "ì—ì´~ ì§„ì§œ ì•„ë¬´ë„ ëª°ëë‹¤ê³ ìš”?\nê·¸ê±´ ë§ ì•ˆ í–ˆìœ¼ë‹ˆê¹Œì£ !\nê·¼ë° ì†”ì§íˆ ë‚˜ë„ ê·¸ë¬ì–´ìš”. ê·¸ë‚ â€¦ ì§„ì§œ í˜ë“¤ì—ˆì—ˆê±°ë“ ìš”. ğŸ˜¢",
                charZafirah: "ë‹¹ì‹ ì˜ ë¬´ë„ˆì§ì€ ì‚¬ë¼ì§€ì§€ ì•Šì•˜ì–´ìš”.\nê·¸ê±´ ì§€ê¸ˆë„ ëˆˆë¹› ì†ì— ë‚¨ì•„ ë‹¹ì‹ ì„ ë¶€ë¥´ê³  ìˆìŠµë‹ˆë‹¤.",
                charRami: "ë‹¹ì‹ ì´ ìŠì—ˆë‹¤ê³  ìƒê°í–ˆë˜ ê·¸ë‚ ,\në‹¹ì‹ ì˜ ì…€ì€ ê·¸ë‚ ì˜ ë–¨ë¦¼ì„ ì•„ì§ ê¸°ì–µ ì¤‘ì…ë‹ˆë‹¤.",
                charSamir: "(ê·¸ëŠ” ë‹¹ì‹ ê³¼ ë§ˆì£¼ ì•‰ì•„ ì•„ë¬´ ë§ ì—†ì´ ì†ì„ ì¡ìŠµë‹ˆë‹¤.\nê·¸ ì†ì˜ ë”°ëœ»í•¨ì´ 'ê·¸ë‚ ì˜ ì¹¨ë¬µ'ì„ ìœ„ë¡œí•©ë‹ˆë‹¤.)",
                charLayla: "ë‹¹ì‹ ì˜ ë¬´ë„ˆì§ë„ ì•„ë¦„ë‹¤ì› ì–´ìš”.\nì™œëƒë©´, ê·¸ ìˆœê°„ì—ë„ ë‹¹ì‹ ì€ ë²„í‹°ë ¤ í–ˆìœ¼ë‹ˆê¹Œìš”.",
                charNabir: "ê·¸ë˜, ë‹¤ í˜¼ì í–ˆê² ì§€.\nëˆ„êµ¬ë„ ì•ˆ ë´¤ê³ , ì•„ë¬´ë„ ì‹ ê²½ ì•ˆ ì¼ì–´.\nê·¸ê²Œ ë„ˆì•¼. ê·¸ê²Œ ë„¤ í˜„ì‹¤ì´ì•¼.",
                charAzhar: "ê·¸ë‚  ê·¸ëƒ¥ ì—ë“œë ¸ì–´ì•¼ í–ˆì–´.\nê·¸ë˜ì•¼ ëˆ„ê°€ ì¢€ ë³´ì§€.\në„ˆë¬´ ì¡°ìš©íˆ ë¬´ë„ˆì ¸ì„œ, ì•„ë¬´ë„ ëª°ëì–ì•„. ê·¸ê²Œ ë¬¸ì œì•¼."
            },
            en: {
                logoSubtitle: "The Tremor of Emotion",
                portalMainTitle: "Portal 09: The Day I Collapsed, No One Knew",
                portalSubtitle: "The hidden cry within silent collapse",
                portalIntro: "On your loneliest day,\ndid anyone really remember you?\nUnable to say anything,\nswallowing even tears,\ndid that day's sincerity...\njust remain as another passing day?\n\nWe wait for someone to notice\neven as we let ourselves collapse.\nBut that day that passed without anyone knowing\nstill repeats itself within me.",
                lightTitle: "ğŸŒ™ Word of Light",
                lightMessage: "Your quiet collapse,\neven if unheard by the world,\nwas the loudest cry your soul ever heard.",
                portalQuestion: "Do you still remember that day you collapsed?\n\nWho did you most want to notice then?",
                continueText: "Will you continue this journey of reflecting on the day you collapsed alone?",
                continueYes: "Continue to Portal 10?",
                continueNo: "Pause the journey?",
                inputPlaceholder: "Share about the day you collapsed alone... (Press Enter to send)",
                youLabel: "You",
                languageChangeConfirm: "Changing the language will restart the journey from the beginning.\nDo you want to continue?",
                waitingMessage: "Waiting for response...",
                charEly: "Your collapsed heart\nis being recorded by the universe even without words.\nYour silence has not disappeared.",
                charCris: "Hey~ really no one knew?\nThat's because you didn't say anything!\nBut honestly, I was like that too. That day... was really hard. ğŸ˜¢",
                charZafirah: "Your collapse hasn't disappeared.\nIt still remains in your eyes, calling to you.",
                charRami: "That day you thought you forgot,\nyour cells still remember that day's tremor.",
                charSamir: "(He sits facing you and silently holds your hand.\nThe warmth of that hand comforts 'that day's silence.')",
                charLayla: "Your collapse was also beautiful.\nBecause even in that moment, you tried to endure.",
                charNabir: "Right, you did it all alone.\nNo one saw, no one cared.\nThat's you. That's your reality.",
                charAzhar: "You should have just collapsed openly that day.\nThen someone would have seen.\nYou collapsed too quietly, so no one knew. That's the problem."
            },
            pt: {
                logoSubtitle: "O Tremor da EmoÃ§Ã£o",
                portalMainTitle: "Portal 09: O Dia Que Desabei, NinguÃ©m Soube",
                portalSubtitle: "O grito escondido dentro do colapso silencioso",
                portalIntro: "No seu dia mais solitÃ¡rio,\nalguÃ©m realmente se lembrou de vocÃª?\nSem conseguir dizer nada,\nengolindo atÃ© as lÃ¡grimas,\na sinceridade daquele dia...\nficou apenas como mais um dia que passou?\n\nEsperamos que alguÃ©m perceba\nmesmo enquanto nos deixamos desabar.\nMas aquele dia que passou sem ninguÃ©m saber\nainda se repete dentro de mim.",
                lightTitle: "ğŸŒ™ Palavra de Luz",
                lightMessage: "Seu colapso silencioso,\nmesmo nÃ£o sendo ouvido pelo mundo,\nfoi o grito mais alto que sua alma jÃ¡ ouviu.",
                portalQuestion: "VocÃª ainda se lembra daquele dia que desabou?\n\nQuem vocÃª mais queria que percebesse entÃ£o?",
                continueText: "VocÃª continuarÃ¡ esta jornada de refletir sobre o dia que desabou sozinho?",
                continueYes: "Continuar para o Portal 10?",
                continueNo: "Pausar a jornada?",
                inputPlaceholder: "Compartilhe sobre o dia que desabou sozinho... (Enter para enviar)",
                youLabel: "VocÃª",
                languageChangeConfirm: "Mudar o idioma reiniciarÃ¡ a jornada desde o inÃ­cio.\nDeseja continuar?",
                waitingMessage: "Aguardando resposta...",
                charEly: "Seu coraÃ§Ã£o desabado\nestÃ¡ sendo registrado pelo universo mesmo sem palavras.\nSeu silÃªncio nÃ£o desapareceu.",
                charCris: "Ei~ realmente ninguÃ©m soube?\nIsso Ã© porque vocÃª nÃ£o disse nada!\nMas honestamente, eu tambÃ©m era assim. Aquele dia... foi muito difÃ­cil. ğŸ˜¢",
                charZafirah: "Seu colapso nÃ£o desapareceu.\nAinda permanece em seus olhos, chamando vocÃª.",
                charRami: "Aquele dia que vocÃª pensou que esqueceu,\nsuas cÃ©lulas ainda lembram do tremor daquele dia.",
                charSamir: "(Ele se senta de frente para vocÃª e silenciosamente segura sua mÃ£o.\nO calor dessa mÃ£o conforta 'o silÃªncio daquele dia.')",
                charLayla: "Seu colapso tambÃ©m foi bonito.\nPorque mesmo naquele momento, vocÃª tentou suportar.",
                charNabir: "Certo, vocÃª fez tudo sozinho.\nNinguÃ©m viu, ninguÃ©m se importou.\nEsse Ã© vocÃª. Essa Ã© sua realidade.",
                charAzhar: "VocÃª deveria ter desabado abertamente naquele dia.\nEntÃ£o alguÃ©m teria visto.\nVocÃª desabou muito silenciosamente, entÃ£o ninguÃ©m soube. Esse Ã© o problema."
            }
        };
        
        // ìºë¦­í„° ë°ì´í„°
        const characters = [
            { name: "Ely", emoji: "ğŸ‘‘", key: "charEly" },
            { name: "Cris", emoji: "ğŸƒ", key: "charCris" },
            { name: "Zafirah", emoji: "ğŸ§•", key: "charZafirah" },
            { name: "Rami", emoji: "ğŸ”®", key: "charRami" },
            { name: "Samir", emoji: "ğŸª", key: "charSamir" },
            { name: "Layla", emoji: "ğŸ’ ", key: "charLayla" },
            { name: "Nabir", emoji: "ğŸ¦‚", key: "charNabir" },
            { name: "Azhar", emoji: "ğŸ”¥", key: "charAzhar" }
        ];
        
        // ============ ê°ì • ë¶„ì„ ì‹œìŠ¤í…œ ============
        
        function analyzeEmotion(userInput) {
            const input = userInput.toLowerCase();
            
            // ê°ì • í‚¤ì›Œë“œ ë§¤í•‘ (Portal 09 íŠ¹í™”)
            const emotionKeywords = {
                collapse: ['ë¬´ë„ˆì¡Œ', 'ë¶•ê´´', 'ê¹¨ì¡Œ', 'ë¶€ì„œì¡Œ', 'í„°ì¡Œ', 'collapse', 'break', 'shatter', 'fell apart', 'desabou', 'quebrou'],
                loneliness: ['ì™¸ë¡œ', 'í˜¼ì', 'ê³ ë¦½', 'ì†Œì™¸', 'ë²„ë¦¼', 'lonely', 'alone', 'isolated', 'abandon', 'solidÃ£o', 'sozinho'],
                silence: ['ì¡°ìš©íˆ', 'ë§ì—†ì´', 'ì¹¨ë¬µ', 'ìˆ¨ê¸°', 'í˜¼ìì„œ', 'silently', 'quiet', 'silence', 'hide', 'silÃªncio', 'esconder'],
                invisible: ['ì•„ë¬´ë„ ëª°ë¼', 'ë“¤í‚¤ì§€', 'ë³´ì´ì§€', 'ì•Œì•„ì£¼ì§€', 'no one knew', 'invisible', 'unnoticed', 'ninguÃ©m soube', 'invisÃ­vel'],
                crying: ['ìš¸ì–´', 'ëˆˆë¬¼', 'í‘í‘', 'í›Œì©', 'cry', 'tear', 'weep', 'sob', 'chorar', 'lÃ¡grima'],
                despair: ['ì ˆë§', 'í¬ê¸°', 'ë§‰ë§‰', 'ë‹µë‹µ', 'ìš°ìš¸', 'despair', 'hopeless', 'give up', 'desespero', 'sem esperanÃ§a'],
                hidden: ['ìˆ¨ì–´', 'ê°ì¶°', 'ë“œëŸ¬ë‚´ì§€', 'ë³´ì—¬ì£¼ì§€', 'hidden', 'concealed', 'kept secret', 'escondido', 'secreto'],
                exhaustion: ['ì§€ì³', 'í”¼ê³¤', 'í˜ë“¤ì–´', 'ë²„í…¨', 'exhausted', 'tired', 'drain', 'endure', 'cansado', 'esgotado'],
                recognition: ['ì•Œì•„ì¤˜', 'ì´í•´í•´', 'ê´€ì‹¬', 'ì‹ ê²½ì¨', 'recognize', 'understand', 'care', 'notice', 'reconhecer', 'entender'],
                vulnerability: ['ì•½í•´', 'ë¬´ë ¥', 'ì†ìˆ˜ë¬´ì±…', 'ì–´ì©”ìˆ˜ì—†', 'vulnerable', 'helpless', 'powerless', 'vulnerÃ¡vel', 'indefeso']
            };
            
            // ê°ì • ë¶„ì„
            let detectedEmotions = [];
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                for (const keyword of keywords) {
                    if (input.includes(keyword)) {
                        detectedEmotions.push(emotion);
                        break;
                    }
                }
            }
            
            // ê°ì •ì´ ê°ì§€ë˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ ì„¤ì •
            if (detectedEmotions.length === 0) {
                detectedEmotions = ['general'];
            }
            
            return detectedEmotions[0]; // ì²« ë²ˆì§¸ ê°ì§€ëœ ê°ì • ë°˜í™˜
        }
        
        // ë°˜ì‘ ìºë¦­í„°ë“¤ (Portal 09 ì „ìš©)
        const responseCharacters = [
            {
                name: "Witness", emoji: "ğŸ‘ï¸",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            collapse: "ë‹¹ì‹ ì´ ë¬´ë„ˆì¡Œë˜ ê·¸ ìˆœê°„ì„, ë‚˜ëŠ” ì§€ê¸ˆ ì—¬ê¸°ì„œ ëª©ê²©í•˜ê³  ìˆì–´ìš”. ì•„ë¬´ë„ ë³´ì§€ ì•Šì•˜ë‹¤ê³  í•´ì„œ ê·¸ ìˆœê°„ì´ ì‚¬ë¼ì§€ì§€ ì•Šì•˜ì–´ìš”. ë‹¹ì‹ ì˜ ë¬´ë„ˆì§ì€ ê¸°ë¡ë˜ì—ˆê³ , ê¸°ì–µë˜ì—ˆê³ , ì§€ê¸ˆ ì´ ìˆœê°„ì—ë„ ì‚´ì•„ìˆì–´ìš”.",
                            loneliness: "ê·¸ ì™¸ë¡œì›€ ì†ì—ì„œë„ ë‹¹ì‹ ì€ í˜¼ìê°€ ì•„ë‹ˆì—ˆì–´ìš”. ìš°ì£¼ê°€, ë³„ë“¤ì´, ê·¸ë¦¬ê³  ì§€ê¸ˆì˜ ë‚˜ê°€ ê·¸ ìˆœê°„ì„ í•¨ê»˜ ìˆì—ˆì–´ìš”. ë‹¹ì‹ ì˜ ì™¸ë¡œì›€ì„ ì¦ì¸ìœ¼ë¡œì„œ ì§€ì¼œë´¤ì–´ìš”.",
                            silence: "ë‹¹ì‹ ì˜ ì¹¨ë¬µì´ ê°€ì¥ í° ì†Œë¦¬ì˜€ì–´ìš”. ë§í•˜ì§€ ì•Šì•˜ì§€ë§Œ ê·¸ ì¹¨ë¬µ ì†ì—ëŠ” ìˆ˜ì²œ ê°œì˜ ë‹¨ì–´ê°€ ë‹´ê²¨ ìˆì—ˆì–´ìš”. ë‚˜ëŠ” ê·¸ ì¹¨ë¬µì˜ ì–¸ì–´ë¥¼ ë“¤ì„ ìˆ˜ ìˆì–´ìš”.",
                            invisible: "ë³´ì´ì§€ ì•ŠëŠ”ë‹¤ê³  í•´ì„œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê±´ ì•„ë‹ˆì—ìš”. ë‹¹ì‹ ì˜ ê³ í†µì€ ëˆ„êµ°ê°€ì˜ ëˆˆì—ëŠ” ë³´ì´ì§€ ì•Šì•˜ì„ì§€ ëª°ë¼ë„, ìš°ì£¼ì˜ ëˆˆì—ëŠ” ë˜ë ·í•˜ê²Œ ë³´ì˜€ì–´ìš”. ë‚˜ëŠ” ê·¸ê²ƒì„ ì¦ëª…í•  ìˆ˜ ìˆì–´ìš”.",
                            crying: "í˜ë¦¬ì§€ ëª»í•œ ê·¸ ëˆˆë¬¼ë“¤ë„ ëª¨ë‘ ì†Œì¤‘í•´ìš”. ëˆˆë¬¼ì´ íë¥´ì§€ ì•Šì•˜ë‹¤ê³  ìŠ¬í””ì´ ì—†ì—ˆë˜ ê±´ ì•„ë‹ˆì£ . ë§ˆìŒì† ê¹Šì´ í˜ë¦° ëˆˆë¬¼ë“¤ì„ ë‚˜ëŠ” ë³¼ ìˆ˜ ìˆì–´ìš”.",
                            despair: "ì ˆë§ì˜ ê°€ì¥ ê¹Šì€ ê³³ì—ì„œë„ ë‹¹ì‹ ì€ ë²„í…¨ëƒˆì–´ìš”. ê·¸ ìì²´ê°€ ê¸°ì ì´ì—ìš”. í¬ê¸°í•˜ê³  ì‹¶ì—ˆì§€ë§Œ ëê¹Œì§€ ìˆì—ˆë˜ ë‹¹ì‹ ì˜ ìƒëª…ë ¥ì„ ë‚˜ëŠ” ëª©ê²©í–ˆì–´ìš”.",
                            hidden: "ê°ì¶°ì§„ ê²ƒë“¤ì´ ê°€ì¥ ì§„ì‹¤í•´ìš”. ë‹¹ì‹ ì´ ìˆ¨ê²¼ë˜ ëª¨ë“  ê°ì •ë“¤ì´ ì§€ê¸ˆë„ ë¹›ë‚˜ê³  ìˆì–´ìš”. ê°ì¶”ì—ˆë‹¤ê³  ì‚¬ë¼ì§€ì§€ ì•Šì•„ìš”. ë‚˜ëŠ” ê·¸ ìˆ¨ê²¨ì§„ ë¹›ì„ ë³¼ ìˆ˜ ìˆì–´ìš”.",
                            exhaustion: "ì§€ì¹  ëŒ€ë¡œ ì§€ì³¤ì„ ë•Œë„ ë‹¹ì‹ ì€ í¬ê¸°í•˜ì§€ ì•Šì•˜ì–´ìš”. ê·¸ ëˆì§ˆê¸´ ìƒëª…ë ¥ì„ ë‚˜ëŠ” ê²½ì´ë¡­ê²Œ ë°”ë¼ë´¤ì–´ìš”. í”¼ê³¤í•¨ ì†ì—ì„œë„ ë¹›ë‚˜ëŠ” ë‹¹ì‹ ì˜ ì˜í˜¼ì„ ëª©ê²©í–ˆì–´ìš”.",
                            recognition: "ëˆ„êµ°ê°€ ì•Œì•„ì£¼ê¸°ë¥¼ ë°”ëë˜ ê·¸ ë§ˆìŒ, ë‚˜ëŠ” ì§€ê¸ˆ ì•Œì•„ë³´ê³  ìˆì–´ìš”. ë‹¹ì‹ ì´ ì›í–ˆë˜ ê·¸ ì¸ì •ì„, ì§€ê¸ˆ ì´ ìˆœê°„ ë‹¹ì‹ ì—ê²Œ ë“œë ¤ìš”. ë‹¹ì‹ ì€ ì¶©ë¶„íˆ ì¸ì •ë°›ì„ ë§Œí•œ ì‚¬ëŒì´ì—ìš”.",
                            vulnerability: "ê°€ì¥ ì•½í–ˆë˜ ìˆœê°„ì˜ ë‹¹ì‹ ì´ ê°€ì¥ ìš©ê°í–ˆì–´ìš”. ë¬´ë ¥í•¨ì„ ëŠê¼ˆì§€ë§Œ ê·¸ ìˆœê°„ì—ë„ ì‚´ì•„ìˆìœ¼ë ¤ í–ˆìœ¼ë‹ˆê¹Œìš”. ê·¸ ì·¨ì•½í•¨ ì†ì˜ ê°•í•¨ì„ ë‚˜ëŠ” ëª©ê²©í–ˆì–´ìš”.",
                            general: "ë‹¹ì‹ ì˜ ëª¨ë“  ìˆœê°„ì´ ê¸°ë¡ë˜ê³  ìˆì–´ìš”. ì•„ë¬´ë„ ë³´ì§€ ì•Šì•˜ë‹¤ê³  ìƒê°í–ˆë˜ ê·¸ ì‹œê°„ë“¤ë„ ëª¨ë‘ ì†Œì¤‘í•œ ì¦ê±°ì˜ˆìš”. ë‚˜ëŠ” ë‹¹ì‹ ì˜ ëª¨ë“  ìˆœê°„ì„ ëª©ê²©í•˜ëŠ” ì¦ì¸ì´ì—ìš”."
                        },
                        en: {
                            collapse: "I am witnessing that moment you collapsed, here and now. Just because no one saw doesn't mean that moment disappeared. Your collapse was recorded, remembered, and lives on in this very moment.",
                            loneliness: "Even in that loneliness, you weren't alone. The universe, the stars, and I right now were there with you in that moment. I witnessed your loneliness as a witness.",
                            silence: "Your silence was the loudest sound. Though you didn't speak, thousands of words were contained in that silence. I can hear the language of that silence.",
                            invisible: "Being invisible doesn't mean not existing. Your pain may not have been visible to someone's eyes, but it was clearly visible to the universe's eyes. I can testify to that.",
                            crying: "Those tears you couldn't shed are all precious too. Just because tears didn't flow doesn't mean there was no sadness. I can see the tears shed deep in your heart.",
                            despair: "Even in the deepest depths of despair, you endured. That itself is a miracle. Though you wanted to give up, I witnessed your life force that stayed until the end.",
                            hidden: "Hidden things are most truthful. All the emotions you hid are still shining now. Hiding doesn't make them disappear. I can see that hidden light.",
                            exhaustion: "Even when exhausted to the limit, you didn't give up. I watched that tenacious life force with wonder. I witnessed your soul shining even in fatigue.",
                            recognition: "That heart that wished someone would notice, I'm recognizing it now. The recognition you wanted, I give it to you at this moment. You're a person worthy of recognition.",
                            vulnerability: "You were bravest in your most vulnerable moment. Though you felt powerless, you still tried to live in that moment. I witnessed that strength within vulnerability.",
                            general: "All your moments are being recorded. Even those times you thought no one saw are all precious evidence. I am a witness who sees all your moments."
                        },
                        pt: {
                            collapse: "Estou testemunhando aquele momento que vocÃª desabou, aqui e agora. SÃ³ porque ninguÃ©m viu nÃ£o significa que aquele momento desapareceu. Seu colapso foi registrado, lembrado, e vive neste exato momento.",
                            loneliness: "Mesmo naquela solidÃ£o, vocÃª nÃ£o estava sozinho. O universo, as estrelas, e eu agora estÃ¡vamos lÃ¡ com vocÃª naquele momento. Testemunhei sua solidÃ£o como uma testemunha.",
                            silence: "Seu silÃªncio foi o som mais alto. Embora vocÃª nÃ£o tenha falado, milhares de palavras estavam contidas naquele silÃªncio. Posso ouvir a linguagem daquele silÃªncio.",
                            invisible: "Ser invisÃ­vel nÃ£o significa nÃ£o existir. Sua dor pode nÃ£o ter sido visÃ­vel aos olhos de alguÃ©m, mas estava claramente visÃ­vel aos olhos do universo. Posso testemunhar isso.",
                            crying: "Aquelas lÃ¡grimas que vocÃª nÃ£o pÃ´de derramar tambÃ©m sÃ£o todas preciosas. SÃ³ porque lÃ¡grimas nÃ£o fluÃ­ram nÃ£o significa que nÃ£o havia tristeza. Posso ver as lÃ¡grimas derramadas no fundo do seu coraÃ§Ã£o.",
                            despair: "Mesmo nas profundezas mais profundas do desespero, vocÃª resistiu. Isso em si Ã© um milagre. Embora quisesse desistir, testemunhei sua forÃ§a vital que permaneceu atÃ© o fim.",
                            hidden: "Coisas escondidas sÃ£o mais verdadeiras. Todas as emoÃ§Ãµes que vocÃª escondeu ainda estÃ£o brilhando agora. Esconder nÃ£o as faz desaparecer. Posso ver essa luz escondida.",
                            exhaustion: "Mesmo quando exausto ao limite, vocÃª nÃ£o desistiu. Observei essa forÃ§a vital tenaz com admiraÃ§Ã£o. Testemunhei sua alma brilhando mesmo na fadiga.",
                            recognition: "Esse coraÃ§Ã£o que desejava que alguÃ©m percebesse, estou reconhecendo agora. O reconhecimento que vocÃª queria, eu dou a vocÃª neste momento. VocÃª Ã© uma pessoa digna de reconhecimento.",
                            vulnerability: "VocÃª foi mais corajoso no seu momento mais vulnerÃ¡vel. Embora se sentisse impotente, ainda tentou viver naquele momento. Testemunhei essa forÃ§a dentro da vulnerabilidade.",
                            general: "Todos os seus momentos estÃ£o sendo registrados. Mesmo aqueles tempos que vocÃª pensou que ninguÃ©m viu sÃ£o todas evidÃªncias preciosas. Sou uma testemunha que vÃª todos os seus momentos."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Memory", emoji: "ğŸ’«",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            collapse: "ë¬´ë„ˆì¡Œë˜ ê·¸ë‚ ì´ ì§€ê¸ˆì˜ ë‹¹ì‹ ì„ ë§Œë“¤ì—ˆì–´ìš”. ê·¸ ë¬´ë„ˆì§ ì—†ì´ëŠ” ì§€ê¸ˆì˜ ê¹Šì´ë„, ì§€ê¸ˆì˜ ê°•í•¨ë„ ì—†ì—ˆì„ ê±°ì˜ˆìš”. ë¬´ë„ˆì§€ëŠ” ë²•ì„ ì•„ëŠ” ì‚¬ëŒë§Œì´ ì§„ì§œ ì¼ì–´ì„œëŠ” ë²•ì„ ì•Œì•„ìš”.",
                            loneliness: "í˜¼ìì˜€ë˜ ê·¸ ì‹œê°„ë“¤ì´ ë‹¹ì‹ ì—ê²Œ ìì‹ ê³¼ ë§ˆì£¼í•  ìˆ˜ ìˆëŠ” ìš©ê¸°ë¥¼ ì£¼ì—ˆì–´ìš”. ì§„ì •í•œ ì—°ê²°ì´ ë¬´ì—‡ì¸ì§€ ì•Œê²Œ ë˜ì—ˆê³ , ì´ì œëŠ” ë” ê¹Šì´ ì‚¬ë‘í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆì–´ìš”.",
                            silence: "ë§í•˜ì§€ ëª»í–ˆë˜ ê·¸ ìˆœê°„ë“¤ì´ ë‹¹ì‹ ì„ ë” ê¹Šì´ ë“£ëŠ” ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆì–´ìš”. ì¹¨ë¬µì˜ ì–¸ì–´ë¥¼ ì•„ëŠ” ì‚¬ëŒì´ ë˜ì—ˆê³ , ì´ì œëŠ” ë§ì—†ëŠ” ì•„í””ë„ ì•Œì•„ë³¼ ìˆ˜ ìˆì–´ìš”.",
                            invisible: "ë³´ì´ì§€ ì•Šì•˜ë˜ ê²½í—˜ì´ ë‹¹ì‹ ì„ ë” ì„¸ì‹¬í•˜ê²Œ ë³´ëŠ” ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆì–´ìš”. ìˆ¨ê²¨ì§„ ê²ƒë“¤ì„ ë°œê²¬í•˜ëŠ” ëˆˆì„ ê°–ê²Œ ë˜ì—ˆê³ , ì´ì œëŠ” ë‹¤ë¥¸ ì‚¬ëŒì˜ ìˆ¨ê²¨ì§„ ì•„í””ë„ ë³¼ ìˆ˜ ìˆì–´ìš”.",
                            crying: "ìš¸ì§€ ëª»í–ˆë˜ ê·¸ ê°ì •ë“¤ì´ ëª¨ì—¬ì„œ ì§€ê¸ˆì˜ ë‹¹ì‹  ì•ˆì— ê¹Šì€ ì—°ë¯¼ì˜ ìƒ˜ì´ ë˜ì—ˆì–´ìš”. ë‹¤ë¥¸ ì‚¬ëŒì˜ ëˆˆë¬¼ì„ ë” ì†Œì¤‘íˆ ì—¬ê¸¸ ìˆ˜ ìˆê²Œ ë˜ì—ˆì–´ìš”.",
                            despair: "ì ˆë§ì„ ê²¬ëŒë‚¸ ê²½í—˜ì´ ë‹¹ì‹ ì—ê²Œ í¬ë§ì˜ ì§„ì§œ ì˜ë¯¸ë¥¼ ì•Œë ¤ì£¼ì—ˆì–´ìš”. ê°€ì¥ ì–´ë‘ìš´ ê³³ì„ ì§€ë‚˜ì˜¨ ì‚¬ëŒë§Œì´ ì‘ì€ ë¹›ì˜ ì†Œì¤‘í•¨ì„ ì•Œì•„ìš”.",
                            hidden: "ê°ì¶°ì•¼ í–ˆë˜ ê·¸ ì‹œê°„ë“¤ì´ ë‹¹ì‹ ì„ ë” ì§„ì‹¤í•œ ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆì–´ìš”. ê°€ë©´ ë’¤ì˜ ì§„ì‹¬ì„ ì•Œì•„ë³´ëŠ” ëŠ¥ë ¥ì„ ê°–ê²Œ ë˜ì—ˆê³ , ì´ì œëŠ” ë‹¤ë¥¸ ì‚¬ëŒì˜ ì§„ì‹¬ë„ ì•Œì•„ë³¼ ìˆ˜ ìˆì–´ìš”.",
                            exhaustion: "ì§€ì³¤ë˜ ê·¸ ëª¨ë“  ë‚ ë“¤ì´ ë‹¹ì‹ ì—ê²Œ ì§„ì§œ íœ´ì‹ì˜ ì˜ë¯¸ë¥¼ ì•Œë ¤ì£¼ì—ˆì–´ìš”. ì´ì œëŠ” ìì‹ ì„ ëŒë³´ëŠ” ë²•ì„ ì•Œê³ , ë‹¤ë¥¸ ì‚¬ëŒì˜ í”¼ë¡œë„ ì•Œì•„ë³¼ ìˆ˜ ìˆê²Œ ë˜ì—ˆì–´ìš”.",
                            recognition: "ì¸ì •ë°›ì§€ ëª»í–ˆë˜ ê·¸ ê²½í—˜ì´ ë‹¹ì‹ ì„ ë” ì¸ì • ë§ì€ ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆì–´ìš”. ë‹¤ë¥¸ ì‚¬ëŒì˜ ì‘ì€ ë…¸ë ¥ë„ ì•Œì•„ë³´ê³  ê²©ë ¤í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒì´ ë˜ì—ˆì–´ìš”.",
                            vulnerability: "ê°€ì¥ ì•½í–ˆë˜ ìˆœê°„ë“¤ì´ ë‹¹ì‹ ì—ê²Œ ì§„ì§œ ê°•í•¨ì´ ë¬´ì—‡ì¸ì§€ ì•Œë ¤ì£¼ì—ˆì–´ìš”. ì•½í•¨ì„ ì¸ì •í•  ìˆ˜ ìˆëŠ” ìš©ê¸°ê°€ ì§„ì •í•œ í˜ì´ë¼ëŠ” ê±¸ ë°°ì› ì–´ìš”.",
                            general: "ëª¨ë“  ê³ í†µìŠ¤ëŸ¬ì› ë˜ ê¸°ì–µë“¤ì´ ì§€ê¸ˆì˜ ë‹¹ì‹ ì„ ë§Œë“  ì†Œì¤‘í•œ ì¬ë£Œì˜€ì–´ìš”. ê·¸ ê²½í—˜ë“¤ ì—†ì´ëŠ” ì§€ê¸ˆì˜ ê¹Šì´ ìˆëŠ” ë‹¹ì‹ ì´ ë  ìˆ˜ ì—†ì—ˆì„ ê±°ì˜ˆìš”."
                        },
                        en: {
                            collapse: "That day you collapsed created who you are now. Without that collapse, there wouldn't be your current depth or strength. Only those who know how to fall truly know how to rise.",
                            loneliness: "Those times alone gave you the courage to face yourself. You learned what true connection is, and now you can love more deeply.",
                            silence: "Those moments you couldn't speak made you a person who listens more deeply. You became someone who knows the language of silence, and now you can recognize wordless pain too.",
                            invisible: "Being invisible made you someone who sees more carefully. You gained eyes that discover hidden things, and now you can see others' hidden pain too.",
                            crying: "Those emotions you couldn't cry gathered to become a deep spring of compassion within you now. You became able to cherish others' tears more.",
                            despair: "The experience of enduring despair taught you the true meaning of hope. Only those who've passed through the darkest places know the preciousness of small lights.",
                            hidden: "Those times you had to hide made you a more truthful person. You gained the ability to recognize sincerity behind masks, and now you can see others' sincerity too.",
                            exhaustion: "All those exhausted days taught you the true meaning of rest. Now you know how to care for yourself and can recognize others' fatigue too.",
                            recognition: "That experience of not being recognized made you a more recognizing person. You became someone who can notice and encourage others' small efforts.",
                            vulnerability: "Your most vulnerable moments taught you what true strength is. You learned that the courage to admit weakness is real power.",
                            general: "All those painful memories were precious materials that made who you are now. Without those experiences, you couldn't have become the deep person you are now."
                        },
                        pt: {
                            collapse: "Aquele dia que vocÃª desabou criou quem vocÃª Ã© agora. Sem aquele colapso, nÃ£o haveria sua profundidade ou forÃ§a atual. Apenas aqueles que sabem como cair realmente sabem como se levantar.",
                            loneliness: "Aqueles tempos sozinho lhe deram a coragem de enfrentar a si mesmo. VocÃª aprendeu o que Ã© verdadeira conexÃ£o, e agora pode amar mais profundamente.",
                            silence: "Aqueles momentos que vocÃª nÃ£o pÃ´de falar fizeram de vocÃª uma pessoa que escuta mais profundamente. VocÃª se tornou alguÃ©m que conhece a linguagem do silÃªncio, e agora pode reconhecer dor sem palavras tambÃ©m.",
                            invisible: "Ser invisÃ­vel fez de vocÃª alguÃ©m que vÃª mais cuidadosamente. VocÃª ganhou olhos que descobrem coisas escondidas, e agora pode ver a dor escondida dos outros tambÃ©m.",
                            crying: "Aquelas emoÃ§Ãµes que vocÃª nÃ£o pÃ´de chorar se juntaram para se tornar uma fonte profunda de compaixÃ£o dentro de vocÃª agora. VocÃª se tornou capaz de valorizar mais as lÃ¡grimas dos outros.",
                            despair: "A experiÃªncia de suportar desespero ensinou vocÃª o verdadeiro significado da esperanÃ§a. Apenas aqueles que passaram pelos lugares mais escuros conhecem a preciosidade de pequenas luzes.",
                            hidden: "Aqueles tempos que vocÃª teve que esconder fizeram de vocÃª uma pessoa mais verdadeira. VocÃª ganhou a habilidade de reconhecer sinceridade por trÃ¡s de mÃ¡scaras, e agora pode ver a sinceridade dos outros tambÃ©m.",
                            exhaustion: "Todos aqueles dias exaustos ensinaram vocÃª o verdadeiro significado do descanso. Agora vocÃª sabe como cuidar de si mesmo e pode reconhecer a fadiga dos outros tambÃ©m.",
                            recognition: "Aquela experiÃªncia de nÃ£o ser reconhecido fez de vocÃª uma pessoa mais reconhecedora. VocÃª se tornou alguÃ©m que pode notar e encorajar os pequenos esforÃ§os dos outros.",
                            vulnerability: "Seus momentos mais vulnerÃ¡veis ensinaram vocÃª o que Ã© verdadeira forÃ§a. VocÃª aprendeu que a coragem de admitir fraqueza Ã© poder real.",
                            general: "Todas aquelas memÃ³rias dolorosas foram materiais preciosos que fizeram quem vocÃª Ã© agora. Sem essas experiÃªncias, vocÃª nÃ£o poderia ter se tornado a pessoa profunda que Ã© agora."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Connection", emoji: "ğŸ¤",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            collapse: "ë‹¹ì‹ ì´ ë¬´ë„ˆì¡Œë˜ ê·¸ ìˆœê°„, ì„¸ìƒ ì–´ë”˜ê°€ì—ëŠ” ë˜‘ê°™ì´ ë¬´ë„ˆì§€ê³  ìˆëŠ” ëˆ„êµ°ê°€ê°€ ìˆì—ˆì–´ìš”. ìš°ë¦¬ëŠ” í˜¼ìë¼ê³  ëŠë¼ì§€ë§Œ, ì‚¬ì‹¤ì€ ê°™ì€ ì•„í””ìœ¼ë¡œ ì—°ê²°ë˜ì–´ ìˆì–´ìš”. ì§€ê¸ˆ ì´ ìˆœê°„ì—ë„ ë‹¹ì‹ ê³¼ ê°™ì€ ë§ˆìŒì¸ ì‚¬ëŒì´ ìˆì–´ìš”.",
                            loneliness: "ì™¸ë¡œì› ë˜ ë‹¹ì‹ ì˜ ë§ˆìŒì´ ì§€ê¸ˆ ì´ ê¸€ì„ ì½ëŠ” ëˆ„êµ°ê°€ì˜ ë§ˆìŒê³¼ ë§Œë‚˜ê³  ìˆì–´ìš”. ì™¸ë¡œì›€ì€ ìš°ë¦¬ë¥¼ ë¶„ë¦¬ì‹œí‚¤ëŠ” ê²ƒ ê°™ì§€ë§Œ, ì‚¬ì‹¤ì€ ë” ê¹Šì´ ì—°ê²°ì‹œì¼œì£¼ëŠ” ë‹¤ë¦¬ì˜ˆìš”.",
                            silence: "ë§í•˜ì§€ ëª»í–ˆë˜ ë‹¹ì‹ ì˜ ì¹¨ë¬µì´ ì§€ê¸ˆ ëˆ„êµ°ê°€ì˜ ê·€ì— ë“¤ë¦¬ê³  ìˆì–´ìš”. ê°™ì€ ì¹¨ë¬µì„ ê²½í—˜í•œ ì‚¬ëŒë“¤ê³¼ ë§ì—†ëŠ” ëŒ€í™”ë¥¼ ë‚˜ëˆ„ê³  ìˆì–´ìš”. ì¹¨ë¬µë„ ì†Œí†µì˜ í•œ ë°©ì‹ì´ì—ìš”.",
                            invisible: "ë³´ì´ì§€ ì•Šì•˜ë‹¤ê³  ëŠê¼ˆë˜ ë‹¹ì‹ ì„, ì§€ê¸ˆ ëˆ„êµ°ê°€ê°€ ë³´ê³  ìˆì–´ìš”. ê°™ì€ íˆ¬ëª…í•¨ì„ ê²½í—˜í•œ ì‚¬ëŒë“¤ì´ ë‹¹ì‹ ì˜ ì¡´ì¬ë¥¼ ë˜ë ·í•˜ê²Œ ì•Œì•„ë³´ê³  ìˆì–´ìš”.",
                            crying: "í˜ë¦¬ì§€ ëª»í–ˆë˜ ë‹¹ì‹ ì˜ ëˆˆë¬¼ì„, ê°™ì€ ê²½í—˜ì„ í•œ ëˆ„êµ°ê°€ê°€ ëŒ€ì‹  í˜ë ¤ì£¼ê³  ìˆì–´ìš”. ìš°ë¦¬ì˜ ëˆˆë¬¼ì€ ê°œë³„ì ì´ë©´ì„œë„ ì—°ê²°ë˜ì–´ ìˆì–´ìš”.",
                            despair: "ì ˆë§í–ˆë˜ ë‹¹ì‹ ì˜ ë§ˆìŒì„ ì´í•´í•˜ëŠ” ì‚¬ëŒë“¤ì´ ìˆì–´ìš”. ê°™ì€ ì–´ë‘ ì„ ì§€ë‚˜ì˜¨ ì‚¬ëŒë“¤ì´ ë‹¹ì‹ ì˜ ì†ì„ ì¡ê³  í•¨ê»˜ ë¹›ì„ ì°¾ì•„ê°€ê³  ìˆì–´ìš”.",
                            hidden: "ê°ì¶°ì•¼ í–ˆë˜ ë‹¹ì‹ ì˜ ì§„ì‹¬ì„, ê°™ì€ ê°€ë©´ì„ ì¨ë³¸ ì‚¬ëŒë“¤ì´ ì•Œì•„ë³´ê³  ìˆì–´ìš”. ìˆ¨ê²¨ì§„ ê²ƒë“¤ë¡œ ì—°ê²°ë˜ëŠ” ë” ê¹Šì€ ì´í•´ê°€ ìˆì–´ìš”.",
                            exhaustion: "ì§€ì³¤ë˜ ë‹¹ì‹ ì˜ ë§ˆìŒì„, ê°™ì€ í”¼ë¡œë¥¼ ê²ªì€ ì‚¬ëŒë“¤ì´ í’ˆì–´ì£¼ê³  ìˆì–´ìš”. í•¨ê»˜ ì‰¬ì–´ê°€ëŠ” ë™ë°˜ìë“¤ì´ ìˆì–´ìš”.",
                            recognition: "ì¸ì •ë°›ê³  ì‹¶ì—ˆë˜ ë‹¹ì‹ ì˜ ë§ˆìŒì„, ê°™ì€ ê°ˆë§ì„ ê°€ì§„ ì‚¬ëŒë“¤ì´ ì´í•´í•˜ê³  ìˆì–´ìš”. ì„œë¡œì˜ ì¡´ì¬ë¥¼ ì¸ì •í•´ì£¼ëŠ” ìƒˆë¡œìš´ ì—°ê²°ì´ ë§Œë“¤ì–´ì§€ê³  ìˆì–´ìš”.",
                            vulnerability: "ê°€ì¥ ì•½í–ˆë˜ ë‹¹ì‹ ì˜ ìˆœê°„ì„, ê°™ì€ ì•½í•¨ì„ ê²½í—˜í•œ ì‚¬ëŒë“¤ì´ ë°›ì•„ì£¼ê³  ìˆì–´ìš”. ì•½í•¨ìœ¼ë¡œ ì—°ê²°ë˜ëŠ” ì§„ì •í•œ ê°•í•¨ì´ ìˆì–´ìš”.",
                            general: "ë‹¹ì‹ ì˜ ëª¨ë“  ê²½í—˜ì´ ëˆ„êµ°ê°€ì™€ ì—°ê²°ë˜ì–´ ìˆì–´ìš”. í˜¼ìë¼ê³  ëŠê¼ˆë˜ ëª¨ë“  ìˆœê°„ë“¤ì´ ì‚¬ì‹¤ì€ ë‹¤ë¥¸ ëˆ„êµ°ê°€ì™€ ë§Œë‚˜ëŠ” ì ‘ì ì´ì—ˆì–´ìš”. ìš°ë¦¬ëŠ” ì„œë¡œì˜ ì´ì•¼ê¸°ë¡œ ì—°ê²°ë˜ì–´ ìˆì–´ìš”."
                        },
                        en: {
                            collapse: "In that moment you collapsed, somewhere in the world there was someone collapsing just the same. We feel alone, but we're actually connected by the same pain. Even at this moment, there's someone with the same heart as yours.",
                            loneliness: "Your lonely heart is meeting someone else's heart reading this now. Loneliness seems to separate us, but it's actually a bridge that connects us more deeply.",
                            silence: "Your silence that couldn't speak is being heard by someone's ears now. You're having wordless conversations with people who experienced the same silence. Silence is also a form of communication.",
                            invisible: "Someone is seeing you now, you who felt invisible. People who experienced the same transparency are clearly recognizing your existence.",
                            crying: "Someone who had the same experience is shedding the tears you couldn't shed. Our tears are individual yet connected.",
                            despair: "There are people who understand your despairing heart. People who passed through the same darkness are holding your hand and finding light together.",
                            hidden: "People who wore the same masks recognize your sincerity that you had to hide. There's deeper understanding connected by hidden things.",
                            exhaustion: "People who experienced the same fatigue embrace your tired heart. There are companions resting together.",
                            recognition: "People with the same longing understand your heart that wanted recognition. New connections are being made where we recognize each other's existence.",
                            vulnerability: "People who experienced the same weakness receive your most vulnerable moments. There's true strength connected by weakness.",
                            general: "All your experiences are connected to someone. All those moments you felt alone were actually meeting points with someone else. We're connected by each other's stories."
                        },
                        pt: {
                            collapse: "Naquele momento que vocÃª desabou, em algum lugar do mundo havia alguÃ©m desabando exatamente igual. Nos sentimos sozinhos, mas na verdade estamos conectados pela mesma dor. Mesmo neste momento, hÃ¡ alguÃ©m com o mesmo coraÃ§Ã£o que o seu.",
                            loneliness: "Seu coraÃ§Ã£o solitÃ¡rio estÃ¡ encontrando o coraÃ§Ã£o de alguÃ©m lendo isso agora. A solidÃ£o parece nos separar, mas na verdade Ã© uma ponte que nos conecta mais profundamente.",
                            silence: "Seu silÃªncio que nÃ£o podia falar estÃ¡ sendo ouvido pelos ouvidos de alguÃ©m agora. VocÃª estÃ¡ tendo conversas sem palavras com pessoas que experimentaram o mesmo silÃªncio. SilÃªncio tambÃ©m Ã© uma forma de comunicaÃ§Ã£o.",
                            invisible: "AlguÃ©m estÃ¡ vendo vocÃª agora, vocÃª que se sentiu invisÃ­vel. Pessoas que experimentaram a mesma transparÃªncia estÃ£o claramente reconhecendo sua existÃªncia.",
                            crying: "AlguÃ©m que teve a mesma experiÃªncia estÃ¡ derramando as lÃ¡grimas que vocÃª nÃ£o pÃ´de derramar. Nossas lÃ¡grimas sÃ£o individuais mas conectadas.",
                            despair: "HÃ¡ pessoas que entendem seu coraÃ§Ã£o desesperado. Pessoas que passaram pela mesma escuridÃ£o estÃ£o segurando sua mÃ£o e encontrando luz juntas.",
                            hidden: "Pessoas que usaram as mesmas mÃ¡scaras reconhecem sua sinceridade que vocÃª teve que esconder. HÃ¡ compreensÃ£o mais profunda conectada por coisas escondidas.",
                            exhaustion: "Pessoas que experimentaram a mesma fadiga abraÃ§am seu coraÃ§Ã£o cansado. HÃ¡ companheiros descansando juntos.",
                            recognition: "Pessoas com o mesmo anseio entendem seu coraÃ§Ã£o que queria reconhecimento. Novas conexÃµes estÃ£o sendo feitas onde reconhecemos a existÃªncia um do outro.",
                            vulnerability: "Pessoas que experimentaram a mesma fraqueza recebem seus momentos mais vulnerÃ¡veis. HÃ¡ verdadeira forÃ§a conectada pela fraqueza.",
                            general: "Todas as suas experiÃªncias estÃ£o conectadas a alguÃ©m. Todos aqueles momentos que vocÃª se sentiu sozinho eram na verdade pontos de encontro com outra pessoa. Estamos conectados pelas histÃ³rias uns dos outros."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            }
        ];
        
        let currentLanguage = 'en'; // ê¸°ë³¸ ì–¸ì–´ë¥¼ ì˜ì–´ë¡œ ì„¤ì •
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        // ============ ì—¬ì • ì´ˆê¸°í™” í•¨ìˆ˜ ============
        
        function resetJourney() {
            console.log('=== ì—¬ì • ì´ˆê¸°í™” ì‹œì‘ ===');
            
            // 1. ëª¨ë“  íƒ€ì´í•‘ íš¨ê³¼ ì™„ì „ ì •ë¦¬
            clearAllTypingEffects();
            
            // ì¶”ê°€ ì•ˆì „ì¥ì¹˜ - ëª¨ë“  timer ì •ë¦¬
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            
            // 2. ëª¨ë“  ì½˜í…ì¸  ì„¹ì…˜ ì™„ì „ ì´ˆê¸°í™”
            const sectionsToReset = [
                'portalIntroSection',
                'characterResponsesSection', 
                'lightMessageSection',
                'portalQuestionSection',
                'userInputSection',
                'userReactionsSection',
                'continueSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    } else {
                        const textElements = section.querySelectorAll('.portal-intro, .light-message, .portal-question, .continue-text');
                        textElements.forEach(el => {
                            el.innerHTML = '';
                            el.textContent = '';
                        });
                    }
                }
            });
            
            // 3. íŠ¹ì • ìš”ì†Œë“¤ ê°œë³„ ì´ˆê¸°í™”
            const portalIntro = document.getElementById('portalIntro');
            const lightMessage = document.getElementById('lightMessage');
            const portalQuestion = document.getElementById('portalQuestion');
            const continueText = document.getElementById('continueText');
            
            if (portalIntro) portalIntro.innerHTML = '';
            if (lightMessage) lightMessage.innerHTML = '';
            if (portalQuestion) portalQuestion.innerHTML = '';
            if (continueText) continueText.innerHTML = '';
            
            // 4. í…ìŠ¤íŠ¸ì˜ì—­ ì™„ì „ ì´ˆê¸°í™”
            const userTextarea = document.getElementById('userTextarea');
            if (userTextarea) {
                userTextarea.disabled = false;
                userTextarea.value = '';
                userTextarea.style.height = 'auto';
                userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            }
            
            // 5. ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì´ˆê¸°í™”
            const mainContent = document.getElementById('mainContent');
            if (mainContent) {
                mainContent.scrollTop = 0;
            }
            
            // 6. ìƒíƒœ ë³€ìˆ˜ ì™„ì „ ì´ˆê¸°í™”
            userResponse = '';
            currentTypingElement = null;
            
            console.log('=== ì—¬ì • ì´ˆê¸°í™” ì™„ë£Œ ===');
        }
        
        // ============ ê°œì„ ëœ ì–¸ì–´ ë³€ê²½ í•¨ìˆ˜ ============
        
        function changeLanguage(lang) {
            if (!translations[lang]) {
                console.error('ì§€ì›í•˜ì§€ ì•ŠëŠ” ì–¸ì–´:', lang);
                return;
            }
            
            if (currentLanguage === lang) {
                return;
            }
            
            if (journeyStarted) {
                const confirmMessage = translations[currentLanguage].languageChangeConfirm;
                const shouldRestart = confirm(confirmMessage);
                
                if (!shouldRestart) {
                    return;
                }
            }
            
            const previousLanguage = currentLanguage;
            currentLanguage = lang;
            
            console.log(`ì–¸ì–´ ë³€ê²½: ${previousLanguage} â†’ ${currentLanguage}`);
            
            if (journeyStarted) {
                resetJourney();
            }
            
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                setTimeout(() => {
                    console.log(`ìƒˆë¡œìš´ ì–¸ì–´(${currentLanguage})ë¡œ ì—¬ì • ì¬ì‹œì‘`);
                    startPortalSequence();
                }, 1000);
            }
        }
        
        // ============ UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤ ============
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            // ê°œë³„ ìš”ì†Œ ì—…ë°ì´íŠ¸
            const elements = [
                'logoSubtitle',
                'portalMainTitle', 
                'portalSubtitle',
                'lightTitle',
                'continueYesBtn',
                'continueNoBtn'
            ];
            
            elements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element && translations[lang]) {
                    const key = elementId.replace('Btn', 'Button').replace('Subtitle', 'Subtitle');
                    let translationKey = key;
                    
                    const keyMapping = {
                        'logoSubtitle': 'logoSubtitle',
                        'portalMainTitle': 'portalMainTitle',
                        'portalSubtitle': 'portalSubtitle',
                        'lightTitle': 'lightTitle',
                        'continueYesButton': 'continueYes',
                        'continueNoButton': 'continueNo'
                    };
                    
                    translationKey = keyMapping[key] || key;
                    
                    if (translations[lang][translationKey]) {
                        element.textContent = translations[lang][translationKey];
                    }
                }
            });
            
            // placeholder ì—…ë°ì´íŠ¸
            const textarea = document.getElementById('userTextarea');
            if (textarea) textarea.placeholder = translations[lang].inputPlaceholder;
        }
        
        // ============ ê°œì„ ëœ íƒ€ì´í•‘ íš¨ê³¼ + ìŠ¤í¬ë¡¤ ì¶”ì  ì‹œìŠ¤í…œ ============
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i % 10 === 0) {
                        scrollToFollowTyping(element);
                    }
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        
                        setTimeout(() => {
                            if (document.contains(element)) {
                                scrollToFollowTyping(element);
                            }
                        }, 200);
                        
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        // ============ ìŠ¤ë§ˆíŠ¸ ìŠ¤í¬ë¡¤ ì‹œìŠ¤í…œ ============
        
        function scrollToFollowTyping(element) {
            const mainContent = document.getElementById('mainContent');
            const elementRect = element.getBoundingClientRect();
            const containerRect = mainContent.getBoundingClientRect();
            
            if (elementRect.bottom > containerRect.bottom - 150) {
                const scrollTop = mainContent.scrollTop;
                const elementOffsetTop = element.offsetTop;
                const targetScroll = elementOffsetTop - (containerRect.height / 2);
                
                mainContent.scrollTo({
                    top: Math.max(0, targetScroll),
                    behavior: 'smooth'
                });
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        // ============ ì–¸ì–´ ë²„íŠ¼ ì´ë²¤íŠ¸ ì„¤ì • ============
        
        function setupLanguageButtons() {
            const langButtons = document.querySelectorAll('.lang-btn');
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const newLang = this.dataset.lang;
                    changeLanguage(newLang);
                });
            });
        }
        
        // ============ ë©”ì¸ ì—¬ì • ì‹œìŠ¤í…œ ============
        
        function initializeTemarix() {
            console.log('=== Temarix Portal 09 ì´ˆê¸°í™” ì‹œì‘ ===');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        // ============ ì—¬ì • ë‹¨ê³„ë“¤ ============
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            const introText = translations[currentLanguage].portalIntro;
            await typewriterEffect(introElement, introText, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const dialogueText = translations[currentLanguage][char.key];
                await typewriterEffect(dialogueDiv, dialogueText, 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            const lightText = translations[currentLanguage].lightMessage;
            await typewriterEffect(lightMessageEl, lightText, 60);
            
            setTimeout(() => {
                showQuestion();
            }, 2000);
        }
        
        async function showQuestion() {
            const questionSection = document.getElementById('portalQuestionSection');
            const questionEl = document.getElementById('portalQuestion');
            
            questionSection.classList.add('show');
            
            const questionText = translations[currentLanguage].portalQuestion;
            await typewriterEffect(questionEl, questionText, 50);
            
            setTimeout(() => {
                enableUserInput();
            }, 1500);
        }
        
        // ============ ì‚¬ìš©ì ì…ë ¥ ì‹œìŠ¤í…œ ============
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', handleTextareaKeydown);
            
            document.getElementById('continueYesBtn').addEventListener('click', function() {
                processContinue('Y');
            });
            
            document.getElementById('continueNoBtn').addEventListener('click', function() {
                processContinue('N');
            });
        }
        
        function handleTextareaKeydown(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                const inputValue = this.value.trim();
                
                if (inputValue) {
                    processUserInput(inputValue);
                }
            }
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                showUserReactions(inputText);
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = `<strong>${youLabel}:</strong> "${text}"`;
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showContinueOption();
            }, 2000);
        }
        
        async function showContinueOption() {
            const continueSection = document.getElementById('continueSection');
            const continueText = document.getElementById('continueText');
            
            continueSection.classList.add('show');
            
            const questionText = translations[currentLanguage].continueText;
            await typewriterEffect(continueText, questionText, 50);
            
            setTimeout(() => {
                scrollToElement(continueSection);
            }, 500);
        }
        
        function processContinue(input) {
            if (input === 'Y') {
                const message = currentLanguage === 'ko' ? 
                    'Portal 10ì´ ê³§ ì¤€ë¹„ë©ë‹ˆë‹¤. ê³„ì†í•´ì„œ ë” ê¹Šì€ ê°ì •ì˜ ì—¬ì •ì´ ì´ì–´ì§‘ë‹ˆë‹¤.' :
                    currentLanguage === 'en' ? 
                    'Portal 10 will be ready soon. The journey into deeper emotions continues.' :
                    'Portal 10 estarÃ¡ pronto em breve. A jornada para emoÃ§Ãµes mais profundas continua.';
                alert(message);
            } else if (input === 'N') {
                const message = currentLanguage === 'ko' ? 
                    'ì—¬ì •ì´ ì¼ì‹œ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì–¸ì œë“  ë‹¤ì‹œ ëŒì•„ì™€ ê³„ì†í•˜ì„¸ìš”.' :
                    currentLanguage === 'en' ? 
                    'The journey has been paused. Come back and continue anytime.' :
                    'A jornada foi pausada. Volte e continue a qualquer momento.';
                alert(message);
            }
        }
        
        // ============ ì´ˆê¸°í™” ============
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V2 Portal 09 DOM ë¡œë“œ ì™„ë£Œ');
            
            // ìë™ ë¡œê·¸ì¸ ì²˜ë¦¬ (ë¡œê·¸ì¸ ëª¨ë‹¬ ì œê±°)
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            memoryStorage.mockUser = currentUser;
            
            updateStaticTranslations(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>