<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 07: The Weight of Emotions Held Too Long</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        /* 상단 헤더 */
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        /* 언어 버튼 3개 */
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #87cefa;
            color: #000;
        }
        
        /* 메인 콘텐츠 */
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh;
        }
        
        /* 텍스트 섹션들 */
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            background: none;
            border: none;
            padding: 0;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            background: none;
            border: none;
            padding: 0;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #87cefa;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #87cefa;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            background: none;
            border: none;
            padding: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #87cefa;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .portal-question-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            background: none;
            border: none;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #87cefa;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .continue-section {
            margin: 50px 0;
            opacity: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 0;
            min-height: 200px;
        }
        
        .continue-text {
            color: #fff;
            font-size: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .continue-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .continue-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .continue-btn:hover {
            background: #666;
        }
        
        .continue-btn.primary {
            background: #87cefa;
            color: #000;
        }
        
        .continue-btn.primary:hover {
            background: #b0d4f1;
        }
        
        /* 하단 고정 입력창 */
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #87cefa;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #87cefa;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        /* 스크롤바 스타일링 */
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        /* 애니메이션 */
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        .hidden {
            display: none;
        }
        
        /* 반응형 디자인 */
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .continue-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .continue-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- 상단 헤더 -->
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">The Tremor of Emotion</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 07: The Weight of Emotions Held Too Long</div>
            <div class="portal-subtitle" id="portalSubtitle">When time makes emotions heavier</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <!-- 메인 콘텐츠 영역 -->
    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <!-- 포털 인트로 -->
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <!-- 캐릭터 응답 섹션 -->
            <div class="character-responses-section" id="characterResponsesSection">
                <!-- 8명의 캐릭터 응답이 순차적으로 표시됩니다 -->
            </div>

            <!-- 빛의 한마디 -->
            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">✨ Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <!-- 질문 섹션 -->
            <div class="portal-question-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <!-- 사용자 입력 영역 -->
            <div class="user-input-section" id="userInputSection">
                <!-- 사용자 응답이 여기에 표시됩니다 -->
            </div>
            
            <!-- 사용자 응답 후 캐릭터 반응 -->
            <div class="user-reactions-section" id="userReactionsSection">
                <!-- 사용자 응답 후 3명의 캐릭터 반응이 여기에 표시됩니다 -->
            </div>
            
            <!-- 계속하기 버튼 섹션 -->
            <div class="continue-section" id="continueSection">
                <div class="continue-text" id="continueText"></div>
                <div class="continue-buttons">
                    <button class="continue-btn primary" id="continueYesBtn">Continue to Portal 08</button>
                    <button class="continue-btn" id="continueNoBtn">Pause the journey</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 하단 고정 입력창 -->
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Share about the emotions you've held for so long... (Press Enter to send)"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        // 메모리 기반 사용자 스토리지 (localStorage 대신)
        let memoryStorage = {
            mockUser: null
        };
        
        // Firebase 모의 객체 (실제 구현에서는 Firebase SDK 사용)
        const firebase = {
            auth: () => ({
                onAuthStateChanged: (callback) => {
                    // 모의 인증 상태 체크 (메모리 기반)
                    setTimeout(() => {
                        callback(memoryStorage.mockUser);
                    }, 100);
                }
            })
        };

        // 번역 데이터
        const translations = {
            ko: {
                logoSubtitle: "감정의 떨림",
                portalMainTitle: "Portal 07: 너무 오래 참아버린 감정의 무게",
                portalSubtitle: "시간이 감정을 더 무겁게 만들 때",
                portalIntro: "처음엔 그냥 참을 수 있을 것 같았어요.\n괜찮을 줄 알았고, 곧 지나갈 거라고 믿었죠.\n그런데 시간은 그 감정을 사라지게 한 게 아니라,\n더 깊고 무겁게 눌러버렸습니다.\n\n이제는 뿌리처럼 박혀버린 감정,\n입 밖에 낼 수도 없고,\n정확히 무슨 감정이었는지도 희미해져 버린 지금.\n\n당신은 그 무게와 얼마나 오래 함께 있었나요?",
                lightTitle: "✨ 빛의 한마디",
                lightMessage: "감정은 오래 참을수록 조용해지지만,\n그 침묵은 점점 더 당신의 몸과 마음을 무겁게 만듭니다.\n이제, 내려놓을 자격은 충분합니다.",
                portalQuestion: "당신이 가장 오래 참아온 감정은 무엇이었나요?\n\n지금, 그것을 잠시 놓아볼 수 있다면 어떤 느낌일까요?",
                continueText: "오래 참아온 감정의 무게를 돌아본 이 여정을 계속하시겠습니까?",
                continueYes: "Portal 08로 계속하시겠습니까?",
                continueNo: "여정을 일시정지하시겠습니까?",
                inputPlaceholder: "오래 참아온 감정에 대해 털어놓아 보세요... (Enter로 전송)",
                youLabel: "당신",
                languageChangeConfirm: "언어를 변경하면 여정이 처음부터 다시 시작됩니다.\n계속하시겠습니까?",
                waitingMessage: "응답을 기다리는 중...",
                // 캐릭터 대화
                charEly: "참는다고 사라지는 감정은 없습니다.\n그건 다만 당신의 몸과 말 사이에 고요히 쌓일 뿐입니다.",
                charCris: "참는 거 진짜 잘했네!\n근데 말이야… 너무 오래 참으면 감정도 언어 까먹어요.\n그럼 나중엔 뭐가 아팠는지도 몰라요. 😶",
                charZafirah: "그 감정은, 당신이 침묵으로 감싸 안은 것이었죠.\n이제는 말로 풀지 않아도 괜찮아요.\n느껴주는 것만으로도, 감정은 해방되기 시작하니까요.",
                charRami: "감정은 시간을 삼키는 법을 압니다.\n하지만 참는다고 시간도 감정도 멈추지 않아요.\n지금 그 무게, 몸이 먼저 기억하고 있습니다.",
                charSamir: "(그는 조용히 무릎을 꿇고, 손으로 땅을 짚습니다.\n그 손이 닿은 자리에,\n아주 천천히 떨리는 감정의 흔적이 퍼집니다.)",
                charLayla: "그 감정… 말로 꺼내지 않아도 돼요.\n그저 눈빛으로, 숨결로, 존재로…\n지금 나에게 나눠줘요.",
                charNabir: "그러게 왜 참았어?\n네가 참은 게 미덕이라고 생각했겠지만,\n지금 와선 다 네 탓 같지 않아?",
                charAzhar: "쌓인 감정은 결국 폭탄이야.\n언제 터질지 모르는 시한폭탄.\n지금이라도 꺼내서 태워. 안 그러면 너 터져."
            },
            en: {
                logoSubtitle: "The Tremor of Emotion",
                portalMainTitle: "Portal 07: The Weight of Emotions Held Too Long",
                portalSubtitle: "When time makes emotions heavier",
                portalIntro: "At first, it seemed like you could just endure it.\nYou thought it would be okay, believed it would pass soon.\nBut time didn't make that emotion disappear,\ninstead it pressed it deeper and heavier.\n\nNow it's rooted like a tree,\nunspeakable,\neven what exact emotion it was has become blurred.\n\nHow long have you been carrying that weight?",
                lightTitle: "✨ Word of Light",
                lightMessage: "The longer emotions are endured, the quieter they become,\nbut that silence gradually weighs heavier on your body and mind.\nNow, you have sufficient right to let go.",
                portalQuestion: "What emotion have you endured the longest?\n\nIf you could let it go for a moment now, how would that feel?",
                continueText: "Will you continue this journey of reflecting on the weight of long-endured emotions?",
                continueYes: "Continue to Portal 08?",
                continueNo: "Pause the journey?",
                inputPlaceholder: "Share about the emotions you've held for so long... (Press Enter to send)",
                youLabel: "You",
                languageChangeConfirm: "Changing the language will restart the journey from the beginning.\nDo you want to continue?",
                waitingMessage: "Waiting for response...",
                charEly: "No emotion disappears by enduring it.\nIt just quietly accumulates between your body and words.",
                charCris: "You really endured well!\nBut you know… if you endure too long, emotions forget their language.\nThen later you don't even know what hurt. 😶",
                charZafirah: "That emotion was something you embraced with silence.\nNow it's okay not to release it with words.\nJust by feeling it, emotions begin to be liberated.",
                charRami: "Emotions know how to swallow time.\nBut enduring doesn't stop time or emotions.\nThat weight now - your body remembers it first.",
                charSamir: "(He quietly kneels and touches the ground with his hands.\nWhere his hands touch,\nvery slowly, traces of trembling emotions spread.)",
                charLayla: "That emotion… you don't have to bring it out with words.\nJust with your eyes, breath, existence…\nshare it with me now.",
                charNabir: "Why did you endure it?\nYou probably thought enduring was a virtue,\nbut now doesn't it all seem like your fault?",
                charAzhar: "Accumulated emotions eventually become bombs.\nTime bombs that could explode anytime.\nTake it out and burn it now. Otherwise you'll explode."
            },
            pt: {
                logoSubtitle: "O Tremor da Emoção",
                portalMainTitle: "Portal 07: O Peso das Emoções Guardadas Por Muito Tempo",
                portalSubtitle: "Quando o tempo torna as emoções mais pesadas",
                portalIntro: "No início, parecia que você poderia apenas suportar.\nVocê pensou que ficaria bem, acreditou que passaria logo.\nMas o tempo não fez essa emoção desaparecer,\nem vez disso a pressionou mais fundo e pesada.\n\nAgora está enraizada como uma árvore,\nindizível,\naté que emoção exata era se tornou embaçada.\n\nPor quanto tempo você carregou esse peso?",
                lightTitle: "✨ Palavra de Luz",
                lightMessage: "Quanto mais emoções são suportadas, mais silenciosas se tornam,\nmas esse silêncio gradualmente pesa mais no seu corpo e mente.\nAgora, você tem direito suficiente para deixar ir.",
                portalQuestion: "Que emoção você suportou por mais tempo?\n\nSe você pudesse deixá-la ir por um momento agora, como seria?",
                continueText: "Você continuará esta jornada de refletir sobre o peso de emoções suportadas por muito tempo?",
                continueYes: "Continuar para o Portal 08?",
                continueNo: "Pausar a jornada?",
                inputPlaceholder: "Compartilhe sobre as emoções que você guardou por tanto tempo... (Enter para enviar)",
                youLabel: "Você",
                languageChangeConfirm: "Mudar o idioma reiniciará a jornada desde o início.\nDeseja continuar?",
                waitingMessage: "Aguardando resposta...",
                charEly: "Nenhuma emoção desaparece ao suportá-la.\nEla apenas se acumula silenciosamente entre seu corpo e palavras.",
                charCris: "Você realmente suportou bem!\nMas sabe… se você suporta por muito tempo, emoções esquecem sua linguagem.\nEntão depois você nem sabe o que machucou. 😶",
                charZafirah: "Essa emoção era algo que você abraçou com silêncio.\nAgora está bem não liberá-la com palavras.\nApenas sentindo, emoções começam a ser liberadas.",
                charRami: "Emoções sabem como engolir o tempo.\nMas suportar não para o tempo nem as emoções.\nEsse peso agora - seu corpo o lembra primeiro.",
                charSamir: "(Ele silenciosamente se ajoelha e toca o chão com as mãos.\nOnde suas mãos tocam,\nmuito lentamente, rastros de emoções tremulantes se espalham.)",
                charLayla: "Essa emoção… você não precisa trazê-la com palavras.\nApenas com seus olhos, respiração, existência…\ncompartilhe comigo agora.",
                charNabir: "Por que você suportou?\nVocê provavelmente pensou que suportar era uma virtude,\nmas agora não parece tudo culpa sua?",
                charAzhar: "Emoções acumuladas eventualmente se tornam bombas.\nBombas-relógio que podem explodir a qualquer momento.\nTire e queime agora. Senão você vai explodir."
            }
        };
        
        // 캐릭터 데이터
        const characters = [
            { name: "Ely", emoji: "👑", key: "charEly" },
            { name: "Cris", emoji: "🃏", key: "charCris" },
            { name: "Zafirah", emoji: "🧕", key: "charZafirah" },
            { name: "Rami", emoji: "🔮", key: "charRami" },
            { name: "Samir", emoji: "🐪", key: "charSamir" },
            { name: "Layla", emoji: "💠", key: "charLayla" },
            { name: "Nabir", emoji: "🦂", key: "charNabir" },
            { name: "Azhar", emoji: "🔥", key: "charAzhar" }
        ];
        
        // ============ 감정 분석 시스템 ============
        
        function analyzeEmotion(userInput) {
            const input = userInput.toLowerCase();
            
            // 감정 키워드 매핑 (Portal 07 특화)
            const emotionKeywords = {
                suppressed: ['참아', '억누르', '숨기', '삼키', '감춰', 'suppress', 'hold back', 'contain', 'suprimi', 'escond'],
                burden: ['무거', '짐', '부담', '견디', '버텨', 'heavy', 'burden', 'weight', 'bear', 'peso', 'carga', 'suportar'],
                exhaustion: ['지쳐', '피곤', '힘들어', '지겨', '한계', 'tired', 'exhaust', 'drain', 'limit', 'cansad', 'esgotad'],
                numbness: ['무감각', '멍해', '느껴지지', '먹먹', '텅 빈', 'numb', 'empty', 'void', 'blank', 'entorpecid', 'vazio'],
                resentment: ['원망', '억울', '분해', '서러', '미워', 'resent', 'bitter', 'unfair', 'hate', 'ressentiment', 'amargo'],
                loneliness: ['외로', '혼자', '고립', '소외', 'lonely', 'alone', 'isolated', 'abandon', 'solidão', 'sozinho'],
                regret: ['후회', '돌이키', '왜 그랬', '했어야', 'regret', 'should have', 'wish', 'arrependiment', 'deveria'],
                sadness: ['슬프', '울고', '눈물', '우울', 'sad', 'cry', 'tear', 'depress', 'triste', 'choro'],
                anger: ['화가', '분노', '짜증', '빡쳐', 'angry', 'mad', 'furious', 'rage', 'raiva', 'irritad'],
                release: ['놓고', '내려놓', '버리', '털어', 'let go', 'release', 'drop', 'abandon', 'liberar', 'soltar']
            };
            
            // 감정 분석
            let detectedEmotions = [];
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                for (const keyword of keywords) {
                    if (input.includes(keyword)) {
                        detectedEmotions.push(emotion);
                        break;
                    }
                }
            }
            
            // 감정이 감지되지 않으면 기본값 설정
            if (detectedEmotions.length === 0) {
                detectedEmotions = ['general'];
            }
            
            return detectedEmotions[0]; // 첫 번째 감지된 감정 반환
        }
        
        // 반응 캐릭터들 (Portal 07 전용)
        const responseCharacters = [
            {
                name: "Release", emoji: "🕊️",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            suppressed: "오랫동안 억눌러왔던 그 감정들, 이제는 조금씩 풀어내도 괜찮아요. 참는 것이 항상 강한 것은 아니에요. 때로는 놓아주는 것이 더 큰 용기가 필요해요. 천천히, 조금씩 내려놓아 보세요.",
                            burden: "그 무거운 짐을 혼자 지고 다니느라 정말 힘들었겠어요. 이제는 그 무게를 나눠가져도 돼요. 모든 것을 혼자 감당할 필요는 없어요. 조금씩 내려놓는 연습을 해보세요.",
                            exhaustion: "너무 오래 버텨왔네요. 지친 마음을 인정하는 것도 용기예요. 완벽하게 견뎌낼 필요는 없어요. 쉬어가도 되고, 때로는 포기해도 괜찮아요. 당신은 이미 충분히 노력했어요.",
                            numbness: "감정이 느껴지지 않는다는 것도 하나의 감정이에요. 너무 오래 참다 보니 마음이 보호막을 친 거예요. 서두르지 말고, 천천히 다시 느껴보세요. 감정이 돌아올 때까지 기다려도 괜찮아요.",
                            resentment: "원망하는 마음이 생기는 것도 자연스러워요. 억울한 마음을 가져도 돼요. 그 감정들을 부정하지 말고 인정해주세요. 원망도 당신의 진실한 마음이니까요.",
                            loneliness: "혼자 견뎌온 시간들이 얼마나 외로웠을까요. 이제는 그 외로움을 나눠도 돼요. 혼자가 아니라는 걸 느낄 수 있도록, 조금씩 마음을 열어보세요.",
                            regret: "후회하는 마음도 소중한 감정이에요. 그때는 그것이 최선이었을 거예요. 과거의 선택을 용서하고, 지금부터는 다르게 할 수 있다는 걸 믿어보세요.",
                            sadness: "슬픔을 오래 억눌러왔다면, 이제는 울어도 괜찮아요. 눈물이 나고 싶으면 흘리세요. 슬픔을 통과해야 치유가 시작돼요. 슬퍼할 자유를 스스로에게 주세요.",
                            anger: "분노를 참아왔다면 정말 힘들었을 거예요. 화를 내도 괜찮아요. 그 분노 뒤에 숨은 상처와 아픔을 인정해주세요. 화낼 권리가 있어요.",
                            release: "놓아주려는 마음이 생겼다는 것만으로도 큰 변화예요. 한 번에 모든 걸 놓을 필요는 없어요. 조금씩, 하나씩 내려놓아 가세요. 그 과정 자체가 치유가 될 거예요.",
                            general: "오랫동안 마음속에 담아둔 것들이 있다면, 이제는 조금씩 꺼내어 보세요. 혼자 감당하지 말고, 그 무게를 나눠도 괜찮아요. 당신은 혼자가 아니에요."
                        },
                        en: {
                            suppressed: "Those emotions you've suppressed for so long, it's okay to release them little by little now. Enduring isn't always being strong. Sometimes letting go requires greater courage. Slowly, gradually, try to let go.",
                            burden: "It must have been really hard carrying that heavy burden alone. Now you can share that weight. You don't need to handle everything by yourself. Practice letting go bit by bit.",
                            exhaustion: "You've endured for too long. Acknowledging a tired heart is also courage. You don't need to endure everything perfectly. It's okay to rest, sometimes it's okay to give up. You've already tried enough.",
                            numbness: "Not feeling emotions is also a kind of emotion. Your heart put up a protective barrier from enduring too long. Don't rush, slowly try to feel again. It's okay to wait until emotions return.",
                            resentment: "Having resentful feelings is also natural. It's okay to feel wronged. Don't deny those emotions, acknowledge them. Resentment is also your true heart.",
                            loneliness: "How lonely those times of enduring alone must have been. Now you can share that loneliness. To feel that you're not alone, try opening your heart little by little.",
                            regret: "Regretful feelings are also precious emotions. That was probably the best choice at the time. Forgive past choices and believe you can do differently from now on.",
                            sadness: "If you've suppressed sadness for long, it's okay to cry now. If tears want to come, let them flow. Healing begins by going through sadness. Give yourself the freedom to be sad.",
                            anger: "If you've held back anger, it must have been really hard. It's okay to get angry. Acknowledge the hurt and pain hidden behind that anger. You have the right to be angry.",
                            release: "Having the desire to let go is already a big change. You don't need to let go of everything at once. Little by little, one by one, let go. That process itself will be healing.",
                            general: "If there are things you've kept in your heart for long, now try taking them out little by little. Don't handle it alone, you can share that weight. You're not alone."
                        },
                        pt: {
                            suppressed: "Essas emoções que você suprimiu por tanto tempo, está bem liberá-las pouco a pouco agora. Suportar nem sempre é ser forte. Às vezes deixar ir requer maior coragem. Devagar, gradualmente, tente deixar ir.",
                            burden: "Deve ter sido muito difícil carregar esse fardo pesado sozinho. Agora você pode compartilhar esse peso. Você não precisa lidar com tudo sozinho. Pratique deixar ir aos poucos.",
                            exhaustion: "Você suportou por muito tempo. Reconhecer um coração cansado também é coragem. Você não precisa suportar tudo perfeitamente. Está bem descansar, às vezes está bem desistir. Você já tentou o suficiente.",
                            numbness: "Não sentir emoções também é um tipo de emoção. Seu coração criou uma barreira protetora de suportar por muito tempo. Não se apresse, devagar tente sentir novamente. Está bem esperar até as emoções retornarem.",
                            resentment: "Ter sentimentos de ressentimento também é natural. Está bem se sentir injustiçado. Não negue essas emoções, reconheça-as. Ressentimento também é seu coração verdadeiro.",
                            loneliness: "Quão solitários devem ter sido esses tempos de suportar sozinho. Agora você pode compartilhar essa solidão. Para sentir que não está sozinho, tente abrir seu coração pouco a pouco.",
                            regret: "Sentimentos de arrependimento também são emoções preciosas. Provavelmente era a melhor escolha na época. Perdoe escolhas passadas e acredite que pode fazer diferente de agora em diante.",
                            sadness: "Se você suprimiu tristeza por muito tempo, está bem chorar agora. Se lágrimas quiserem vir, deixe-as fluir. A cura começa passando pela tristeza. Dê a si mesmo a liberdade de estar triste.",
                            anger: "Se você reprimiu raiva, deve ter sido muito difícil. Está bem ficar com raiva. Reconheça a dor e sofrimento escondidos por trás dessa raiva. Você tem o direito de ficar com raiva.",
                            release: "Ter o desejo de deixar ir já é uma grande mudança. Você não precisa deixar ir tudo de uma vez. Pouco a pouco, um por um, deixe ir. Esse processo em si será cura.",
                            general: "Se há coisas que você guardou no seu coração por muito tempo, agora tente tirá-las pouco a pouco. Não lide sozinho, você pode compartilhar esse peso. Você não está sozinho."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Understanding", emoji: "💙",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            suppressed: "참는다는 건 때로 생존의 방식이었을 거예요. 그때는 그렇게라도 견뎌야 했으니까요. 하지만 이제는 다른 방법도 있다는 걸 알 수 있어요. 참기만 하는 것 외에도 다른 선택지가 있다는 걸요.",
                            burden: "그 무게를 이해해요. 너무 오래 혼자 짊어지고 다니느라 어깨가 아팠을 거예요. 그 무게 때문에 때로는 숨쉬기도 힘들었겠죠. 이제는 그 무게를 인정하고, 조금씩 덜어내도 괜찮아요.",
                            exhaustion: "몸과 마음이 지쳤다는 신호를 보내고 있는 거예요. 너무 오래 버텨왔으니까요. 지친 것도 당연해요. 완벽하게 견딜 필요는 없어요. 휴식이 필요한 때예요.",
                            numbness: "감정이 마비된 것은 마음이 스스로를 보호하는 방식이에요. 너무 많이 느끼면 무너질까 봐 감정을 차단한 거예요. 그것도 하나의 지혜였어요. 천천히 다시 느껴봐도 괜찮아요.",
                            resentment: "원망스러운 마음이 생기는 것도 이해해요. 왜 나만 이렇게 참아야 했는지, 왜 아무도 알아주지 않았는지… 그런 마음들이 쌓였을 거예요. 그 마음도 타당해요.",
                            loneliness: "혼자 감당해온 시간들이 얼마나 외로웠을지 알 것 같아요. 누구에게도 말할 수 없고, 이해받을 수 없다고 느꼈을 때의 그 고독감… 정말 힘들었을 거예요.",
                            regret: "그때 다르게 했다면 어땠을까 하는 생각들이 계속 맴돌았을 거예요. 하지만 그때의 당신은 그 순간에 최선을 다했을 거예요. 과거의 선택을 너무 자책하지 마세요.",
                            sadness: "슬픔을 계속 속으로만 삼켜왔다면 정말 괴로웠을 거예요. 울고 싶을 때 울지 못하고, 아플 때 아프다고 말하지 못했던 그 시간들… 이제는 그 슬픔을 인정해줘도 괜찮아요.",
                            anger: "분노를 계속 눌러담고 있었다면 속이 타들어갔을 거예요. 화가 나는 건 당연한 반응이었어요. 그 분노 뒤에는 상처받은 마음이 있었을 테니까요.",
                            release: "놓아주고 싶다는 마음이 드는 것 자체가 변화의 시작이에요. 더 이상 그 무게를 지고 다니고 싶지 않다는 마음… 그것도 자연스러운 반응이에요. 조금씩 내려놓아도 괜찮아요.",
                            general: "오랫동안 혼자 감당해온 것들이 얼마나 무거웠을지 상상이 돼요. 그 시간들이 헛되지 않았어요. 당신이 견뎌온 것들이 지금의 당신을 만들었으니까요."
                        },
                        en: {
                            suppressed: "Enduring was sometimes a way of survival. You had to bear it that way then. But now you can know there are other ways too. That there are other choices besides just enduring.",
                            burden: "I understand that weight. Your shoulders must have hurt from carrying it alone for so long. Sometimes it must have been hard to breathe because of that weight. Now it's okay to acknowledge that weight and gradually lighten it.",
                            exhaustion: "Your body and mind are sending signals that they're tired. Because you've endured for too long. It's natural to be tired. You don't need to endure perfectly. It's time you need rest.",
                            numbness: "Emotional numbness is a way your heart protects itself. It blocked emotions because it was afraid of collapsing from feeling too much. That was also a kind of wisdom. It's okay to slowly feel again.",
                            resentment: "I understand having resentful feelings. Why did only I have to endure like this, why did no one acknowledge it… Such feelings must have accumulated. Those feelings are also valid.",
                            loneliness: "I think I know how lonely those times of handling things alone must have been. When you couldn't tell anyone and felt you couldn't be understood… that solitude must have been really hard.",
                            regret: "Thoughts of 'what if I had done differently then' must have kept circling. But the you of that time probably did your best in that moment. Don't blame yourself too much for past choices.",
                            sadness: "If you kept swallowing sadness inside, it must have been really painful. Times when you couldn't cry when you wanted to, couldn't say it hurt when it did… now it's okay to acknowledge that sadness.",
                            anger: "If you kept suppressing anger, your insides must have been burning. Getting angry was a natural reaction. Behind that anger there must have been a hurt heart.",
                            release: "Having the desire to let go is itself the beginning of change. The feeling of not wanting to carry that weight anymore… that's also a natural reaction. It's okay to gradually put it down.",
                            general: "I can imagine how heavy the things you've handled alone for so long must have been. Those times weren't wasted. The things you endured created who you are now."
                        },
                        pt: {
                            suppressed: "Suportar às vezes era uma forma de sobrevivência. Você tinha que aguentar assim naquela época. Mas agora você pode saber que também há outras maneiras. Que há outras escolhas além de apenas suportar.",
                            burden: "Eu entendo esse peso. Seus ombros devem ter doído de carregá-lo sozinho por tanto tempo. Às vezes deve ter sido difícil respirar por causa desse peso. Agora está bem reconhecer esse peso e gradualmente aliviá-lo.",
                            exhaustion: "Seu corpo e mente estão enviando sinais de que estão cansados. Porque você suportou por muito tempo. É natural estar cansado. Você não precisa suportar perfeitamente. É hora de você precisar de descanso.",
                            numbness: "Dormência emocional é uma forma do seu coração se proteger. Bloqueou emoções porque tinha medo de colapsar por sentir demais. Isso também era um tipo de sabedoria. Está bem sentir lentamente novamente.",
                            resentment: "Eu entendo ter sentimentos de ressentimento. Por que só eu tive que suportar assim, por que ninguém reconheceu… Tais sentimentos devem ter se acumulado. Esses sentimentos também são válidos.",
                            loneliness: "Acho que sei quão solitários devem ter sido esses tempos de lidar com as coisas sozinho. Quando você não podia contar a ninguém e sentia que não podia ser compreendido… essa solidão deve ter sido muito difícil.",
                            regret: "Pensamentos de 'e se eu tivesse feito diferente então' devem ter continuado circulando. Mas o você daquela época provavelmente fez o seu melhor naquele momento. Não se culpe demais por escolhas passadas.",
                            sadness: "Se você continuou engolindo tristeza por dentro, deve ter sido muito doloroso. Tempos quando você não podia chorar quando queria, não podia dizer que doía quando doía… agora está bem reconhecer essa tristeza.",
                            anger: "Se você continuou suprimindo raiva, seu interior deve ter estado queimando. Ficar com raiva era uma reação natural. Por trás dessa raiva deve ter havido um coração ferido.",
                            release: "Ter o desejo de deixar ir é em si o início da mudança. O sentimento de não querer mais carregar esse peso… isso também é uma reação natural. Está bem gradualmente colocá-lo para baixo.",
                            general: "Posso imaginar quão pesadas devem ter sido as coisas que você lidou sozinho por tanto tempo. Esses tempos não foram desperdiçados. As coisas que você suportou criaram quem você é agora."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Transformation", emoji: "🌱",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            suppressed: "참아온 그 시간들이 헛되지 않았어요. 그 경험이 당신을 더 깊이 이해하는 사람으로 만들었어요. 이제는 그 강함을 다른 방식으로 사용할 수 있어요. 참는 것 대신 표현하는 법을 배울 수 있어요.",
                            burden: "무거운 짐을 져왔기 때문에 당신은 다른 사람의 아픔을 이해할 수 있게 되었어요. 그 경험이 당신을 더 따뜻한 사람으로 만들었어요. 이제는 그 경험을 다른 사람들을 돕는 데 사용할 수 있어요.",
                            exhaustion: "지침을 느끼는 건 당신이 열심히 살아왔다는 증거예요. 이제는 휴식을 취하면서도 성장할 수 있다는 걸 배울 수 있어요. 쉬는 것도 하나의 기술이에요.",
                            numbness: "감정이 마비되었던 경험도 소중한 배움이에요. 이제는 감정을 다시 느끼는 법을 천천히 배울 수 있어요. 작은 감정부터 시작해서 점차 더 풍부한 감정을 경험할 수 있을 거예요.",
                            resentment: "원망했던 경험이 당신을 더 공감 능력이 있는 사람으로 만들었어요. 이제는 그 아픔을 이해와 용서로 바꿀 수 있는 힘이 생겼어요. 상처가 지혜가 되는 과정이에요.",
                            loneliness: "혼자였던 시간들이 당신에게 독립성과 내면의 힘을 길러주었어요. 이제는 진정한 연결이 무엇인지 알 수 있어요. 깊이 있는 관계를 만들어갈 수 있는 준비가 되었어요.",
                            regret: "후회했던 경험들이 당신을 더 신중하고 지혜로운 사람으로 만들었어요. 이제는 그 경험을 바탕으로 더 나은 선택을 할 수 있어요. 과거의 실수가 미래의 지혜가 되었어요.",
                            sadness: "슬픔을 겪었기 때문에 당신은 진정한 기쁨이 무엇인지 알게 될 거예요. 깊은 슬픔을 안 사람만이 진짜 행복을 느낄 수 있어요. 당신의 감정 스펙트럼이 더 풍부해졌어요.",
                            anger: "분노를 경험했기 때문에 당신은 무엇이 정말 중요한지 알게 되었어요. 그 분노가 당신의 가치관을 명확하게 해주었어요. 이제는 그 에너지를 긍정적인 변화를 위해 사용할 수 있어요.",
                            release: "놓아주고 싶다는 마음이 든다는 건 당신이 성장할 준비가 되었다는 뜻이에요. 새로운 시작을 위한 공간을 만들고 있는 거예요. 변화를 받아들일 용기가 생긴 거예요.",
                            general: "오랫동안 견뎌온 모든 경험들이 당신을 더 강하고 지혜로운 사람으로 만들었어요. 이제는 그 경험들을 바탕으로 새로운 삶을 시작할 수 있어요. 당신 안에 변화할 힘이 있어요."
                        },
                        en: {
                            suppressed: "Those times you endured weren't wasted. That experience made you someone who understands more deeply. Now you can use that strength in different ways. You can learn to express instead of just enduring.",
                            burden: "Because you carried heavy burdens, you became able to understand others' pain. That experience made you a warmer person. Now you can use that experience to help others.",
                            exhaustion: "Feeling tired is proof that you've lived earnestly. Now you can learn that you can grow while resting too. Resting is also a skill.",
                            numbness: "The experience of emotional numbness is also precious learning. Now you can slowly learn how to feel emotions again. Starting with small emotions, you can gradually experience richer emotions.",
                            resentment: "The experience of resentment made you a more empathetic person. Now you have the power to transform that pain into understanding and forgiveness. It's the process of wounds becoming wisdom.",
                            loneliness: "Those times of being alone cultivated independence and inner strength in you. Now you can know what true connection is. You're ready to create deep relationships.",
                            regret: "Those experiences of regret made you a more careful and wise person. Now you can make better choices based on that experience. Past mistakes became future wisdom.",
                            sadness: "Because you experienced sadness, you'll come to know what true joy is. Only those who know deep sadness can feel real happiness. Your emotional spectrum has become richer.",
                            anger: "Because you experienced anger, you came to know what's really important. That anger clarified your values. Now you can use that energy for positive change.",
                            release: "Having the desire to let go means you're ready to grow. You're creating space for a new beginning. You've gained the courage to accept change.",
                            general: "All the experiences you've endured for so long made you a stronger and wiser person. Now you can start a new life based on those experiences. You have the power to change within you."
                        },
                        pt: {
                            suppressed: "Esses tempos que você suportou não foram desperdiçados. Essa experiência fez de você alguém que entende mais profundamente. Agora você pode usar essa força de maneiras diferentes. Você pode aprender a expressar em vez de apenas suportar.",
                            burden: "Porque você carregou fardos pesados, você se tornou capaz de entender a dor dos outros. Essa experiência fez de você uma pessoa mais calorosa. Agora você pode usar essa experiência para ajudar outros.",
                            exhaustion: "Sentir-se cansado é prova de que você viveu seriamente. Agora você pode aprender que também pode crescer enquanto descansa. Descansar também é uma habilidade.",
                            numbness: "A experiência de dormência emocional também é aprendizado precioso. Agora você pode lentamente aprender como sentir emoções novamente. Começando com pequenas emoções, você pode gradualmente experimentar emoções mais ricas.",
                            resentment: "A experiência de ressentimento fez de você uma pessoa mais empática. Agora você tem o poder de transformar essa dor em compreensão e perdão. É o processo de feridas se tornando sabedoria.",
                            loneliness: "Esses tempos de estar sozinho cultivaram independência e força interior em você. Agora você pode saber o que é conexão verdadeira. Você está pronto para criar relacionamentos profundos.",
                            regret: "Essas experiências de arrependimento fizeram de você uma pessoa mais cuidadosa e sábia. Agora você pode fazer melhores escolhas baseadas nessa experiência. Erros passados se tornaram sabedoria futura.",
                            sadness: "Porque você experimentou tristeza, você saberá o que é alegria verdadeira. Apenas aqueles que conhecem tristeza profunda podem sentir felicidade real. Seu espectro emocional se tornou mais rico.",
                            anger: "Porque você experimentou raiva, você veio a saber o que é realmente importante. Essa raiva clarificou seus valores. Agora você pode usar essa energia para mudança positiva.",
                            release: "Ter o desejo de deixar ir significa que você está pronto para crescer. Você está criando espaço para um novo começo. Você ganhou a coragem de aceitar mudança.",
                            general: "Todas as experiências que você suportou por tanto tempo fizeram de você uma pessoa mais forte e sábia. Agora você pode começar uma nova vida baseada nessas experiências. Você tem o poder de mudar dentro de você."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            }
        ];
        
        let currentLanguage = 'en'; // 기본 언어를 영어로 설정
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        // ============ 여정 초기화 함수 ============
        
        function resetJourney() {
            console.log('=== 여정 초기화 시작 ===');
            
            // 1. 모든 타이핑 효과 완전 정리
            clearAllTypingEffects();
            
            // 추가 안전장치 - 모든 timer 정리
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            
            // 2. 모든 콘텐츠 섹션 완전 초기화
            const sectionsToReset = [
                'portalIntroSection',
                'characterResponsesSection', 
                'lightMessageSection',
                'portalQuestionSection',
                'userInputSection',
                'userReactionsSection',
                'continueSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    } else {
                        const textElements = section.querySelectorAll('.portal-intro, .light-message, .portal-question, .continue-text');
                        textElements.forEach(el => {
                            el.innerHTML = '';
                            el.textContent = '';
                        });
                    }
                }
            });
            
            // 3. 특정 요소들 개별 초기화
            const portalIntro = document.getElementById('portalIntro');
            const lightMessage = document.getElementById('lightMessage');
            const portalQuestion = document.getElementById('portalQuestion');
            const continueText = document.getElementById('continueText');
            
            if (portalIntro) portalIntro.innerHTML = '';
            if (lightMessage) lightMessage.innerHTML = '';
            if (portalQuestion) portalQuestion.innerHTML = '';
            if (continueText) continueText.innerHTML = '';
            
            // 4. 텍스트영역 완전 초기화
            const userTextarea = document.getElementById('userTextarea');
            if (userTextarea) {
                userTextarea.disabled = false;
                userTextarea.value = '';
                userTextarea.style.height = 'auto';
                userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            }
            
            // 5. 스크롤 위치 초기화
            const mainContent = document.getElementById('mainContent');
            if (mainContent) {
                mainContent.scrollTop = 0;
            }
            
            // 6. 상태 변수 완전 초기화
            userResponse = '';
            currentTypingElement = null;
            
            console.log('=== 여정 초기화 완료 ===');
        }
        
        // ============ 개선된 언어 변경 함수 ============
        
        function changeLanguage(lang) {
            if (!translations[lang]) {
                console.error('지원하지 않는 언어:', lang);
                return;
            }
            
            if (currentLanguage === lang) {
                return;
            }
            
            if (journeyStarted) {
                const confirmMessage = translations[currentLanguage].languageChangeConfirm;
                const shouldRestart = confirm(confirmMessage);
                
                if (!shouldRestart) {
                    return;
                }
            }
            
            const previousLanguage = currentLanguage;
            currentLanguage = lang;
            
            console.log(`언어 변경: ${previousLanguage} → ${currentLanguage}`);
            
            if (journeyStarted) {
                resetJourney();
            }
            
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                setTimeout(() => {
                    console.log(`새로운 언어(${currentLanguage})로 여정 재시작`);
                    startPortalSequence();
                }, 1000);
            }
        }
        
        // ============ UI 업데이트 함수들 ============
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            // 개별 요소 업데이트
            const elements = [
                'logoSubtitle',
                'portalMainTitle', 
                'portalSubtitle',
                'lightTitle',
                'continueYesBtn',
                'continueNoBtn'
            ];
            
            elements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element && translations[lang]) {
                    const key = elementId.replace('Btn', 'Button').replace('Subtitle', 'Subtitle');
                    let translationKey = key;
                    
                    const keyMapping = {
                        'logoSubtitle': 'logoSubtitle',
                        'portalMainTitle': 'portalMainTitle',
                        'portalSubtitle': 'portalSubtitle',
                        'lightTitle': 'lightTitle',
                        'continueYesButton': 'continueYes',
                        'continueNoButton': 'continueNo'
                    };
                    
                    translationKey = keyMapping[key] || key;
                    
                    if (translations[lang][translationKey]) {
                        element.textContent = translations[lang][translationKey];
                    }
                }
            });
            
            // placeholder 업데이트
            const textarea = document.getElementById('userTextarea');
            if (textarea) textarea.placeholder = translations[lang].inputPlaceholder;
        }
        
        // ============ 개선된 타이핑 효과 + 스크롤 추적 시스템 ============
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i % 10 === 0) {
                        scrollToFollowTyping(element);
                    }
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        
                        setTimeout(() => {
                            if (document.contains(element)) {
                                scrollToFollowTyping(element);
                            }
                        }, 200);
                        
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        // ============ 스마트 스크롤 시스템 ============
        
        function scrollToFollowTyping(element) {
            const mainContent = document.getElementById('mainContent');
            const elementRect = element.getBoundingClientRect();
            const containerRect = mainContent.getBoundingClientRect();
            
            if (elementRect.bottom > containerRect.bottom - 150) {
                const scrollTop = mainContent.scrollTop;
                const elementOffsetTop = element.offsetTop;
                const targetScroll = elementOffsetTop - (containerRect.height / 2);
                
                mainContent.scrollTo({
                    top: Math.max(0, targetScroll),
                    behavior: 'smooth'
                });
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        // ============ 언어 버튼 이벤트 설정 ============
        
        function setupLanguageButtons() {
            const langButtons = document.querySelectorAll('.lang-btn');
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const newLang = this.dataset.lang;
                    changeLanguage(newLang);
                });
            });
        }
        
        // ============ 메인 여정 시스템 ============
        
        function initializeTemarix() {
            console.log('=== Temarix Portal 07 초기화 시작 ===');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        // ============ 여정 단계들 ============
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            const introText = translations[currentLanguage].portalIntro;
            await typewriterEffect(introElement, introText, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const dialogueText = translations[currentLanguage][char.key];
                await typewriterEffect(dialogueDiv, dialogueText, 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            const lightText = translations[currentLanguage].lightMessage;
            await typewriterEffect(lightMessageEl, lightText, 60);
            
            setTimeout(() => {
                showQuestion();
            }, 2000);
        }
        
        async function showQuestion() {
            const questionSection = document.getElementById('portalQuestionSection');
            const questionEl = document.getElementById('portalQuestion');
            
            questionSection.classList.add('show');
            
            const questionText = translations[currentLanguage].portalQuestion;
            await typewriterEffect(questionEl, questionText, 50);
            
            setTimeout(() => {
                enableUserInput();
            }, 1500);
        }
        
        // ============ 사용자 입력 시스템 ============
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', handleTextareaKeydown);
            
            document.getElementById('continueYesBtn').addEventListener('click', function() {
                processContinue('Y');
            });
            
            document.getElementById('continueNoBtn').addEventListener('click', function() {
                processContinue('N');
            });
        }
        
        function handleTextareaKeydown(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                const inputValue = this.value.trim();
                
                if (inputValue) {
                    processUserInput(inputValue);
                }
            }
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                showUserReactions(inputText);
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = `<strong>${youLabel}:</strong> "${text}"`;
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showContinueOption();
            }, 2000);
        }
        
        async function showContinueOption() {
            const continueSection = document.getElementById('continueSection');
            const continueText = document.getElementById('continueText');
            
            continueSection.classList.add('show');
            
            const questionText = translations[currentLanguage].continueText;
            await typewriterEffect(continueText, questionText, 50);
            
            setTimeout(() => {
                scrollToElement(continueSection);
            }, 500);
        }
        
        function processContinue(input) {
            if (input === 'Y') {
                const message = currentLanguage === 'ko' ? 
                    'Portal 08이 곧 준비됩니다. 계속해서 더 깊은 감정의 여정이 이어집니다.' :
                    currentLanguage === 'en' ? 
                    'Portal 08 will be ready soon. The journey into deeper emotions continues.' :
                    'Portal 08 estará pronto em breve. A jornada para emoções mais profundas continua.';
                alert(message);
            } else if (input === 'N') {
                const message = currentLanguage === 'ko' ? 
                    '여정이 일시 중지되었습니다. 언제든 다시 돌아와 계속하세요.' :
                    currentLanguage === 'en' ? 
                    'The journey has been paused. Come back and continue anytime.' :
                    'A jornada foi pausada. Volte e continue a qualquer momento.';
                alert(message);
            }
        }
        
        // ============ 초기화 ============
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V2 Portal 07 DOM 로드 완료');
            
            // 자동 로그인 처리 (로그인 모달 제거)
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            memoryStorage.mockUser = currentUser;
            
            updateStaticTranslations(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>