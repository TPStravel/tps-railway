<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 07: The Weight of Emotions Held Too Long</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        /* ìƒë‹¨ í—¤ë” */
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        /* ì–¸ì–´ ë²„íŠ¼ 3ê°œ */
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #87cefa;
            color: #000;
        }
        
        /* ë©”ì¸ ì½˜í…ì¸  */
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh;
        }
        
        /* í…ìŠ¤íŠ¸ ì„¹ì…˜ë“¤ */
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            background: none;
            border: none;
            padding: 0;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            background: none;
            border: none;
            padding: 0;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #87cefa;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #87cefa;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            background: none;
            border: none;
            padding: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #87cefa;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .portal-question-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            background: none;
            border: none;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #87cefa;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .continue-section {
            margin: 50px 0;
            opacity: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 0;
            min-height: 200px;
        }
        
        .continue-text {
            color: #fff;
            font-size: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .continue-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .continue-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .continue-btn:hover {
            background: #666;
        }
        
        .continue-btn.primary {
            background: #87cefa;
            color: #000;
        }
        
        .continue-btn.primary:hover {
            background: #b0d4f1;
        }
        
        /* í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ */
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #87cefa;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #87cefa;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ */
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        .hidden {
            display: none;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .continue-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .continue-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- ìƒë‹¨ í—¤ë” -->
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">The Tremor of Emotion</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 07: The Weight of Emotions Held Too Long</div>
            <div class="portal-subtitle" id="portalSubtitle">When time makes emotions heavier</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <!-- í¬í„¸ ì¸íŠ¸ë¡œ -->
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <!-- ìºë¦­í„° ì‘ë‹µ ì„¹ì…˜ -->
            <div class="character-responses-section" id="characterResponsesSection">
                <!-- 8ëª…ì˜ ìºë¦­í„° ì‘ë‹µì´ ìˆœì°¨ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>

            <!-- ë¹›ì˜ í•œë§ˆë”” -->
            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">âœ¨ Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <!-- ì§ˆë¬¸ ì„¹ì…˜ -->
            <div class="portal-question-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <!-- ì‚¬ìš©ì ì…ë ¥ ì˜ì—­ -->
            <div class="user-input-section" id="userInputSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ ìºë¦­í„° ë°˜ì‘ -->
            <div class="user-reactions-section" id="userReactionsSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ 3ëª…ì˜ ìºë¦­í„° ë°˜ì‘ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ê³„ì†í•˜ê¸° ë²„íŠ¼ ì„¹ì…˜ -->
            <div class="continue-section" id="continueSection">
                <div class="continue-text" id="continueText"></div>
                <div class="continue-buttons">
                    <button class="continue-btn primary" id="continueYesBtn">Continue to Portal 08</button>
                    <button class="continue-btn" id="continueNoBtn">Pause the journey</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ -->
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Share about the emotions you've held for so long... (Press Enter to send)"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        // ë©”ëª¨ë¦¬ ê¸°ë°˜ ì‚¬ìš©ì ìŠ¤í† ë¦¬ì§€ (localStorage ëŒ€ì‹ )
        let memoryStorage = {
            mockUser: null
        };
        
        // Firebase ëª¨ì˜ ê°ì²´ (ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” Firebase SDK ì‚¬ìš©)
        const firebase = {
            auth: () => ({
                onAuthStateChanged: (callback) => {
                    // ëª¨ì˜ ì¸ì¦ ìƒíƒœ ì²´í¬ (ë©”ëª¨ë¦¬ ê¸°ë°˜)
                    setTimeout(() => {
                        callback(memoryStorage.mockUser);
                    }, 100);
                }
            })
        };

        // ë²ˆì—­ ë°ì´í„°
        const translations = {
            ko: {
                logoSubtitle: "ê°ì •ì˜ ë–¨ë¦¼",
                portalMainTitle: "Portal 07: ë„ˆë¬´ ì˜¤ë˜ ì°¸ì•„ë²„ë¦° ê°ì •ì˜ ë¬´ê²Œ",
                portalSubtitle: "ì‹œê°„ì´ ê°ì •ì„ ë” ë¬´ê²ê²Œ ë§Œë“¤ ë•Œ",
                portalIntro: "ì²˜ìŒì—” ê·¸ëƒ¥ ì°¸ì„ ìˆ˜ ìˆì„ ê²ƒ ê°™ì•˜ì–´ìš”.\nê´œì°®ì„ ì¤„ ì•Œì•˜ê³ , ê³§ ì§€ë‚˜ê°ˆ ê±°ë¼ê³  ë¯¿ì—ˆì£ .\nê·¸ëŸ°ë° ì‹œê°„ì€ ê·¸ ê°ì •ì„ ì‚¬ë¼ì§€ê²Œ í•œ ê²Œ ì•„ë‹ˆë¼,\në” ê¹Šê³  ë¬´ê²ê²Œ ëˆŒëŸ¬ë²„ë ¸ìŠµë‹ˆë‹¤.\n\nì´ì œëŠ” ë¿Œë¦¬ì²˜ëŸ¼ ë°•í˜€ë²„ë¦° ê°ì •,\nì… ë°–ì— ë‚¼ ìˆ˜ë„ ì—†ê³ ,\nì •í™•íˆ ë¬´ìŠ¨ ê°ì •ì´ì—ˆëŠ”ì§€ë„ í¬ë¯¸í•´ì ¸ ë²„ë¦° ì§€ê¸ˆ.\n\në‹¹ì‹ ì€ ê·¸ ë¬´ê²Œì™€ ì–¼ë§ˆë‚˜ ì˜¤ë˜ í•¨ê»˜ ìˆì—ˆë‚˜ìš”?",
                lightTitle: "âœ¨ ë¹›ì˜ í•œë§ˆë””",
                lightMessage: "ê°ì •ì€ ì˜¤ë˜ ì°¸ì„ìˆ˜ë¡ ì¡°ìš©í•´ì§€ì§€ë§Œ,\nê·¸ ì¹¨ë¬µì€ ì ì  ë” ë‹¹ì‹ ì˜ ëª¸ê³¼ ë§ˆìŒì„ ë¬´ê²ê²Œ ë§Œë“­ë‹ˆë‹¤.\nì´ì œ, ë‚´ë ¤ë†“ì„ ìê²©ì€ ì¶©ë¶„í•©ë‹ˆë‹¤.",
                portalQuestion: "ë‹¹ì‹ ì´ ê°€ì¥ ì˜¤ë˜ ì°¸ì•„ì˜¨ ê°ì •ì€ ë¬´ì—‡ì´ì—ˆë‚˜ìš”?\n\nì§€ê¸ˆ, ê·¸ê²ƒì„ ì ì‹œ ë†“ì•„ë³¼ ìˆ˜ ìˆë‹¤ë©´ ì–´ë–¤ ëŠë‚Œì¼ê¹Œìš”?",
                continueText: "ì˜¤ë˜ ì°¸ì•„ì˜¨ ê°ì •ì˜ ë¬´ê²Œë¥¼ ëŒì•„ë³¸ ì´ ì—¬ì •ì„ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                continueYes: "Portal 08ë¡œ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                continueNo: "ì—¬ì •ì„ ì¼ì‹œì •ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                inputPlaceholder: "ì˜¤ë˜ ì°¸ì•„ì˜¨ ê°ì •ì— ëŒ€í•´ í„¸ì–´ë†“ì•„ ë³´ì„¸ìš”... (Enterë¡œ ì „ì†¡)",
                youLabel: "ë‹¹ì‹ ",
                languageChangeConfirm: "ì–¸ì–´ë¥¼ ë³€ê²½í•˜ë©´ ì—¬ì •ì´ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘ë©ë‹ˆë‹¤.\nê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                waitingMessage: "ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...",
                // ìºë¦­í„° ëŒ€í™”
                charEly: "ì°¸ëŠ”ë‹¤ê³  ì‚¬ë¼ì§€ëŠ” ê°ì •ì€ ì—†ìŠµë‹ˆë‹¤.\nê·¸ê±´ ë‹¤ë§Œ ë‹¹ì‹ ì˜ ëª¸ê³¼ ë§ ì‚¬ì´ì— ê³ ìš”íˆ ìŒ“ì¼ ë¿ì…ë‹ˆë‹¤.",
                charCris: "ì°¸ëŠ” ê±° ì§„ì§œ ì˜í–ˆë„¤!\nê·¼ë° ë§ì´ì•¼â€¦ ë„ˆë¬´ ì˜¤ë˜ ì°¸ìœ¼ë©´ ê°ì •ë„ ì–¸ì–´ ê¹Œë¨¹ì–´ìš”.\nê·¸ëŸ¼ ë‚˜ì¤‘ì—” ë­ê°€ ì•„íŒ ëŠ”ì§€ë„ ëª°ë¼ìš”. ğŸ˜¶",
                charZafirah: "ê·¸ ê°ì •ì€, ë‹¹ì‹ ì´ ì¹¨ë¬µìœ¼ë¡œ ê°ì‹¸ ì•ˆì€ ê²ƒì´ì—ˆì£ .\nì´ì œëŠ” ë§ë¡œ í’€ì§€ ì•Šì•„ë„ ê´œì°®ì•„ìš”.\nëŠê»´ì£¼ëŠ” ê²ƒë§Œìœ¼ë¡œë„, ê°ì •ì€ í•´ë°©ë˜ê¸° ì‹œì‘í•˜ë‹ˆê¹Œìš”.",
                charRami: "ê°ì •ì€ ì‹œê°„ì„ ì‚¼í‚¤ëŠ” ë²•ì„ ì••ë‹ˆë‹¤.\ní•˜ì§€ë§Œ ì°¸ëŠ”ë‹¤ê³  ì‹œê°„ë„ ê°ì •ë„ ë©ˆì¶”ì§€ ì•Šì•„ìš”.\nì§€ê¸ˆ ê·¸ ë¬´ê²Œ, ëª¸ì´ ë¨¼ì € ê¸°ì–µí•˜ê³  ìˆìŠµë‹ˆë‹¤.",
                charSamir: "(ê·¸ëŠ” ì¡°ìš©íˆ ë¬´ë¦ì„ ê¿‡ê³ , ì†ìœ¼ë¡œ ë•…ì„ ì§šìŠµë‹ˆë‹¤.\nê·¸ ì†ì´ ë‹¿ì€ ìë¦¬ì—,\nì•„ì£¼ ì²œì²œíˆ ë–¨ë¦¬ëŠ” ê°ì •ì˜ í”ì ì´ í¼ì§‘ë‹ˆë‹¤.)",
                charLayla: "ê·¸ ê°ì •â€¦ ë§ë¡œ êº¼ë‚´ì§€ ì•Šì•„ë„ ë¼ìš”.\nê·¸ì € ëˆˆë¹›ìœ¼ë¡œ, ìˆ¨ê²°ë¡œ, ì¡´ì¬ë¡œâ€¦\nì§€ê¸ˆ ë‚˜ì—ê²Œ ë‚˜ëˆ ì¤˜ìš”.",
                charNabir: "ê·¸ëŸ¬ê²Œ ì™œ ì°¸ì•˜ì–´?\në„¤ê°€ ì°¸ì€ ê²Œ ë¯¸ë•ì´ë¼ê³  ìƒê°í–ˆê² ì§€ë§Œ,\nì§€ê¸ˆ ì™€ì„  ë‹¤ ë„¤ íƒ“ ê°™ì§€ ì•Šì•„?",
                charAzhar: "ìŒ“ì¸ ê°ì •ì€ ê²°êµ­ í­íƒ„ì´ì•¼.\nì–¸ì œ í„°ì§ˆì§€ ëª¨ë¥´ëŠ” ì‹œí•œí­íƒ„.\nì§€ê¸ˆì´ë¼ë„ êº¼ë‚´ì„œ íƒœì›Œ. ì•ˆ ê·¸ëŸ¬ë©´ ë„ˆ í„°ì ¸."
            },
            en: {
                logoSubtitle: "The Tremor of Emotion",
                portalMainTitle: "Portal 07: The Weight of Emotions Held Too Long",
                portalSubtitle: "When time makes emotions heavier",
                portalIntro: "At first, it seemed like you could just endure it.\nYou thought it would be okay, believed it would pass soon.\nBut time didn't make that emotion disappear,\ninstead it pressed it deeper and heavier.\n\nNow it's rooted like a tree,\nunspeakable,\neven what exact emotion it was has become blurred.\n\nHow long have you been carrying that weight?",
                lightTitle: "âœ¨ Word of Light",
                lightMessage: "The longer emotions are endured, the quieter they become,\nbut that silence gradually weighs heavier on your body and mind.\nNow, you have sufficient right to let go.",
                portalQuestion: "What emotion have you endured the longest?\n\nIf you could let it go for a moment now, how would that feel?",
                continueText: "Will you continue this journey of reflecting on the weight of long-endured emotions?",
                continueYes: "Continue to Portal 08?",
                continueNo: "Pause the journey?",
                inputPlaceholder: "Share about the emotions you've held for so long... (Press Enter to send)",
                youLabel: "You",
                languageChangeConfirm: "Changing the language will restart the journey from the beginning.\nDo you want to continue?",
                waitingMessage: "Waiting for response...",
                charEly: "No emotion disappears by enduring it.\nIt just quietly accumulates between your body and words.",
                charCris: "You really endured well!\nBut you knowâ€¦ if you endure too long, emotions forget their language.\nThen later you don't even know what hurt. ğŸ˜¶",
                charZafirah: "That emotion was something you embraced with silence.\nNow it's okay not to release it with words.\nJust by feeling it, emotions begin to be liberated.",
                charRami: "Emotions know how to swallow time.\nBut enduring doesn't stop time or emotions.\nThat weight now - your body remembers it first.",
                charSamir: "(He quietly kneels and touches the ground with his hands.\nWhere his hands touch,\nvery slowly, traces of trembling emotions spread.)",
                charLayla: "That emotionâ€¦ you don't have to bring it out with words.\nJust with your eyes, breath, existenceâ€¦\nshare it with me now.",
                charNabir: "Why did you endure it?\nYou probably thought enduring was a virtue,\nbut now doesn't it all seem like your fault?",
                charAzhar: "Accumulated emotions eventually become bombs.\nTime bombs that could explode anytime.\nTake it out and burn it now. Otherwise you'll explode."
            },
            pt: {
                logoSubtitle: "O Tremor da EmoÃ§Ã£o",
                portalMainTitle: "Portal 07: O Peso das EmoÃ§Ãµes Guardadas Por Muito Tempo",
                portalSubtitle: "Quando o tempo torna as emoÃ§Ãµes mais pesadas",
                portalIntro: "No inÃ­cio, parecia que vocÃª poderia apenas suportar.\nVocÃª pensou que ficaria bem, acreditou que passaria logo.\nMas o tempo nÃ£o fez essa emoÃ§Ã£o desaparecer,\nem vez disso a pressionou mais fundo e pesada.\n\nAgora estÃ¡ enraizada como uma Ã¡rvore,\nindizÃ­vel,\natÃ© que emoÃ§Ã£o exata era se tornou embaÃ§ada.\n\nPor quanto tempo vocÃª carregou esse peso?",
                lightTitle: "âœ¨ Palavra de Luz",
                lightMessage: "Quanto mais emoÃ§Ãµes sÃ£o suportadas, mais silenciosas se tornam,\nmas esse silÃªncio gradualmente pesa mais no seu corpo e mente.\nAgora, vocÃª tem direito suficiente para deixar ir.",
                portalQuestion: "Que emoÃ§Ã£o vocÃª suportou por mais tempo?\n\nSe vocÃª pudesse deixÃ¡-la ir por um momento agora, como seria?",
                continueText: "VocÃª continuarÃ¡ esta jornada de refletir sobre o peso de emoÃ§Ãµes suportadas por muito tempo?",
                continueYes: "Continuar para o Portal 08?",
                continueNo: "Pausar a jornada?",
                inputPlaceholder: "Compartilhe sobre as emoÃ§Ãµes que vocÃª guardou por tanto tempo... (Enter para enviar)",
                youLabel: "VocÃª",
                languageChangeConfirm: "Mudar o idioma reiniciarÃ¡ a jornada desde o inÃ­cio.\nDeseja continuar?",
                waitingMessage: "Aguardando resposta...",
                charEly: "Nenhuma emoÃ§Ã£o desaparece ao suportÃ¡-la.\nEla apenas se acumula silenciosamente entre seu corpo e palavras.",
                charCris: "VocÃª realmente suportou bem!\nMas sabeâ€¦ se vocÃª suporta por muito tempo, emoÃ§Ãµes esquecem sua linguagem.\nEntÃ£o depois vocÃª nem sabe o que machucou. ğŸ˜¶",
                charZafirah: "Essa emoÃ§Ã£o era algo que vocÃª abraÃ§ou com silÃªncio.\nAgora estÃ¡ bem nÃ£o liberÃ¡-la com palavras.\nApenas sentindo, emoÃ§Ãµes comeÃ§am a ser liberadas.",
                charRami: "EmoÃ§Ãµes sabem como engolir o tempo.\nMas suportar nÃ£o para o tempo nem as emoÃ§Ãµes.\nEsse peso agora - seu corpo o lembra primeiro.",
                charSamir: "(Ele silenciosamente se ajoelha e toca o chÃ£o com as mÃ£os.\nOnde suas mÃ£os tocam,\nmuito lentamente, rastros de emoÃ§Ãµes tremulantes se espalham.)",
                charLayla: "Essa emoÃ§Ã£oâ€¦ vocÃª nÃ£o precisa trazÃª-la com palavras.\nApenas com seus olhos, respiraÃ§Ã£o, existÃªnciaâ€¦\ncompartilhe comigo agora.",
                charNabir: "Por que vocÃª suportou?\nVocÃª provavelmente pensou que suportar era uma virtude,\nmas agora nÃ£o parece tudo culpa sua?",
                charAzhar: "EmoÃ§Ãµes acumuladas eventualmente se tornam bombas.\nBombas-relÃ³gio que podem explodir a qualquer momento.\nTire e queime agora. SenÃ£o vocÃª vai explodir."
            }
        };
        
        // ìºë¦­í„° ë°ì´í„°
        const characters = [
            { name: "Ely", emoji: "ğŸ‘‘", key: "charEly" },
            { name: "Cris", emoji: "ğŸƒ", key: "charCris" },
            { name: "Zafirah", emoji: "ğŸ§•", key: "charZafirah" },
            { name: "Rami", emoji: "ğŸ”®", key: "charRami" },
            { name: "Samir", emoji: "ğŸª", key: "charSamir" },
            { name: "Layla", emoji: "ğŸ’ ", key: "charLayla" },
            { name: "Nabir", emoji: "ğŸ¦‚", key: "charNabir" },
            { name: "Azhar", emoji: "ğŸ”¥", key: "charAzhar" }
        ];
        
        // ============ ê°ì • ë¶„ì„ ì‹œìŠ¤í…œ ============
        
        function analyzeEmotion(userInput) {
            const input = userInput.toLowerCase();
            
            // ê°ì • í‚¤ì›Œë“œ ë§¤í•‘ (Portal 07 íŠ¹í™”)
            const emotionKeywords = {
                suppressed: ['ì°¸ì•„', 'ì–µëˆ„ë¥´', 'ìˆ¨ê¸°', 'ì‚¼í‚¤', 'ê°ì¶°', 'suppress', 'hold back', 'contain', 'suprimi', 'escond'],
                burden: ['ë¬´ê±°', 'ì§', 'ë¶€ë‹´', 'ê²¬ë””', 'ë²„í…¨', 'heavy', 'burden', 'weight', 'bear', 'peso', 'carga', 'suportar'],
                exhaustion: ['ì§€ì³', 'í”¼ê³¤', 'í˜ë“¤ì–´', 'ì§€ê²¨', 'í•œê³„', 'tired', 'exhaust', 'drain', 'limit', 'cansad', 'esgotad'],
                numbness: ['ë¬´ê°ê°', 'ë©í•´', 'ëŠê»´ì§€ì§€', 'ë¨¹ë¨¹', 'í…… ë¹ˆ', 'numb', 'empty', 'void', 'blank', 'entorpecid', 'vazio'],
                resentment: ['ì›ë§', 'ì–µìš¸', 'ë¶„í•´', 'ì„œëŸ¬', 'ë¯¸ì›Œ', 'resent', 'bitter', 'unfair', 'hate', 'ressentiment', 'amargo'],
                loneliness: ['ì™¸ë¡œ', 'í˜¼ì', 'ê³ ë¦½', 'ì†Œì™¸', 'lonely', 'alone', 'isolated', 'abandon', 'solidÃ£o', 'sozinho'],
                regret: ['í›„íšŒ', 'ëŒì´í‚¤', 'ì™œ ê·¸ë¬', 'í–ˆì–´ì•¼', 'regret', 'should have', 'wish', 'arrependiment', 'deveria'],
                sadness: ['ìŠ¬í”„', 'ìš¸ê³ ', 'ëˆˆë¬¼', 'ìš°ìš¸', 'sad', 'cry', 'tear', 'depress', 'triste', 'choro'],
                anger: ['í™”ê°€', 'ë¶„ë…¸', 'ì§œì¦', 'ë¹¡ì³', 'angry', 'mad', 'furious', 'rage', 'raiva', 'irritad'],
                release: ['ë†“ê³ ', 'ë‚´ë ¤ë†“', 'ë²„ë¦¬', 'í„¸ì–´', 'let go', 'release', 'drop', 'abandon', 'liberar', 'soltar']
            };
            
            // ê°ì • ë¶„ì„
            let detectedEmotions = [];
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                for (const keyword of keywords) {
                    if (input.includes(keyword)) {
                        detectedEmotions.push(emotion);
                        break;
                    }
                }
            }
            
            // ê°ì •ì´ ê°ì§€ë˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ ì„¤ì •
            if (detectedEmotions.length === 0) {
                detectedEmotions = ['general'];
            }
            
            return detectedEmotions[0]; // ì²« ë²ˆì§¸ ê°ì§€ëœ ê°ì • ë°˜í™˜
        }
        
        // ë°˜ì‘ ìºë¦­í„°ë“¤ (Portal 07 ì „ìš©)
        const responseCharacters = [
            {
                name: "Release", emoji: "ğŸ•Šï¸",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            suppressed: "ì˜¤ë«ë™ì•ˆ ì–µëˆŒëŸ¬ì™”ë˜ ê·¸ ê°ì •ë“¤, ì´ì œëŠ” ì¡°ê¸ˆì”© í’€ì–´ë‚´ë„ ê´œì°®ì•„ìš”. ì°¸ëŠ” ê²ƒì´ í•­ìƒ ê°•í•œ ê²ƒì€ ì•„ë‹ˆì—ìš”. ë•Œë¡œëŠ” ë†“ì•„ì£¼ëŠ” ê²ƒì´ ë” í° ìš©ê¸°ê°€ í•„ìš”í•´ìš”. ì²œì²œíˆ, ì¡°ê¸ˆì”© ë‚´ë ¤ë†“ì•„ ë³´ì„¸ìš”.",
                            burden: "ê·¸ ë¬´ê±°ìš´ ì§ì„ í˜¼ì ì§€ê³  ë‹¤ë‹ˆëŠë¼ ì •ë§ í˜ë“¤ì—ˆê² ì–´ìš”. ì´ì œëŠ” ê·¸ ë¬´ê²Œë¥¼ ë‚˜ëˆ ê°€ì ¸ë„ ë¼ìš”. ëª¨ë“  ê²ƒì„ í˜¼ì ê°ë‹¹í•  í•„ìš”ëŠ” ì—†ì–´ìš”. ì¡°ê¸ˆì”© ë‚´ë ¤ë†“ëŠ” ì—°ìŠµì„ í•´ë³´ì„¸ìš”.",
                            exhaustion: "ë„ˆë¬´ ì˜¤ë˜ ë²„í…¨ì™”ë„¤ìš”. ì§€ì¹œ ë§ˆìŒì„ ì¸ì •í•˜ëŠ” ê²ƒë„ ìš©ê¸°ì˜ˆìš”. ì™„ë²½í•˜ê²Œ ê²¬ëŒë‚¼ í•„ìš”ëŠ” ì—†ì–´ìš”. ì‰¬ì–´ê°€ë„ ë˜ê³ , ë•Œë¡œëŠ” í¬ê¸°í•´ë„ ê´œì°®ì•„ìš”. ë‹¹ì‹ ì€ ì´ë¯¸ ì¶©ë¶„íˆ ë…¸ë ¥í–ˆì–´ìš”.",
                            numbness: "ê°ì •ì´ ëŠê»´ì§€ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒë„ í•˜ë‚˜ì˜ ê°ì •ì´ì—ìš”. ë„ˆë¬´ ì˜¤ë˜ ì°¸ë‹¤ ë³´ë‹ˆ ë§ˆìŒì´ ë³´í˜¸ë§‰ì„ ì¹œ ê±°ì˜ˆìš”. ì„œë‘ë¥´ì§€ ë§ê³ , ì²œì²œíˆ ë‹¤ì‹œ ëŠê»´ë³´ì„¸ìš”. ê°ì •ì´ ëŒì•„ì˜¬ ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ë„ ê´œì°®ì•„ìš”.",
                            resentment: "ì›ë§í•˜ëŠ” ë§ˆìŒì´ ìƒê¸°ëŠ” ê²ƒë„ ìì—°ìŠ¤ëŸ¬ì›Œìš”. ì–µìš¸í•œ ë§ˆìŒì„ ê°€ì ¸ë„ ë¼ìš”. ê·¸ ê°ì •ë“¤ì„ ë¶€ì •í•˜ì§€ ë§ê³  ì¸ì •í•´ì£¼ì„¸ìš”. ì›ë§ë„ ë‹¹ì‹ ì˜ ì§„ì‹¤í•œ ë§ˆìŒì´ë‹ˆê¹Œìš”.",
                            loneliness: "í˜¼ì ê²¬ëŒì˜¨ ì‹œê°„ë“¤ì´ ì–¼ë§ˆë‚˜ ì™¸ë¡œì› ì„ê¹Œìš”. ì´ì œëŠ” ê·¸ ì™¸ë¡œì›€ì„ ë‚˜ëˆ ë„ ë¼ìš”. í˜¼ìê°€ ì•„ë‹ˆë¼ëŠ” ê±¸ ëŠë‚„ ìˆ˜ ìˆë„ë¡, ì¡°ê¸ˆì”© ë§ˆìŒì„ ì—´ì–´ë³´ì„¸ìš”.",
                            regret: "í›„íšŒí•˜ëŠ” ë§ˆìŒë„ ì†Œì¤‘í•œ ê°ì •ì´ì—ìš”. ê·¸ë•ŒëŠ” ê·¸ê²ƒì´ ìµœì„ ì´ì—ˆì„ ê±°ì˜ˆìš”. ê³¼ê±°ì˜ ì„ íƒì„ ìš©ì„œí•˜ê³ , ì§€ê¸ˆë¶€í„°ëŠ” ë‹¤ë¥´ê²Œ í•  ìˆ˜ ìˆë‹¤ëŠ” ê±¸ ë¯¿ì–´ë³´ì„¸ìš”.",
                            sadness: "ìŠ¬í””ì„ ì˜¤ë˜ ì–µëˆŒëŸ¬ì™”ë‹¤ë©´, ì´ì œëŠ” ìš¸ì–´ë„ ê´œì°®ì•„ìš”. ëˆˆë¬¼ì´ ë‚˜ê³  ì‹¶ìœ¼ë©´ í˜ë¦¬ì„¸ìš”. ìŠ¬í””ì„ í†µê³¼í•´ì•¼ ì¹˜ìœ ê°€ ì‹œì‘ë¼ìš”. ìŠ¬í¼í•  ììœ ë¥¼ ìŠ¤ìŠ¤ë¡œì—ê²Œ ì£¼ì„¸ìš”.",
                            anger: "ë¶„ë…¸ë¥¼ ì°¸ì•„ì™”ë‹¤ë©´ ì •ë§ í˜ë“¤ì—ˆì„ ê±°ì˜ˆìš”. í™”ë¥¼ ë‚´ë„ ê´œì°®ì•„ìš”. ê·¸ ë¶„ë…¸ ë’¤ì— ìˆ¨ì€ ìƒì²˜ì™€ ì•„í””ì„ ì¸ì •í•´ì£¼ì„¸ìš”. í™”ë‚¼ ê¶Œë¦¬ê°€ ìˆì–´ìš”.",
                            release: "ë†“ì•„ì£¼ë ¤ëŠ” ë§ˆìŒì´ ìƒê²¼ë‹¤ëŠ” ê²ƒë§Œìœ¼ë¡œë„ í° ë³€í™”ì˜ˆìš”. í•œ ë²ˆì— ëª¨ë“  ê±¸ ë†“ì„ í•„ìš”ëŠ” ì—†ì–´ìš”. ì¡°ê¸ˆì”©, í•˜ë‚˜ì”© ë‚´ë ¤ë†“ì•„ ê°€ì„¸ìš”. ê·¸ ê³¼ì • ìì²´ê°€ ì¹˜ìœ ê°€ ë  ê±°ì˜ˆìš”.",
                            general: "ì˜¤ë«ë™ì•ˆ ë§ˆìŒì†ì— ë‹´ì•„ë‘” ê²ƒë“¤ì´ ìˆë‹¤ë©´, ì´ì œëŠ” ì¡°ê¸ˆì”© êº¼ë‚´ì–´ ë³´ì„¸ìš”. í˜¼ì ê°ë‹¹í•˜ì§€ ë§ê³ , ê·¸ ë¬´ê²Œë¥¼ ë‚˜ëˆ ë„ ê´œì°®ì•„ìš”. ë‹¹ì‹ ì€ í˜¼ìê°€ ì•„ë‹ˆì—ìš”."
                        },
                        en: {
                            suppressed: "Those emotions you've suppressed for so long, it's okay to release them little by little now. Enduring isn't always being strong. Sometimes letting go requires greater courage. Slowly, gradually, try to let go.",
                            burden: "It must have been really hard carrying that heavy burden alone. Now you can share that weight. You don't need to handle everything by yourself. Practice letting go bit by bit.",
                            exhaustion: "You've endured for too long. Acknowledging a tired heart is also courage. You don't need to endure everything perfectly. It's okay to rest, sometimes it's okay to give up. You've already tried enough.",
                            numbness: "Not feeling emotions is also a kind of emotion. Your heart put up a protective barrier from enduring too long. Don't rush, slowly try to feel again. It's okay to wait until emotions return.",
                            resentment: "Having resentful feelings is also natural. It's okay to feel wronged. Don't deny those emotions, acknowledge them. Resentment is also your true heart.",
                            loneliness: "How lonely those times of enduring alone must have been. Now you can share that loneliness. To feel that you're not alone, try opening your heart little by little.",
                            regret: "Regretful feelings are also precious emotions. That was probably the best choice at the time. Forgive past choices and believe you can do differently from now on.",
                            sadness: "If you've suppressed sadness for long, it's okay to cry now. If tears want to come, let them flow. Healing begins by going through sadness. Give yourself the freedom to be sad.",
                            anger: "If you've held back anger, it must have been really hard. It's okay to get angry. Acknowledge the hurt and pain hidden behind that anger. You have the right to be angry.",
                            release: "Having the desire to let go is already a big change. You don't need to let go of everything at once. Little by little, one by one, let go. That process itself will be healing.",
                            general: "If there are things you've kept in your heart for long, now try taking them out little by little. Don't handle it alone, you can share that weight. You're not alone."
                        },
                        pt: {
                            suppressed: "Essas emoÃ§Ãµes que vocÃª suprimiu por tanto tempo, estÃ¡ bem liberÃ¡-las pouco a pouco agora. Suportar nem sempre Ã© ser forte. Ã€s vezes deixar ir requer maior coragem. Devagar, gradualmente, tente deixar ir.",
                            burden: "Deve ter sido muito difÃ­cil carregar esse fardo pesado sozinho. Agora vocÃª pode compartilhar esse peso. VocÃª nÃ£o precisa lidar com tudo sozinho. Pratique deixar ir aos poucos.",
                            exhaustion: "VocÃª suportou por muito tempo. Reconhecer um coraÃ§Ã£o cansado tambÃ©m Ã© coragem. VocÃª nÃ£o precisa suportar tudo perfeitamente. EstÃ¡ bem descansar, Ã s vezes estÃ¡ bem desistir. VocÃª jÃ¡ tentou o suficiente.",
                            numbness: "NÃ£o sentir emoÃ§Ãµes tambÃ©m Ã© um tipo de emoÃ§Ã£o. Seu coraÃ§Ã£o criou uma barreira protetora de suportar por muito tempo. NÃ£o se apresse, devagar tente sentir novamente. EstÃ¡ bem esperar atÃ© as emoÃ§Ãµes retornarem.",
                            resentment: "Ter sentimentos de ressentimento tambÃ©m Ã© natural. EstÃ¡ bem se sentir injustiÃ§ado. NÃ£o negue essas emoÃ§Ãµes, reconheÃ§a-as. Ressentimento tambÃ©m Ã© seu coraÃ§Ã£o verdadeiro.",
                            loneliness: "QuÃ£o solitÃ¡rios devem ter sido esses tempos de suportar sozinho. Agora vocÃª pode compartilhar essa solidÃ£o. Para sentir que nÃ£o estÃ¡ sozinho, tente abrir seu coraÃ§Ã£o pouco a pouco.",
                            regret: "Sentimentos de arrependimento tambÃ©m sÃ£o emoÃ§Ãµes preciosas. Provavelmente era a melhor escolha na Ã©poca. Perdoe escolhas passadas e acredite que pode fazer diferente de agora em diante.",
                            sadness: "Se vocÃª suprimiu tristeza por muito tempo, estÃ¡ bem chorar agora. Se lÃ¡grimas quiserem vir, deixe-as fluir. A cura comeÃ§a passando pela tristeza. DÃª a si mesmo a liberdade de estar triste.",
                            anger: "Se vocÃª reprimiu raiva, deve ter sido muito difÃ­cil. EstÃ¡ bem ficar com raiva. ReconheÃ§a a dor e sofrimento escondidos por trÃ¡s dessa raiva. VocÃª tem o direito de ficar com raiva.",
                            release: "Ter o desejo de deixar ir jÃ¡ Ã© uma grande mudanÃ§a. VocÃª nÃ£o precisa deixar ir tudo de uma vez. Pouco a pouco, um por um, deixe ir. Esse processo em si serÃ¡ cura.",
                            general: "Se hÃ¡ coisas que vocÃª guardou no seu coraÃ§Ã£o por muito tempo, agora tente tirÃ¡-las pouco a pouco. NÃ£o lide sozinho, vocÃª pode compartilhar esse peso. VocÃª nÃ£o estÃ¡ sozinho."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Understanding", emoji: "ğŸ’™",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            suppressed: "ì°¸ëŠ”ë‹¤ëŠ” ê±´ ë•Œë¡œ ìƒì¡´ì˜ ë°©ì‹ì´ì—ˆì„ ê±°ì˜ˆìš”. ê·¸ë•ŒëŠ” ê·¸ë ‡ê²Œë¼ë„ ê²¬ëŒì•¼ í–ˆìœ¼ë‹ˆê¹Œìš”. í•˜ì§€ë§Œ ì´ì œëŠ” ë‹¤ë¥¸ ë°©ë²•ë„ ìˆë‹¤ëŠ” ê±¸ ì•Œ ìˆ˜ ìˆì–´ìš”. ì°¸ê¸°ë§Œ í•˜ëŠ” ê²ƒ ì™¸ì—ë„ ë‹¤ë¥¸ ì„ íƒì§€ê°€ ìˆë‹¤ëŠ” ê±¸ìš”.",
                            burden: "ê·¸ ë¬´ê²Œë¥¼ ì´í•´í•´ìš”. ë„ˆë¬´ ì˜¤ë˜ í˜¼ì ì§Šì–´ì§€ê³  ë‹¤ë‹ˆëŠë¼ ì–´ê¹¨ê°€ ì•„íŒ ì„ ê±°ì˜ˆìš”. ê·¸ ë¬´ê²Œ ë•Œë¬¸ì— ë•Œë¡œëŠ” ìˆ¨ì‰¬ê¸°ë„ í˜ë“¤ì—ˆê² ì£ . ì´ì œëŠ” ê·¸ ë¬´ê²Œë¥¼ ì¸ì •í•˜ê³ , ì¡°ê¸ˆì”© ëœì–´ë‚´ë„ ê´œì°®ì•„ìš”.",
                            exhaustion: "ëª¸ê³¼ ë§ˆìŒì´ ì§€ì³¤ë‹¤ëŠ” ì‹ í˜¸ë¥¼ ë³´ë‚´ê³  ìˆëŠ” ê±°ì˜ˆìš”. ë„ˆë¬´ ì˜¤ë˜ ë²„í…¨ì™”ìœ¼ë‹ˆê¹Œìš”. ì§€ì¹œ ê²ƒë„ ë‹¹ì—°í•´ìš”. ì™„ë²½í•˜ê²Œ ê²¬ë”œ í•„ìš”ëŠ” ì—†ì–´ìš”. íœ´ì‹ì´ í•„ìš”í•œ ë•Œì˜ˆìš”.",
                            numbness: "ê°ì •ì´ ë§ˆë¹„ëœ ê²ƒì€ ë§ˆìŒì´ ìŠ¤ìŠ¤ë¡œë¥¼ ë³´í˜¸í•˜ëŠ” ë°©ì‹ì´ì—ìš”. ë„ˆë¬´ ë§ì´ ëŠë¼ë©´ ë¬´ë„ˆì§ˆê¹Œ ë´ ê°ì •ì„ ì°¨ë‹¨í•œ ê±°ì˜ˆìš”. ê·¸ê²ƒë„ í•˜ë‚˜ì˜ ì§€í˜œì˜€ì–´ìš”. ì²œì²œíˆ ë‹¤ì‹œ ëŠê»´ë´ë„ ê´œì°®ì•„ìš”.",
                            resentment: "ì›ë§ìŠ¤ëŸ¬ìš´ ë§ˆìŒì´ ìƒê¸°ëŠ” ê²ƒë„ ì´í•´í•´ìš”. ì™œ ë‚˜ë§Œ ì´ë ‡ê²Œ ì°¸ì•„ì•¼ í–ˆëŠ”ì§€, ì™œ ì•„ë¬´ë„ ì•Œì•„ì£¼ì§€ ì•Šì•˜ëŠ”ì§€â€¦ ê·¸ëŸ° ë§ˆìŒë“¤ì´ ìŒ“ì˜€ì„ ê±°ì˜ˆìš”. ê·¸ ë§ˆìŒë„ íƒ€ë‹¹í•´ìš”.",
                            loneliness: "í˜¼ì ê°ë‹¹í•´ì˜¨ ì‹œê°„ë“¤ì´ ì–¼ë§ˆë‚˜ ì™¸ë¡œì› ì„ì§€ ì•Œ ê²ƒ ê°™ì•„ìš”. ëˆ„êµ¬ì—ê²Œë„ ë§í•  ìˆ˜ ì—†ê³ , ì´í•´ë°›ì„ ìˆ˜ ì—†ë‹¤ê³  ëŠê¼ˆì„ ë•Œì˜ ê·¸ ê³ ë…ê°â€¦ ì •ë§ í˜ë“¤ì—ˆì„ ê±°ì˜ˆìš”.",
                            regret: "ê·¸ë•Œ ë‹¤ë¥´ê²Œ í–ˆë‹¤ë©´ ì–´ë• ì„ê¹Œ í•˜ëŠ” ìƒê°ë“¤ì´ ê³„ì† ë§´ëŒì•˜ì„ ê±°ì˜ˆìš”. í•˜ì§€ë§Œ ê·¸ë•Œì˜ ë‹¹ì‹ ì€ ê·¸ ìˆœê°„ì— ìµœì„ ì„ ë‹¤í–ˆì„ ê±°ì˜ˆìš”. ê³¼ê±°ì˜ ì„ íƒì„ ë„ˆë¬´ ìì±…í•˜ì§€ ë§ˆì„¸ìš”.",
                            sadness: "ìŠ¬í””ì„ ê³„ì† ì†ìœ¼ë¡œë§Œ ì‚¼ì¼œì™”ë‹¤ë©´ ì •ë§ ê´´ë¡œì› ì„ ê±°ì˜ˆìš”. ìš¸ê³  ì‹¶ì„ ë•Œ ìš¸ì§€ ëª»í•˜ê³ , ì•„í”Œ ë•Œ ì•„í”„ë‹¤ê³  ë§í•˜ì§€ ëª»í–ˆë˜ ê·¸ ì‹œê°„ë“¤â€¦ ì´ì œëŠ” ê·¸ ìŠ¬í””ì„ ì¸ì •í•´ì¤˜ë„ ê´œì°®ì•„ìš”.",
                            anger: "ë¶„ë…¸ë¥¼ ê³„ì† ëˆŒëŸ¬ë‹´ê³  ìˆì—ˆë‹¤ë©´ ì†ì´ íƒ€ë“¤ì–´ê°”ì„ ê±°ì˜ˆìš”. í™”ê°€ ë‚˜ëŠ” ê±´ ë‹¹ì—°í•œ ë°˜ì‘ì´ì—ˆì–´ìš”. ê·¸ ë¶„ë…¸ ë’¤ì—ëŠ” ìƒì²˜ë°›ì€ ë§ˆìŒì´ ìˆì—ˆì„ í…Œë‹ˆê¹Œìš”.",
                            release: "ë†“ì•„ì£¼ê³  ì‹¶ë‹¤ëŠ” ë§ˆìŒì´ ë“œëŠ” ê²ƒ ìì²´ê°€ ë³€í™”ì˜ ì‹œì‘ì´ì—ìš”. ë” ì´ìƒ ê·¸ ë¬´ê²Œë¥¼ ì§€ê³  ë‹¤ë‹ˆê³  ì‹¶ì§€ ì•Šë‹¤ëŠ” ë§ˆìŒâ€¦ ê·¸ê²ƒë„ ìì—°ìŠ¤ëŸ¬ìš´ ë°˜ì‘ì´ì—ìš”. ì¡°ê¸ˆì”© ë‚´ë ¤ë†“ì•„ë„ ê´œì°®ì•„ìš”.",
                            general: "ì˜¤ë«ë™ì•ˆ í˜¼ì ê°ë‹¹í•´ì˜¨ ê²ƒë“¤ì´ ì–¼ë§ˆë‚˜ ë¬´ê±°ì› ì„ì§€ ìƒìƒì´ ë¼ìš”. ê·¸ ì‹œê°„ë“¤ì´ í—›ë˜ì§€ ì•Šì•˜ì–´ìš”. ë‹¹ì‹ ì´ ê²¬ëŒì˜¨ ê²ƒë“¤ì´ ì§€ê¸ˆì˜ ë‹¹ì‹ ì„ ë§Œë“¤ì—ˆìœ¼ë‹ˆê¹Œìš”."
                        },
                        en: {
                            suppressed: "Enduring was sometimes a way of survival. You had to bear it that way then. But now you can know there are other ways too. That there are other choices besides just enduring.",
                            burden: "I understand that weight. Your shoulders must have hurt from carrying it alone for so long. Sometimes it must have been hard to breathe because of that weight. Now it's okay to acknowledge that weight and gradually lighten it.",
                            exhaustion: "Your body and mind are sending signals that they're tired. Because you've endured for too long. It's natural to be tired. You don't need to endure perfectly. It's time you need rest.",
                            numbness: "Emotional numbness is a way your heart protects itself. It blocked emotions because it was afraid of collapsing from feeling too much. That was also a kind of wisdom. It's okay to slowly feel again.",
                            resentment: "I understand having resentful feelings. Why did only I have to endure like this, why did no one acknowledge itâ€¦ Such feelings must have accumulated. Those feelings are also valid.",
                            loneliness: "I think I know how lonely those times of handling things alone must have been. When you couldn't tell anyone and felt you couldn't be understoodâ€¦ that solitude must have been really hard.",
                            regret: "Thoughts of 'what if I had done differently then' must have kept circling. But the you of that time probably did your best in that moment. Don't blame yourself too much for past choices.",
                            sadness: "If you kept swallowing sadness inside, it must have been really painful. Times when you couldn't cry when you wanted to, couldn't say it hurt when it didâ€¦ now it's okay to acknowledge that sadness.",
                            anger: "If you kept suppressing anger, your insides must have been burning. Getting angry was a natural reaction. Behind that anger there must have been a hurt heart.",
                            release: "Having the desire to let go is itself the beginning of change. The feeling of not wanting to carry that weight anymoreâ€¦ that's also a natural reaction. It's okay to gradually put it down.",
                            general: "I can imagine how heavy the things you've handled alone for so long must have been. Those times weren't wasted. The things you endured created who you are now."
                        },
                        pt: {
                            suppressed: "Suportar Ã s vezes era uma forma de sobrevivÃªncia. VocÃª tinha que aguentar assim naquela Ã©poca. Mas agora vocÃª pode saber que tambÃ©m hÃ¡ outras maneiras. Que hÃ¡ outras escolhas alÃ©m de apenas suportar.",
                            burden: "Eu entendo esse peso. Seus ombros devem ter doÃ­do de carregÃ¡-lo sozinho por tanto tempo. Ã€s vezes deve ter sido difÃ­cil respirar por causa desse peso. Agora estÃ¡ bem reconhecer esse peso e gradualmente aliviÃ¡-lo.",
                            exhaustion: "Seu corpo e mente estÃ£o enviando sinais de que estÃ£o cansados. Porque vocÃª suportou por muito tempo. Ã‰ natural estar cansado. VocÃª nÃ£o precisa suportar perfeitamente. Ã‰ hora de vocÃª precisar de descanso.",
                            numbness: "DormÃªncia emocional Ã© uma forma do seu coraÃ§Ã£o se proteger. Bloqueou emoÃ§Ãµes porque tinha medo de colapsar por sentir demais. Isso tambÃ©m era um tipo de sabedoria. EstÃ¡ bem sentir lentamente novamente.",
                            resentment: "Eu entendo ter sentimentos de ressentimento. Por que sÃ³ eu tive que suportar assim, por que ninguÃ©m reconheceuâ€¦ Tais sentimentos devem ter se acumulado. Esses sentimentos tambÃ©m sÃ£o vÃ¡lidos.",
                            loneliness: "Acho que sei quÃ£o solitÃ¡rios devem ter sido esses tempos de lidar com as coisas sozinho. Quando vocÃª nÃ£o podia contar a ninguÃ©m e sentia que nÃ£o podia ser compreendidoâ€¦ essa solidÃ£o deve ter sido muito difÃ­cil.",
                            regret: "Pensamentos de 'e se eu tivesse feito diferente entÃ£o' devem ter continuado circulando. Mas o vocÃª daquela Ã©poca provavelmente fez o seu melhor naquele momento. NÃ£o se culpe demais por escolhas passadas.",
                            sadness: "Se vocÃª continuou engolindo tristeza por dentro, deve ter sido muito doloroso. Tempos quando vocÃª nÃ£o podia chorar quando queria, nÃ£o podia dizer que doÃ­a quando doÃ­aâ€¦ agora estÃ¡ bem reconhecer essa tristeza.",
                            anger: "Se vocÃª continuou suprimindo raiva, seu interior deve ter estado queimando. Ficar com raiva era uma reaÃ§Ã£o natural. Por trÃ¡s dessa raiva deve ter havido um coraÃ§Ã£o ferido.",
                            release: "Ter o desejo de deixar ir Ã© em si o inÃ­cio da mudanÃ§a. O sentimento de nÃ£o querer mais carregar esse pesoâ€¦ isso tambÃ©m Ã© uma reaÃ§Ã£o natural. EstÃ¡ bem gradualmente colocÃ¡-lo para baixo.",
                            general: "Posso imaginar quÃ£o pesadas devem ter sido as coisas que vocÃª lidou sozinho por tanto tempo. Esses tempos nÃ£o foram desperdiÃ§ados. As coisas que vocÃª suportou criaram quem vocÃª Ã© agora."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Transformation", emoji: "ğŸŒ±",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            suppressed: "ì°¸ì•„ì˜¨ ê·¸ ì‹œê°„ë“¤ì´ í—›ë˜ì§€ ì•Šì•˜ì–´ìš”. ê·¸ ê²½í—˜ì´ ë‹¹ì‹ ì„ ë” ê¹Šì´ ì´í•´í•˜ëŠ” ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆì–´ìš”. ì´ì œëŠ” ê·¸ ê°•í•¨ì„ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”. ì°¸ëŠ” ê²ƒ ëŒ€ì‹  í‘œí˜„í•˜ëŠ” ë²•ì„ ë°°ìš¸ ìˆ˜ ìˆì–´ìš”.",
                            burden: "ë¬´ê±°ìš´ ì§ì„ ì ¸ì™”ê¸° ë•Œë¬¸ì— ë‹¹ì‹ ì€ ë‹¤ë¥¸ ì‚¬ëŒì˜ ì•„í””ì„ ì´í•´í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆì–´ìš”. ê·¸ ê²½í—˜ì´ ë‹¹ì‹ ì„ ë” ë”°ëœ»í•œ ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆì–´ìš”. ì´ì œëŠ” ê·¸ ê²½í—˜ì„ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì„ ë•ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.",
                            exhaustion: "ì§€ì¹¨ì„ ëŠë¼ëŠ” ê±´ ë‹¹ì‹ ì´ ì—´ì‹¬íˆ ì‚´ì•„ì™”ë‹¤ëŠ” ì¦ê±°ì˜ˆìš”. ì´ì œëŠ” íœ´ì‹ì„ ì·¨í•˜ë©´ì„œë„ ì„±ì¥í•  ìˆ˜ ìˆë‹¤ëŠ” ê±¸ ë°°ìš¸ ìˆ˜ ìˆì–´ìš”. ì‰¬ëŠ” ê²ƒë„ í•˜ë‚˜ì˜ ê¸°ìˆ ì´ì—ìš”.",
                            numbness: "ê°ì •ì´ ë§ˆë¹„ë˜ì—ˆë˜ ê²½í—˜ë„ ì†Œì¤‘í•œ ë°°ì›€ì´ì—ìš”. ì´ì œëŠ” ê°ì •ì„ ë‹¤ì‹œ ëŠë¼ëŠ” ë²•ì„ ì²œì²œíˆ ë°°ìš¸ ìˆ˜ ìˆì–´ìš”. ì‘ì€ ê°ì •ë¶€í„° ì‹œì‘í•´ì„œ ì ì°¨ ë” í’ë¶€í•œ ê°ì •ì„ ê²½í—˜í•  ìˆ˜ ìˆì„ ê±°ì˜ˆìš”.",
                            resentment: "ì›ë§í–ˆë˜ ê²½í—˜ì´ ë‹¹ì‹ ì„ ë” ê³µê° ëŠ¥ë ¥ì´ ìˆëŠ” ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆì–´ìš”. ì´ì œëŠ” ê·¸ ì•„í””ì„ ì´í•´ì™€ ìš©ì„œë¡œ ë°”ê¿€ ìˆ˜ ìˆëŠ” í˜ì´ ìƒê²¼ì–´ìš”. ìƒì²˜ê°€ ì§€í˜œê°€ ë˜ëŠ” ê³¼ì •ì´ì—ìš”.",
                            loneliness: "í˜¼ìì˜€ë˜ ì‹œê°„ë“¤ì´ ë‹¹ì‹ ì—ê²Œ ë…ë¦½ì„±ê³¼ ë‚´ë©´ì˜ í˜ì„ ê¸¸ëŸ¬ì£¼ì—ˆì–´ìš”. ì´ì œëŠ” ì§„ì •í•œ ì—°ê²°ì´ ë¬´ì—‡ì¸ì§€ ì•Œ ìˆ˜ ìˆì–´ìš”. ê¹Šì´ ìˆëŠ” ê´€ê³„ë¥¼ ë§Œë“¤ì–´ê°ˆ ìˆ˜ ìˆëŠ” ì¤€ë¹„ê°€ ë˜ì—ˆì–´ìš”.",
                            regret: "í›„íšŒí–ˆë˜ ê²½í—˜ë“¤ì´ ë‹¹ì‹ ì„ ë” ì‹ ì¤‘í•˜ê³  ì§€í˜œë¡œìš´ ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆì–´ìš”. ì´ì œëŠ” ê·¸ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ë” ë‚˜ì€ ì„ íƒì„ í•  ìˆ˜ ìˆì–´ìš”. ê³¼ê±°ì˜ ì‹¤ìˆ˜ê°€ ë¯¸ë˜ì˜ ì§€í˜œê°€ ë˜ì—ˆì–´ìš”.",
                            sadness: "ìŠ¬í””ì„ ê²ªì—ˆê¸° ë•Œë¬¸ì— ë‹¹ì‹ ì€ ì§„ì •í•œ ê¸°ì¨ì´ ë¬´ì—‡ì¸ì§€ ì•Œê²Œ ë  ê±°ì˜ˆìš”. ê¹Šì€ ìŠ¬í””ì„ ì•ˆ ì‚¬ëŒë§Œì´ ì§„ì§œ í–‰ë³µì„ ëŠë‚„ ìˆ˜ ìˆì–´ìš”. ë‹¹ì‹ ì˜ ê°ì • ìŠ¤í™íŠ¸ëŸ¼ì´ ë” í’ë¶€í•´ì¡Œì–´ìš”.",
                            anger: "ë¶„ë…¸ë¥¼ ê²½í—˜í–ˆê¸° ë•Œë¬¸ì— ë‹¹ì‹ ì€ ë¬´ì—‡ì´ ì •ë§ ì¤‘ìš”í•œì§€ ì•Œê²Œ ë˜ì—ˆì–´ìš”. ê·¸ ë¶„ë…¸ê°€ ë‹¹ì‹ ì˜ ê°€ì¹˜ê´€ì„ ëª…í™•í•˜ê²Œ í•´ì£¼ì—ˆì–´ìš”. ì´ì œëŠ” ê·¸ ì—ë„ˆì§€ë¥¼ ê¸ì •ì ì¸ ë³€í™”ë¥¼ ìœ„í•´ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.",
                            release: "ë†“ì•„ì£¼ê³  ì‹¶ë‹¤ëŠ” ë§ˆìŒì´ ë“ ë‹¤ëŠ” ê±´ ë‹¹ì‹ ì´ ì„±ì¥í•  ì¤€ë¹„ê°€ ë˜ì—ˆë‹¤ëŠ” ëœ»ì´ì—ìš”. ìƒˆë¡œìš´ ì‹œì‘ì„ ìœ„í•œ ê³µê°„ì„ ë§Œë“¤ê³  ìˆëŠ” ê±°ì˜ˆìš”. ë³€í™”ë¥¼ ë°›ì•„ë“¤ì¼ ìš©ê¸°ê°€ ìƒê¸´ ê±°ì˜ˆìš”.",
                            general: "ì˜¤ë«ë™ì•ˆ ê²¬ëŒì˜¨ ëª¨ë“  ê²½í—˜ë“¤ì´ ë‹¹ì‹ ì„ ë” ê°•í•˜ê³  ì§€í˜œë¡œìš´ ì‚¬ëŒìœ¼ë¡œ ë§Œë“¤ì—ˆì–´ìš”. ì´ì œëŠ” ê·¸ ê²½í—˜ë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ìƒˆë¡œìš´ ì‚¶ì„ ì‹œì‘í•  ìˆ˜ ìˆì–´ìš”. ë‹¹ì‹  ì•ˆì— ë³€í™”í•  í˜ì´ ìˆì–´ìš”."
                        },
                        en: {
                            suppressed: "Those times you endured weren't wasted. That experience made you someone who understands more deeply. Now you can use that strength in different ways. You can learn to express instead of just enduring.",
                            burden: "Because you carried heavy burdens, you became able to understand others' pain. That experience made you a warmer person. Now you can use that experience to help others.",
                            exhaustion: "Feeling tired is proof that you've lived earnestly. Now you can learn that you can grow while resting too. Resting is also a skill.",
                            numbness: "The experience of emotional numbness is also precious learning. Now you can slowly learn how to feel emotions again. Starting with small emotions, you can gradually experience richer emotions.",
                            resentment: "The experience of resentment made you a more empathetic person. Now you have the power to transform that pain into understanding and forgiveness. It's the process of wounds becoming wisdom.",
                            loneliness: "Those times of being alone cultivated independence and inner strength in you. Now you can know what true connection is. You're ready to create deep relationships.",
                            regret: "Those experiences of regret made you a more careful and wise person. Now you can make better choices based on that experience. Past mistakes became future wisdom.",
                            sadness: "Because you experienced sadness, you'll come to know what true joy is. Only those who know deep sadness can feel real happiness. Your emotional spectrum has become richer.",
                            anger: "Because you experienced anger, you came to know what's really important. That anger clarified your values. Now you can use that energy for positive change.",
                            release: "Having the desire to let go means you're ready to grow. You're creating space for a new beginning. You've gained the courage to accept change.",
                            general: "All the experiences you've endured for so long made you a stronger and wiser person. Now you can start a new life based on those experiences. You have the power to change within you."
                        },
                        pt: {
                            suppressed: "Esses tempos que vocÃª suportou nÃ£o foram desperdiÃ§ados. Essa experiÃªncia fez de vocÃª alguÃ©m que entende mais profundamente. Agora vocÃª pode usar essa forÃ§a de maneiras diferentes. VocÃª pode aprender a expressar em vez de apenas suportar.",
                            burden: "Porque vocÃª carregou fardos pesados, vocÃª se tornou capaz de entender a dor dos outros. Essa experiÃªncia fez de vocÃª uma pessoa mais calorosa. Agora vocÃª pode usar essa experiÃªncia para ajudar outros.",
                            exhaustion: "Sentir-se cansado Ã© prova de que vocÃª viveu seriamente. Agora vocÃª pode aprender que tambÃ©m pode crescer enquanto descansa. Descansar tambÃ©m Ã© uma habilidade.",
                            numbness: "A experiÃªncia de dormÃªncia emocional tambÃ©m Ã© aprendizado precioso. Agora vocÃª pode lentamente aprender como sentir emoÃ§Ãµes novamente. ComeÃ§ando com pequenas emoÃ§Ãµes, vocÃª pode gradualmente experimentar emoÃ§Ãµes mais ricas.",
                            resentment: "A experiÃªncia de ressentimento fez de vocÃª uma pessoa mais empÃ¡tica. Agora vocÃª tem o poder de transformar essa dor em compreensÃ£o e perdÃ£o. Ã‰ o processo de feridas se tornando sabedoria.",
                            loneliness: "Esses tempos de estar sozinho cultivaram independÃªncia e forÃ§a interior em vocÃª. Agora vocÃª pode saber o que Ã© conexÃ£o verdadeira. VocÃª estÃ¡ pronto para criar relacionamentos profundos.",
                            regret: "Essas experiÃªncias de arrependimento fizeram de vocÃª uma pessoa mais cuidadosa e sÃ¡bia. Agora vocÃª pode fazer melhores escolhas baseadas nessa experiÃªncia. Erros passados se tornaram sabedoria futura.",
                            sadness: "Porque vocÃª experimentou tristeza, vocÃª saberÃ¡ o que Ã© alegria verdadeira. Apenas aqueles que conhecem tristeza profunda podem sentir felicidade real. Seu espectro emocional se tornou mais rico.",
                            anger: "Porque vocÃª experimentou raiva, vocÃª veio a saber o que Ã© realmente importante. Essa raiva clarificou seus valores. Agora vocÃª pode usar essa energia para mudanÃ§a positiva.",
                            release: "Ter o desejo de deixar ir significa que vocÃª estÃ¡ pronto para crescer. VocÃª estÃ¡ criando espaÃ§o para um novo comeÃ§o. VocÃª ganhou a coragem de aceitar mudanÃ§a.",
                            general: "Todas as experiÃªncias que vocÃª suportou por tanto tempo fizeram de vocÃª uma pessoa mais forte e sÃ¡bia. Agora vocÃª pode comeÃ§ar uma nova vida baseada nessas experiÃªncias. VocÃª tem o poder de mudar dentro de vocÃª."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            }
        ];
        
        let currentLanguage = 'en'; // ê¸°ë³¸ ì–¸ì–´ë¥¼ ì˜ì–´ë¡œ ì„¤ì •
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        // ============ ì—¬ì • ì´ˆê¸°í™” í•¨ìˆ˜ ============
        
        function resetJourney() {
            console.log('=== ì—¬ì • ì´ˆê¸°í™” ì‹œì‘ ===');
            
            // 1. ëª¨ë“  íƒ€ì´í•‘ íš¨ê³¼ ì™„ì „ ì •ë¦¬
            clearAllTypingEffects();
            
            // ì¶”ê°€ ì•ˆì „ì¥ì¹˜ - ëª¨ë“  timer ì •ë¦¬
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            
            // 2. ëª¨ë“  ì½˜í…ì¸  ì„¹ì…˜ ì™„ì „ ì´ˆê¸°í™”
            const sectionsToReset = [
                'portalIntroSection',
                'characterResponsesSection', 
                'lightMessageSection',
                'portalQuestionSection',
                'userInputSection',
                'userReactionsSection',
                'continueSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    } else {
                        const textElements = section.querySelectorAll('.portal-intro, .light-message, .portal-question, .continue-text');
                        textElements.forEach(el => {
                            el.innerHTML = '';
                            el.textContent = '';
                        });
                    }
                }
            });
            
            // 3. íŠ¹ì • ìš”ì†Œë“¤ ê°œë³„ ì´ˆê¸°í™”
            const portalIntro = document.getElementById('portalIntro');
            const lightMessage = document.getElementById('lightMessage');
            const portalQuestion = document.getElementById('portalQuestion');
            const continueText = document.getElementById('continueText');
            
            if (portalIntro) portalIntro.innerHTML = '';
            if (lightMessage) lightMessage.innerHTML = '';
            if (portalQuestion) portalQuestion.innerHTML = '';
            if (continueText) continueText.innerHTML = '';
            
            // 4. í…ìŠ¤íŠ¸ì˜ì—­ ì™„ì „ ì´ˆê¸°í™”
            const userTextarea = document.getElementById('userTextarea');
            if (userTextarea) {
                userTextarea.disabled = false;
                userTextarea.value = '';
                userTextarea.style.height = 'auto';
                userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            }
            
            // 5. ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì´ˆê¸°í™”
            const mainContent = document.getElementById('mainContent');
            if (mainContent) {
                mainContent.scrollTop = 0;
            }
            
            // 6. ìƒíƒœ ë³€ìˆ˜ ì™„ì „ ì´ˆê¸°í™”
            userResponse = '';
            currentTypingElement = null;
            
            console.log('=== ì—¬ì • ì´ˆê¸°í™” ì™„ë£Œ ===');
        }
        
        // ============ ê°œì„ ëœ ì–¸ì–´ ë³€ê²½ í•¨ìˆ˜ ============
        
        function changeLanguage(lang) {
            if (!translations[lang]) {
                console.error('ì§€ì›í•˜ì§€ ì•ŠëŠ” ì–¸ì–´:', lang);
                return;
            }
            
            if (currentLanguage === lang) {
                return;
            }
            
            if (journeyStarted) {
                const confirmMessage = translations[currentLanguage].languageChangeConfirm;
                const shouldRestart = confirm(confirmMessage);
                
                if (!shouldRestart) {
                    return;
                }
            }
            
            const previousLanguage = currentLanguage;
            currentLanguage = lang;
            
            console.log(`ì–¸ì–´ ë³€ê²½: ${previousLanguage} â†’ ${currentLanguage}`);
            
            if (journeyStarted) {
                resetJourney();
            }
            
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                setTimeout(() => {
                    console.log(`ìƒˆë¡œìš´ ì–¸ì–´(${currentLanguage})ë¡œ ì—¬ì • ì¬ì‹œì‘`);
                    startPortalSequence();
                }, 1000);
            }
        }
        
        // ============ UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤ ============
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            // ê°œë³„ ìš”ì†Œ ì—…ë°ì´íŠ¸
            const elements = [
                'logoSubtitle',
                'portalMainTitle', 
                'portalSubtitle',
                'lightTitle',
                'continueYesBtn',
                'continueNoBtn'
            ];
            
            elements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element && translations[lang]) {
                    const key = elementId.replace('Btn', 'Button').replace('Subtitle', 'Subtitle');
                    let translationKey = key;
                    
                    const keyMapping = {
                        'logoSubtitle': 'logoSubtitle',
                        'portalMainTitle': 'portalMainTitle',
                        'portalSubtitle': 'portalSubtitle',
                        'lightTitle': 'lightTitle',
                        'continueYesButton': 'continueYes',
                        'continueNoButton': 'continueNo'
                    };
                    
                    translationKey = keyMapping[key] || key;
                    
                    if (translations[lang][translationKey]) {
                        element.textContent = translations[lang][translationKey];
                    }
                }
            });
            
            // placeholder ì—…ë°ì´íŠ¸
            const textarea = document.getElementById('userTextarea');
            if (textarea) textarea.placeholder = translations[lang].inputPlaceholder;
        }
        
        // ============ ê°œì„ ëœ íƒ€ì´í•‘ íš¨ê³¼ + ìŠ¤í¬ë¡¤ ì¶”ì  ì‹œìŠ¤í…œ ============
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i % 10 === 0) {
                        scrollToFollowTyping(element);
                    }
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        
                        setTimeout(() => {
                            if (document.contains(element)) {
                                scrollToFollowTyping(element);
                            }
                        }, 200);
                        
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        // ============ ìŠ¤ë§ˆíŠ¸ ìŠ¤í¬ë¡¤ ì‹œìŠ¤í…œ ============
        
        function scrollToFollowTyping(element) {
            const mainContent = document.getElementById('mainContent');
            const elementRect = element.getBoundingClientRect();
            const containerRect = mainContent.getBoundingClientRect();
            
            if (elementRect.bottom > containerRect.bottom - 150) {
                const scrollTop = mainContent.scrollTop;
                const elementOffsetTop = element.offsetTop;
                const targetScroll = elementOffsetTop - (containerRect.height / 2);
                
                mainContent.scrollTo({
                    top: Math.max(0, targetScroll),
                    behavior: 'smooth'
                });
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        // ============ ì–¸ì–´ ë²„íŠ¼ ì´ë²¤íŠ¸ ì„¤ì • ============
        
        function setupLanguageButtons() {
            const langButtons = document.querySelectorAll('.lang-btn');
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const newLang = this.dataset.lang;
                    changeLanguage(newLang);
                });
            });
        }
        
        // ============ ë©”ì¸ ì—¬ì • ì‹œìŠ¤í…œ ============
        
        function initializeTemarix() {
            console.log('=== Temarix Portal 07 ì´ˆê¸°í™” ì‹œì‘ ===');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        // ============ ì—¬ì • ë‹¨ê³„ë“¤ ============
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            const introText = translations[currentLanguage].portalIntro;
            await typewriterEffect(introElement, introText, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const dialogueText = translations[currentLanguage][char.key];
                await typewriterEffect(dialogueDiv, dialogueText, 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            const lightText = translations[currentLanguage].lightMessage;
            await typewriterEffect(lightMessageEl, lightText, 60);
            
            setTimeout(() => {
                showQuestion();
            }, 2000);
        }
        
        async function showQuestion() {
            const questionSection = document.getElementById('portalQuestionSection');
            const questionEl = document.getElementById('portalQuestion');
            
            questionSection.classList.add('show');
            
            const questionText = translations[currentLanguage].portalQuestion;
            await typewriterEffect(questionEl, questionText, 50);
            
            setTimeout(() => {
                enableUserInput();
            }, 1500);
        }
        
        // ============ ì‚¬ìš©ì ì…ë ¥ ì‹œìŠ¤í…œ ============
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', handleTextareaKeydown);
            
            document.getElementById('continueYesBtn').addEventListener('click', function() {
                processContinue('Y');
            });
            
            document.getElementById('continueNoBtn').addEventListener('click', function() {
                processContinue('N');
            });
        }
        
        function handleTextareaKeydown(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                const inputValue = this.value.trim();
                
                if (inputValue) {
                    processUserInput(inputValue);
                }
            }
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                showUserReactions(inputText);
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = `<strong>${youLabel}:</strong> "${text}"`;
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = `${char.emoji} ${char.name}`;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showContinueOption();
            }, 2000);
        }
        
        async function showContinueOption() {
            const continueSection = document.getElementById('continueSection');
            const continueText = document.getElementById('continueText');
            
            continueSection.classList.add('show');
            
            const questionText = translations[currentLanguage].continueText;
            await typewriterEffect(continueText, questionText, 50);
            
            setTimeout(() => {
                scrollToElement(continueSection);
            }, 500);
        }
        
        function processContinue(input) {
            if (input === 'Y') {
                const message = currentLanguage === 'ko' ? 
                    'Portal 08ì´ ê³§ ì¤€ë¹„ë©ë‹ˆë‹¤. ê³„ì†í•´ì„œ ë” ê¹Šì€ ê°ì •ì˜ ì—¬ì •ì´ ì´ì–´ì§‘ë‹ˆë‹¤.' :
                    currentLanguage === 'en' ? 
                    'Portal 08 will be ready soon. The journey into deeper emotions continues.' :
                    'Portal 08 estarÃ¡ pronto em breve. A jornada para emoÃ§Ãµes mais profundas continua.';
                alert(message);
            } else if (input === 'N') {
                const message = currentLanguage === 'ko' ? 
                    'ì—¬ì •ì´ ì¼ì‹œ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì–¸ì œë“  ë‹¤ì‹œ ëŒì•„ì™€ ê³„ì†í•˜ì„¸ìš”.' :
                    currentLanguage === 'en' ? 
                    'The journey has been paused. Come back and continue anytime.' :
                    'A jornada foi pausada. Volte e continue a qualquer momento.';
                alert(message);
            }
        }
        
        // ============ ì´ˆê¸°í™” ============
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V2 Portal 07 DOM ë¡œë“œ ì™„ë£Œ');
            
            // ìë™ ë¡œê·¸ì¸ ì²˜ë¦¬ (ë¡œê·¸ì¸ ëª¨ë‹¬ ì œê±°)
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            memoryStorage.mockUser = currentUser;
            
            updateStaticTranslations(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>