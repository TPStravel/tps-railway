<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 01: ë‚´ë©´ì˜ ê°ì„±</title>
    
    <!-- Firebase SDK - compat ë²„ì „ ì‚¬ìš© -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        /* ë¡œê·¸ì¸ ëª¨ë‹¬ */
        .login-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .login-container {
            background: #111;
            border: 1px solid #444;
            padding: 40px;
            max-width: 400px;
            width: 90%;
            text-align: center;
        }
        
        .login-title {
            font-size: 28px;
            color: #87cefa;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }
        
        .login-subtitle {
            font-size: 16px;
            color: #ccc;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .login-input {
            width: 100%;
            background: transparent;
            border: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            padding: 15px;
            margin: 10px 0;
            outline: none;
            transition: border-color 0.3s;
        }
        
        .login-input:focus {
            border-color: #87cefa;
        }
        
        .login-input::placeholder {
            color: #777;
        }
        
        .login-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 15px 30px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
            transition: background 0.3s;
            min-width: 120px;
        }
        
        .login-btn:hover {
            background: #666;
        }
        
        .login-btn.primary {
            background: #87cefa;
            color: #000;
        }
        
        .login-btn.primary:hover {
            background: #b0d4f1;
        }
        
        .login-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .google-login-btn {
            background: #4285f4;
            color: #fff;
            border: none;
            padding: 15px 30px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            margin: 20px 0 10px 0;
            transition: background 0.3s;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .google-login-btn:hover {
            background: #357ae8;
        }
        
        .google-login-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .login-error {
            color: #ff6666;
            font-size: 14px;
            margin-top: 15px;
            min-height: 20px;
        }
        
        .login-success {
            color: #66ff66;
            font-size: 14px;
            margin-top: 15px;
            min-height: 20px;
        }
        
        /* ìƒë‹¨ í—¤ë” */
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        /* ì–¸ì–´ ë²„íŠ¼ + ë¡œê·¸ì•„ì›ƒ */
        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #87cefa;
            color: #000;
        }
        
        .logout-btn {
            background: #ff4444;
            color: #fff;
            border: none;
            padding: 8px 16px;
            font-size: 12px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .logout-btn:hover {
            background: #ff6666;
        }
        
        /* ë©”ì¸ ì½˜í…ì¸  - ìŠ¤í¬ë¡¤ ì˜ì—­ */
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh; /* ìŠ¤í¬ë¡¤ ìœ ë„ */
        }
        
        /* ì½˜í…ì¸  ì„¹ì…˜ë“¤ */
        .content-section {
            margin: 40px 0;
            opacity: 0;
            transition: opacity 1s ease-in;
            min-height: 100px;
        }
        
        .content-section.show {
            opacity: 1;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            text-align: left;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            min-height: 80px;
        }
        
        .character-response.show {
            opacity: 1;
        }
        
        .character-name {
            font-weight: bold;
            color: #87cefa;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .light-message {
            font-size: 20px;
            color: #87cefa;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            text-align: center;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            text-align: center;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #87cefa;
            margin-right: 8px;
        }
        
        .continue-text {
            color: #fff;
            font-size: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            text-align: center;
        }
        
        .continue-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .continue-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .continue-btn:hover {
            background: #666;
        }
        
        .continue-btn.primary {
            background: #87cefa;
            color: #000;
        }
        
        .continue-btn.primary:hover {
            background: #b0d4f1;
        }
        
        /* íƒ€ì´í•‘ ì»¤ì„œ íš¨ê³¼ */
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #87cefa;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        /* í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ */
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }
        
        .input-fixed-bottom.show {
            opacity: 1;
            pointer-events: auto;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #87cefa;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #87cefa;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ */
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        /* ìˆ¨ê¹€ ìƒíƒœ */
        .hidden {
            display: none;
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .continue-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .continue-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- ë¡œê·¸ì¸ ëª¨ë‹¬ -->
    <div class="login-modal" id="loginModal">
        <div class="login-container">
            <div class="login-title">TEMARIX V2</div>
            <div class="login-subtitle" id="loginSubtitle">ìœ ë£Œ ë²„ì „ - ë¡œê·¸ì¸ í•„ìš”</div>
            
            <form id="loginForm">
                <input type="email" class="login-input" id="loginEmail" placeholder="ì´ë©”ì¼ ì£¼ì†Œ" required>
                <input type="password" class="login-input" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸" required>
                
                <button type="submit" class="login-btn primary" id="loginBtn">ë¡œê·¸ì¸</button>
                <button type="button" class="login-btn" id="signupBtn">íšŒì›ê°€ì…</button>
            </form>
            
            <!-- Google ë¡œê·¸ì¸ ë²„íŠ¼ -->
            <button class="google-login-btn" id="googleLoginBtn">
                ğŸ” Googleë¡œ ë¡œê·¸ì¸
            </button>
            
            <div class="login-error" id="loginError"></div>
            <div class="login-success" id="loginSuccess"></div>
        </div>
    </div>

    <!-- ìƒë‹¨ í—¤ë” -->
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">ê°ì •ì˜ ë–¨ë¦¼</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 01: ë‚´ë©´ì˜ ê°ì„±</div>
            <div class="portal-subtitle" id="portalSubtitle">ì˜í˜¼ì˜ ì—¬ì •ì´ ì‹œì‘ë˜ëŠ” ê³³</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn active" data-lang="ko">KR</button>
                <button class="lang-btn" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
            <button class="logout-btn" id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <!-- í¬í„¸ ì¸íŠ¸ë¡œ -->
            <div class="content-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <!-- ìºë¦­í„° ì‘ë‹µ ì„¹ì…˜ -->
            <div class="content-section" id="characterResponsesSection">
                <!-- 8ëª…ì˜ ìºë¦­í„° ì‘ë‹µì´ ìˆœì°¨ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>

            <!-- ë¹›ì˜ í•œë§ˆë”” -->
            <div class="content-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">âœ¨ ë¹›ì˜ í•œë§ˆë””</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <!-- ì§ˆë¬¸ ì„¹ì…˜ -->
            <div class="content-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <!-- ì‚¬ìš©ì ì…ë ¥ ì˜ì—­ -->
            <div class="content-section" id="userInputSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ ìºë¦­í„° ë°˜ì‘ -->
            <div class="content-section" id="userReactionsSection">
                <!-- ì‚¬ìš©ì ì‘ë‹µ í›„ 3ëª…ì˜ ìºë¦­í„° ë°˜ì‘ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <!-- ê³„ì†í•˜ê¸° ë²„íŠ¼ ì„¹ì…˜ -->
            <div class="content-section" id="continueSection">
                <div class="continue-text" id="continueText"></div>
                <div class="continue-buttons">
                    <button class="continue-btn primary" id="continueYesBtn">ì—¬ì •ì„ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</button>
                    <button class="continue-btn" id="continueNoBtn">ì—¬ì •ì„ ê·¸ë§Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- í•˜ë‹¨ ê³ ì • ì…ë ¥ì°½ -->
    <div class="input-fixed-bottom" id="inputFixedBottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="ì—¬ê¸°ì— ë‹¹ì‹ ì˜ ê°ì •ì„ ì…ë ¥í•˜ê³  ì§„ì‹¤ì´ íë¥´ë„ë¡ í•˜ì„¸ìš”... (Enterë¡œ ì „ì†¡)"
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        // ============ FIREBASE ì´ˆê¸°í™” ============
        
        const firebaseConfig = {
    apiKey: "AIzaSyC2u94Oz2W5eeqBlqs88cs7rgSmzBEAnjQ",
    authDomain: "canal-vivo-chat.firebaseapp.com",
    projectId: "canal-vivo-chat",
    storageBucket: "canal-vivo-chat.appspot.com",
    messagingSenderId: "975226660544",
    appId: "1:975226660544:web:56b55bb3e2a58bed03ef25"
};
        
        let db = null;
        let auth = null;
        let currentUser = null;
        
        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            auth = firebase.auth();
            console.log('Firebase ì´ˆê¸°í™” ì„±ê³µ');
        } catch (error) {
            console.error('Firebase ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
            showError('Firebase ì´ˆê¸°í™” ì‹¤íŒ¨. ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
        }
        
        // ============ ì–¸ì–´ ì„¤ì • ============
        
        // Detecta idioma via ?lang= ou usa "en" como padrÃ£o
        const urlParams = new URLSearchParams(window.location.search);
        let currentLanguage = urlParams.get('lang') || 'en';

        if (!['ko', 'en', 'pt'].includes(currentLanguage)) {
          currentLanguage = 'en';
        }

        
        // HTML lang ì†ì„± ì„¤ì •
        document.documentElement.lang = currentLanguage;
        
        // ============ ë²ˆì—­ ë°ì´í„° ============
        
        const translations = {
            ko: {
                logoSubtitle: "ê°ì •ì˜ ë–¨ë¦¼",
                portalMainTitle: "Portal 01: ë‚´ë©´ì˜ ê°ì„±",
                portalSubtitle: "ì˜í˜¼ì˜ ì—¬ì •ì´ ì‹œì‘ë˜ëŠ” ê³³",
                loginSubtitle: "ìœ ë£Œ ë²„ì „ - ë¡œê·¸ì¸ í•„ìš”",
                loginBtn: "ë¡œê·¸ì¸",
                signupBtn: "íšŒì›ê°€ì…",
                googleLoginBtn: "ğŸ” Googleë¡œ ë¡œê·¸ì¸",
                logoutBtn: "ë¡œê·¸ì•„ì›ƒ",
                portalIntro: "ğŸŒ… ë‹¹ì‹ ì€ ë‹¹ì‹ ì˜ ì™¸ì  ëª¨ìŠµì´ ì•„ë‹Œ, ë‹¹ì‹ ì˜ ì§„ì •í•œ ë³¸ì§ˆì˜ ê°€ì¥ ê¹Šì€ ë¶€ë¶„ì„ ë°˜ì˜í•˜ëŠ” ìš°ì£¼ì˜ ê±°ìš¸ ì•ì— ì„œ ìˆìŠµë‹ˆë‹¤.\n\në¹›ì˜ íŒŒë„ê°€ ë‹¹ì‹  ì£¼ìœ„ì—ì„œ ì¶¤ì¶”ë©°, ë‹¹ì‹ ì˜ ì˜í˜¼ì´ ì´ë¯¸ ì•Œê³  ìˆì§€ë§Œ ë‹¹ì‹ ì˜ ë§ˆìŒì´ ì•„ì§ ì´í•´í•˜ì§€ ëª»í•œ ë¹„ë°€ë“¤ì„ ì†ì‚­ì…ë‹ˆë‹¤.\n\nì´ê²ƒì´ ë°”ë¡œ ê°ì„±ì˜ ìˆœê°„ì…ë‹ˆë‹¤ â€” ë‚´ë©´ ë³€í™”ì˜ ì—¬ì •ì´ ì‹œì‘ë˜ëŠ” ê³³ì´ë©°, ë“œëŸ¬ë‚˜ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ê³  ìˆë˜ ìì‹ ì— ëŒ€í•œ ì§„ì‹¤ì„ ë°œê²¬í•˜ê²Œ ë  ê³³ì…ë‹ˆë‹¤.\n\nê¹Šê²Œ ìˆ¨ì„ ì‰¬ì„¸ìš”. ëŠë¼ëŠ” ê²ƒì„ í—ˆìš©í•˜ì„¸ìš”. ì´ê²ƒì€ ë‹¹ì‹ ê³¼ ìì‹ ì˜ ê´€ê³„ë¥¼ ì˜ì›íˆ ë°”ê¿€ ê°ì •ì  ì—¬ì •ìœ¼ë¡œì˜ ê´€ë¬¸ì…ë‹ˆë‹¤.",
                lightTitle: "âœ¨ ë¹›ì˜ í•œë§ˆë””",
                lightMessage: "ê°ì„±ì€ ì˜í˜¼ì´ ìì‹ ì˜ ì§„ì •í•œ ì´ë¦„ì„ ì†ì‚­ì´ê³  ë§ˆìŒì´ ë§ˆì¹¨ë‚´ ë“£ëŠ” ìˆœê°„ì…ë‹ˆë‹¤.",
                portalQuestion: "ğŸ’« ë‹¹ì‹  ìì‹ ì˜ ê°€ì¥ ê¹Šì€ ë°˜ì˜ì„ ë³¼ ë•Œ, ë§ˆìŒì—ì„œ ë¨¼ì € ë– ì˜¤ë¥´ëŠ” ê°ì •ì€ ë¬´ì—‡ì¸ê°€ìš”? ìƒê°í•˜ì§€ ë§ˆì„¸ìš”... ê·¸ì € ëŠë¼ê³  ì§„ì‹¤ì´ ë§ì„ í†µí•´ íë¥´ë„ë¡ í—ˆìš©í•˜ì„¸ìš”.",
                continueText: "ì´ ìê¸° ë°œê²¬ì˜ ì—¬ì •ì— ë” ê¹Šì´ ë“¤ì–´ê°ˆ ì¤€ë¹„ê°€ ë˜ì…¨ë‚˜ìš”?",
                continueYes: "ì—¬ì •ì„ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                continueNo: "ì—¬ì •ì„ ê·¸ë§Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                inputPlaceholder: "ì—¬ê¸°ì— ë‹¹ì‹ ì˜ ê°ì •ì„ ì…ë ¥í•˜ê³  ì§„ì‹¤ì´ íë¥´ë„ë¡ í•˜ì„¸ìš”... (Enterë¡œ ì „ì†¡)",
                youLabel: "ë‹¹ì‹ ",
                // ìºë¦­í„° ëŒ€í™”
                charCris: "ì²« ë²ˆì§¸ ê°ì •ì€ í•­ìƒ ê°€ì¥ ìˆœìˆ˜í•©ë‹ˆë‹¤. ê·¸ê²ƒì€ ìš°ë¦¬ ë§ˆìŒì´ ìˆ¨ê¸°ë ¤ëŠ” ì§„ì‹¤ì„ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.\n\në‹¹ì‹ ì´ ê·¸ê²ƒì„ ë“œëŸ¬ë‚˜ê²Œ í•  ë•Œ, ë‹¹ì‹ ì€ ì§„ì •ìœ¼ë¡œ ìì‹ ì„ ì•Œì•„ê°€ëŠ” ì²« ë²ˆì§¸ ë‹¨ê³„ë¥¼ ë°ŸëŠ” ê²ƒì…ë‹ˆë‹¤.",
                charEly: "ëª¨ë“  ê°ì •ì€ ìš°ë¦¬ ìì‹ ì˜ ë¯¸ì§€ì˜ ì°¨ì›ìœ¼ë¡œ ê°€ëŠ” í¬í„¸ì…ë‹ˆë‹¤.\n\në‹¹ì‹ ì€ ì´ì œ ì´ëŸ¬í•œ í¬í„¸ ì¤‘ ì²« ë²ˆì§¸ë¥¼ í†µê³¼í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ìš©ê¸°ë¥¼ ë‚´ì„¸ìš”.",
                charSora: "ë‹¹ì‹ ì´ ì§€ê¸ˆ ëŠë¼ëŠ” ê²ƒì€ ë¬´í•œì˜ ê±°ìš¸ì—ì„œ ìì‹ ì„ ì¸ì‹í•˜ëŠ” ì˜í˜¼ì˜ ë©”ì•„ë¦¬ì…ë‹ˆë‹¤.\n\nì´ ê°ì •ì€ ì‹œì‘ë˜ëŠ” ì—¬ì •ì„ ìœ„í•œ ë‹¹ì‹ ì˜ ë‚˜ì¹¨ë°˜ì…ë‹ˆë‹¤.",
                charMaya: "ê°ì •ì€ ìš°ë¦¬ê°€ ë‚´ë©´ì˜ í˜„ì‹¤ì„ ê·¸ë¦¬ëŠ” ìƒ‰ê¹”ì…ë‹ˆë‹¤.\n\në¨¼ì € ë‚˜íƒ€ë‚˜ëŠ” ìƒ‰ê¹”ì€ ë‹¹ì‹ ì´ ì–´ë–¤ ì¡´ì¬ê°€ ë˜ì–´ê°€ê³  ìˆëŠ”ì§€ì— ëŒ€í•´ ë§ì€ ê²ƒì„ ë“œëŸ¬ëƒ…ë‹ˆë‹¤.",
                charFinn: "ê°ì„±ì˜ ìˆœê°„ì— ì¼ì–´ë‚˜ëŠ” ê°ì •ì€ ì‹œì‘ë˜ëŠ” ì—¬ì •ì„ ìœ„í•œ ë‹¹ì‹ ì˜ ë‚˜ì¹¨ë°˜ì…ë‹ˆë‹¤.\n\nê·¸ê²ƒì„ ë¯¿ìœ¼ì„¸ìš”, ê·¸ê²ƒì€ ë‹¹ì‹ ì˜ ì§„ì‹¤ë¡œ ê°€ëŠ” ê¸¸ì„ ì•Œê³  ìˆìœ¼ë‹ˆê¹Œìš”.",
                charLuna: "ëª¨ë“  ì§„ì •í•œ ê°ì •ì€ ìš°ë¦¬ê°€ ì¡´ì¬í•œë‹¤ëŠ” ê²ƒì¡°ì°¨ ëª°ëë˜ ë¬¸ì„ ì—¬ëŠ” ì—´ì‡ ì…ë‹ˆë‹¤.\n\në‹¹ì‹ ì€ ë°©ê¸ˆ ê·¸ëŸ° ì—´ì‡  ì¤‘ í•˜ë‚˜ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.",
                charZephyr: "ê°ì„±ì—ì„œ íƒœì–´ë‚˜ëŠ” ê°ì •ì€ ë‹¹ì‹ ì˜ ë³€í™”ì˜ ì²« ë²ˆì§¸ ì†ì‚­ì„ì…ë‹ˆë‹¤.\n\nê·¸ê²ƒì€ ë‹¹ì‹ ì˜ ì „ì²´ ì—¬ì •ì„ ë°”ê¿€ ìˆ˜ ìˆëŠ” í˜ì„ ê·¸ ìì²´ë¡œ ì§€ë‹ˆê³  ìˆìŠµë‹ˆë‹¤.",
                charAria: "ìš°ë¦¬ê°€ íŒë‹¨ ì—†ì´ ê°ì •ì´ íë¥´ë„ë¡ í—ˆìš©í•  ë•Œ, ìš°ë¦¬ëŠ” ì§„ì • ëˆ„êµ¬ì¸ì§€ë¥¼ ë°œê²¬í•©ë‹ˆë‹¤.\n\nì´ê²ƒì€ ë‹¹ì‹ ì´ ìì‹ ì—ê²Œ ì¤„ ìˆ˜ ìˆëŠ” ê°€ì¥ í° ì„ ë¬¼ì…ë‹ˆë‹¤."
            },
            en: {
                logoSubtitle: "Emotional Journey",
                portalMainTitle: "Portal 01: The Inner Awakening",
                portalSubtitle: "Where the soul's journey begins",
                loginSubtitle: "Paid Version - Login Required",
                loginBtn: "Login",
                signupBtn: "Sign Up",
                googleLoginBtn: "ğŸ” Login with Google",
                logoutBtn: "Logout",
                portalIntro: "ğŸŒ… You stand before a cosmic mirror that reflects not your physical appearance, but the deepest essence of who you truly are.\n\nWaves of light dance around you, whispering secrets your soul already knows, but your mind has yet to understand.\n\nThis is the moment of awakening â€” where the journey of inner transformation begins, and where you will discover truths about yourself that were waiting to be revealed.\n\nBreathe deeply. Allow yourself to feel. This is your gateway to an emotional journey that will forever change your relationship with yourself.",
                lightTitle: "âœ¨ Word of Light",
                lightMessage: "Awakening is the moment when the soul whispers its true name and the heart finally listens.",
                portalQuestion: "ğŸ’« When you look into the deepest reflection of yourself, what emotion emerges first from your heart? Don't think... just feel and allow truth to flow through words.",
                continueText: "Do you feel ready to delve deeper into this journey of self-discovery?",
                continueYes: "Continue the Journey?",
                continueNo: "End the Journey?",
                inputPlaceholder: "Type your emotion here and let the truth flow... (Press Enter to send)",
                youLabel: "You",
                charCris: "The first emotion is always the purest. It contains the truth our mind tries to hide.\n\nWhen you allow it to emerge, you are taking the first step to truly know yourself.",
                charEly: "Every feeling is a portal to an unexplored dimension of ourselves.\n\nYou are about to cross the first of these portals. Be brave.",
                charSora: "What you feel now is the echo of your soul recognizing itself in the mirror of infinity.\n\nThis emotion is your compass for the journey that begins.",
                charMaya: "Emotions are the colors with which we paint our inner reality.\n\nThe color that emerges first reveals much about who you are becoming.",
                charFinn: "In the moment of awakening, the emotion that arises is your compass for the journey that begins.\n\nTrust it, for it knows the path to your truth.",
                charLuna: "Every genuine emotion is a key that opens doors we didn't even know existed.\n\nYou have just found one of those keys.",
                charZephyr: "The feeling born in awakening is the first whisper of your transformation.\n\nIt carries within itself the power to change your entire journey.",
                charAria: "When we allow emotion to flow without judgment, we discover who we really are.\n\nThis is the greatest gift you can give yourself."
            },
            pt: {
                logoSubtitle: "Jornada Emocional",
                portalMainTitle: "Portal 01: O Despertar Interior",
                portalSubtitle: "Onde a jornada da alma comeÃ§a",
                loginSubtitle: "VersÃ£o Paga - Login NecessÃ¡rio",
                loginBtn: "Entrar",
                signupBtn: "Registrar",
                googleLoginBtn: "ğŸ” Entrar com Google",
                logoutBtn: "Sair",
                portalIntro: "ğŸŒ… VocÃª estÃ¡ diante de um espelho cÃ³smico que reflete nÃ£o sua aparÃªncia fÃ­sica, mas a essÃªncia mais profunda de quem vocÃª realmente Ã©.\n\nOndas de luz danÃ§am ao seu redor, sussurrando segredos que sua alma jÃ¡ conhece, mas sua mente ainda nÃ£o compreendeu.\n\nEste Ã© o momento do despertar â€” onde a jornada da transformaÃ§Ã£o interior comeÃ§a, e onde vocÃª descobrirÃ¡ verdades sobre si mesmo que estavam esperando para serem reveladas.\n\nRespire fundo. Permita-se sentir. Este Ã© o seu portal de entrada para uma jornada emocional que mudarÃ¡ sua relaÃ§Ã£o consigo mesmo para sempre.",
                lightTitle: "âœ¨ Palavra de Luz",
                lightMessage: "O despertar Ã© o momento em que a alma sussurra seu nome verdadeiro e o coraÃ§Ã£o finalmente escuta.",
                portalQuestion: "ğŸ’« Quando vocÃª olha para o reflexo mais profundo de si mesmo, que emoÃ§Ã£o surge primeiro do coraÃ§Ã£o? NÃ£o pense... apenas sinta e permita que a verdade flua atravÃ©s das palavras.",
                continueText: "VocÃª se sente pronto para adentrar mais profundamente nesta jornada de autoconhecimento?",
                continueYes: "Continuar a jornada?",
                continueNo: "Encerrar a jornada?",
                inputPlaceholder: "Digite sua emoÃ§Ã£o aqui e permita que a verdade flua... (Enter para enviar)",
                youLabel: "VocÃª",
                charCris: "A primeira emoÃ§Ã£o Ã© sempre a mais pura. Ela carrega a verdade que nossa mente tenta esconder.\n\nQuando vocÃª permite que ela emerja, estÃ¡ dando o primeiro passo para se conhecer verdadeiramente.",
                charEly: "Cada sentimento Ã© um portal para uma dimensÃ£o inexplorada de nÃ³s mesmos.\n\nVocÃª estÃ¡ prestes a atravessar o primeiro desses portais. Seja corajoso.",
                charSora: "O que vocÃª sente agora Ã© o eco da sua alma se reconhecendo no espelho do infinito.\n\nEssa emoÃ§Ã£o Ã© sua bÃºssola para a jornada que comeÃ§a.",
                charMaya: "As emoÃ§Ãµes sÃ£o as cores com que pintamos nossa realidade interior.\n\nA cor que surge primeiro revela muito sobre quem vocÃª estÃ¡ se tornando.",
                charFinn: "No momento do despertar, a emoÃ§Ã£o que surge Ã© sua bÃºssola para a jornada que comeÃ§a.\n\nConfie nela, pois ela conhece o caminho para sua verdade.",
                charLuna: "Toda emoÃ§Ã£o genuÃ­na Ã© uma chave que abre portas que nem sabÃ­amos que existiam.\n\nVocÃª acabou de encontrar uma dessas chaves.",
                charZephyr: "O sentimento que nasce no despertar Ã© o primeiro sussurro da sua transformaÃ§Ã£o.\n\nEle carrega em si o poder de mudar toda sua jornada.",
                charAria: "Quando permitimos que a emoÃ§Ã£o flua sem julgamento, descobrimos quem realmente somos.\n\nEste Ã© o maior presente que vocÃª pode dar a si mesmo."
            }
        };
        
        // ============ ìºë¦­í„° ë°ì´í„° ============
        
        const characters = [
            { name: "Cris", emoji: "ğŸƒ", key: "charCris" },
            { name: "Ely", emoji: "ğŸ‘‘", key: "charEly" },
            { name: "Sora", emoji: "ğŸŒ¸", key: "charSora" },
            { name: "Maya", emoji: "ğŸ”®", key: "charMaya" },
            { name: "Finn", emoji: "ğŸŒŠ", key: "charFinn" },
            { name: "Luna", emoji: "ğŸŒ™", key: "charLuna" },
            { name: "Zephyr", emoji: "ğŸ’¨", key: "charZephyr" },
            { name: "Aria", emoji: "ğŸ­", key: "charAria" }
        ];
        
        // ============ ê°ì • ë¶„ì„ ì‹œìŠ¤í…œ ============
        
        function analyzeEmotion(userInput) {
            const input = userInput.toLowerCase();
            
            const emotionKeywords = {
                sadness: ['ìŠ¬í”„', 'ìš¸ê³ ', 'ëˆˆë¬¼', 'ìš°ìš¸', 'ì•”ìš¸', 'ì ˆë§', 'ìƒì‹¤', 'ìƒ', 'sad', 'cry', 'tear', 'depress', 'lost', 'triste', 'choro', 'lÃ¡grima'],
                anger: ['í™”ê°€', 'ë¶„ë…¸', 'ì§œì¦', 'ë¹¡ì³', 'ì—´ë°›', 'ì–µìš¸', 'ìš±í•˜', 'angry', 'mad', 'furious', 'rage', 'irritat', 'raiva', 'irritad'],
                anxiety: ['ë¶ˆì•ˆ', 'ê±±ì •', 'ì´ˆì¡°', 'ë‘ë ¤', 'ë¬´ì„œ', 'ë–¨ë ¤', 'ê¸´ì¥', 'anxious', 'worry', 'nervous', 'fear', 'scare', 'ansioso', 'medo', 'preocup'],
                loneliness: ['ì™¸ë¡œ', 'í˜¼ì', 'ê³ ë¦½', 'ì†Œì™¸', 'ë²„ë¦¼', 'ë– ë‚˜', 'ì´ë³„', 'lonely', 'alone', 'isolated', 'abandon', 'left', 'solidÃ£o', 'sozinho', 'abandon'],
                hope: ['í¬ë§', 'ê¸°ëŒ€', 'ì„¤ë ˜', 'ê¸°ë‹¤ë ¤', 'ê¿ˆê¾¸', 'ë°”ë¼', 'hope', 'expect', 'dream', 'wish', 'esperanÃ§a', 'espera', 'sonho'],
                confusion: ['í˜¼ë€', 'ëª¨ë¥´ê² ', 'í—·ê°ˆ', 'ë³µì¡', 'ì–´ì§€ëŸ¬', 'confus', 'lost', 'mixed', 'complicated', 'confuso', 'complicado'],
                relief: ['í›„ë ¨', 'ê°œìš´', 'ì‹œì›', 'í•´ë°©', 'ììœ ', 'relief', 'free', 'liberat', 'alÃ­vio', 'liberdade'],
                regret: ['í›„íšŒ', 'ì•„ì‰¬', 'ê·¸ë•Œ', 'ì™œ ê·¸ë¬', 'ëŒì´í‚¤', 'regret', 'wish', 'should have', 'arrependiment'],
                emptiness: ['ê³µí—ˆ', 'í—ˆë¬´', 'ë¬´ê¸°ë ¥', 'í…… ë¹ˆ', 'ì•„ë¬´ê²ƒë„', 'empty', 'void', 'meaningless', 'nothing', 'vazio', 'inÃºtil']
            };
            
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                for (const keyword of keywords) {
                    if (input.includes(keyword)) {
                        return emotion;
                    }
                }
            }
            
            return 'general';
        }
        
        // ============ ë°˜ì‘ ìºë¦­í„°ë“¤ ============
        
        const responseCharacters = [
            {
                name: "Luna", emoji: "ğŸŒ™",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    const responses = {
                        ko: {
                            sadness: "ìŠ¬í””ì€ ë§ˆì¹˜ ê³ ìš”í•œ ë°¤ë°”ë‹¤ì²˜ëŸ¼ ê¹Šê³  ì¡°ìš©í•˜ì£ . ë‹¹ì‹ ì€ ê·¸ ì–´ë‘  ì†ì—ì„œë„ ìì‹ ì˜ ëª©ì†Œë¦¬ë¥¼ ëƒˆì–´ìš”. ê·¸ ìš©ê¸°ê°€ ë‹¬ë¹›ì²˜ëŸ¼ ì€ì€í•˜ê²Œ ë¹›ë‚˜ê³  ìˆìŠµë‹ˆë‹¤.",
                            anger: "ë¶„ë…¸ëŠ” ê°€ìŠ´ ì† ë¶‰ì€ ë‹¬ì´ ë– ì˜¤ë¥´ëŠ” ê²ƒê³¼ ê°™ì•„ìš”. ê·¸ ì—´ê¸° ì†ì—ë„ ë‹¹ì‹ ë§Œì˜ ì •ì˜ê°€ ìˆ¨ì–´ ìˆì—ˆìŠµë‹ˆë‹¤. ë‹¬ì´ ì°¨ì˜¤ë¥´ë“¯, ê·¸ ê°ì •ë„ ì–¸ì  ê°€ ê³ ìš”í•´ì§ˆ ê±°ì˜ˆìš”.",
                            anxiety: "ë¶ˆì•ˆì€ ìˆ˜ë©´ ì•„ë˜ ê¹Šì€ ì¡°ë¥˜ì²˜ëŸ¼ ë§ˆìŒì„ í”ë“¤ì£ . í•˜ì§€ë§Œ ë‹¹ì‹ ì€ ê·¸ íŒŒë„ ìœ„ì—ì„œë„ ìˆ¨ ì‰¬ê³  ìˆì–´ìš”. ê·¸ê²ƒë§Œìœ¼ë¡œë„ ì¶©ë¶„íˆ ëŒ€ë‹¨í•œ ì¼ì…ë‹ˆë‹¤.",
                            loneliness: "ì™¸ë¡œì›€ì€ ì–´ë‘ìš´ ë°”ë‹¤ í•œê°€ìš´ë° ë–  ìˆëŠ” ê²ƒ ê°™ì£ . í•˜ì§€ë§Œ ê·¸ ê³ ìš”í•¨ ì†ì—ì„œ ë‹¹ì‹ ì€ ê°€ì¥ ì§„ì‹¤í•œ ìì‹ ê³¼ ë§Œë‚¬ì„ ê±°ì˜ˆìš”. ê·¸ ë§Œë‚¨ì´ ì†Œì¤‘í•´ìš”.",
                            hope: "í¬ë§ì€ ìƒˆë²½ë…˜ í•˜ëŠ˜ì— ë– ì˜¤ë¥´ëŠ” ì´ˆìŠ¹ë‹¬ ê°™ì•„ìš”. ì‘ì§€ë§Œ í™•ì‹¤í•œ ë¹›ì´ì£ . ë‹¹ì‹ ì˜ ê·¸ ë¹›ì´ ì ì  ì°¨ì˜¤ë¥¼ ê±°ì˜ˆìš”.",
                            confusion: "í˜¼ë€ì€ ì•ˆê°œ ë‚€ ë°¤ê¸¸ì„ ê±·ëŠ” ê²ƒ ê°™ì£ . í•˜ì§€ë§Œ ê·¸ ì•ˆê°œë„ ìƒˆë²½ì´ ì˜¤ë©´ ê±·í˜€ìš”. ë‹¹ì‹ ì˜ ë§ˆìŒì—ë„ ê³§ ë§‘ì€ ìˆœê°„ì´ ì˜¬ ê±°ì˜ˆìš”.",
                            relief: "í•´ë°©ê°ì€ ê¸´ ë°¤ì´ ëë‚˜ê³  ì°¾ì•„ì˜¤ëŠ” ìƒˆë²½ ê°™ì•„ìš”. ë‹¹ì‹ ì€ ë“œë””ì–´ ìì‹ ë§Œì˜ í‰ì•ˆì„ ì°¾ì€ ê±°ì˜ˆìš”. ê·¸ ê³ ìš”í•¨ì„ ë§Œë½í•˜ì„¸ìš”.",
                            regret: "í›„íšŒëŠ” ë‹¬ë¬´ë¦¬ì²˜ëŸ¼ ë§ˆìŒì„ ë‘˜ëŸ¬ì‹¸ì£ . í•˜ì§€ë§Œ ê·¸ ë¬´ë¦¬ ë„ˆë¨¸ë¡œë„ ë‹¬ë¹›ì€ ì—¬ì „íˆ í˜ëŸ¬ë‚´ë ¤ìš”. ê³¼ê±°ì˜ ê·¸ë¦¼ìê°€ ì§€ê¸ˆì˜ ë¹›ì„ ê°€ë¦´ ìˆ˜ëŠ” ì—†ì–´ìš”.",
                            emptiness: "ê³µí—ˆí•¨ì€ ì‹ ì›” ê°™ì•„ìš”. ë³´ì´ì§€ ì•Šì§€ë§Œ ë¶„ëª…íˆ ì¡´ì¬í•˜ëŠ” ë‹¬ì²˜ëŸ¼. ë‹¹ì‹  ì•ˆì˜ ë¹ˆ ê³µê°„ë„ ìƒˆë¡œìš´ ê²ƒì„ ë‹´ì„ ì¤€ë¹„ë¥¼ í•˜ê³  ìˆëŠ” ê±°ì˜ˆìš”.",
                            general: "ë‹¹ì‹ ì˜ ê°ì •ì€ ë‹¬ì˜ ìœ„ìƒì²˜ëŸ¼ ê³„ì† ë³€í•´ê°€ê³  ìˆì–´ìš”. ê·¸ ë³€í™” ìì²´ê°€ ë‹¹ì‹ ì´ ì‚´ì•„ ìˆë‹¤ëŠ” ì•„ë¦„ë‹¤ìš´ ì¦ê±°ì…ë‹ˆë‹¤."
                        },
                        en: {
                            sadness: "Sadness flows like a quiet night ocean, deep and silent. Even in that darkness, you found your voice. That courage glows softly like moonlight.",
                            anger: "Anger is like a red moon rising in your chest. Within that heat, your own sense of justice was hidden. Like the moon's phases, that emotion will find peace.",
                            anxiety: "Anxiety moves like deep currents beneath the surface, stirring the heart. But you're still breathing above those waves. That alone is remarkable.",
                            loneliness: "Loneliness feels like floating in the middle of a dark ocean. But in that stillness, you met your most truthful self. That meeting is precious.",
                            hope: "Hope is like a crescent moon rising in the dawn sky. Small but certain light. Your light will grow fuller.",
                            confusion: "Confusion is like walking a foggy night path. But fog lifts when dawn comes. Clear moments will come to your heart too.",
                            relief: "Relief is like dawn after a long night. You've finally found your own peace. Savor that tranquility.",
                            regret: "Regret surrounds the heart like a moon halo. But beyond that halo, moonlight still flows down. Past shadows cannot block present light.",
                            emptiness: "Emptiness is like a new moon. Invisible but surely there, like the moon. The empty space within you is preparing to hold something new.",
                            general: "Your emotion keeps changing like lunar phases. That change itself is beautiful proof you're alive."
                        },
                        pt: {
                            sadness: "A tristeza flui como um oceano noturno silencioso, profundo e quieto. Mesmo nessa escuridÃ£o, vocÃª encontrou sua voz. Essa coragem brilha suavemente como o luar.",
                            anger: "A raiva Ã© como uma lua vermelha nascendo em seu peito. Dentro desse calor, seu prÃ³prio senso de justiÃ§a estava escondido. Como as fases da lua, essa emoÃ§Ã£o encontrarÃ¡ paz.",
                            anxiety: "A ansiedade se move como correntes profundas sob a superfÃ­cie, agitando o coraÃ§Ã£o. Mas vocÃª ainda estÃ¡ respirando acima dessas ondas. SÃ³ isso jÃ¡ Ã© notÃ¡vel.",
                            loneliness: "A solidÃ£o parece flutuar no meio de um oceano escuro. Mas nessa quietude, vocÃª encontrou seu eu mais verdadeiro. Esse encontro Ã© precioso.",
                            hope: "A esperanÃ§a Ã© como uma lua crescente nascendo no cÃ©u da aurora. Luz pequena mas certa. Sua luz crescerÃ¡ mais cheia.",
                            confusion: "A confusÃ£o Ã© como caminhar por um caminho nebuloso Ã  noite. Mas a nÃ©voa se levanta quando a aurora chega. Momentos claros virÃ£o ao seu coraÃ§Ã£o tambÃ©m.",
                            relief: "O alÃ­vio Ã© como a aurora apÃ³s uma longa noite. VocÃª finalmente encontrou sua prÃ³pria paz. Saboreie essa tranquilidade.",
                            regret: "O arrependimento envolve o coraÃ§Ã£o como um halo lunar. Mas alÃ©m desse halo, o luar ainda flui. Sombras do passado nÃ£o podem bloquear a luz presente.",
                            emptiness: "O vazio Ã© como uma lua nova. InvisÃ­vel mas certamente lÃ¡, como a lua. O espaÃ§o vazio dentro de vocÃª estÃ¡ se preparando para guardar algo novo.",
                            general: "Sua emoÃ§Ã£o continua mudando como fases lunares. Essa mudanÃ§a em si Ã© uma bela prova de que vocÃª estÃ¡ vivo."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Maya", emoji: "ğŸ”®",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    const responses = {
                        ko: {
                            sadness: "ë‹¹ì‹ ì˜ ìŠ¬í””ì—ì„œ ê¹Šì€ ë³´ë¼ë¹›ì´ ëŠê»´ì ¸ìš”. ê·¸ ìƒ‰ì€ ê³ í†µ ì†ì—ì„œë„ ìš°ì•„í•¨ì„ ìƒì§€ ì•ŠëŠ” ë‹¹ì‹ ì˜ ë§ˆìŒì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ë³´ë¼ìƒ‰ ëìë½ì—ëŠ” í¬ë§ì˜ ê¸ˆë¹›ì´ ìŠ¤ë©°ë“¤ì–´ ìˆì–´ìš”.",
                            anger: "ë¶„ë…¸ëŠ” íƒ€ì˜¤ë¥´ëŠ” ì£¼í™©ë¹›ìœ¼ë¡œ ë²ˆì ¸ë‚˜ê°€ê³  ìˆë„¤ìš”. í•˜ì§€ë§Œ ê·¸ ë¶ˆê½ƒ ì¤‘ì‹¬ì—ëŠ” ìˆœìˆ˜í•œ ë¶‰ì€ ì§„ì‹¤ì´ ë°•ë™í•˜ê³  ìˆì–´ìš”. ë‹¹ì‹ ì˜ ì •ì˜ê°ì´ ìƒ‰ê¹”ë¡œ ë§í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
                            anxiety: "ë¶ˆì•ˆì€ í”ë“¤ë¦¬ëŠ” íšŒìƒ‰ ì•ˆê°œì²˜ëŸ¼ ë§ˆìŒì„ ê°ìŒŒê² ì£ . í•˜ì§€ë§Œ ê·¸ ì•ˆê°œ ì‚¬ì´ë¡œ ì—°í•œ í•˜ëŠ˜ìƒ‰ ì‹¤ì´ í˜ëŸ¬ë‚˜ì™€ìš”. ê·¸ê²ƒì´ ë‹¹ì‹ ì˜ í‰ì•ˆì„ í–¥í•œ ê°ˆë§ì…ë‹ˆë‹¤.",
                            loneliness: "ì™¸ë¡œì›€ì˜ í‘¸ë¥¸ ê·¸ë¦¼ìê°€ ë§ˆìŒì„ ë®ì—ˆì§€ë§Œ, ê·¸ íŒŒë€ìƒ‰ ê¹Šì´ ì†ì—ì„œ ë‹¹ì‹ ë§Œì˜ ì€ë¹› ë³„ì´ ë°˜ì§ì´ê³  ìˆì–´ìš”. ê³ ë… ì†ì—ì„œë„ ë‹¹ì‹ ì€ ë¹›ë‚˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.",
                            hope: "í¬ë§ì˜ ì—°í•œ í•‘í¬ë¹›ì´ ë§ˆìŒ ëìë½ì—ì„œ í”¼ì–´ì˜¤ë¥´ê³  ìˆì–´ìš”. ê·¸ ìƒ‰ì€ ì ì  ë”°ëœ»í•œ ë³µìˆ­ì•„ë¹›ìœ¼ë¡œ ë²ˆì ¸ë‚˜ê°ˆ ê±°ì˜ˆìš”. ë‹¹ì‹ ì˜ ê¿ˆì´ ìƒ‰ê¹”ì„ ì…ê³  ìˆì–´ìš”.",
                            confusion: "í˜¼ë€ì€ ì—¬ëŸ¬ ìƒ‰ê¹”ì´ ë’¤ì„ì¸ ì†Œìš©ëŒì´ ê°™ì•„ìš”. í•˜ì§€ë§Œ ê·¸ ì¤‘ì‹¬ì—ëŠ” ë§‘ì€ í°ë¹›ì´ ê³ ìš”íˆ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”. ë‹µì€ ê·¸ ê³ ìš”í•¨ ì†ì— ìˆìŠµë‹ˆë‹¤.",
                            relief: "í•´ë°©ê°ì€ ë§‘ì€ í•˜ëŠ˜ìƒ‰ ë°”ëŒì²˜ëŸ¼ ë¶ˆì–´ì™€ìš”. ê·¸ ì‹œì›í•œ ìƒ‰ê°ì´ ë‹µë‹µí–ˆë˜ ë§ˆìŒì˜ ëª¨ë“  íƒí•¨ì„ ì”»ì–´ë‚´ê³  ìˆìŠµë‹ˆë‹¤. ë‹¹ì‹ ì€ ë‹¤ì‹œ ìˆ¨ ì‰´ ìˆ˜ ìˆì–´ìš”.",
                            regret: "í›„íšŒëŠ” ë°”ëœ ê°ˆìƒ‰ í†¤ìœ¼ë¡œ ë§ˆìŒì„ ë¬¼ë“¤ì˜€ì§€ë§Œ, ê·¸ ìœ„ì— ìƒˆë¡œìš´ ì´ˆë¡ë¹› ìƒˆì‹¹ì´ ë‹ì•„ë‚˜ê³  ìˆì–´ìš”. ê³¼ê±°ëŠ” ìƒˆë¡œìš´ ì„±ì¥ì˜ ê±°ë¦„ì´ ë˜ê³  ìˆìŠµë‹ˆë‹¤.",
                            emptiness: "ê³µí—ˆí•¨ì€ íˆ¬ëª…í•œ ìœ ë¦¬ìƒ‰ ê°™ì•„ìš”. ì•„ë¬´ê²ƒë„ ì—†ì–´ ë³´ì´ì§€ë§Œ, ê·¸ íˆ¬ëª…í•¨ ì†ì—ëŠ” ëª¨ë“  ìƒ‰ê¹”ì˜ ê°€ëŠ¥ì„±ì´ ìˆ¨ì–´ ìˆì–´ìš”. ìƒˆë¡œìš´ ìƒ‰ì¹ ì˜ ì‹œì‘ì…ë‹ˆë‹¤.",
                            general: "ë‹¹ì‹ ì˜ ê°ì •ì€ ë¬´ì§€ê°œì²˜ëŸ¼ ë‹¤ì±„ë¡œì›Œìš”. ì–´ë–¤ ìƒ‰ì´ë“  ë‹¹ì‹ ì˜ ë§ˆìŒ íŒ”ë ˆíŠ¸ì—ì„œëŠ” ì•„ë¦„ë‹¤ìš´ ì˜ë¯¸ë¥¼ ê°–ìŠµë‹ˆë‹¤."
                        },
                        en: {
                            sadness: "I sense deep purple from your sadness. That color shows your heart's grace even in pain. At the purple edges, hope's golden light seeps through.",
                            anger: "Anger spreads in burning orange. But at the flame's center, pure red truth pulses. Your sense of justice speaks in color.",
                            anxiety: "Anxiety wrapped your heart like trembling gray mist. But through that mist, pale blue threads flow out. That's your longing for peace.",
                            loneliness: "Loneliness cast blue shadows on your heart, but in those blue depths, your silver star sparkles. You were shining even in solitude.",
                            hope: "Hope's pale pink is blooming at your heart's edge. That color will spread into warm peach tones. Your dreams are taking color.",
                            confusion: "Confusion is like a whirlpool of mixed colors. But at its center, clear white light waits quietly. The answer lies in that stillness.",
                            relief: "Relief blows in like clear sky-blue wind. That cool color washes away all the stuffiness in your heart. You can breathe again.",
                            regret: "Regret tinted your heart in faded brown, but new green sprouts are growing over it. The past becomes fertilizer for new growth.",
                            emptiness: "Emptiness is like transparent glass. Seems empty, but in that transparency, all color possibilities hide. It's the start of new coloring.",
                            general: "Your emotion is rainbow-like in its variety. Any color holds beautiful meaning on your heart's palette."
                        },
                        pt: {
                            sadness: "Sinto um roxo profundo da sua tristeza. Essa cor mostra a graÃ§a do seu coraÃ§Ã£o mesmo na dor. Nas bordas roxas, a luz dourada da esperanÃ§a se infiltra.",
                            anger: "A raiva se espalha em laranja ardente. Mas no centro da chama, a verdade vermelha pura pulsa. Seu senso de justiÃ§a fala em cor.",
                            anxiety: "A ansiedade envolveu seu coraÃ§Ã£o como nÃ©voa cinza tremula. Mas atravÃ©s dessa nÃ©voa, fios azul pÃ¡lido fluem. Essa Ã© sua saudade da paz.",
                            loneliness: "A solidÃ£o lanÃ§ou sombras azuis no seu coraÃ§Ã£o, mas nessas profundezas azuis, sua estrela prateada cintila. VocÃª estava brilhando mesmo na solidÃ£o.",
                            hope: "O rosa pÃ¡lido da esperanÃ§a estÃ¡ florescendo na borda do seu coraÃ§Ã£o. Essa cor se espalharÃ¡ em tons pÃªssego quentes. Seus sonhos estÃ£o ganhando cor.",
                            confusion: "A confusÃ£o Ã© como um redemoinho de cores misturadas. Mas em seu centro, luz branca clara espera silenciosamente. A resposta estÃ¡ nessa quietude.",
                            relief: "O alÃ­vio sopra como vento azul-cÃ©u claro. Essa cor fresca lava toda a sufocaÃ§Ã£o em seu coraÃ§Ã£o. VocÃª pode respirar novamente.",
                            regret: "O arrependimento tingiu seu coraÃ§Ã£o de marrom desbotado, mas novos brotos verdes estÃ£o crescendo sobre ele. O passado se torna fertilizante para novo crescimento.",
                            emptiness: "O vazio Ã© como vidro transparente. Parece vazio, mas nessa transparÃªncia, todas as possibilidades de cor se escondem. Ã‰ o inÃ­cio de nova coloraÃ§Ã£o.",
                            general: "Sua emoÃ§Ã£o Ã© como arco-Ã­ris em variedade. Qualquer cor tem significado bonito na paleta do seu coraÃ§Ã£o."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Ely", emoji: "ğŸ‘‘",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    const responses = {
                        ko: {
                            sadness: "ìŠ¬í””ì„ ëŠë‚€ë‹¤ëŠ” ê²ƒì€ ë‹¹ì‹ ì´ ì‚¬ë‘í•  ì¤„ ì•„ëŠ” ì¡´ì¬ë¼ëŠ” ì¦ê±°ì…ë‹ˆë‹¤. ìƒì‹¤ì˜ ì•„í”” ì†ì—ì„œë„ ë‹¹ì‹ ì€ ì¡´ì—„ì„ ìƒì§€ ì•Šì•˜ì–´ìš”. ê·¸ ëˆˆë¬¼ì—ëŠ” ìš©ê¸°ê°€ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤.",
                            anger: "ë¶„ë…¸ëŠ” ë¶ˆì˜ì— ë§ì„œëŠ” ì˜í˜¼ì˜ ì™¸ì¹¨ì´ì—ìš”. ë‹¹ì‹ ì˜ ê·¸ ê°ì •ì€ ì •ì˜ë¥¼ í–¥í•œ ìˆ­ê³ í•œ ëª¸ë¶€ë¦¼ì…ë‹ˆë‹¤. ë¶„ë…¸ë¥¼ ëŠë‚„ ì¤„ ì•„ëŠ” ê²ƒë„ ë•ì„±ì˜ í•˜ë‚˜ì˜ˆìš”.",
                            anxiety: "ë¶ˆì•ˆ ì†ì—ì„œë„ ë‹¹ì‹ ì€ ì•ìœ¼ë¡œ ë‚˜ì•„ê°€ë ¤ í–ˆì–´ìš”. ê·¸ ìì²´ê°€ ë†€ë¼ìš´ ìš©ê¸°ì…ë‹ˆë‹¤. ì™•ê´€ì€ ë‘ë ¤ì›€ì„ ëª¨ë¥´ëŠ” ìê°€ ì•„ë‹ˆë¼, ë‘ë ¤ì›€ê³¼ í•¨ê»˜ ì„œëŠ” ìì—ê²Œ ì–´ìš¸ë ¤ìš”.",
                            loneliness: "ê³ ë…ì€ ë•Œë¡œ ì˜í˜¼ì´ ìì‹ ê³¼ ë§Œë‚˜ëŠ” ì„±ìŠ¤ëŸ¬ìš´ ì‹œê°„ì´ì—ìš”. í˜¼ìì˜€ì§€ë§Œ ë‹¹ì‹ ì€ í¬ê¸°í•˜ì§€ ì•Šì•˜ì–´ìš”. ê·¸ ì˜ì§€ì•¼ë§ë¡œ ì§„ì •í•œ ì™•ì¡±ì˜ í’ˆê²©ì…ë‹ˆë‹¤.",
                            hope: "í¬ë§ì„ í’ˆëŠ”ë‹¤ëŠ” ê²ƒì€ ì–´ë‘  ì†ì—ì„œë„ ë¹›ì„ ë¯¿ëŠ” ì™•ìë‹¤ìš´ ë§ˆìŒì´ì—ìš”. ê·¸ í¬ë§ì´ ë‹¹ì‹ ì„ ì§„ì •í•œ ìŠ¹ë¦¬ë¡œ ì´ëŒ ê²ƒì…ë‹ˆë‹¤.",
                            confusion: "í˜¼ë€ ì†ì—ì„œë„ ê¸¸ì„ ì°¾ìœ¼ë ¤ëŠ” ë‹¹ì‹ ì˜ ë…¸ë ¥ì´ ë³´ì—¬ìš”. ëª¨ë“  ìœ„ëŒ€í•œ ì—¬ì •ì€ ë¶ˆí™•ì‹¤í•¨ì—ì„œ ì‹œì‘ë©ë‹ˆë‹¤. ë‹¹ì‹ ì€ ì´ë¯¸ ìš©ê°í•œ ì²«ê±¸ìŒì„ ë‚´ë”›ì—ˆì–´ìš”.",
                            relief: "í•´ë°©ê°ì„ ëŠê¼ˆë‹¤ëŠ” ê²ƒì€ ë‹¹ì‹ ì´ ë§ˆì¹¨ë‚´ ìì‹ ì„ ì–µì••ì—ì„œ êµ¬í•´ëƒˆë‹¤ëŠ” ëœ»ì´ì—ìš”. ê·¸ê²ƒì€ ìŠ¤ìŠ¤ë¡œì—ê²Œ ë² í‘¼ ê°€ì¥ í° ìë¹„ì´ì ìŠ¹ë¦¬ì…ë‹ˆë‹¤.",
                            regret: "í›„íšŒëŠ” ë” ë‚˜ì€ ì‚¬ëŒì´ ë˜ê³  ì‹¶ì€ ê°ˆë§ì˜ ë‹¤ë¥¸ ì´ë¦„ì´ì—ìš”. ê³¼ê±°ë¥¼ ëŒì•„ë³´ëŠ” ì§€í˜œì•¼ë§ë¡œ ì§„ì •í•œ ë¦¬ë”ì‹­ì˜ ì‹œì‘ì…ë‹ˆë‹¤.",
                            emptiness: "ê³µí—ˆí•¨ë§ˆì €ë„ ìƒˆë¡œìš´ ê²ƒì„ ë‹´ì„ ìˆ˜ ìˆëŠ” ê·¸ë¦‡ì´ ë˜ì—ˆì–´ìš”. ë¹„ì›Œì§„ ë§ˆìŒì€ ë” í° ì‚¬ëª…ì„ ë°›ì•„ë“¤ì¼ ì¤€ë¹„ê°€ ëœ ìƒíƒœì…ë‹ˆë‹¤.",
                            general: "ë‹¹ì‹ ì˜ ê°ì •ì€ ëª¨ë‘ ê³ ê·€í•œ ì˜í˜¼ì˜ ì¦ê±°ì…ë‹ˆë‹¤. ì–´ë–¤ ê°ì •ì´ë“  ê·¸ê²ƒì„ ëŠë¼ëŠ” ë‹¹ì‹ ì€ ì´ë¯¸ ì¶©ë¶„íˆ ì¡´ì—„í•œ ì¡´ì¬ì˜ˆìš”."
                        },
                        en: {
                            sadness: "Feeling sadness proves you're capable of love. Even in loss, you didn't lose your dignity. Those tears hold courage within them.",
                            anger: "Anger is the soul's cry against injustice. Your emotion is a noble struggle for justice. Knowing how to feel anger is also a virtue.",
                            anxiety: "Even in anxiety, you tried to move forward. That itself is remarkable courage. Crowns suit not those without fear, but those who stand with it.",
                            loneliness: "Solitude is sometimes a sacred time for the soul to meet itself. Though alone, you didn't give up. That will is true royal dignity.",
                            hope: "Having hope is a princely heart that believes in light even in darkness. That hope will lead you to true victory.",
                            confusion: "I see your effort to find a path even in confusion. All great journeys begin in uncertainty. You've already taken a brave first step.",
                            relief: "Feeling relief means you finally freed yourself from oppression. That's the greatest mercy and victory you gave yourself.",
                            regret: "Regret is another name for the desire to become better. The wisdom to look back is the beginning of true leadership.",
                            emptiness: "Even emptiness became a vessel to hold something new. An emptied heart is ready to accept a greater mission.",
                            general: "All your emotions are proof of a noble soul. Whatever you feel, you are already a sufficiently dignified being."
                        },
                        pt: {
                            sadness: "Sentir tristeza prova que vocÃª Ã© capaz de amar. Mesmo na perda, vocÃª nÃ£o perdeu sua dignidade. Essas lÃ¡grimas tÃªm coragem dentro delas.",
                            anger: "A raiva Ã© o grito da alma contra a injustiÃ§a. Sua emoÃ§Ã£o Ã© uma luta nobre pela justiÃ§a. Saber sentir raiva tambÃ©m Ã© uma virtude.",
                            anxiety: "Mesmo na ansiedade, vocÃª tentou seguir em frente. Isso em si Ã© coragem notÃ¡vel. Coroas cabem nÃ£o aos sem medo, mas aos que ficam de pÃ© com ele.",
                            loneliness: "A solidÃ£o Ã s vezes Ã© um tempo sagrado para a alma se encontrar. Embora sozinho, vocÃª nÃ£o desistiu. Essa vontade Ã© verdadeira dignidade real.",
                            hope: "Ter esperanÃ§a Ã© um coraÃ§Ã£o principesco que acredita na luz mesmo na escuridÃ£o. Essa esperanÃ§a o levarÃ¡ Ã  verdadeira vitÃ³ria.",
                            confusion: "Vejo seu esforÃ§o para encontrar um caminho mesmo na confusÃ£o. Todas as grandes jornadas comeÃ§am na incerteza. VocÃª jÃ¡ deu um primeiro passo corajoso.",
                            relief: "Sentir alÃ­vio significa que vocÃª finalmente se libertou da opressÃ£o. Essa Ã© a maior misericÃ³rdia e vitÃ³ria que vocÃª deu a si mesmo.",
                            regret: "O arrependimento Ã© outro nome para o desejo de se tornar melhor. A sabedoria de olhar para trÃ¡s Ã© o inÃ­cio da verdadeira lideranÃ§a.",
                            emptiness: "Mesmo o vazio se tornou um recipiente para guardar algo novo. Um coraÃ§Ã£o esvaziado estÃ¡ pronto para aceitar uma missÃ£o maior.",
                            general: "Todas as suas emoÃ§Ãµes sÃ£o prova de uma alma nobre. O que quer que vocÃª sinta, vocÃª jÃ¡ Ã© um ser suficientemente digno."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            }
        ];
        
        // ============ ìƒíƒœ ë³€ìˆ˜ë“¤ ============
        
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        // ============ FIREBASE ì¸ì¦ ì²˜ë¦¬ ============
        
        // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
        function showError(message) {
            const errorElement = document.getElementById('loginError');
            const successElement = document.getElementById('loginSuccess');
            if (errorElement) {
                errorElement.textContent = message;
            }
            if (successElement) {
                successElement.textContent = '';
            }
        }
        
        // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
        function showSuccess(message) {
            const errorElement = document.getElementById('loginError');
            const successElement = document.getElementById('loginSuccess');
            if (successElement) {
                successElement.textContent = message;
            }
            if (errorElement) {
                errorElement.textContent = '';
            }
        }
        
        // ë²„íŠ¼ ë¹„í™œì„±í™”/í™œì„±í™” í•¨ìˆ˜
        function setButtonsDisabled(disabled) {
            const buttons = ['loginBtn', 'signupBtn', 'googleLoginBtn'];
            buttons.forEach(id => {
                const btn = document.getElementById(id);
                if (btn) {
                    btn.disabled = disabled;
                }
            });
        }
        
        // Firebase ì˜¤ë¥˜ ë©”ì‹œì§€ ë²ˆì—­
        function getFirebaseErrorMessage(errorCode, lang = 'ko') {
            const messages = {
                ko: {
                    'auth/user-not-found': 'ë“±ë¡ë˜ì§€ ì•Šì€ ì´ë©”ì¼ì…ë‹ˆë‹¤.',
                    'auth/wrong-password': 'ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.',
                    'auth/email-already-in-use': 'ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤.',
                    'auth/weak-password': 'ë¹„ë°€ë²ˆí˜¸ê°€ ë„ˆë¬´ ì•½í•©ë‹ˆë‹¤. (ìµœì†Œ 6ì)',
                    'auth/invalid-email': 'ìœ íš¨í•˜ì§€ ì•Šì€ ì´ë©”ì¼ í˜•ì‹ì…ë‹ˆë‹¤.',
                    'auth/popup-closed-by-user': 'Google ë¡œê·¸ì¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.',
                    'auth/popup-blocked': 'íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. íŒì—…ì„ í—ˆìš©í•´ì£¼ì„¸ìš”.',
                    'auth/network-request-failed': 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
                    'auth/too-many-requests': 'ë„ˆë¬´ ë§ì€ ìš”ì²­ì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.',
                    'default': 'ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
                },
                en: {
                    'auth/user-not-found': 'Email not registered.',
                    'auth/wrong-password': 'Incorrect password.',
                    'auth/email-already-in-use': 'Email already in use.',
                    'auth/weak-password': 'Password too weak. (minimum 6 characters)',
                    'auth/invalid-email': 'Invalid email format.',
                    'auth/popup-closed-by-user': 'Google login cancelled.',
                    'auth/popup-blocked': 'Popup blocked. Please allow popups.',
                    'auth/network-request-failed': 'Network error occurred.',
                    'auth/too-many-requests': 'Too many requests. Please try again later.',
                    'default': 'Error occurred during login.'
                },
                pt: {
                    'auth/user-not-found': 'Email nÃ£o registrado.',
                    'auth/wrong-password': 'Senha incorreta.',
                    'auth/email-already-in-use': 'Email jÃ¡ em uso.',
                    'auth/weak-password': 'Senha muito fraca. (mÃ­nimo 6 caracteres)',
                    'auth/invalid-email': 'Formato de email invÃ¡lido.',
                    'auth/popup-closed-by-user': 'Login do Google cancelado.',
                    'auth/popup-blocked': 'Popup bloqueado. Permita popups.',
                    'auth/network-request-failed': 'Erro de rede ocorreu.',
                    'auth/too-many-requests': 'Muitas solicitaÃ§Ãµes. Tente novamente mais tarde.',
                    'default': 'Erro durante o login.'
                }
            };
            
            return messages[lang][errorCode] || messages[lang]['default'];
        }
        
        // ì´ë©”ì¼ ë¡œê·¸ì¸ í•¨ìˆ˜
        async function loginWithEmail(email, password) {
            try {
                setButtonsDisabled(true);
                showSuccess('ë¡œê·¸ì¸ ì¤‘...');
                
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                currentUser = userCredential.user;
                
                showSuccess('ë¡œê·¸ì¸ ì„±ê³µ!');
                setTimeout(() => {
                    hideLoginModal();
                }, 1000);
                
                return true;
            } catch (error) {
                console.error('ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
                showError(getFirebaseErrorMessage(error.code, currentLanguage));
                return false;
            } finally {
                setButtonsDisabled(false);
            }
        }
        
        // íšŒì›ê°€ì… í•¨ìˆ˜
        async function signUpWithEmail(email, password) {
            try {
                setButtonsDisabled(true);
                showSuccess('ê³„ì • ìƒì„± ì¤‘...');
                
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                currentUser = userCredential.user;
                
                showSuccess('ê³„ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!');
                setTimeout(() => {
                    hideLoginModal();
                }, 1000);
                
                return true;
            } catch (error) {
                console.error('íšŒì›ê°€ì… ì˜¤ë¥˜:', error);
                showError(getFirebaseErrorMessage(error.code, currentLanguage));
                return false;
            } finally {
                setButtonsDisabled(false);
            }
        }
        
        // Google ë¡œê·¸ì¸ í•¨ìˆ˜
        async function loginWithGoogle() {
            try {
                setButtonsDisabled(true);
                showSuccess('Google ë¡œê·¸ì¸ ì¤‘...');
                
                const provider = new firebase.auth.GoogleAuthProvider();
                provider.addScope('profile');
                provider.addScope('email');
                
                const result = await auth.signInWithPopup(provider);
                currentUser = result.user;
                
                showSuccess('Google ë¡œê·¸ì¸ ì„±ê³µ!');
                setTimeout(() => {
                    hideLoginModal();
                }, 1000);
                
                return true;
            } catch (error) {
                console.error('Google ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
                showError(getFirebaseErrorMessage(error.code, currentLanguage));
                return false;
            } finally {
                setButtonsDisabled(false);
            }
        }
        
        // ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜
        async function logout() {
            try {
                await auth.signOut();
                currentUser = null;
                location.reload();
            } catch (error) {
                console.error('ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:', error);
                alert('ë¡œê·¸ì•„ì›ƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // ë¡œê·¸ì¸ ëª¨ë‹¬ ìˆ¨ê¸°ê¸°
        function hideLoginModal() {
            const modal = document.getElementById('loginModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        // ë¡œê·¸ì¸ ëª¨ë‹¬ ë³´ì´ê¸°
        function showLoginModal() {
            const modal = document.getElementById('loginModal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        
        // ì¸ì¦ ìƒíƒœ í™•ì¸ ë° ì²˜ë¦¬
        function checkAuthentication() {
            if (!auth) {
                console.log('Firebase ì¸ì¦ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                showError('Firebase ì„œë¹„ìŠ¤ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            auth.onAuthStateChanged((user) => {
                if (user) {
                    console.log('ì‚¬ìš©ì ì¸ì¦ë¨:', user.email);
                    currentUser = user;
                    hideLoginModal();
                    initializePortal();
                } else {
                    console.log('ì‚¬ìš©ì ì¸ì¦ë˜ì§€ ì•ŠìŒ');
                    currentUser = null;
                    showLoginModal();
                }
            });
        }
        
        // ============ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ============
        
        function setupAuthEventListeners() {
            // ë¡œê·¸ì¸ í¼ ì œì¶œ
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const email = document.getElementById('loginEmail').value.trim();
                    const password = document.getElementById('loginPassword').value;
                    
                    if (!email || !password) {
                        showError('ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                        return;
                    }
                    
                    await loginWithEmail(email, password);
                });
            }
            
            // íšŒì›ê°€ì… ë²„íŠ¼
            const signupBtn = document.getElementById('signupBtn');
            if (signupBtn) {
                signupBtn.addEventListener('click', async () => {
                    const email = document.getElementById('loginEmail').value.trim();
                    const password = document.getElementById('loginPassword').value;
                    
                    if (!email || !password) {
                        showError('ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                        return;
                    }
                    
                    await signUpWithEmail(email, password);
                });
            }
            
            // Google ë¡œê·¸ì¸ ë²„íŠ¼
            const googleLoginBtn = document.getElementById('googleLoginBtn');
            if (googleLoginBtn) {
                googleLoginBtn.addEventListener('click', async () => {
                    await loginWithGoogle();
                });
            }
            
            // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', async () => {
                    if (confirm('ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        await logout();
                    }
                });
            }
        }
        
        // ============ íƒ€ì´í•‘ íš¨ê³¼ í•¨ìˆ˜ë“¤ ============
        
        function clearAllTypingIntervals() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
        }
        
        function typeWriter(element, text, speed = 50, callback = null) {
            if (!element) return;
            
            clearAllTypingIntervals();
            element.textContent = '';
            element.classList.add('typing-cursor');
            
            let i = 0;
            const interval = setInterval(() => {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                } else {
                    clearInterval(interval);
                    element.classList.remove('typing-cursor');
                    if (callback) callback();
                }
            }, speed);
            
            typingIntervals.push(interval);
        }
        
        // ============ ì–¸ì–´ ë³€ê²½ í•¨ìˆ˜ ============
        
        function updateLanguage(lang) {
            currentLanguage = lang;
            document.documentElement.lang = lang;
            
            // URL ì—…ë°ì´íŠ¸
            const url = new URL(window.location);
            url.searchParams.set('lang', lang);
            window.history.replaceState({}, '', url);
            
            // ì–¸ì–´ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
            
            // ë²ˆì—­ í…ìŠ¤íŠ¸ ì ìš©
            const t = translations[lang];
            if (t) {
                // í—¤ë” í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
                const elements = {
                    'logoSubtitle': t.logoSubtitle,
                    'portalMainTitle': t.portalMainTitle,
                    'portalSubtitle': t.portalSubtitle,
                    'loginSubtitle': t.loginSubtitle,
                    'loginBtn': t.loginBtn,
                    'signupBtn': t.signupBtn,
                    'logoutBtn': t.logoutBtn,
                    'lightTitle': t.lightTitle
                };
                
                for (const [id, text] of Object.entries(elements)) {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = text;
                    }
                }
                
                // Google ë¡œê·¸ì¸ ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
                const googleBtn = document.getElementById('googleLoginBtn');
                if (googleBtn) {
                    googleBtn.innerHTML = t.googleLoginBtn;
                }
                
                // ê³„ì†í•˜ê¸° ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
                const continueYesBtn = document.getElementById('continueYesBtn');
                const continueNoBtn = document.getElementById('continueNoBtn');
                if (continueYesBtn) continueYesBtn.textContent = t.continueYes;
                if (continueNoBtn) continueNoBtn.textContent = t.continueNo;
                
                // ì…ë ¥ì°½ placeholder ì—…ë°ì´íŠ¸
                const textarea = document.getElementById('userTextarea');
                if (textarea) {
                    textarea.placeholder = t.inputPlaceholder;
                }
                
                // ì½˜í…ì¸ ê°€ ì´ë¯¸ ë¡œë“œë˜ì—ˆë‹¤ë©´ ë‹¤ì‹œ ì´ˆê¸°í™”
                if (journeyStarted && currentUser) {
                    initializePortal();
                }
            }
        }
        
        // ============ í¬í„¸ ì´ˆê¸°í™” í•¨ìˆ˜ ============
        
        function initializePortal() {
            if (!currentUser) return;
            
            journeyStarted = true;
            clearAllTypingIntervals();
            
            const t = translations[currentLanguage];
            
            // í¬í„¸ ì¸íŠ¸ë¡œ íƒ€ì´í•‘
            setTimeout(() => {
                const introElement = document.getElementById('portalIntro');
                const introSection = document.getElementById('portalIntroSection');
                
                if (introElement && introSection) {
                    introSection.classList.add('show');
                    typeWriter(introElement, t.portalIntro, 30, () => {
                        showCharacterResponses();
                    });
                }
            }, 500);
        }
        
        function showCharacterResponses() {
            const t = translations[currentLanguage];
            const responseSection = document.getElementById('characterResponsesSection');
            
            if (!responseSection) return;
            
            responseSection.innerHTML = '';
            responseSection.classList.add('show');
            
            characters.forEach((char, index) => {
                setTimeout(() => {
                    const charDiv = document.createElement('div');
                    charDiv.className = 'character-response';
                    charDiv.innerHTML = `
                        <div class="character-name">${char.emoji} ${char.name}</div>
                        <div class="character-dialogue"></div>
                    `;
                    
                    responseSection.appendChild(charDiv);
                    
                    setTimeout(() => {
                        charDiv.classList.add('show');
                        const dialogueElement = charDiv.querySelector('.character-dialogue');
                        if (dialogueElement) {
                            typeWriter(dialogueElement, t[char.key], 25, () => {
                                if (index === characters.length - 1) {
                                    showLightMessage();
                                }
                            });
                        }
                    }, 100);
                }, index * 2000);
            });
        }
        
        function showLightMessage() {
            setTimeout(() => {
                const lightSection = document.getElementById('lightMessageSection');
                const lightMessage = document.getElementById('lightMessage');
                const t = translations[currentLanguage];
                
                if (lightSection && lightMessage) {
                    lightSection.classList.add('show');
                    typeWriter(lightMessage, t.lightMessage, 40, () => {
                        showPortalQuestion();
                    });
                }
            }, 1500);
        }
        
        function showPortalQuestion() {
            setTimeout(() => {
                const questionSection = document.getElementById('portalQuestionSection');
                const questionElement = document.getElementById('portalQuestion');
                const inputBottom = document.getElementById('inputFixedBottom');
                const t = translations[currentLanguage];
                
                if (questionSection && questionElement && inputBottom) {
                    questionSection.classList.add('show');
                    typeWriter(questionElement, t.portalQuestion, 35, () => {
                        inputBottom.classList.add('show');
                        setupUserInput();
                    });
                }
            }, 1000);
        }
        
        function setupUserInput() {
            const textarea = document.getElementById('userTextarea');
            if (!textarea) return;
            
            textarea.disabled = false;
            textarea.focus();
            
            // Enter í‚¤ë¡œ ì œì¶œ
            textarea.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const input = textarea.value.trim();
                    
                    if (input.length > 0) {
                        submitUserResponse(input);
                    }
                }
            });
            
            // ìë™ ë†’ì´ ì¡°ì ˆ
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function submitUserResponse(input) {
            userResponse = input;
            const textarea = document.getElementById('userTextarea');
            const inputBottom = document.getElementById('inputFixedBottom');
            const userSection = document.getElementById('userInputSection');
            const t = translations[currentLanguage];
            
            if (textarea && inputBottom && userSection) {
                textarea.disabled = true;
                inputBottom.classList.remove('show');
                
                // ì‚¬ìš©ì ì‘ë‹µ í‘œì‹œ
                userSection.innerHTML = `
                    <div class="user-response">
                        <strong>${t.youLabel}:</strong> ${userResponse}
                    </div>
                `;
                userSection.classList.add('show');
                
                // ìŠ¤í¬ë¡¤ì„ ì•„ë˜ë¡œ
                setTimeout(() => {
                    userSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    showUserReactions();
                }, 500);
            }
        }
        
        function showUserReactions() {
            const reactionsSection = document.getElementById('userReactionsSection');
            if (!reactionsSection) return;
            
            reactionsSection.innerHTML = '';
            reactionsSection.classList.add('show');
            
            // 3ëª…ì˜ ë°˜ì‘ ìºë¦­í„° ì„ íƒ
            const selectedChars = responseCharacters.slice(0, 3);
            
            selectedChars.forEach((char, index) => {
                setTimeout(() => {
                    const charDiv = document.createElement('div');
                    charDiv.className = 'character-response';
                    charDiv.innerHTML = `
                        <div class="character-name">${char.emoji} ${char.name}</div>
                        <div class="character-dialogue"></div>
                    `;
                    
                    reactionsSection.appendChild(charDiv);
                    
                    setTimeout(() => {
                        charDiv.classList.add('show');
                        const dialogueElement = charDiv.querySelector('.character-dialogue');
                        if (dialogueElement) {
                            const response = char.getResponse(userResponse, currentLanguage);
                            typeWriter(dialogueElement, response, 25, () => {
                                if (index === selectedChars.length - 1) {
                                    showContinueSection();
                                }
                            });
                        }
                    }, 100);
                }, index * 2500);
            });
        }
        
        function showContinueSection() {
            setTimeout(() => {
                const continueSection = document.getElementById('continueSection');
                const continueText = document.getElementById('continueText');
                const t = translations[currentLanguage];
                
                if (continueSection && continueText) {
                    continueSection.classList.add('show');
                    typeWriter(continueText, t.continueText, 40, () => {
                        setupContinueButtons();
                    });
                }
            }, 1500);
        }
        
        function setupContinueButtons() {
            const continueYesBtn = document.getElementById('continueYesBtn');
            const continueNoBtn = document.getElementById('continueNoBtn');
            
            if (continueYesBtn) {
              continueYesBtn.addEventListener('click', () => {
                const lang = new URLSearchParams(window.location.search).get("lang") || "en";
                window.location.href = `temarix_v02_02.html?lang=${lang}`;
              });
            }

            
            if (continueNoBtn) {
                continueNoBtn.addEventListener('click', () => {
                    if (confirm('ì •ë§ë¡œ ì—¬ì •ì„ ëë‚´ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        location.reload();
                    }
                });
            }
        }
        
        // ============ ì–¸ì–´ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ============
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const lang = btn.dataset.lang;
                    if (lang && lang !== currentLanguage) {
                        updateLanguage(lang);
                    }
                });
            });
        }
        
        // ============ ì´ˆê¸°í™” í•¨ìˆ˜ ============
        
        function initialize() {
            console.log('ì•± ì´ˆê¸°í™” ì‹œì‘');
            
            // ì–¸ì–´ ì„¤ì • ì ìš©
            updateLanguage(currentLanguage);
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            setupAuthEventListeners();
            setupLanguageButtons();
            
            // Firebase ì¸ì¦ í™•ì¸
            checkAuthentication();
            
            console.log('ì•± ì´ˆê¸°í™” ì™„ë£Œ');
        }
        
        // ============ ì•± ì‹œì‘ ============
        
        // DOM ë¡œë“œ ì™„ë£Œ í›„ ì´ˆê¸°í™”
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initialize);
        } else {
            initialize();
        }
        
        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì •ë¦¬
        window.addEventListener('beforeunload', () => {
            clearAllTypingIntervals();
        });
        
    </script>
<script>
  document.getElementById("continueYesBtn").onclick = function () {
    const lang = new URLSearchParams(window.location.search).get('lang') || 'ko';
    window.location.href = `temarix_v02_02.html?lang=${lang}`;
  };
</script>

</body>
</html>