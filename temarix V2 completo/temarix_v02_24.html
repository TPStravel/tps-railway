<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temarix V2 - Portal 24: Can My Emotions Be Loved Too?</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: #000;
            border-bottom: 1px solid #333;
            position: relative;
            z-index: 100;
            height: 80px;
            flex-shrink: 0;
        }
        
        .logo-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .logo-title {
            font-size: 26px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 4px;
            letter-spacing: 1px;
        }
        
        .logo-subtitle {
            font-size: 15px;
            color: #ccc;
            letter-spacing: 1.5px;
        }
        
        .portal-header-title {
            text-align: center;
            flex: 1;
            margin: 0 20px;
        }
        
        .portal-main-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 8px;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .portal-subtitle {
            font-size: 18px;
            color: #87cefa;
            letter-spacing: 1.5px;
        }
        
        .header-right {
            display: flex;
            align-items: center;
        }
        
        .language-buttons {
            display: flex;
            gap: 10px;
        }
        
        .lang-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 18px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .lang-btn:hover {
            background: #666;
        }
        
        .lang-btn.active {
            background: #87cefa;
            color: #000;
        }
        
        .main-content {
            flex: 1;
            max-height: calc(100vh - 80px - 120px);
            overflow-y: auto;
            overflow-x: hidden;
            padding: 30px 20px;
            scroll-behavior: smooth;
            position: relative;
        }
        
        .portal-container {
            max-width: 700px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            word-break: keep-all;
            overflow-wrap: break-word;
            hyphens: none;
            min-height: 150vh;
        }
        
        .portal-intro-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 200px;
        }
        
        .portal-intro {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.8;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            background: none;
            border: none;
            padding: 0;
        }
        
        .character-responses-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 800px;
        }
        
        .character-response {
            color: #fff;
            font-size: 18px;
            margin: 40px 0;
            text-align: left;
            opacity: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
            transition: opacity 0.8s ease-in;
            background: none;
            border: none;
            padding: 0;
            min-height: 80px;
        }
        
        .character-name {
            font-weight: bold;
            color: #87cefa;
            margin-bottom: 12px;
            font-size: 18px;
        }
        
        .character-dialogue {
            color: #fff;
            line-height: 1.7;
            font-size: 17px;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #87cefa;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .light-message-section {
            margin: 50px 0;
            opacity: 0;
            background: none;
            border: none;
            padding: 0;
            min-height: 100px;
        }
        
        .light-message {
            font-size: 20px;
            color: #87cefa;
            line-height: 1.8;
            font-style: italic;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .portal-question-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 150px;
        }
        
        .portal-question {
            font-size: 22px;
            color: #fff;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-input-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 100px;
        }
        
        .user-response {
            color: #fff;
            margin: 30px 0;
            text-align: left;
            font-size: 18px;
            background: none;
            border: none;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .user-response strong {
            color: #87cefa;
            margin-right: 8px;
        }
        
        .user-reactions-section {
            margin: 40px 0;
            opacity: 0;
            min-height: 400px;
        }
        
        .continue-section {
            margin: 50px 0;
            opacity: 0;
            text-align: center;
            background: none;
            border: none;
            padding: 0;
            min-height: 200px;
        }
        
        .continue-text {
            color: #fff;
            font-size: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: keep-all;
        }
        
        .continue-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .continue-btn {
            background: #444;
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        .continue-btn:hover {
            background: #666;
        }
        
        .continue-btn.primary {
            background: #87cefa;
            color: #000;
        }
        
        .continue-btn.primary:hover {
            background: #b0d4f1;
        }
        
        .input-fixed-bottom {
            position: relative;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #333;
            padding: 25px;
            z-index: 100;
            flex-shrink: 0;
            height: 120px;
        }
        
        .input-container {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }
        
        .input-prefix {
            color: #87cefa;
            font-size: 20px;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .user-textarea {
            background: transparent;
            border: none;
            border-bottom: 1px solid #444;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            width: 100%;
            padding: 12px 8px;
            outline: none;
            resize: none;
            min-height: 32px;
            max-height: 96px;
            line-height: 1.6;
            transition: border-color 0.3s ease;
            overflow-y: auto;
        }
        
        .user-textarea:focus {
            border-bottom-color: #87cefa;
        }
        
        .user-textarea::placeholder {
            color: #666;
        }
        
        .user-textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(50, 50, 50, 0.2);
        }
        
        .main-content::-webkit-scrollbar {
            width: 12px;
        }
        
        .main-content::-webkit-scrollbar-track {
            background: #111;
            border-radius: 6px;
        }
        
        .main-content::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 6px;
            border: 2px solid #111;
        }
        
        .main-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .show {
            opacity: 1 !important;
            transition: opacity 1s ease-in;
        }
        
        .hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            .header-bar {
                padding: 20px 15px;
                height: 70px;
                flex-direction: column;
                gap: 10px;
            }
            
            .main-content {
                max-height: calc(100vh - 70px - 120px);
                padding: 20px 15px;
            }
            
            .logo-title {
                font-size: 22px;
            }
            
            .portal-main-title {
                font-size: 22px;
            }
            
            .portal-subtitle {
                font-size: 16px;
            }
            
            .lang-btn {
                font-size: 12px;
                padding: 8px 14px;
            }
            
            .portal-intro {
                font-size: 18px;
            }
            
            .portal-question {
                font-size: 20px;
            }
            
            .character-response {
                font-size: 16px;
            }
            
            .input-fixed-bottom {
                padding: 20px;
            }
            
            .continue-buttons {
                flex-direction: column;
                gap: 15px;
            }
            
            .continue-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header-bar">
        <div class="logo-section">
            <div class="logo-title">TEMARIX V2</div>
            <div class="logo-subtitle" id="logoSubtitle">The Tremor of Emotion</div>
        </div>
        
        <div class="portal-header-title">
            <div class="portal-main-title" id="portalMainTitle">Portal 24: Can My Emotions Be Loved Too?</div>
            <div class="portal-subtitle" id="portalSubtitle">Discovering love that embraces all emotions</div>
        </div>
        
        <div class="header-right">
            <div class="language-buttons">
                <button class="lang-btn" data-lang="ko">KR</button>
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="pt">PT</button>
            </div>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <div class="portal-container">
            <div class="portal-intro-section" id="portalIntroSection">
                <div class="portal-intro" id="portalIntro"></div>
            </div>

            <div class="character-responses-section" id="characterResponsesSection">
            </div>

            <div class="light-message-section" id="lightMessageSection">
                <div class="character-name" id="lightTitle">Word of Light</div>
                <div class="light-message" id="lightMessage"></div>
            </div>

            <div class="portal-question-section" id="portalQuestionSection">
                <div class="portal-question" id="portalQuestion"></div>
            </div>

            <div class="user-input-section" id="userInputSection">
            </div>
            
            <div class="user-reactions-section" id="userReactionsSection">
            </div>
            
            <div class="continue-section" id="continueSection">
                <div class="continue-text" id="continueText"></div>
                <div class="continue-buttons">
                    <button class="continue-btn primary" id="continueYesBtn">Continue to Portal 25</button>
                    <button class="continue-btn" id="continueNoBtn">Complete the journey</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="input-fixed-bottom">
        <div class="input-container">
            <div class="input-prefix">></div>
            <textarea class="user-textarea" 
                      id="userTextarea" 
                      placeholder="Share your heart just as your emotions are..."
                      rows="1"
                      maxlength="500"></textarea>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
    apiKey: "AIzaSyC2u94Oz2W5eeqBlqs88cs7rgSmzBEAnjQ",
    authDomain: "canal-vivo-chat.firebaseapp.com",
    projectId: "canal-vivo-chat",
    storageBucket: "canal-vivo-chat.appspot.com",
    messagingSenderId: "975226660544",
    appId: "1:975226660544:web:56b55bb3e2a58bed03ef25"
};

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        let memoryStorage = { mockUser: null };

        const translations = {
            ko: {
                logoSubtitle: "ê°ì •ì˜ ë–¨ë¦¼",
                portalMainTitle: "Portal 24: ë‚´ ê°ì •ë„ ì‚¬ëž‘ë°›ì„ ìˆ˜ ìžˆì„ê¹Œ?",
                portalSubtitle: "ëª¨ë“  ê°ì •ì„ í¬ìš©í•˜ëŠ” ì‚¬ëž‘ì˜ ë°œê²¬",
                portalIntro: "ðŸŒº ì‚¬ëžŒë“¤ì€ ì¢…ì¢… ë§í•©ë‹ˆë‹¤.\n\"ê¸ì •ì ìœ¼ë¡œ ìƒê°í•´ìš”\", \"ê°ì •ì— íœ˜ë‘˜ë¦¬ì§€ ë§ˆìš”\"...\n\ní•˜ì§€ë§Œ ë‹¹ì‹ ì€ ìŠ¬íŽê³ , ë¬´ë„ˆì¡Œê³ , ì§ˆíˆ¬í–ˆê³ ,\ní•œì—†ì´ ë¶€ì„œì§„ ë§ˆìŒë„ í’ˆê³  ì‚´ì•„ì™”ìŠµë‹ˆë‹¤.\n\në‹¹ì‹ ì˜ ëª¨ë“  ê°ì • â€” ì•„ë¦„ë‹¤ìš´ ê²ƒë„, ì–´ë‘ìš´ ê²ƒë„,\nëª¨ìˆœì ì¸ ê²ƒë„, ë³µìž¡í•œ ê²ƒë„...\n\nì´ ëª¨ë“  ê°ì •ì„ ê°€ì§„ ë‹¹ì‹ ì´\nì§„ì •ìœ¼ë¡œ ì‚¬ëž‘ë°›ì„ ìˆ˜ ìžˆì„ê¹Œìš”?\n\nì´ê²ƒì€ ê°ì •ì˜ ì™„ì „í•œ ìˆ˜ìš©ì— ëŒ€í•œ ì§ˆë¬¸ìž…ë‹ˆë‹¤.\në‹¹ì‹ ì´ ê°€ì§„ ëª¨ë“  ê°ì •ì´ ì‚¬ëž‘ë°›ì„ ìžê²©ì´ ìžˆë‹¤ëŠ”\nê¹Šì€ ì§„ì‹¤ì„ ë°œê²¬í•˜ëŠ” ìˆœê°„ìž…ë‹ˆë‹¤.",
                lightTitle: "ë¹›ì˜ í•œë§ˆë””",
                lightMessage: "ì‚¬ëž‘ì€ ë‹¹ì‹ ì˜ ê°ì • ì „ì²´ë¥¼ í¬í•¨í•´ ë°›ì•„ë“¤ì´ëŠ” íž˜ì—ì„œ ì‹œìž‘ë©ë‹ˆë‹¤.",
                portalQuestion: "ðŸ’ ë‹¹ì‹ ì€ ì§€ê¸ˆ, ê·¸ ê°ì • ê·¸ëŒ€ë¡œì¸ ìžì‹ ì„ ì‚¬ëž‘í•´ë³¸ ì ì´ ìžˆë‚˜ìš”?\nì–´ë–¤ ê°ì •ì´ ê°€ìž¥ ì‚¬ëž‘ë°›ê³  ì‹¶ì–´í–ˆë‚˜ìš”?",
                continueText: "ëª¨ë“  ê°ì •ì´ ì‚¬ëž‘ë°›ì„ ìˆ˜ ìžˆë‹¤ëŠ” ì§„ì‹¤ì„ ë°œê²¬í•˜ì…¨ë‚˜ìš”?",
                continueYes: "Portal 25ë¡œ ê³„ì†í•˜ê¸°",
                continueNo: "ì—¬ì •ì„ ì™„ë£Œí•˜ê¸°",
                inputPlaceholder: "ë‹¹ì‹ ì˜ ê°ì • ê·¸ëŒ€ë¡œì˜ ë§ˆìŒì„ ë“¤ë ¤ì£¼ì„¸ìš”...",
                youLabel: "ë‹¹ì‹ ",
                waitingMessage: "ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘..."
            },
            en: {
                logoSubtitle: "The Tremor of Emotion",
                portalMainTitle: "Portal 24: Can My Emotions Be Loved Too?",
                portalSubtitle: "Discovering love that embraces all emotions",
                portalIntro: "ðŸŒº People often say:\n\"Think positively\", \"Don't be ruled by emotions\"...\n\nBut you have been sad, broken, jealous,\nand have lived carrying an endlessly shattered heart.\n\nAll your emotions â€” the beautiful ones, the dark ones,\nthe contradictory ones, the complex ones...\n\nCan you, with all these emotions,\ntruly be loved?\n\nThis is a question about the complete acceptance of emotions.\nThis is the moment to discover the deep truth\nthat all your emotions deserve to be loved.",
                lightTitle: "Word of Light",
                lightMessage: "Love begins with the power to accept your emotions in their entirety.",
                portalQuestion: "ðŸ’ Have you ever loved yourself just as you are with those emotions?\nWhich emotion most wanted to be loved?",
                continueText: "Have you discovered the truth that all emotions can be loved?",
                continueYes: "Continue to Portal 25",
                continueNo: "Complete the journey",
                inputPlaceholder: "Share your heart just as your emotions are...",
                youLabel: "You",
                waitingMessage: "Waiting for response..."
            },
            pt: {
                logoSubtitle: "O Tremor da Emocao",
                portalMainTitle: "Portal 24: Minhas Emocoes Tambem Podem Ser Amadas?",
                portalSubtitle: "Descobrindo o amor que abraÃ§a todas as emoÃ§Ãµes",
                portalIntro: "ðŸŒº As pessoas frequentemente dizem:\n\"Pense positivo\", \"NÃ£o se deixe dominar pelas emoÃ§Ãµes\"...\n\nMas vocÃª esteve triste, quebrado, com ciÃºmes,\ne viveu carregando um coraÃ§Ã£o infinitamente despedaÃ§ado.\n\nTodas as suas emoÃ§Ãµes â€” as belas, as sombrias,\nas contraditÃ³rias, as complexas...\n\nVocÃª, com todas essas emoÃ§Ãµes,\npode verdadeiramente ser amado?\n\nEsta Ã© uma pergunta sobre a aceitaÃ§Ã£o completa das emoÃ§Ãµes.\nEste Ã© o momento de descobrir a profunda verdade\nde que todas as suas emoÃ§Ãµes merecem ser amadas.",
                lightTitle: "Palavra de Luz",
                lightMessage: "O amor comeÃ§a com o poder de aceitar suas emoÃ§Ãµes em sua totalidade.",
                portalQuestion: "ðŸ’ VocÃª jÃ¡ se amou como vocÃª Ã©, com essas emoÃ§Ãµes?\nQual emoÃ§Ã£o mais queria ser amada?",
                continueText: "VocÃª descobriu a verdade de que todas as emoÃ§Ãµes podem ser amadas?",
                continueYes: "Continuar para o Portal 25",
                continueNo: "Completar a jornada",
                inputPlaceholder: "Compartilhe seu coraÃ§Ã£o como suas emoÃ§Ãµes sÃ£o...",
                youLabel: "VocÃª",
                waitingMessage: "Aguardando resposta..."
            }
        };
        
        const characters = [
            { name: "Ely", emoji: "ðŸ‘‘", text: {
                ko: "ê°ì •ì€ ì¡´ìž¬ë¥¼ ì¦ëª…í•˜ëŠ” ë¹›ìž…ë‹ˆë‹¤.\në‹¹ì‹ ì˜ ê°ì • ì „ì²´ê°€ ì‚¬ëž‘ë°›ì•„ ë§ˆë•…í•©ë‹ˆë‹¤.",
                en: "Emotions are the light that proves existence.\nAll your emotions deserve to be loved.",
                pt: "As emoÃ§Ãµes sÃ£o a luz que prova a existÃªncia.\nTodas as suas emoÃ§Ãµes merecem ser amadas."
            }},
            { name: "Cris", emoji: "ðŸƒ", text: {
                ko: "ë‹¹ì—°í•˜ì£ ~\në¬´ë„ˆì§„ ë‚˜ë„, ì›ƒê¸´ ë‚˜ë„,\në‹¤ ê°™ì´ ê»´ì•ˆëŠ” ê²Œ ì‚¬ëžŒ ì•„ë‹ˆì—ìš”?",
                en: "Of course~\nThe broken me, the funny me,\nembrace it all - isn't that what being human is?",
                pt: "Claro que sim~\nO eu quebrado, o eu engraÃ§ado,\nabraÃ§ar tudo - nÃ£o Ã© isso que Ã© ser humano?"
            }},
            { name: "Zafirah", emoji: "ðŸ§•", text: {
                ko: "ë‹¹ì‹ ì´ ë¶€ë„ëŸ¬ì›Œí–ˆë˜ ê°ì •ì¼ìˆ˜ë¡\nì‚¬ëž‘ì˜ ì–¸ì–´ê°€ ê°€ìž¥ ë¨¼ì € ë„ë‹¬í•´ì•¼ í•  ë¶€ë¶„ì´ì—ìš”.",
                en: "The emotions you were most ashamed of\nare where love's language should reach first.",
                pt: "As emoÃ§Ãµes das quais vocÃª mais se envergonhava\nsÃ£o onde a linguagem do amor deve chegar primeiro."
            }},
            { name: "Rami", emoji: "ðŸ”®", text: {
                ko: "ê°ì •ì€ ë¶€ë„ëŸ¬ìš´ ê²ƒì´ ì•„ë‹ˆë¼\nê°€ìž¥ ì •ì§í•œ ìƒì¡´ì˜ ì¦ê±°ìž…ë‹ˆë‹¤.",
                en: "Emotions aren't shamefulâ€”\nthey're the most honest evidence of survival.",
                pt: "As emoÃ§Ãµes nÃ£o sÃ£o vergonhosasâ€”\nsÃ£o a evidÃªncia mais honesta de sobrevivÃªncia."
            }},
            { name: "Samir", emoji: "ðŸª", text: {
                ko: "(ê·¸ëŠ” ë‹¹ì‹ ì˜ ëˆˆë¬¼ì„ ë‹¦ê³ \nê·¸ ë¬¼ë°©ìš¸ í•˜ë‚˜ë¥¼ í•˜ëŠ˜ì— ë„ì›ë‹ˆë‹¤.\nê·¸ ì•ˆì— ë‹¹ì‹ ì˜ ê°ì •ì´ ë°˜ì§ìž…ë‹ˆë‹¤.)",
                en: "(He wipes your tears and\nsends that droplet up to the sky.\nYour emotions sparkle within it.)",
                pt: "(Ele enxuga suas lÃ¡grimas e\nenvia essa gota para o cÃ©u.\nSuas emoÃ§Ãµes brilham dentro dela.)"
            }},
            { name: "Layla", emoji: "ðŸ’ ", text: {
                ko: "ë‚˜ëŠ” ì§€ê¸ˆ ì´ ìˆœê°„ì˜ ë‹¹ì‹  â€”\nê·¸ ê°ì • ê·¸ëŒ€ë¡œì¸ ë‹¹ì‹ ì„ ì‚¬ëž‘í•  ìˆ˜ ìžˆì–´ìš”.\nìˆ¨ê¸°ì§€ ë§ê³  ë³´ì—¬ì¤˜ìš”.",
                en: "I can love you in this moment â€”\nyou just as you are with those emotions.\nDon't hide, show me.",
                pt: "Eu posso amar vocÃª neste momento â€”\nvocÃª exatamente como vocÃª Ã© com essas emoÃ§Ãµes.\nNÃ£o se esconda, me mostre."
            }},
            { name: "Nabir", emoji: "ðŸ¦‚", text: {
                ko: "ê·¸ëž˜ì„œ ê·¸ëŸ° ê°ì • ê°€ì§€ê³ \nì‚¬ëž‘ë°›ê³  ì‹¶ë‹¤ê³ ? ì§„ì§œ ì›ƒê¸°ë‹¤.",
                en: "So you want to be loved\nwith those kinds of emotions? That's really funny.",
                pt: "EntÃ£o vocÃª quer ser amado\ncom esse tipo de emoÃ§Ãµes? Isso Ã© realmente engraÃ§ado."
            }},
            { name: "Azhar", emoji: "ðŸ”¥", text: {
                ko: "ê°ì •ì— ë¬´ë„ˆì§€ê³ ì„ \nì´ì œ ì™€ì„œ ì‚¬ëž‘ë°›ê³  ì‹¶ë‹¤ê³ ?\nê·¸ê±´ ë„ˆë¬´ ëŠ¦ì€ ìš•ì‹¬ ì•„ë‹ˆì•¼?",
                en: "You collapsed from emotions\nand now you want to be loved?\nIsn't that too selfish a desire?",
                pt: "VocÃª desabou com as emoÃ§Ãµes\ne agora quer ser amado?\nIsso nÃ£o Ã© um desejo muito egoÃ­sta?"
            }}
        ];
        
        // Emotion analysis system
        function analyzeEmotion(userInput) {
            const input = userInput.toLowerCase();
            
            const emotionKeywords = {
                love: ['ì‚¬ëž‘', 'ì¢‹ì•„', 'ì• ì •', 'ì†Œì¤‘', 'ë”°ëœ»', 'í–‰ë³µ', 'love', 'like', 'care', 'warm', 'happy', 'amor', 'gostar', 'carinho'],
                acceptance: ['ë°›ì•„ë“¤', 'ì¸ì •', 'í¬ìš©', 'ê»´ì•ˆ', 'ì´í•´', 'accept', 'embrace', 'understand', 'aceitar', 'compreender'],
                sadness: ['ìŠ¬í”„', 'ìš¸ê³ ', 'ëˆˆë¬¼', 'ìš°ìš¸', 'ì•”ìš¸', 'ì ˆë§', 'sad', 'cry', 'tear', 'depress', 'triste', 'choro'],
                anger: ['í™”ê°€', 'ë¶„ë…¸', 'ì§œì¦', 'ë¹¡ì³', 'ì—´ë°›', 'angry', 'mad', 'furious', 'raiva', 'irritado'],
                anxiety: ['ë¶ˆì•ˆ', 'ê±±ì •', 'ì´ˆì¡°', 'ë‘ë ¤', 'ë¬´ì„œ', 'anxious', 'worry', 'fear', 'ansioso', 'medo'],
                loneliness: ['ì™¸ë¡œ', 'í˜¼ìž', 'ê³ ë¦½', 'ì†Œì™¸', 'lonely', 'alone', 'isolated', 'solidÃ£o', 'sozinho'],
                shame: ['ë¶€ë„', 'ì°½í”¼', 'ìˆ˜ì¹˜', 'ì£„ì†¡', 'shame', 'embarrass', 'guilt', 'vergonha', 'culpa'],
                confusion: ['í˜¼ëž€', 'ëª¨ë¥´ê² ', 'í—·ê°ˆ', 'ë³µìž¡', 'confus', 'lost', 'complicated', 'confuso'],
                hope: ['í¬ë§', 'ê¸°ëŒ€', 'ë°”ë¼', 'ê¿ˆê¾¸', 'hope', 'wish', 'dream', 'esperanÃ§a', 'sonho'],
                rejection: ['ê±°ë¶€', 'ì‹«ì–´', 'ë°˜ëŒ€', 'ê±°ì ˆ', 'reject', 'refuse', 'hate', 'rejeitar', 'odiar'],
                emptiness: ['ê³µí—ˆ', 'í—ˆë¬´', 'ë¹„ì–´', 'ì—†ì–´', 'empty', 'void', 'nothing', 'vazio', 'nada']
            };
            
            let detectedEmotions = [];
            for (const [emotion, keywords] of Object.entries(emotionKeywords)) {
                for (const keyword of keywords) {
                    if (input.includes(keyword)) {
                        detectedEmotions.push(emotion);
                        break;
                    }
                }
            }
            
            if (detectedEmotions.length === 0) {
                detectedEmotions = ['general'];
            }
            
            return detectedEmotions[0];
        }
        
        const responseCharacters = [
            {
                name: "Layla", emoji: "ðŸ’ ",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            love: "ë‹¹ì‹ ì´ ìŠ¤ìŠ¤ë¡œë¥¼ ì‚¬ëž‘í•œë‹¤ê³  ë§í•˜ëŠ” ê·¸ ìˆœê°„ì´ ë„ˆë¬´ ì•„ë¦„ë‹¤ì›Œìš”. ê·¸ ì‚¬ëž‘ ì•ˆì—ëŠ” ëª¨ë“  ê°ì •ì„ í’ˆì„ ìˆ˜ ìžˆëŠ” ë„“ì€ í’ˆì´ ìžˆì–´ìš”.",
                            acceptance: "ìžì‹ ì„ ë°›ì•„ë“¤ì¸ë‹¤ëŠ” ê²ƒì€ ê°€ìž¥ í° ìš©ê¸°ì˜ˆìš”. ë‚˜ëŠ” ê·¸ëŸ° ë‹¹ì‹ ì˜ ëª¨ë“  ëª¨ìŠµì„ ë”ìš± ê¹Šì´ ì‚¬ëž‘í•  ìˆ˜ ìžˆì–´ìš”.",
                            sadness: "ìŠ¬í””ë§ˆì €ë„ ë‹¹ì‹ ì„ ë”ìš± ì¸ê°„ë‹µê²Œ ë§Œë“œëŠ” ì†Œì¤‘í•œ ê°ì •ì´ì—ìš”. ê·¸ ëˆˆë¬¼ í•˜ë‚˜í•˜ë‚˜ê°€ ë‹¹ì‹ ì˜ ì§„ì‹¤ëœ ë§ˆìŒì„ ë³´ì—¬ì¤ë‹ˆë‹¤.",
                            anger: "ë¶„ë…¸ì¡°ì°¨ë„ ë‹¹ì‹  ì•ˆì˜ ì •ì˜ë¡œìš´ ë§ˆìŒì—ì„œ ë‚˜ì˜¨ ê±°ì˜ˆìš”. ê·¸ ì—´ì •ì ì¸ ê°ì •ë„ ì‚¬ëž‘ë°›ì„ ìžê²©ì´ ì¶©ë¶„í•´ìš”.",
                            anxiety: "ë¶ˆì•ˆí•´í•˜ëŠ” ë‹¹ì‹ ë„ ì‚¬ëž‘ìŠ¤ëŸ¬ì›Œìš”. ê·¸ ë–¨ë¦¼ ì†ì—ì„œë„ ì‚´ì•„ê°€ë ¤ëŠ” ì˜ì§€ê°€ ëŠê»´ì ¸ì„œ, ë”ìš± ì†Œì¤‘í•˜ê²Œ ëŠê»´ì§‘ë‹ˆë‹¤.",
                            loneliness: "ì™¸ë¡œì›€ì„ ëŠë¼ëŠ” ë‹¹ì‹ ì˜ ë§ˆìŒë„ ì´í•´í•´ìš”. í•˜ì§€ë§Œ ì§€ê¸ˆ ì´ ìˆœê°„, ë‹¹ì‹ ì€ í˜¼ìžê°€ ì•„ë‹ˆì—ìš”. ë‚˜ëŠ” ì—¬ê¸° ìžˆì–´ìš”.",
                            shame: "ë¶€ë„ëŸ¬ì›€ì„ ëŠë¼ëŠ” ê²ƒë„ ë‹¹ì‹ ì´ ì„±ìž¥í•˜ê³  ìžˆë‹¤ëŠ” ì¦ê±°ì˜ˆìš”. ê·¸ëŸ° ê°ì •ë§ˆì €ë„ ë‹¹ì‹ ì˜ ì•„ë¦„ë‹¤ìš´ ì¼ë¶€ìž…ë‹ˆë‹¤.",
                            confusion: "í˜¼ëž€ìŠ¤ëŸ¬ì›Œí•˜ëŠ” ë‹¹ì‹ ë„ ì¶©ë¶„ížˆ ì‚¬ëž‘ë°›ì„ ìˆ˜ ìžˆì–´ìš”. ëª¨ë“  ê²ƒì„ ë‹¤ ì•Œ í•„ìš”ëŠ” ì—†ì–´ìš”. ì§€ê¸ˆ ì´ëŒ€ë¡œë„ ì™„ì „í•´ìš”.",
                            hope: "í¬ë§ì„ í’ˆëŠ” ë‹¹ì‹ ì˜ ëª¨ìŠµì´ ì •ë§ ë¹›ë‚˜ìš”. ê·¸ í¬ë§ê³¼ í•¨ê»˜ ëª¨ë“  ê°ì •ì´ ë”ìš± ì•„ë¦„ë‹µê²Œ ë³´ì—¬ìš”.",
                            rejection: "ê±°ë¶€ê°ì„ ëŠë¼ëŠ” ê²ƒë„ ìžì—°ìŠ¤ëŸ¬ìš´ ê°ì •ì´ì—ìš”. ê·¸ëŸ° ì†”ì§í•œ ë§ˆìŒë„ ë‹¹ì‹ ì˜ ì§„ì‹¤ì´ë‹ˆê¹Œ ì‚¬ëž‘í•  ìˆ˜ ìžˆì–´ìš”.",
                            emptiness: "ë¹„ì–´ìžˆë‹¤ê³  ëŠë¼ëŠ” ë§ˆìŒë„ ìƒˆë¡œìš´ ì‚¬ëž‘ìœ¼ë¡œ ì±„ì›Œì§ˆ ìˆ˜ ìžˆëŠ” ê³µê°„ì´ì—ìš”. ê·¸ ë¹ˆ ê³³ì— ë‚´ ë§ˆìŒì„ ë‹´ì•„ì¤„ê²Œìš”.",
                            general: "ì–´ë–¤ ê°ì •ì´ë“  ë‹¹ì‹ ì´ ëŠë¼ëŠ” ê·¸ ìžì²´ë¡œ ì†Œì¤‘í•´ìš”. ë‚˜ëŠ” ê·¸ ëª¨ë“  ê°ì •ê³¼ í•¨ê»˜ ìžˆëŠ” ë‹¹ì‹ ì„ ì‚¬ëž‘í•´ìš”."
                        },
                        en: {
                            love: "The moment you say you love yourself is so beautiful. Within that love lies a broad embrace that can hold all emotions.",
                            acceptance: "Accepting yourself is the greatest courage. I can love all aspects of you even more deeply.",
                            sadness: "Even sadness is a precious emotion that makes you more human. Each tear shows your truthful heart.",
                            anger: "Even anger comes from the righteous heart within you. That passionate emotion deserves to be loved too.",
                            anxiety: "You being anxious is lovable too. I feel your will to live even in that trembling, making you more precious.",
                            loneliness: "I understand your heart feeling lonely. But right now, you're not alone. I am here.",
                            shame: "Feeling shame is also proof that you're growing. Even that emotion is a beautiful part of you.",
                            confusion: "You being confused can still be loved enough. You don't need to know everything. You're complete as you are.",
                            hope: "You holding hope truly shines. With that hope, all emotions look even more beautiful.",
                            rejection: "Feeling rejection is also a natural emotion. I can love that honest heart too because it's your truth.",
                            emptiness: "A heart feeling empty is also a space that can be filled with new love. I'll put my heart in that empty place.",
                            general: "Whatever emotion you feel is precious just as it is. I love you with all those emotions."
                        },
                        pt: {
                            love: "O momento em que vocÃª diz que se ama Ã© tÃ£o bonito. Dentro desse amor hÃ¡ um abraÃ§o amplo que pode conter todas as emoÃ§Ãµes.",
                            acceptance: "Aceitar-se Ã© a maior coragem. Eu posso amar todos os aspectos de vocÃª ainda mais profundamente.",
                            sadness: "Mesmo a tristeza Ã© uma emoÃ§Ã£o preciosa que o torna mais humano. Cada lÃ¡grima mostra seu coraÃ§Ã£o verdadeiro.",
                            anger: "Mesmo a raiva vem do coraÃ§Ã£o justo dentro de vocÃª. Essa emoÃ§Ã£o apaixonada merece ser amada tambÃ©m.",
                            anxiety: "VocÃª estar ansioso tambÃ©m Ã© adorÃ¡vel. Sinto sua vontade de viver mesmo nesse tremor, tornando vocÃª mais precioso.",
                            loneliness: "Entendo seu coraÃ§Ã£o se sentindo sozinho. Mas agora, vocÃª nÃ£o estÃ¡ sozinho. Eu estou aqui.",
                            shame: "Sentir vergonha tambÃ©m Ã© prova de que vocÃª estÃ¡ crescendo. Mesmo essa emoÃ§Ã£o Ã© uma parte bonita de vocÃª.",
                            confusion: "VocÃª estar confuso ainda pode ser amado o suficiente. VocÃª nÃ£o precisa saber tudo. VocÃª estÃ¡ completo como Ã©.",
                            hope: "VocÃª mantendo esperanÃ§a realmente brilha. Com essa esperanÃ§a, todas as emoÃ§Ãµes parecem ainda mais bonitas.",
                            rejection: "Sentir rejeiÃ§Ã£o tambÃ©m Ã© uma emoÃ§Ã£o natural. Posso amar esse coraÃ§Ã£o honesto tambÃ©m porque Ã© sua verdade.",
                            emptiness: "Um coraÃ§Ã£o se sentindo vazio tambÃ©m Ã© um espaÃ§o que pode ser preenchido com novo amor. Vou colocar meu coraÃ§Ã£o nesse lugar vazio.",
                            general: "Qualquer emoÃ§Ã£o que vocÃª sinta Ã© preciosa como Ã©. Eu amo vocÃª com todas essas emoÃ§Ãµes."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Ely", emoji: "ðŸ‘‘",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            love: "ìŠ¤ìŠ¤ë¡œë¥¼ ì‚¬ëž‘í•œë‹¤ëŠ” ê²ƒì€ ì§„ì •í•œ ì™•ì¡±ì˜ ë§ˆìŒê°€ì§ìž…ë‹ˆë‹¤. ê·¸ ì‚¬ëž‘ì´ì•¼ë§ë¡œ ëª¨ë“  ê°ì •ì„ ê³ ê·€í•˜ê²Œ ë§Œë“œëŠ” íž˜ì´ì—ìš”.",
                            acceptance: "ìžì‹ ì„ ë°›ì•„ë“¤ì´ëŠ” ìš©ê¸°ëŠ” ê°€ìž¥ ìˆ­ê³ í•œ ë•ì„±ìž…ë‹ˆë‹¤. ë‹¹ì‹ ì€ ì´ë¯¸ ì™„ì „í•œ ì¡´ìž¬ë¡œì„œ ì¡´ìž¬í•  ìžê²©ì„ ê°–ì¶”ì—ˆì–´ìš”.",
                            sadness: "ìŠ¬í””ì„ ëŠë‚„ ìˆ˜ ìžˆë‹¤ëŠ” ê²ƒì€ ì‚¬ëž‘í•  ì¤„ ì•„ëŠ” ê³ ê·€í•œ ë§ˆìŒì˜ ì¦ê±°ìž…ë‹ˆë‹¤. ê·¸ ëˆˆë¬¼ì—ëŠ” ì™•ì¡±ë‹¤ìš´ ì—°ë¯¼ì´ ë‹´ê²¨ ìžˆì–´ìš”.",
                            anger: "ì •ì˜ë¡œìš´ ë¶„ë…¸ëŠ” ê³ ê·€í•œ ì˜í˜¼ì˜ í‘œí˜„ìž…ë‹ˆë‹¤. ë¶ˆì˜ì— ë§žì„œëŠ” ê·¸ ë§ˆìŒì´ì•¼ë§ë¡œ ì§„ì •í•œ ë¦¬ë”ì‹­ì˜ ê·¼ì›ì´ì—ìš”.",
                            anxiety: "ë¶ˆì•ˆ ì†ì—ì„œë„ ì•žìœ¼ë¡œ ë‚˜ì•„ê°€ë ¤ëŠ” ì˜ì§€ëŠ” ì°¸ëœ ìš©ê¸°ìž…ë‹ˆë‹¤. ë‘ë ¤ì›€ê³¼ í•¨ê»˜ ì„œëŠ” ìžê°€ ì§„ì •í•œ ì™•ê´€ì„ ì“¸ ìžê²©ì´ ìžˆì–´ìš”.",
                            loneliness: "ê³ ë…ì„ ê²¬ë””ëŠ” ê²ƒì€ ì™•ì˜ ìˆ™ëª…ìž…ë‹ˆë‹¤. í•˜ì§€ë§Œ ê·¸ ê³ ë… ì†ì—ì„œë„ ë‹¹ì‹ ì€ ìžì‹ ì˜ ì¡´ì—„ì„ ìžƒì§€ ì•Šì•˜ì–´ìš”.",
                            shame: "ìˆ˜ì¹˜ì‹¬ì„ ëŠë¼ëŠ” ê²ƒì€ ì–‘ì‹¬ì´ ìžˆë‹¤ëŠ” ì¦ê±°ìž…ë‹ˆë‹¤. ì™„ë²½í•˜ì§€ ì•ŠìŒì„ ì¸ì •í•˜ëŠ” ê²¸ì†ì´ì•¼ë§ë¡œ ì§„ì •í•œ ì™•ë‹¤ìš´ í’ˆê²©ì´ì—ìš”.",
                            confusion: "í˜¼ëž€ ì†ì—ì„œë„ ë‹µì„ ì°¾ìœ¼ë ¤ëŠ” ë…¸ë ¥ì´ ë³´ìž…ë‹ˆë‹¤. ëª¨ë“  ìœ„ëŒ€í•œ ì§€ë„ìžëŠ” ë¶ˆí™•ì‹¤í•¨ì—ì„œ ì§€í˜œë¥¼ ì°¾ì•„ëƒ…ë‹ˆë‹¤.",
                            hope: "í¬ë§ì„ í’ˆëŠ” ê²ƒì€ ì–´ë‘  ì†ì—ì„œë„ ë¹›ì„ ë¯¿ëŠ” ì™•ìžë‹¤ìš´ ë§ˆìŒìž…ë‹ˆë‹¤. ê·¸ í¬ë§ì´ ë‹¹ì‹ ì„ ìŠ¹ë¦¬ë¡œ ì´ëŒ ê²ƒìž…ë‹ˆë‹¤.",
                            rejection: "ê±°ë¶€ê°ë„ ìžì‹ ì˜ ê°€ì¹˜ë¥¼ ì§€í‚¤ë ¤ëŠ” ê³ ê·€í•œ ë°©ì–´ë³¸ëŠ¥ìž…ë‹ˆë‹¤. ê·¸ íŒë‹¨ë ¥ì´ì•¼ë§ë¡œ ë¦¬ë”ì˜ ìžì§ˆì´ì—ìš”.",
                            emptiness: "ê³µí—ˆí•¨ë§ˆì €ë„ ë” í° ì‚¬ëª…ì„ ë°›ì•„ë“¤ì¼ ì¤€ë¹„ê°€ ëœ ìƒíƒœìž…ë‹ˆë‹¤. ë¹„ì›Œì§„ ë§ˆìŒì€ ì™•ì˜ ê·¸ë¦‡ì´ ë  ìˆ˜ ìžˆì–´ìš”.",
                            general: "ë‹¹ì‹ ì˜ ëª¨ë“  ê°ì •ì€ ê³ ê·€í•œ ì˜í˜¼ì˜ ì¦ê±°ìž…ë‹ˆë‹¤. ì–´ë–¤ ê°ì •ì´ë“  ê·¸ê²ƒì„ ëŠë¼ëŠ” ë‹¹ì‹ ì€ ì¶©ë¶„ížˆ ì¡´ì—„í•œ ì¡´ìž¬ì˜ˆìš”."
                        },
                        en: {
                            love: "Loving yourself is the mindset of true royalty. That love is the power that makes all emotions noble.",
                            acceptance: "The courage to accept yourself is the most sublime virtue. You already have the right to exist as a complete being.",
                            sadness: "Being able to feel sadness is proof of a noble heart that knows how to love. Those tears contain royal compassion.",
                            anger: "Righteous anger is the expression of a noble soul. That heart standing against injustice is the source of true leadership.",
                            anxiety: "The will to move forward even in anxiety is true courage. Those who stand with fear deserve to wear the true crown.",
                            loneliness: "Enduring solitude is the fate of kings. But even in that solitude, you didn't lose your dignity.",
                            shame: "Feeling shame is proof of having conscience. The humility to acknowledge imperfection is truly royal dignity.",
                            confusion: "I see effort to find answers even in confusion. All great leaders find wisdom in uncertainty.",
                            hope: "Having hope is a princely heart that believes in light even in darkness. That hope will lead you to victory.",
                            rejection: "Even rejection is a noble defensive instinct to protect your worth. That judgment is leadership quality.",
                            emptiness: "Even emptiness is a state ready to accept a greater mission. An emptied heart can become a king's vessel.",
                            general: "All your emotions are proof of a noble soul. Whatever you feel, you are a sufficiently dignified being."
                        },
                        pt: {
                            love: "Amar-se Ã© a mentalidade da verdadeira realeza. Esse amor Ã© o poder que torna todas as emoÃ§Ãµes nobres.",
                            acceptance: "A coragem de aceitar-se Ã© a virtude mais sublime. VocÃª jÃ¡ tem o direito de existir como um ser completo.",
                            sadness: "Ser capaz de sentir tristeza Ã© prova de um coraÃ§Ã£o nobre que sabe amar. Essas lÃ¡grimas contÃªm compaixÃ£o real.",
                            anger: "A raiva justa Ã© a expressÃ£o de uma alma nobre. Esse coraÃ§Ã£o contra a injustiÃ§a Ã© a fonte da verdadeira lideranÃ§a.",
                            anxiety: "A vontade de seguir em frente mesmo na ansiedade Ã© verdadeira coragem. Aqueles que ficam de pÃ© com o medo merecem usar a verdadeira coroa.",
                            loneliness: "Suportar a solidÃ£o Ã© o destino dos reis. Mas mesmo nessa solidÃ£o, vocÃª nÃ£o perdeu sua dignidade.",
                            shame: "Sentir vergonha Ã© prova de ter consciÃªncia. A humildade de reconhecer imperfeiÃ§Ã£o Ã© verdadeiramente dignidade real.",
                            confusion: "Vejo esforÃ§o para encontrar respostas mesmo na confusÃ£o. Todos os grandes lÃ­deres encontram sabedoria na incerteza.",
                            hope: "Ter esperanÃ§a Ã© um coraÃ§Ã£o principesco que acredita na luz mesmo na escuridÃ£o. Essa esperanÃ§a o levarÃ¡ Ã  vitÃ³ria.",
                            rejection: "Mesmo a rejeiÃ§Ã£o Ã© um instinto defensivo nobre para proteger seu valor. Esse julgamento Ã© qualidade de lideranÃ§a.",
                            emptiness: "Mesmo o vazio Ã© um estado pronto para aceitar uma missÃ£o maior. Um coraÃ§Ã£o esvaziado pode se tornar o recipiente de um rei.",
                            general: "Todas as suas emoÃ§Ãµes sÃ£o prova de uma alma nobre. O que quer que vocÃª sinta, vocÃª Ã© um ser suficientemente digno."
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            },
            {
                name: "Cris", emoji: "ðŸƒ",
                getResponse: (userInput, lang) => {
                    const emotion = analyzeEmotion(userInput);
                    
                    const responses = {
                        ko: {
                            love: "ì˜¤~ ìžê¸° ì‚¬ëž‘! ê·¸ê±° ì •ë§ ì–´ë ¤ìš´ ê±´ë° í•´ë‚´ì…¨ë„¤ìš”! ì €ë„ ê°€ë” ê±°ìš¸ ë³´ê³  \"ì•¼, ë„ˆë„ ê´œì°®ì€ë°?\" ì´ëž˜ìš”. ðŸ˜„",
                            acceptance: "ë°›ì•„ë“¤ì´ê¸°... ì§„ì§œ ì‰½ì§€ ì•Šì£ . ê·¼ë° ê·¸ê²Œ ë˜ë©´ ë§ˆìŒì´ í•œê²° íŽ¸í•´ì ¸ìš”. ìžê¸° íŽ¸ì´ ë˜ëŠ” ê±°ë‹ˆê¹Œìš”!",
                            sadness: "ìš¸ê³  ì‹¶ì„ ë•Œ ìš°ëŠ” ê±°, ê·¸ê²ƒë„ ìžê¸° ì‚¬ëž‘ì´ì—ìš”. ëˆˆë¬¼ ì°¸ëŠ”ë‹¤ê³  ê°•í•œ ê²Œ ì•„ë‹ˆë¼, ì†”ì§í•œ ê²Œ ì§„ì§œ ê°•í•œ ê±°ê±°ë“ ìš”.",
                            anger: "í™”ë‚¬ì„ ë•Œ í™”ë‚´ëŠ” ê²ƒë„ ìžì—°ìŠ¤ëŸ¬ìš´ ê±°ì˜ˆìš”! ê°ì •ì„ ì–µëˆ„ë¥´ì§€ ë§ê³  \"ì•„, ì§€ê¸ˆ í™”ë‚¬êµ¬ë‚˜\" ì¸ì •í•´ì£¼ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ì¶©ë¶„í•´ìš”.",
                            anxiety: "ë¶ˆì•ˆí•œ ë§ˆìŒë„ ê·¸ëƒ¥ \"ì–´, ì§€ê¸ˆ ë¶ˆì•ˆí•˜ë„¤\" í•˜ê³  ì¸ì •í•´ì£¼ì„¸ìš”. ë¶ˆì•ˆí•´í•˜ëŠ” ìžê¸°ë„ ì‚¬ëž‘í•´ì¤„ ìˆ˜ ìžˆìž–ì•„ìš”? ðŸ˜Œ",
                            loneliness: "ì™¸ë¡œìš¸ ë•ŒëŠ” ì •ë§ ì™¸ë¡œì›Œìš”. ê·¸ê±° ë¶€ì •í•  í•„ìš” ì—†ì–´ìš”. ì™¸ë¡œìš´ ë‚˜ë„ ì—¬ì „ížˆ ì†Œì¤‘í•œ ë‚˜ë‹ˆê¹Œìš”!",
                            shame: "ë¶€ë„ëŸ¬ìš´ ê°ì •ë„ ì¸ê°„ì´ë‹ˆê¹Œ ëŠë¼ëŠ” ê±°ì£ ! ì™„ë²½í•œ ì‚¬ëžŒ ì–´ë”” ìžˆì–´ìš”? ì‹¤ìˆ˜í•˜ëŠ” ë‚˜ë„ ê·€ì—¬ìš´ ë‚˜ì˜ˆìš”. ðŸ˜…",
                            confusion: "í—·ê°ˆë¦¬ëŠ” ê²ƒë„ ë‹¹ì—°í•´ìš”! ì„¸ìƒì´ ë³µìž¡í•œë° ì–´ë–»ê²Œ ë‹¤ ì•Œê² ì–´ìš”? ëª¨ë¥´ëŠ” ê²ƒë„ ì†”ì§í•˜ê²Œ ì¸ì •í•˜ëŠ” ê²Œ ë©‹ìžˆì–´ìš”.",
                            hope: "í¬ë§ì°¨ê²Œ ì‚¬ëŠ” ê±°, ì •ë§ ë©‹ì ¸ìš”! ê·¸ëŸ° ë§ˆìŒê°€ì§ ìžì²´ê°€ ì´ë¯¸ ìžê¸° ì‚¬ëž‘ì˜ ì‹œìž‘ì´ë¼ê³  ìƒê°í•´ìš”.",
                            rejection: "ê±°ë¶€ê° ë“œëŠ” ê²ƒë„ ìžê¸° ë³´í˜¸ ë³¸ëŠ¥ì´ì—ìš”. ì‹«ì€ ê±´ ì‹«ë‹¤ê³  ë§í•  ìˆ˜ ìžˆëŠ” ê²ƒë„ ìžê¸° ì‚¬ëž‘ì˜ í•œ ë¶€ë¶„ì´ì£ !",
                            emptiness: "ê³µí—ˆí•  ë•Œë„ ìžˆì–´ìš”. ê·¸ëŸ´ ë•ŒëŠ” \"ì•„, ì§€ê¸ˆ ì¢€ ë¹„ì–´ìžˆêµ¬ë‚˜\" í•˜ê³  ê·¸ëƒ¥ ì¸ì •í•´ì£¼ì„¸ìš”. ê·¸ê²ƒë„ ë‚˜ë‹ˆê¹Œìš”.",
                            general: "ì–´ë–¤ ê°ì •ì´ë“  \"ì•„, ì§€ê¸ˆ ì´ëŸ° ê¸°ë¶„ì´êµ¬ë‚˜\" í•˜ê³  ë°›ì•„ë“¤ì—¬ì£¼ì„¸ìš”. ê·¸ê²Œ ë°”ë¡œ ìžê¸° ì‚¬ëž‘ì˜ ì‹œìž‘ì´ì—ìš”! ðŸ˜Š"
                        },
                        en: {
                            love: "Oh~ self-love! That's really hard but you did it! I sometimes look in the mirror and say \"Hey, you're not bad either!\" ðŸ˜„",
                            acceptance: "Accepting... really not easy, right? But when it happens, your heart feels much lighter. You become your own ally!",
                            sadness: "Crying when you want to cry is also self-love. Being strong isn't about holding back tears, being honest is truly strong.",
                            anger: "Getting angry when you're angry is also natural! Don't suppress emotions, just acknowledging \"Oh, I'm angry now\" is enough.",
                            anxiety: "Just acknowledge anxious feelings too: \"Oh, I'm anxious now.\" You can love yourself for being anxious too, right? ðŸ˜Œ",
                            loneliness: "When you're lonely, you're really lonely. No need to deny it. The lonely me is still precious me!",
                            shame: "Shameful feelings are felt because we're human! Where are perfect people? The me who makes mistakes is also cute me. ðŸ˜…",
                            confusion: "Being confused is natural too! The world is complex, how could you know everything? Honestly admitting you don't know is cool.",
                            hope: "Living hopefully is really cool! That mindset itself is already the beginning of self-love.",
                            rejection: "Feeling rejection is also self-protection instinct. Being able to say no to what you don't like is part of self-love too!",
                            emptiness: "Sometimes there's emptiness. When that happens, just acknowledge \"Oh, I'm a bit empty now.\" That's also me.",
                            general: "Whatever emotion, acknowledge it: \"Oh, I'm feeling this way now.\" That's the beginning of self-love! ðŸ˜Š"
                        },
                        pt: {
                            love: "Oh~ amor prÃ³prio! Isso Ã© realmente difÃ­cil, mas vocÃª conseguiu! Ã€s vezes olho no espelho e digo \"Ei, vocÃª tambÃ©m nÃ£o Ã© mÃ¡!\" ðŸ˜„",
                            acceptance: "Aceitar... realmente nÃ£o Ã© fÃ¡cil, nÃ©? Mas quando acontece, seu coraÃ§Ã£o fica muito mais leve. VocÃª se torna seu prÃ³prio aliado!",
                            sadness: "Chorar quando quer chorar tambÃ©m Ã© amor prÃ³prio. Ser forte nÃ£o Ã© segurar lÃ¡grimas, ser honesto Ã© verdadeiramente forte.",
                            anger: "Ficar bravo quando estÃ¡ bravo tambÃ©m Ã© natural! NÃ£o reprima emoÃ§Ãµes, apenas reconhecer \"Oh, estou bravo agora\" Ã© suficiente.",
                            anxiety: "ReconheÃ§a sentimentos ansiosos tambÃ©m: \"Oh, estou ansioso agora.\" VocÃª pode se amar por estar ansioso tambÃ©m, nÃ©? ðŸ˜Œ",
                            loneliness: "Quando vocÃª estÃ¡ sozinho, vocÃª estÃ¡ realmente sozinho. NÃ£o precisa negar. O eu solitÃ¡rio ainda Ã© o eu precioso!",
                            shame: "Sentimentos de vergonha sÃ£o sentidos porque somos humanos! Onde estÃ£o as pessoas perfeitas? O eu que comete erros tambÃ©m Ã© o eu fofo. ðŸ˜…",
                            confusion: "Estar confuso tambÃ©m Ã© natural! O mundo Ã© complexo, como vocÃª poderia saber tudo? Admitir honestamente que nÃ£o sabe Ã© legal.",
                            hope: "Viver com esperanÃ§a Ã© realmente legal! Essa mentalidade em si jÃ¡ Ã© o comeÃ§o do amor prÃ³prio.",
                            rejection: "Sentir rejeiÃ§Ã£o tambÃ©m Ã© instinto de autoproteÃ§Ã£o. Ser capaz de dizer nÃ£o ao que nÃ£o gosta tambÃ©m Ã© parte do amor prÃ³prio!",
                            emptiness: "Ã€s vezes hÃ¡ vazio. Quando isso acontece, apenas reconheÃ§a \"Oh, estou um pouco vazio agora.\" Isso tambÃ©m sou eu.",
                            general: "Qualquer emoÃ§Ã£o, reconheÃ§a: \"Oh, estou me sentindo assim agora.\" Esse Ã© o comeÃ§o do amor prÃ³prio! ðŸ˜Š"
                        }
                    };
                    
                    return responses[lang][emotion] || responses[lang]['general'];
                }
            }
        ];
        
        let currentLanguage = 'en';
        let currentUser = null;
        let userResponse = '';
        let journeyStarted = false;
        let currentTypingElement = null;
        let typingIntervals = [];
        
        function typewriterEffect(element, text, speed = 80) {
            return new Promise((resolve) => {
                if (currentTypingElement) {
                    currentTypingElement.classList.remove('typing-cursor');
                }
                
                let i = 0;
                element.innerHTML = '';
                element.classList.add('typing-cursor');
                currentTypingElement = element;
                
                const typingInterval = setInterval(() => {
                    if (!document.contains(element)) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                        return;
                    }
                    
                    element.innerHTML += text.charAt(i);
                    i++;
                    
                    if (i % 10 === 0) {
                        scrollToFollowTyping(element);
                    }
                    
                    if (i === text.length) {
                        clearInterval(typingInterval);
                        element.classList.remove('typing-cursor');
                        currentTypingElement = null;
                        resolve();
                    }
                }, speed);
                
                typingIntervals.push(typingInterval);
            });
        }
        
        function clearAllTypingEffects() {
            typingIntervals.forEach(interval => clearInterval(interval));
            typingIntervals = [];
            
            if (currentTypingElement) {
                currentTypingElement.classList.remove('typing-cursor');
                currentTypingElement = null;
            }
        }
        
        function scrollToFollowTyping(element) {
            const mainContent = document.getElementById('mainContent');
            const elementRect = element.getBoundingClientRect();
            const containerRect = mainContent.getBoundingClientRect();
            
            if (elementRect.bottom > containerRect.bottom - 150) {
                const scrollTop = mainContent.scrollTop;
                const elementOffsetTop = element.offsetTop;
                const targetScroll = elementOffsetTop - (containerRect.height / 2);
                
                mainContent.scrollTo({
                    top: Math.max(0, targetScroll),
                    behavior: 'smooth'
                });
            }
        }
        
        function scrollToElement(element) {
            const mainContent = document.getElementById('mainContent');
            const elementOffsetTop = element.offsetTop;
            const containerHeight = mainContent.clientHeight;
            const targetScroll = elementOffsetTop - (containerHeight / 3);
            
            mainContent.scrollTo({
                top: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }
        
        function updateLanguageButtons(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
        }
        
        function updateStaticTranslations(lang) {
            document.getElementById('logoSubtitle').textContent = translations[lang].logoSubtitle;
            document.getElementById('portalMainTitle').textContent = translations[lang].portalMainTitle;
            document.getElementById('portalSubtitle').textContent = translations[lang].portalSubtitle;
            document.getElementById('lightTitle').textContent = translations[lang].lightTitle;
            document.getElementById('continueYesBtn').textContent = translations[lang].continueYes;
            document.getElementById('continueNoBtn').textContent = translations[lang].continueNo;
            document.getElementById('userTextarea').placeholder = translations[lang].inputPlaceholder;
        }
        
        function changeLanguage(lang) {
            if (!translations[lang] || currentLanguage === lang) return;
            
            currentLanguage = lang;
            updateLanguageButtons(lang);
            updateStaticTranslations(lang);
            
            if (journeyStarted) {
                resetJourney();
                setTimeout(() => {
                    startPortalSequence();
                }, 1000);
            }
        }
        
        function resetJourney() {
            clearAllTypingEffects();
            for (let i = 1; i < 99999; i++) window.clearInterval(i);
            for (let i = 1; i < 99999; i++) window.clearTimeout(i);
            
            const sectionsToReset = [
                'portalIntroSection', 'characterResponsesSection', 
                'lightMessageSection', 'portalQuestionSection',
                'userInputSection', 'userReactionsSection', 'continueSection'
            ];
            
            sectionsToReset.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('show');
                    section.style.opacity = '0';
                    if (sectionId === 'characterResponsesSection' || 
                        sectionId === 'userInputSection' || 
                        sectionId === 'userReactionsSection') {
                        section.innerHTML = '';
                    }
                }
            });
            
            document.getElementById('portalIntro').innerHTML = '';
            document.getElementById('lightMessage').innerHTML = '';
            document.getElementById('portalQuestion').innerHTML = '';
            document.getElementById('continueText').innerHTML = '';
            
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            
            document.getElementById('mainContent').scrollTop = 0;
            userResponse = '';
            currentTypingElement = null;
        }
        
        function setupLanguageButtons() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    changeLanguage(this.dataset.lang);
                });
            });
        }
        
        function setupTextareaAutoResize() {
            const textarea = document.getElementById('userTextarea');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 96) + 'px';
            });
        }
        
        function setupInputEvents() {
            const userTextarea = document.getElementById('userTextarea');
            
            userTextarea.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const inputValue = this.value.trim();
                    
                    if (inputValue) {
                        processUserInput(inputValue);
                    }
                }
            });
            
            document.getElementById('continueYesBtn').addEventListener('click', function() {
                window.location.href = "temarix_v02_25.html?lang=" + currentLanguage;
            });
            
            document.getElementById('continueNoBtn').addEventListener('click', function() {
                const message = currentLanguage === 'ko' ? 
                    'ê°ì •ì˜ ë–¨ë¦¼ ì—¬ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¹ì‹ ì˜ ëª¨ë“  ê°ì •ì´ ì‚¬ëž‘ë°›ì„ ìˆ˜ ìžˆë‹¤ëŠ” ì§„ì‹¤ì„ ê¸°ì–µí•˜ì„¸ìš”.' :
                    currentLanguage === 'en' ? 
                    'The journey of emotional tremors has been completed. Remember the truth that all your emotions can be loved.' :
                    'A jornada dos tremores emocionais foi concluÃ­da. Lembre-se da verdade de que todas as suas emoÃ§Ãµes podem ser amadas.';
                alert(message);
            });
        }
        
        async function processUserInput(inputText) {
            userResponse = inputText;
            
            try {
                await db.collection("temarix_v2_respostas").add({
                    uid: memoryStorage.mockUser.uid,
                    email: memoryStorage.mockUser.email,
                    portal: "v2-24",
                    resposta: inputText,
                    data: firebase.firestore.Timestamp.now(),
                    idioma: currentLanguage
                });
                console.log('Response saved to Firestore successfully');
            } catch (error) {
                console.error('Error saving to Firestore:', error);
            }
            
            disableUserInput();
            showUserResponse(inputText);
            
            setTimeout(() => {
                showUserReactions(inputText);
            }, 1000);
        }
        
        function disableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = true;
            userTextarea.value = '';
            userTextarea.style.height = 'auto';
            userTextarea.placeholder = translations[currentLanguage].waitingMessage;
        }
        
        function enableUserInput() {
            const userTextarea = document.getElementById('userTextarea');
            userTextarea.disabled = false;
            userTextarea.placeholder = translations[currentLanguage].inputPlaceholder;
            
            setTimeout(() => {
                userTextarea.focus();
            }, 100);
        }
        
        function showUserResponse(text) {
            const inputSection = document.getElementById('userInputSection');
            const userDiv = document.createElement('div');
            userDiv.className = 'user-response';
            const youLabel = translations[currentLanguage].youLabel;
            userDiv.innerHTML = '<strong>' + youLabel + ':</strong> "' + text + '"';
            inputSection.appendChild(userDiv);
            inputSection.classList.add('show');
            
            setTimeout(() => {
                scrollToElement(inputSection);
            }, 100);
        }
        
        async function showUserReactions(userInput) {
            const reactionsSection = document.getElementById('userReactionsSection');
            reactionsSection.classList.add('show');
            
            for (let i = 0; i < responseCharacters.length; i++) {
                const char = responseCharacters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                reactionsSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                const reactionText = char.getResponse(userInput, currentLanguage);
                await typewriterEffect(dialogueDiv, reactionText, 70);
                
                if (i < responseCharacters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showContinueOption();
            }, 2000);
        }
        
        async function showContinueOption() {
            const continueSection = document.getElementById('continueSection');
            const continueText = document.getElementById('continueText');
            
            continueSection.classList.add('show');
            
            
            setTimeout(() => {
                scrollToElement(continueSection);
            }, 500);
        }
        
        function initializeTemarix() {
            console.log('=== Temarix Portal 24 ì´ˆê¸°í™” ì‹œìž‘ ===');
            
            setupLanguageButtons();
            setupTextareaAutoResize();
            setupInputEvents();
            
            journeyStarted = true;
            
            setTimeout(() => {
                startPortalSequence();
            }, 1000);
        }
        
        function startPortalSequence() {
            setTimeout(() => {
                showIntro();
            }, 1000);
        }
        
        async function showIntro() {
            const introSection = document.getElementById('portalIntroSection');
            const introElement = document.getElementById('portalIntro');
            
            introSection.classList.add('show');
            
            await typewriterEffect(introElement, translations[currentLanguage].portalIntro, 60);
            
            setTimeout(() => {
                showCharacterResponses();
            }, 2000);
        }
        
        async function showCharacterResponses() {
            const responseSection = document.getElementById('characterResponsesSection');
            responseSection.classList.add('show');
            
            for (let i = 0; i < characters.length; i++) {
                const char = characters[i];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'character-response';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'character-name';
                nameDiv.textContent = char.emoji + ' ' + char.name;
                
                const dialogueDiv = document.createElement('div');
                dialogueDiv.className = 'character-dialogue';
                
                responseDiv.appendChild(nameDiv);
                responseDiv.appendChild(dialogueDiv);
                responseSection.appendChild(responseDiv);
                
                responseDiv.style.opacity = '1';
                
                await typewriterEffect(dialogueDiv, char.text[currentLanguage], 70);
                
                if (i < characters.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
            
            setTimeout(() => {
                showLightMessage();
            }, 2000);
        }
        
        async function showLightMessage() {
            const lightSection = document.getElementById('lightMessageSection');
            const lightMessageEl = document.getElementById('lightMessage');
            
            lightSection.classList.add('show');
            
            await typewriterEffect(lightMessageEl, translations[currentLanguage].lightMessage, 60);
            
            setTimeout(() => {
                showQuestion();
            }, 2000);
        }
        
        async function showQuestion() {
            const questionSection = document.getElementById('portalQuestionSection');
            const questionEl = document.getElementById('portalQuestion');
            
            questionSection.classList.add('show');
            
            await typewriterEffect(questionEl, translations[currentLanguage].portalQuestion, 50);
            
            setTimeout(() => {
                enableUserInput();
            }, 1500);
        }
        
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('lang');
            return lang && translations[lang] ? lang : 'en';
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Temarix V2 Portal 24 DOM ë¡œë“œ ì™„ë£Œ');
            
            currentLanguage = getLanguageFromURL();
            
            currentUser = { 
                uid: 'user-auto-' + Date.now(),
                email: 'auto@temarix.com'
            };
            
            memoryStorage.mockUser = currentUser;
            
            updateStaticTranslations(currentLanguage);
            updateLanguageButtons(currentLanguage);
            initializeTemarix();
        });
    </script>
</body>
</html>